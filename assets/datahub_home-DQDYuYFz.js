var kt=Object.defineProperty;var It=(t,s,r)=>s in t?kt(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r;var pe=(t,s,r)=>It(t,typeof s!="symbol"?s+"":s,r);import{o as y,j as e,s as k,D as le,m as U,aC as qe,a as ge,g as be,r as f,u as Te,Y as Rt,c as me,d as je,T as m,O as Mt,a2 as Je,Q as G,b as D,ap as Pt,aD as Bt,G as Ne,e as Tt,l as Et,h as $t,n as et,v as ae,B as a,q as X,y as zt,w as Ft,C as Lt,x as At,t as tt,p as Dt,aw as Ee,ax as st,R as Ve,ad as Ot,aE as rt,A as $e,a5 as Ht,aF as qt,P as Nt,z as Vt}from"./routes-jbxUH8QT.js";import{R as Wt,j as Kt,k as Ut,E as _t,a as ot,l as Qt,u as ye,S as ve,t as W,d as Zt,g as We,e as Gt,s as Ke,f as Xt}from"./forum-C0vRpnmV.js";import{D as ze}from"./DataExplorationRounded-CmUK5zWf.js";import{S as v,M as T,I as we,D as Yt}from"./DarkModeRounded-HuAMr60S.js";import{B as Jt,N as es}from"./NotificationsRounded-eSRFzgjg.js";import{I as ts,S as ss,O as rs,D as Pe,C as os}from"./SearchRounded-CrC0lK0i.js";import{T as ee,D as ns,u as as}from"./useMutation-vC97ERmO.js";import{d as is}from"./dayjs.min-BsBgiWvZ.js";const cs=y(e.jsx("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})),ls=k(le)(U(({theme:t})=>({display:"flex",marginLeft:`calc(${t.spacing(1)} * 0.5)`,marginRight:`calc(${t.spacing(1)} * 0.5)`,...t.palette.mode==="light"?{backgroundColor:t.palette.grey[100],color:t.palette.grey[700]}:{backgroundColor:t.palette.grey[700],color:t.palette.grey[100]},borderRadius:2,"&:hover, &:focus":{...t.palette.mode==="light"?{backgroundColor:t.palette.grey[200]}:{backgroundColor:t.palette.grey[600]}},"&:active":{boxShadow:t.shadows[0],...t.palette.mode==="light"?{backgroundColor:qe(t.palette.grey[200],.12)}:{backgroundColor:qe(t.palette.grey[600],.12)}}}))),ds=k(cs)({width:24,height:16});function ps(t){const{slots:s={},slotProps:r={},...o}=t,n=t;return e.jsx("li",{children:e.jsx(ls,{focusRipple:!0,...o,ownerState:n,children:e.jsx(ds,{as:s.CollapsedIcon,ownerState:n,...r.collapsedIcon})})})}function hs(t){return be("MuiBreadcrumbs",t)}const us=ge("MuiBreadcrumbs",["root","ol","li","separator"]),xs=t=>{const{classes:s}=t;return je({root:["root"],li:["li"],ol:["ol"],separator:["separator"]},hs,s)},ms=k(m,{name:"MuiBreadcrumbs",slot:"Root",overridesResolver:(t,s)=>[{[`& .${us.li}`]:s.li},s.root]})({}),fs=k("ol",{name:"MuiBreadcrumbs",slot:"Ol",overridesResolver:(t,s)=>s.ol})({display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"}),gs=k("li",{name:"MuiBreadcrumbs",slot:"Separator",overridesResolver:(t,s)=>s.separator})({display:"flex",userSelect:"none",marginLeft:8,marginRight:8});function bs(t,s,r,o){return t.reduce((n,c,i)=>(i<t.length-1?n=n.concat(c,e.jsx(gs,{"aria-hidden":!0,className:s,ownerState:o,children:r},`separator-${i}`)):n.push(c),n),[])}const js=f.forwardRef(function(s,r){const o=Te({props:s,name:"MuiBreadcrumbs"}),{children:n,className:c,component:i="nav",slots:l={},slotProps:h={},expandText:d="Show path",itemsAfterCollapse:p=1,itemsBeforeCollapse:u=1,maxItems:x=8,separator:g="/",...I}=o,[F,O]=f.useState(!1),R={...o,component:i,expanded:F,expandText:d,itemsAfterCollapse:p,itemsBeforeCollapse:u,maxItems:x,separator:g},L=xs(R),H=Rt({elementType:l.CollapsedIcon,externalSlotProps:h.collapsedIcon,ownerState:R}),M=f.useRef(null),P=w=>{const V=()=>{O(!0);const A=M.current.querySelector("a[href],button,[tabindex]");A&&A.focus()};return u+p>=w.length?w:[...w.slice(0,u),e.jsx(ps,{"aria-label":d,slots:{CollapsedIcon:l.CollapsedIcon},slotProps:{collapsedIcon:H},onClick:V},"ellipsis"),...w.slice(w.length-p,w.length)]},E=f.Children.toArray(n).filter(w=>f.isValidElement(w)).map((w,V)=>e.jsx("li",{className:L.li,children:w},`child-${V}`));return e.jsx(ms,{ref:r,component:i,color:"textSecondary",className:me(L.root,c),ownerState:R,...I,children:e.jsx(fs,{className:L.ol,ref:M,ownerState:R,children:bs(F||x&&E.length<=x?E:P(E),L.separator,g,R)})})});function ys(t){return be("PrivateSwitchBase",t)}ge("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const vs=t=>{const{classes:s,checked:r,disabled:o,edge:n}=t,c={root:["root",r&&"checked",o&&"disabled",n&&`edge${D(n)}`],input:["input"]};return je(c,ys,s)},ws=k(le)({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:({edge:t,ownerState:s})=>t==="start"&&s.size!=="small",style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:({edge:t,ownerState:s})=>t==="end"&&s.size!=="small",style:{marginRight:-12}}]}),Cs=k("input",{shouldForwardProp:Pt})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),Ss=f.forwardRef(function(s,r){const{autoFocus:o,checked:n,checkedIcon:c,defaultChecked:i,disabled:l,disableFocusRipple:h=!1,edge:d=!1,icon:p,id:u,inputProps:x,inputRef:g,name:I,onBlur:F,onChange:O,onFocus:R,readOnly:L,required:H=!1,tabIndex:M,type:P,value:E,slots:w={},slotProps:V={},...A}=s,[_,Se]=Mt({controlled:n,default:!!i,name:"SwitchBase",state:"checked"}),$=Je(),Q=b=>{R&&R(b),$&&$.onFocus&&$.onFocus(b)},q=b=>{F&&F(b),$&&$.onBlur&&$.onBlur(b)},Z=b=>{if(b.nativeEvent.defaultPrevented)return;const B=b.target.checked;Se(B),O&&O(b,B)};let te=l;$&&typeof te>"u"&&(te=$.disabled);const yt=P==="checkbox"||P==="radio",ke={...s,checked:_,disabled:te,disableFocusRipple:h,edge:d},Oe=vs(ke),He={slots:w,slotProps:{input:x,...V}},[vt,wt]=G("root",{ref:r,elementType:ws,className:Oe.root,shouldForwardComponentProp:!0,externalForwardedProps:{...He,component:"span",...A},getSlotProps:b=>({...b,onFocus:B=>{var N;(N=b.onFocus)==null||N.call(b,B),Q(B)},onBlur:B=>{var N;(N=b.onBlur)==null||N.call(b,B),q(B)}}),ownerState:ke,additionalProps:{centerRipple:!0,focusRipple:!h,disabled:te,role:void 0,tabIndex:null}}),[Ct,St]=G("input",{ref:g,elementType:Cs,className:Oe.input,externalForwardedProps:He,getSlotProps:b=>({...b,onChange:B=>{var N;(N=b.onChange)==null||N.call(b,B),Z(B)}}),ownerState:ke,additionalProps:{autoFocus:o,checked:n,defaultChecked:i,disabled:te,id:yt?u:void 0,name:I,readOnly:L,required:H,tabIndex:M,type:P,...P==="checkbox"&&E===void 0?{}:{value:E}}});return e.jsxs(vt,{...wt,children:[e.jsx(Ct,{...St}),_?c:p]})});function ks(t){return be("MuiFormControlLabel",t)}const ne=ge("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),Is=t=>{const{classes:s,disabled:r,labelPlacement:o,error:n,required:c}=t,i={root:["root",r&&"disabled",`labelPlacement${D(o)}`,n&&"error",c&&"required"],label:["label",r&&"disabled"],asterisk:["asterisk",n&&"error"]};return je(i,ks,s)},Rs=k("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:r}=t;return[{[`& .${ne.label}`]:s.label},s.root,s[`labelPlacement${D(r.labelPlacement)}`]]}})(U(({theme:t})=>({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${ne.disabled}`]:{cursor:"default"},[`& .${ne.label}`]:{[`&.${ne.disabled}`]:{color:(t.vars||t).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:({labelPlacement:s})=>s==="start"||s==="top"||s==="bottom",style:{marginLeft:16}}]}))),Ms=k("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(t,s)=>s.asterisk})(U(({theme:t})=>({[`&.${ne.error}`]:{color:(t.vars||t).palette.error.main}}))),Ps=f.forwardRef(function(s,r){const o=Te({props:s,name:"MuiFormControlLabel"}),{checked:n,className:c,componentsProps:i={},control:l,disabled:h,disableTypography:d,inputRef:p,label:u,labelPlacement:x="end",name:g,onChange:I,required:F,slots:O={},slotProps:R={},value:L,...H}=o,M=Je(),P=h??l.props.disabled??(M==null?void 0:M.disabled),E=F??l.props.required,w={disabled:P,required:E};["checked","name","onChange","value","inputRef"].forEach(Z=>{typeof l.props[Z]>"u"&&typeof o[Z]<"u"&&(w[Z]=o[Z])});const V=Bt({props:o,muiFormControl:M,states:["error"]}),A={...o,disabled:P,labelPlacement:x,required:E,error:V.error},_=Is(A),Se={slots:O,slotProps:{...i,...R}},[$,Q]=G("typography",{elementType:m,externalForwardedProps:Se,ownerState:A});let q=u;return q!=null&&q.type!==m&&!d&&(q=e.jsx($,{component:"span",...Q,className:me(_.label,Q==null?void 0:Q.className),children:q})),e.jsxs(Rs,{className:me(_.root,c),ownerState:A,ref:r,...H,children:[f.cloneElement(l,w),E?e.jsxs("div",{children:[q,e.jsxs(Ms,{ownerState:A,"aria-hidden":!0,className:_.asterisk,children:[" ","*"]})]}):q]})});function Bs(t){return be("MuiSwitch",t)}const C=ge("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),Ts=t=>{const{classes:s,edge:r,size:o,color:n,checked:c,disabled:i}=t,l={root:["root",r&&`edge${D(r)}`,`size${D(o)}`],switchBase:["switchBase",`color${D(n)}`,c&&"checked",i&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},h=je(l,Bs,s);return{...s,...h}},Es=k("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:r}=t;return[s.root,r.edge&&s[`edge${D(r.edge)}`],s[`size${D(r.size)}`]]}})({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${C.thumb}`]:{width:16,height:16},[`& .${C.switchBase}`]:{padding:4,[`&.${C.checked}`]:{transform:"translateX(16px)"}}}}]}),$s=k(Ss,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(t,s)=>{const{ownerState:r}=t;return[s.switchBase,{[`& .${C.input}`]:s.input},r.color!=="default"&&s[`color${D(r.color)}`]]}})(U(({theme:t})=>({position:"absolute",top:0,left:0,zIndex:1,color:t.vars?t.vars.palette.Switch.defaultColor:`${t.palette.mode==="light"?t.palette.common.white:t.palette.grey[300]}`,transition:t.transitions.create(["left","transform"],{duration:t.transitions.duration.shortest}),[`&.${C.checked}`]:{transform:"translateX(20px)"},[`&.${C.disabled}`]:{color:t.vars?t.vars.palette.Switch.defaultDisabledColor:`${t.palette.mode==="light"?t.palette.grey[100]:t.palette.grey[600]}`},[`&.${C.checked} + .${C.track}`]:{opacity:.5},[`&.${C.disabled} + .${C.track}`]:{opacity:t.vars?t.vars.opacity.switchTrackDisabled:`${t.palette.mode==="light"?.12:.2}`},[`& .${C.input}`]:{left:"-100%",width:"300%"}})),U(({theme:t})=>({"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:Ne(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(t.palette).filter(Tt(["light"])).map(([s])=>({props:{color:s},style:{[`&.${C.checked}`]:{color:(t.vars||t).palette[s].main,"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette[s].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:Ne(t.palette[s].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${C.disabled}`]:{color:t.vars?t.vars.palette.Switch[`${s}DisabledColor`]:`${t.palette.mode==="light"?Et(t.palette[s].main,.62):$t(t.palette[s].main,.55)}`}},[`&.${C.checked} + .${C.track}`]:{backgroundColor:(t.vars||t).palette[s].main}}}))]}))),zs=k("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(t,s)=>s.track})(U(({theme:t})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:t.transitions.create(["opacity","background-color"],{duration:t.transitions.duration.shortest}),backgroundColor:t.vars?t.vars.palette.common.onBackground:`${t.palette.mode==="light"?t.palette.common.black:t.palette.common.white}`,opacity:t.vars?t.vars.opacity.switchTrack:`${t.palette.mode==="light"?.38:.3}`}))),Fs=k("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(t,s)=>s.thumb})(U(({theme:t})=>({boxShadow:(t.vars||t).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}))),Ls=f.forwardRef(function(s,r){const o=Te({props:s,name:"MuiSwitch"}),{className:n,color:c="primary",edge:i=!1,size:l="medium",sx:h,slots:d={},slotProps:p={},...u}=o,x={...o,color:c,edge:i,size:l},g=Ts(x),I={slots:d,slotProps:p},[F,O]=G("root",{className:me(g.root,n),elementType:Es,externalForwardedProps:I,ownerState:x,additionalProps:{sx:h}}),[R,L]=G("thumb",{className:g.thumb,elementType:Fs,externalForwardedProps:I,ownerState:x}),H=e.jsx(R,{...L}),[M,P]=G("track",{className:g.track,elementType:zs,externalForwardedProps:I,ownerState:x});return e.jsxs(F,{...O,children:[e.jsx($s,{type:"checkbox",icon:H,checkedIcon:H,ref:r,ownerState:x,...u,classes:{...g,root:g.switchBase},slots:{...d.switchBase&&{root:d.switchBase},...d.input&&{input:d.input}},slotProps:{...p.switchBase&&{root:typeof p.switchBase=="function"?p.switchBase(x):p.switchBase},...p.input&&{input:typeof p.input=="function"?p.input(x):p.input}}}),e.jsx(M,{...P})]})}),As=y(e.jsx("path",{d:"M6 7c0 .55.45 1 1 1h7.59l-8.88 8.88c-.39.39-.39 1.02 0 1.41s1.02.39 1.41 0L16 9.41V17c0 .55.45 1 1 1s1-.45 1-1V7c0-.55-.45-1-1-1H7c-.55 0-1 .45-1 1"})),Ds=et(),ue=et({cssVariables:{colorSchemeSelector:".mode-%s"},typography:{fontFamily:'Comfortaa, "jf openhuninn"'},colorSchemes:{light:{palette:{primary:{main:"#66cccc",dark:"#45a1a1"},secondary:{main:"#66cccc90",dark:"color-mix(in srgb, #66cccc 50%, var(--mui-palette-text-primary) 50%)"}}},dark:{palette:{primary:{main:"#66cccc",dark:"#2d8686"},secondary:{main:"#66cccc90",dark:"color-mix(in srgb, #66cccc 50%, var(--mui-palette-text-primary) 50%)"},background:{default:"#222",paper:"#222"}}}},breakpoints:{values:{...Ds.breakpoints.values,sm:700,ml:1440}},components:{MuiInputBase:{defaultProps:{sx:{"&.Mui-disabled::before":{borderBottomStyle:"solid"}}}}},spacing:"0.5rem"}),nt=()=>{const t=ae(ue.breakpoints.up("lg")),s=ae(ue.breakpoints.up("md")),r=ae(ue.breakpoints.up("sm"));return f.useEffect(()=>{t?document.documentElement.style.fontSize="16px":s&&(document.documentElement.style.fontSize="14px")},[t,s,r]),{isLg:t,isMd:s,isSm:r}},Os=y(e.jsx("path",{d:"M19 11H7.83l4.88-4.88c.39-.39.39-1.03 0-1.42a.996.996 0 0 0-1.41 0l-6.59 6.59c-.39.39-.39 1.02 0 1.41l6.59 6.59c.39.39 1.02.39 1.41 0s.39-1.02 0-1.41L7.83 13H19c.55 0 1-.45 1-1s-.45-1-1-1"}));function at({error:t,resetErrorBoundary:s,isFatal:r}){return nt(),e.jsxs(a,{sx:{position:"fixed",inset:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",p:{xs:2,sm:4},bgcolor:"background.default"},children:[e.jsx(a,{sx:{position:"absolute",inset:0,bgcolor:"primary.main",opacity:.1,pointerEvents:"none"}}),e.jsx(a,{sx:{position:"absolute",inset:0,pointerEvents:"none",overflow:"hidden",display:"flex",justifyContent:"center"},children:e.jsxs(a,{sx:{position:"absolute",maskImage:"radial-gradient(circle at 50% 25%, #0008 0%, #0008 100%)",pointerEvents:"none",bgcolor:"primary.main",fill:"var(--mui-palette-background-paper)",fillOpacity:.2,width:1,minWidth:1200,height:1},children:[e.jsxs("svg",{style:{scale:"1 -1"},width:"100%",height:"200",viewBox:"0 0 1920 300",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",children:[e.jsx("path",{d:"M0,160 C160,180 320,140 480,160 C640,180 800,120 960,150 C1120,180 1280,130 1440,160 C1600,190 1760,150 1920,170 L1920,300 L0,300 Z"}),e.jsx("path",{d:"M0,190 C120,210 240,160 360,190 C480,220 600,140 720,180 C840,220 960,130 1080,180 C1200,230 1320,160 1440,200 C1560,240 1740,180 1920,210 L1920,300 L0,300 Z"}),e.jsx("path",{d:"M0,230 C160,250 320,190 480,230 C640,270 800,180 960,220 C1120,260 1280,170 1440,210 C1600,250 1760,200 1920,230 L1920,300 L0,300 Z"})]}),e.jsxs("svg",{style:{position:"absolute",inset:"auto 0 0 0"},width:"100%",height:"200",viewBox:"0 0 1920 300",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",children:[e.jsx("path",{d:"M0,160 C160,180 320,140 480,160 C640,180 800,120 960,150 C1120,180 1280,130 1440,160 C1600,190 1760,150 1920,170 L1920,300 L0,300 Z"}),e.jsx("path",{d:"M0,190 C120,210 240,160 360,190 C480,220 600,140 720,180 C840,220 960,130 1080,180 C1200,230 1320,160 1440,200 C1560,240 1740,180 1920,210 L1920,300 L0,300 Z"}),e.jsx("path",{d:"M0,230 C160,250 320,190 480,230 C640,270 800,180 960,220 C1120,260 1280,170 1440,210 C1600,250 1760,200 1920,230 L1920,300 L0,300 Z"})]})]})}),e.jsx(a,{sx:{position:"relative",zIndex:1,display:"grid",placeItems:"center"},children:e.jsxs(v,{sx:{gap:5,alignItems:"center"},children:[e.jsxs(a,{sx:{display:"flex",gap:1,alignItems:"center",translate:"-2.5%"},children:[e.jsx(ze,{sx:{fontSize:"4rem",color:"secondary.dark"}}),e.jsx(m,{variant:"h3",component:"h1",sx:{fontFamily:'"timemachine-wa"',color:"secondary.dark"},children:"資料樣板"})]}),e.jsxs(v,{sx:{gap:1,alignItems:"center"},children:[e.jsx(m,{variant:"h5",component:"h3",children:"發生錯誤"}),e.jsx(m,{variant:"body1",sx:{color:"text.secondary"},children:(t==null?void 0:t.message)||"未知錯誤"})]}),e.jsxs(a,{sx:{display:"flex",gap:2,mt:2,color:"text.secondary"},children:[!r&&e.jsx(X,{variant:"outlined",color:"inherit",disableElevation:!0,href:zt.datahub_home,startIcon:e.jsx(Os,{}),children:"返回首頁"}),s&&e.jsx(X,{variant:"text",color:"inherit",onClick:()=>s(),startIcon:e.jsx(Wt,{}),children:"重新載入"})]})]})})]})}const Hs=()=>e.jsx(at,{error:{message:"請使用寬度超過 700px 的裝置或將視窗放大，以使用此應用程式。"},isFatal:!0}),qs=new Kt;function Ue({children:t}){return e.jsxs(Ft,{theme:ue,children:[e.jsx(Lt,{}),e.jsx(At,{}),e.jsx(Ut,{client:qs,children:e.jsx(_t,{fallbackRender:s=>e.jsx(at,{...s}),children:t})})]})}const Ns=()=>e.jsxs(tt,{select:!0,defaultValue:"db",size:"small",variant:"outlined",sx:{bgcolor:"background.paper",backgroundImage:"linear-gradient(#fff1, #fff1)",borderRadius:1},slotProps:{input:{sx:{"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"secondary.main"},"& .MuiOutlinedInput-notchedOutline":{borderColor:"divider"}}}},children:[e.jsx(T,{value:"db",dense:!0,children:"資料庫"}),e.jsx(T,{value:"table",dense:!0,children:"資料表"}),e.jsx(T,{value:"column",dense:!0,children:"欄位"}),e.jsx(T,{value:"record",dense:!0,children:"紀錄"})]}),Vs=()=>{const[t,s]=f.useState(""),r=c=>s(c.target.value),o="#"+t,n=({key:c})=>{if(c==="Enter"){if(!t.trim())return console.error("請輸入搜尋內容");console.log("還沒寫完，請稍後再試"),window.location.href="#"}};return e.jsx(tt,{variant:"outlined",label:"搜尋",size:"small",sx:{width:"20vw",maxWidth:"22rem",bgcolor:"background.paper",backgroundImage:"linear-gradient(#fff1, #fff1)",borderRadius:1},value:t,onChange:r,onKeyDown:n,slotProps:{input:{sx:{"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"secondary.main"},"& .MuiOutlinedInput-notchedOutline":{borderColor:"divider"}},endAdornment:e.jsx(ee,{title:t.trim()?"搜尋":"請輸入搜尋內容",arrow:!0,children:e.jsx(ts,{position:"end",children:e.jsx(we,{edge:"end",href:o,disabled:!t.trim(),children:e.jsx(ss,{})})})})}}})},Ws=()=>{const[t,s]=f.useState(null),r=n=>s(n.currentTarget),o=()=>s(null);return e.jsxs(e.Fragment,{children:[e.jsx(ee,{title:"切換主題",arrow:!0,children:e.jsx(we,{onClick:r,children:e.jsx(Yt,{})})}),e.jsx(Ks,{open:!!t,anchorEl:t,onClose:o,anchorOrigin:{horizontal:"center",vertical:"bottom"},transformOrigin:{horizontal:"center",vertical:"top"}})]})},Ks=({onClose:t,...s})=>{const{mode:r,setMode:o}=Dt(),n=c=>()=>{o(c),t()};return e.jsx(Ee,{anchorOrigin:{horizontal:"right",vertical:"top"},onClose:t,...s,children:e.jsxs(st,{dense:!0,children:[e.jsx(T,{onClick:n("light"),selected:r==="light",children:"淺色"}),e.jsx(T,{onClick:n("dark"),selected:r==="dark",children:"暗色"}),e.jsx(T,{onClick:n("system"),selected:r==="system",children:"跟隨系統"})]})})},it=y(e.jsx("path",{d:"m8.71 11.71 2.59 2.59c.39.39 1.02.39 1.41 0l2.59-2.59c.63-.63.18-1.71-.71-1.71H9.41c-.89 0-1.33 1.08-.7 1.71"})),Us=()=>{const t=ae(s=>s.breakpoints.up("md"));return e.jsxs(le,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:1,textAlign:"left",borderRadius:1,p:.5,px:1.5,"&:hover":{bgcolor:"action.hover"}},children:[e.jsx(a,{sx:{width:"2.8rem",aspectRatio:1,borderRadius:1,bgcolor:"primary.main",display:"grid",placeItems:"center"},children:e.jsx(m,{variant:"h6",component:"span",sx:{color:"primary.contrastText"},children:"1"})}),e.jsxs(a,{sx:{pr:{xs:0,md:1}},children:[e.jsx(m,{variant:"subtitle1",component:"h6",children:"1ureka"}),t&&e.jsx(m,{variant:"body2",component:"p",color:"text.secondary",children:"資料庫管理員"})]}),e.jsx(a,{sx:{color:"text.secondary"},children:e.jsx(it,{color:"inherit"})})]})},ct=72,se={display:"flex",flexDirection:"row",alignItems:"center"},_s=()=>{const t=ae(s=>s.breakpoints.up("md"));return e.jsxs(a,{component:"header",sx:{position:"relative",gap:3,justifyContent:"space-between",px:3.5,bgcolor:"background.paper",height:ct,...se},children:[e.jsx(a,{sx:{position:"absolute",inset:0,bgcolor:"primary.main",opacity:.1,pointerEvents:"none"}}),e.jsxs(a,{sx:{gap:6,...se},children:[e.jsxs(a,{sx:{gap:1,...se},children:[e.jsx(ze,{sx:{fontSize:"3em",color:"primary.main"}}),t&&e.jsx(m,{variant:"h4",component:"h1",sx:{fontFamily:'"timemachine-wa"',color:"secondary.dark"},children:"資料樣板"})]}),e.jsxs(a,{sx:{gap:.5,...se},children:[e.jsx(Ns,{}),e.jsx(Vs,{})]})]}),e.jsxs(a,{sx:{gap:2,...se},children:[e.jsx(Ws,{}),e.jsx(ee,{title:"通知",arrow:!0,children:e.jsx(we,{children:e.jsx(Jt,{variant:"dot",badgeContent:1,color:"error",children:e.jsx(es,{})})})}),e.jsx(Us,{})]})]})},lt=y(e.jsx("path",{d:"M4 13h6c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v8c0 .55.45 1 1 1m0 8h6c.55 0 1-.45 1-1v-4c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1m10 0h6c.55 0 1-.45 1-1v-8c0-.55-.45-1-1-1h-6c-.55 0-1 .45-1 1v8c0 .55.45 1 1 1M13 4v4c0 .55.45 1 1 1h6c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1h-6c-.55 0-1 .45-1 1"})),dt=y(e.jsx("path",{d:"M14 10.5v.5h-3v-.5c0-.83-.67-1.5-1.5-1.5h-1V7h1c.83 0 1.5-.67 1.5-1.5v-3c0-.83-.67-1.5-1.5-1.5h-4C4.67 1 4 1.67 4 2.5v3C4 6.33 4.67 7 5.5 7h1v2h-1C4.67 9 4 9.67 4 10.5v3c0 .83.67 1.5 1.5 1.5h1v2h-1c-.83 0-1.5.67-1.5 1.5v3c0 .83.67 1.5 1.5 1.5h4c.83 0 1.5-.67 1.5-1.5v-3c0-.83-.67-1.5-1.5-1.5h-1v-2h1c.83 0 1.5-.67 1.5-1.5V13h3v.5c0 .83.67 1.5 1.5 1.5h4c.83 0 1.5-.67 1.5-1.5v-3c0-.83-.67-1.5-1.5-1.5h-4c-.83 0-1.5.67-1.5 1.5"})),pt=y(e.jsx("path",{d:"M4 14h2c.55 0 1-.45 1-1v-2c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1m0 5h2c.55 0 1-.45 1-1v-2c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1M4 9h2c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1m5 5h11c.55 0 1-.45 1-1v-2c0-.55-.45-1-1-1H9c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1m0 5h11c.55 0 1-.45 1-1v-2c0-.55-.45-1-1-1H9c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1M8 6v2c0 .55.45 1 1 1h11c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1H9c-.55 0-1 .45-1 1"})),ht=y(e.jsx("path",{d:"M20 4H4c-1.11 0-2 .9-2 2v12c0 1.1.89 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.89-2-2-2m0 14H4V8h16zm-8-2c0-.55.45-1 1-1h4c.55 0 1 .45 1 1s-.45 1-1 1h-4c-.55 0-1-.45-1-1M6.79 9.71c.39-.39 1.02-.39 1.41 0l2.59 2.59c.39.39.39 1.02 0 1.41L8.2 16.3c-.39.39-1.02.39-1.41 0a.996.996 0 0 1 0-1.41L8.67 13l-1.88-1.88a.996.996 0 0 1 0-1.41"})),Qs=y(e.jsx("path",{d:"M5 10h10c.55 0 1 .45 1 1s-.45 1-1 1H5c-.55 0-1-.45-1-1s.45-1 1-1m0-4h10c.55 0 1 .45 1 1s-.45 1-1 1H5c-.55 0-1-.45-1-1s.45-1 1-1m0 8h6c.55 0 1 .45 1 1s-.45 1-1 1H5c-.55 0-1-.45-1-1s.45-1 1-1m9 .88v4.23c0 .39.42.63.76.43l3.53-2.12c.32-.19.32-.66 0-.86l-3.53-2.12c-.34-.19-.76.05-.76.44"})),Zs=y(e.jsx("path",{d:"M17.7 15.89 13.82 12l3.89-3.89c.39-.39.39-1.02 0-1.41a.996.996 0 0 0-1.41 0l-4.59 4.59c-.39.39-.39 1.02 0 1.41l4.59 4.59c.39.39 1.02.39 1.41 0 .38-.38.38-1.02-.01-1.4M7 6c.55 0 1 .45 1 1v10c0 .55-.45 1-1 1s-1-.45-1-1V7c0-.55.45-1 1-1"})),re=({title:t,active:s,onClick:r,children:o})=>e.jsx(ee,{title:t,arrow:!0,placement:"right",children:e.jsx(we,{color:"inherit",centerRipple:!1,onClick:r,sx:{borderRadius:1,aspectRatio:1,bgcolor:s?"#fffc":void 0,boxShadow:s?1:void 0,color:s?"primary.dark":void 0,"&:hover":{bgcolor:s?"#fffe":void 0}},children:o})}),oe=({title:t,description:s,icon:r,active:o,onClick:n})=>e.jsx(le,{onClick:n,sx:{borderRadius:1,bgcolor:o?"#fffc":void 0,boxShadow:o?1:void 0,"&:hover":{bgcolor:o?"#fffe":"#fff1"}},children:e.jsxs(a,{sx:{display:"flex",gap:2,alignItems:"center",p:2,width:1},children:[e.jsx(a,{children:r}),e.jsxs(a,{sx:{flex:1,textAlign:"left"},children:[e.jsx(m,{variant:"h6",component:"h6",sx:{color:o?"primary.dark":"#fffc"},children:t}),s&&e.jsx(m,{variant:"body2",component:"p",sx:{color:o?"primary.dark":"#fffc",opacity:.8},children:s})]})]})}),Gs=({open:t,onClose:s})=>e.jsxs(ns,{anchor:"left",open:t,onClose:s,sx:{"& .MuiDrawer-paper":{width:450,maxWidth:"100vw",bgcolor:"primary.dark",p:3,display:"flex",flexDirection:"column",gap:2}},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(ze,{sx:{fontSize:"3em",color:"#fffc"}}),e.jsx(m,{variant:"h4",component:"h1",sx:{fontFamily:'"timemachine-wa"',color:"#fffc"},children:"資料樣板"})]}),e.jsx(oe,{title:"概覽",description:"快速掌握資料庫狀態與視覺化圖表",icon:e.jsx(lt,{sx:{color:"primary.dark",fontSize:"3.5rem"}}),active:!0,onClick:s}),e.jsx(oe,{title:"資料庫結構",description:"圖像化呈現資料表間的關聯",icon:e.jsx(dt,{sx:{color:"#fffc",fontSize:"3.5rem"}}),onClick:s}),e.jsx(oe,{title:"資料表",description:"檢視、編輯與標準化資料表內容",icon:e.jsx(pt,{sx:{color:"#fffc",fontSize:"3.5rem"}}),onClick:s}),e.jsx(oe,{title:"撰寫查詢",description:"手動撰寫 SQL 以進行自定義查詢",icon:e.jsx(ht,{sx:{color:"#fffc",fontSize:"3.5rem"}}),onClick:s}),e.jsx(a,{sx:{flex:1}}),e.jsx(oe,{title:"收起側邊欄",icon:e.jsx(Zs,{sx:{color:"#fffc",fontSize:"2rem"}}),onClick:s})]}),Xs=()=>{const[t,s]=f.useState(!1),r=()=>s(!t);return e.jsxs(v,{sx:{position:"relative",bgcolor:"primary.dark",p:2,py:4,color:"#fffc",height:1,gap:2},children:[e.jsx(re,{title:"概覽",active:!0,children:e.jsx(lt,{})}),e.jsx(re,{title:"資料庫結構",children:e.jsx(dt,{})}),e.jsx(re,{title:"資料表",children:e.jsx(pt,{})}),e.jsx(re,{title:"撰寫查詢",children:e.jsx(ht,{})}),e.jsx(a,{sx:{flex:1}}),e.jsx(re,{title:"展開面板",onClick:r,children:e.jsx(Qs,{})}),e.jsx(Gs,{open:t,onClose:r})]})},Ys=y(e.jsx("path",{d:"M19 13H5c-1.1 0-2 .9-2 2v4c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-4c0-1.1-.9-2-2-2M7 19c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2M19 3H5c-1.1 0-2 .9-2 2v4c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M7 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2"})),Js=y(e.jsx("path",{d:"M12 5V3.21c0-.45-.54-.67-.85-.35l-2.8 2.79c-.2.2-.2.51 0 .71l2.79 2.79c.32.31.86.09.86-.36V7c3.31 0 6 2.69 6 6 0 2.72-1.83 5.02-4.31 5.75-.42.12-.69.52-.69.95 0 .65.62 1.16 1.25.97C17.57 19.7 20 16.64 20 13c0-4.42-3.58-8-8-8m-6 8c0-1.34.44-2.58 1.19-3.59.3-.4.26-.95-.09-1.31-.42-.42-1.14-.38-1.5.1-1 1.34-1.6 3-1.6 4.8 0 3.64 2.43 6.7 5.75 7.67.63.19 1.25-.32 1.25-.97 0-.43-.27-.83-.69-.95C7.83 18.02 6 15.72 6 13"})),er=y(e.jsx("path",{d:"M16.59 9H15V4c0-.55-.45-1-1-1h-4c-.55 0-1 .45-1 1v5H7.41c-.89 0-1.34 1.08-.71 1.71l4.59 4.59c.39.39 1.02.39 1.41 0l4.59-4.59c.63-.63.19-1.71-.7-1.71M5 19c0 .55.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1H6c-.55 0-1 .45-1 1"})),tr=y(e.jsx("path",{d:"M10 16h4c.55 0 1-.45 1-1v-5h1.59c.89 0 1.34-1.08.71-1.71L12.71 3.7a.996.996 0 0 0-1.41 0L6.71 8.29c-.63.63-.19 1.71.7 1.71H9v5c0 .55.45 1 1 1m-4 2h12c.55 0 1 .45 1 1s-.45 1-1 1H6c-.55 0-1-.45-1-1s.45-1 1-1"})),_e=t=>{let s;const r=new Set,o=(d,p)=>{const u=typeof d=="function"?d(s):d;if(!Object.is(u,s)){const x=s;s=p??(typeof u!="object"||u===null)?u:Object.assign({},s,u),r.forEach(g=>g(s,x))}},n=()=>s,l={setState:o,getState:n,getInitialState:()=>h,subscribe:d=>(r.add(d),()=>r.delete(d))},h=s=t(o,n,l);return l},sr=t=>t?_e(t):_e,rr=t=>t;function or(t,s=rr){const r=Ve.useSyncExternalStore(t.subscribe,()=>s(t.getState()),()=>s(t.getInitialState()));return Ve.useDebugValue(r),r}const Qe=t=>{const s=sr(t),r=o=>or(s,o);return Object.assign(r,s),r},nr=t=>t?Qe(t):Qe,Fe=nr(t=>({client:null,setClient:s=>t({client:s}),resetClient:()=>t({client:null})})),ar=()=>{const{client:t}=Fe.getState();if(!t)throw new Error("SQLite client is not initialized.");return t},ir=()=>ar().reset(),cr=()=>{const t=ot();return as({mutationFn:ir,onSuccess:()=>{t.resetQueries({queryKey:[]})},onError:s=>{console.error("重置資料庫失敗:",s),t.resetQueries({queryKey:[]})}})},ut=new Event("locationchange"),lr=window.history.pushState,dr=window.history.replaceState;window.history.pushState=function(...t){lr.apply(this,t),window.dispatchEvent(ut)};window.history.replaceState=function(...t){dr.apply(this,t),window.dispatchEvent(ut)};const pr=t=>t.startsWith("/")?t:"/"+t,Ie="__preserved__hash__key__";function xt(){const[t,s]=f.useState(new URLSearchParams(window.location.search)),[r,o]=f.useState(window.location.hash),n=f.useRef(new Set),c=f.useMemo(()=>({get:d=>(n.current.add(d),t.get(d)),getAll:d=>(n.current.add(d),t.getAll(d)),has:d=>(n.current.add(d),t.has(d))}),[t]),i=f.useMemo(()=>({get:({raw:d})=>(n.current.add(Ie),d?r:r.replace(/^#/,"")),getParts:()=>(n.current.add(Ie),r.replace(/^#/,"").split("/").filter(Boolean))}),[r]),l=f.useCallback(d=>{const p=new URL(window.location.href);Object.entries(d).forEach(([u,x])=>{x===null?p.searchParams.delete(u):p.searchParams.set(u,x)}),p.hash=window.location.hash,window.history.pushState({},"",p)},[]),h=f.useCallback((d,p)=>{const u=new URL(window.location.href);u.hash=pr(d),p!=null&&p.preserveSearch||(u.search=""),window.history.pushState({},"",u)},[]);return f.useEffect(()=>{const d=()=>{const p=new URLSearchParams(window.location.search),u=window.location.hash;let x=!1;n.current.forEach(g=>{(g===Ie&&r!==u||t.get(g)!==p.get(g))&&(x=!0)}),x&&(s(p),o(u))};return window.addEventListener("popstate",d),window.addEventListener("locationchange",d),()=>{window.removeEventListener("popstate",d),window.removeEventListener("locationchange",d)}},[t,n,r]),{searchParams:c,updateSearchParams:l,hash:i,updateHash:h}}const Ze={outlined:{variant:"outlined",color:"inherit"},main:{variant:"contained",color:"inherit"},danger:{variant:"contained",color:"error"}},Re=({variant:t,sx:s,children:r,...o})=>e.jsx(X,{variant:Ze[t].variant,color:Ze[t].color,sx:{scale:"1.001","&:hover":{scale:"1.05"},"&:active":{scale:"0.95"},transition:"all 0.2s ease",...s},...o,children:r}),hr=()=>e.jsx(a,{sx:{position:"absolute",inset:0,pointerEvents:"none",overflow:"hidden",display:"flex",justifyContent:"center"},children:e.jsx(a,{sx:{position:"relative",maskImage:"radial-gradient(circle at 50% 25%, #0003 0%, #000a 100%)",bgcolor:"primary.main",fill:"var(--mui-palette-background-paper)",fillOpacity:.375,width:1,minWidth:1200,height:1},children:e.jsxs("svg",{style:{scale:"1.01 -1"},width:"100%",height:"200",viewBox:"0 0 1920 300",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",children:[e.jsx("path",{d:"M0,160 C160,180 320,140 480,160 C640,180 800,120 960,150 C1120,180 1280,130 1440,160 C1600,190 1760,150 1920,170 L1920,300 L0,300 Z"}),e.jsx("path",{d:"M0,190 C120,210 240,160 360,190 C480,220 600,140 720,180 C840,220 960,130 1080,180 C1200,230 1320,160 1440,200 C1560,240 1740,180 1920,210 L1920,300 L0,300 Z"}),e.jsx("path",{d:"M0,230 C160,250 320,190 480,230 C640,270 800,180 960,220 C1120,260 1280,170 1440,210 C1600,250 1760,200 1920,230 L1920,300 L0,300 Z"})]})})}),ur=()=>{const[t,s]=f.useState(null),r=g=>s(I=>I?null:g.currentTarget),o=()=>s(null),{status:n,mutate:c}=cr(),[i,l]=f.useState(null),h=g=>{n!=="pending"&&l(g.currentTarget)},d=()=>{c(),l(null)},p=()=>{l(null)},{updateSearchParams:u}=xt(),x=g=>()=>{u({db:g}),s(null)};return e.jsxs(a,{sx:{position:"relative",p:5,overflow:"hidden",borderRadius:4,borderTopLeftRadius:0,borderTopRightRadius:0},children:[e.jsx(hr,{}),e.jsxs(a,{sx:{position:"relative",display:"flex",justifyContent:"space-between",alignItems:"flex-end"},children:[e.jsxs(a,{children:[e.jsxs(a,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e.jsx(Ys,{fontSize:"small",sx:{color:"text.secondary"}}),e.jsxs(js,{children:[e.jsx(m,{variant:"body2",sx:{color:"text.secondary"},children:"資料庫"}),e.jsx(m,{variant:"body2",sx:{"&:hover":{textDecoration:"underline"},cursor:"pointer",color:"text.primary"},onClick:r,children:"論壇資料庫"})]}),e.jsx(Ot,{open:!!t,anchorEl:t,onClose:o,children:e.jsx(T,{onClick:o,selected:!0,children:e.jsx(m,{variant:"body2",sx:{color:"text.primary"},onClick:x("forum"),children:"論壇資料庫"})})})]}),e.jsx(m,{variant:"h4",component:"h2",sx:{pt:1.5},children:"概覽"})]}),e.jsxs(a,{sx:{display:"flex",gap:1.5,color:"text.primary"},children:[e.jsx(Re,{startIcon:e.jsx(er,{}),variant:"outlined",children:"匯入"}),e.jsx(Re,{startIcon:e.jsx(tr,{}),variant:"main",disableElevation:!0,sx:{bgcolor:"background.paper"},children:"匯出"}),e.jsx(ee,{title:e.jsx(m,{variant:"body2",children:"從伺服器複製一份副本取代目前資料"}),placement:"bottom",arrow:!0,children:e.jsx("span",{children:e.jsx(Re,{startIcon:e.jsx(Js,{}),variant:"danger",disableElevation:!0,sx:{cursor:"help",pr:2.5},loading:n==="pending",onClick:h,children:"重置"})})}),e.jsx(Ee,{open:!!i,anchorEl:i,onClose:p,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},elevation:3,children:e.jsxs(a,{sx:{p:2,maxWidth:300},children:[e.jsx(m,{variant:"subtitle1",sx:{mb:1},children:"確認重置資料庫"}),e.jsx(m,{variant:"body2",sx:{mb:2,color:"text.secondary"},children:"此操作將從伺服器複製一份新的資料庫，並覆蓋所有本地修改。為避免資料庫不一致，請先關閉所有本網站的分頁再繼續。確定要繼續嗎？"}),e.jsxs(a,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[e.jsx(X,{variant:"outlined",size:"small",onClick:p,color:"inherit",children:"取消"}),e.jsx(X,{variant:"contained",color:"error",size:"small",onClick:d,disabled:n==="pending",disableElevation:!0,children:"確認重置"})]})]})})]})]})]})},xr=y([e.jsx("path",{d:"M4 7v13h13c.55 0 1 .45 1 1s-.45 1-1 1H4c-1.1 0-2-.9-2-2V7c0-.55.45-1 1-1s1 .45 1 1"},"0"),e.jsx("path",{d:"M6 4v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2m9 7h5v5h-5zm-7 0h5v5H8zm0-7h12v5H8z"},"1")]),mr=y(e.jsx("path",{d:"M15.59 3.59c-.38-.38-.89-.59-1.42-.59H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.89 2 1.99 2H19c1.1 0 2-.9 2-2V9.83c0-.53-.21-1.04-.59-1.41zM8 17c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m0-4c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m0-4c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m6 0V4.5l5.5 5.5H15c-.55 0-1-.45-1-1"})),fr=y(e.jsx("path",{d:"M10.5 13h-1c-.83 0-1.5-.67-1.5-1.5S8.67 10 9.5 10h1V9c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5v1h1c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-1v1c0 .83-.67 1.5-1.5 1.5s-1.5-.67-1.5-1.5zm.8-10.74-6 2.25C4.52 4.81 4 5.55 4 6.39v4.7c0 5.05 3.41 9.76 8 10.91 4.59-1.15 8-5.86 8-10.91v-4.7c0-.83-.52-1.58-1.3-1.87l-6-2.25c-.45-.18-.95-.18-1.4-.01"})),Be={xs:4,md:6,xl:8},Le={xs:3,md:4,xl:5},j={xs:1,md:2,xl:3},Ae={xs:0,md:0,xl:0},xe={color:"background.paper",bgcolor:"primary.main",borderRadius:1,p:1,fontSize:"3rem"},Y={"&:hover":{textDecoration:"underline"},cursor:"pointer"},z={display:"-webkit-box",WebkitLineClamp:1,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",wordBreak:"break-all"},ce="all 0.4s cubic-bezier(0.4, 0, 0.2, 1)",K=({children:t,sx:s,...r})=>e.jsx(m,{variant:"subtitle1",component:"h3",sx:{color:"text.secondary",textWrap:"nowrap",...s},...r,children:t}),S=({children:t,sx:s,...r})=>e.jsx(m,{variant:"h5",component:"p",sx:{...z,...s},...r,children:t}),J=({children:t,...s})=>e.jsx(ee,{followCursor:!0,slotProps:{transition:{timeout:{appear:250,enter:250,exit:0}}},...s,children:t});function gr(t,s=.9){if(!Array.isArray(t)||t.length===0)return null;if(s<0||s>1)throw new Error("Ratio must be between 0 and 1");const r=t.reduce((i,l)=>(i[l]=(i[l]||0)+1,i),{});let o=t[0],n=0;for(const[i,l]of rt(r))l>n&&(o=i,n=l);return n/t.length>=s?o:null}const de=()=>{const{client:t}=Fe.getState();if(!t)throw new Error("SQLite client is not initialized.");return t},br=async()=>await de().getDatabaseSize(),mt=async t=>{const s=de(),r=[];return await Promise.all(t.map(async o=>{(await s.exec("SELECT name FROM sqlite_master WHERE type = $type AND name NOT LIKE 'sqlite_%';",{$type:o})).forEach(i=>{typeof i.name=="string"&&r.push({type:o,name:i.name})})})),r},jr=async t=>{const s=de(),r={},o=await mt(t);return await Promise.all(o.map(async({name:n})=>{const c=`SELECT COUNT(*) as count FROM ${n};`,i=await s.exec(c);i.length>0?r[n]=Number(i[0].count??0):r[n]=0})),r},yr=t=>{if(t==null)return"empty";if(typeof t=="number"&&Number.isInteger(t))return"integer";if(typeof t=="number")return"real";if(typeof t!="string")return"unknown";if(t.trim()==="")return"empty";if(/^[0-9a-f]{8}-[0-9a-f]{4}/.test(t))return"uuid";if(["true","false","0","1"].includes(t.toLowerCase()))return"boolean";if(is(t).isValid())return"date";const r=Qt(()=>JSON.parse(t));if(r.error)return"text";const o=r.data;return Array.isArray(o)?"json_array":typeof o=="object"&&o!==null?"json_object":"text"},vr=async(t,s,r)=>{const o=de(),n=`SELECT "${s}" FROM "${t}" LIMIT 20;`,c=await o.exec(n);if(c.length===0)return r;const i=c.map(h=>yr(h[s])).filter(h=>h!=="empty"),l=gr(i,.9);return!l||l==="unknown"?r:l},wr=async t=>{const s=de(),r=`PRAGMA table_info(${t});`,o=await s.exec(r);if(o.length===0)return null;const c=(await Promise.all(o.map(i=>vr(t,i.name,i.type)))).map(i=>i.toLowerCase());return o.map((i,l)=>({...i,type:c[l]}))},Ce=0,Cr=()=>ye({queryKey:["dbBytes"],queryFn:()=>br(),staleTime:Ce}),ft=({types:t})=>ye({queryKey:["objects",...t.toSorted()],queryFn:()=>mt(t),staleTime:Ce}),gt=({types:t})=>ye({queryKey:["rowCounts",...t.toSorted()],queryFn:()=>jr(t),staleTime:Ce}),bt=({types:t})=>{const{data:s=[],isFetching:r}=ft({types:t}),{data:o,isFetching:n}=ye({queryKey:["tableInfos",...s.map(c=>c.name)],queryFn:async()=>(await Promise.all(s.map(({name:c})=>wr(c)))).filter(c=>c!==null),enabled:s.length>0,staleTime:Ce});return{data:o,isFetching:r||n}};function fe(t,s="en-US"){return t.toLocaleString(s)}function Sr(t,s=2){if(t<=0)return"0 Bytes";if(!Number.isFinite(t))return"N/A";const r=1024,o=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(t)/Math.log(r)),c=t/Math.pow(r,n),i=parseFloat(c.toFixed(s)),l=o[n];return`${fe(i)} ${l}`}const Me={display:"flex",alignItems:"center",gap:Le},ie=({children:t,...s})=>e.jsx(ve,{variant:"rounded",animation:"wave",...s,children:t}),kr=()=>{const{data:t,isFetching:s}=Cr(),{data:r,isFetching:o}=ft({types:["table","view"]});return e.jsxs(a,{sx:{display:"flex",gap:j},children:[e.jsxs(v,{sx:{alignItems:"flex-start"},children:[e.jsx(K,{children:"資料庫大小"}),t===void 0||s?e.jsx(ie,{children:e.jsx(S,{sx:{textWrap:"nowrap"},children:"載入中"})}):e.jsx(S,{sx:{textWrap:"nowrap"},children:Sr(t)})]}),e.jsx(Pe,{flexItem:!0,orientation:"vertical"}),e.jsxs(v,{sx:{alignItems:"flex-start"},children:[e.jsx(K,{children:"資料表總數"}),r===void 0||o?e.jsx(ie,{children:e.jsx(S,{children:"載入中"})}):e.jsx(S,{sx:{textWrap:"nowrap"},children:r.filter(({type:n})=>n==="table").length})]}),e.jsx(Pe,{flexItem:!0,orientation:"vertical"}),e.jsxs(v,{sx:{alignItems:"flex-start"},children:[e.jsx(K,{children:"檢視表總數"}),r===void 0||o?e.jsx(ie,{children:e.jsx(S,{children:"載入中"})}):e.jsx(S,{sx:{textWrap:"nowrap"},children:r.filter(({type:n})=>n==="view").length})]})]})},Ir=()=>{const{data:t,isFetching:s}=gt({types:["table","view"]}),r=t?Object.values(t).reduce((n,c)=>n+c,0):0,o=t?rt(t).reduce((n,[c,i])=>i>n[1]?[c,i]:n):["",0];return e.jsxs(a,{sx:{display:"flex",gap:j},children:[e.jsxs(v,{sx:{alignItems:"flex-start"},children:[e.jsx(K,{children:"總紀錄數"}),t===void 0||s?e.jsx(ie,{children:e.jsx(S,{sx:{textWrap:"nowrap"},children:"載入中"})}):e.jsx(S,{sx:{textWrap:"nowrap"},children:fe(r)})]}),e.jsx(Pe,{flexItem:!0,orientation:"vertical"}),e.jsxs(v,{sx:{alignItems:"flex-start"},children:[e.jsx(K,{children:"最多紀錄的資料表"}),t===void 0||s?e.jsx(ie,{children:e.jsx(S,{sx:Y,children:"載入中"})}):e.jsx(J,{title:e.jsxs(m,{children:[o[0]," 有 ",fe(o[1])," 筆紀錄"]}),children:e.jsx(S,{sx:Y,children:o[0]})})]})]})},Rr=()=>e.jsxs(a,{sx:{position:"relative",display:"grid",gap:Be,gridTemplateColumns:{xs:"repeat(6, 1fr)",lg:"repeat(3, 1fr)"}},children:[e.jsxs(a,{sx:{gridColumn:{xs:"span 4",lg:"auto"},...Me},children:[e.jsx(xr,{sx:xe}),e.jsx(kr,{})]}),e.jsxs(a,{sx:{gridColumn:{xs:"1 / span 4",lg:"auto"},...Me},children:[e.jsx(mr,{sx:xe}),e.jsx(Ir,{})]}),e.jsxs(a,{sx:{gridRow:{xs:"1",lg:"auto"},gridColumn:{xs:"5 / span 2",lg:"auto"},...Me},children:[e.jsx(fr,{sx:xe}),e.jsxs(v,{sx:{alignItems:"flex-start"},children:[e.jsx(K,{children:"潛在問題"}),e.jsxs(S,{sx:{textWrap:"nowrap",color:"warning.main",display:"inline-block",...Y},children:["2",e.jsx(rs,{fontSize:"small",sx:{verticalAlign:"middle",ml:.5}})]})]})]})]});function Ge(t){if(!t)return;const s=t.match(/^([a-z]+)(?:\.(\w+))?$/);if(s){const[,r,o]=s,n=["--mui-palette",r];return o&&n.push(o),`var(${n.join("-")})`}return t}const De=({color1:t="white",color2:s="transparent",angle:r=45,stripeWidth:o=10,backgroundSize:n,zIndex:c=0,className:i="",style:l={}})=>{const h=Ge(t),d=Ge(s),p=n??o*2,u=`repeating-linear-gradient(
    ${r}deg,
    ${h},
    ${h} ${o}px,
    ${d} ${o}px,
    ${d} ${p}px
  )`;return e.jsx("div",{className:i,style:{position:"absolute",inset:0,zIndex:c,background:u,pointerEvents:"none",...l}})},Mr=({value:t,onClick:s})=>{const[r,o]=f.useState(null),n=l=>o(h=>h?null:l.currentTarget),c=()=>o(null),i=l=>()=>{s(l),c()};return e.jsxs(a,{sx:{display:"flex",gap:j,justifyContent:"space-between",alignItems:"center",p:j},children:[e.jsx(m,{variant:"h5",component:"h3",children:"紀錄數"}),e.jsxs(le,{sx:{"&:hover":{bgcolor:"action.hover"},p:1,pr:0,borderRadius:1},onClick:n,children:[e.jsxs(m,{sx:{color:"text.secondary"},children:["前 ",t," 筆"]}),e.jsx(it,{sx:{color:"text.secondary"}})]}),e.jsx(Ee,{anchorEl:r,anchorOrigin:{horizontal:"center",vertical:"bottom"},transformOrigin:{horizontal:"center",vertical:"top"},open:!!r,onClose:c,children:e.jsxs(st,{dense:!0,children:[e.jsx(T,{onClick:i(3),selected:t===3,children:"前 3 筆"}),e.jsx(T,{onClick:i(5),selected:t===5,children:"前 5 筆"}),e.jsx(T,{onClick:i(7),selected:t===7,children:"前 7 筆"})]})})]})},Pr=(t,s)=>{if(t===null)return{dataArray:[...Array(s)].map((u,x)=>({label:"載入中"+x,records:0,percentage:0,loading:!0,noData:!1})),averageAmount:0,averagePercentages:0};const r=Object.entries(t).sort(([,u],[,x])=>x-u).slice(0,s),o=r.map(([u])=>u),n=r.map(([,u])=>u),c=1.75,i=Object.values(n).reduce((u,x)=>u+x,0),l=Math.round(i/s),h=Math.round(l/i*100*c),d=n.map(u=>Math.round(u/i*100*c)),p=o.map((u,x)=>({label:u,records:n[x],percentage:d[x],loading:!1,noData:!1}));if(p.length<s){const u=[...Array(s-p.length)].map(()=>({label:"",records:0,percentage:0,loading:!1,noData:!0}));return{dataArray:[...p,...u],averageAmount:l,averagePercentages:h}}return{dataArray:p,averageAmount:l,averagePercentages:h}},Br=()=>{const[t,s]=f.useState(5),{data:r,isFetching:o}=gt({types:["table","view"]}),{dataArray:n,averageAmount:c,averagePercentages:i}=Pr(o?null:r??null,t);return e.jsxs(v,{sx:{aspectRatio:{xs:"2/1",ml:"2/1.2"},borderTop:"1px solid",borderColor:"divider"},children:[e.jsx(Mr,{value:t,onClick:s}),e.jsxs(a,{sx:{position:"relative",flex:1,display:"flex",gap:j,p:j,py:Ae,justifyContent:"space-around",alignItems:"stretch"},children:[n.map(({label:l,records:h,percentage:d,loading:p,noData:u},x)=>e.jsx(J,{title:p||u?null:e.jsxs(a,{children:[e.jsx(m,{variant:"subtitle2",children:l}),e.jsxs(m,{children:[h," 筆紀錄"]})]}),children:e.jsxs(a,{sx:{position:"relative",flex:1,borderRadius:2,overflow:"clip",transition:"all 0.2s ease-in-out","&:hover":{bgcolor:"action.hover","& .bar-content":{opacity:1}}},children:[e.jsx(De,{color1:"divider",color2:"#fff0",angle:-20,stripeWidth:5}),e.jsx(a,{sx:{position:"absolute",inset:`${p||u?100:Math.max(0,100-d)}% 0 0 0`,borderRadius:2,overflow:"hidden",bgcolor:"background.paper",transition:ce},children:e.jsx(a,{className:"bar-content",sx:{position:"absolute",inset:0,bgcolor:"primary.main",opacity:x===0?.9:.65,transition:"all 0.2s ease-in-out"}})})]})},x)),e.jsx(a,{sx:{position:"absolute",inset:`0 0 ${o?0:i}% 0`,borderBottom:"4px dashed",borderColor:"divider",pointerEvents:"none",mx:j,scale:"1.02 1",transition:ce,"&:before":{content:`"平均 ${o?0:c} 筆"`,position:"absolute",right:0,bottom:0,fontSize:"1rem",color:"text.secondary",opacity:.75}}}),o&&e.jsx(a,{sx:{position:"absolute",inset:0,display:"grid",placeItems:"center",pointerEvents:"none"},children:e.jsx($e,{})})]}),e.jsx(a,{sx:{display:"flex",gap:j,p:j,justifyContent:"space-around",alignItems:"center"},children:n.map(({label:l,loading:h,noData:d},p)=>h?e.jsx(ve,{variant:"rounded",animation:"wave",children:e.jsx(m,{variant:"body1",component:"p",sx:{flex:1,textAlign:"center"},children:"載入中"})},p):d?e.jsx(m,{variant:"body1",component:"p",sx:{flex:1,color:"text.secondary",...z,textAlign:"center"},children:"---"},p):e.jsx(J,{title:e.jsx(m,{children:l}),children:e.jsx(m,{variant:"body1",component:"p",sx:{flex:1,color:"text.secondary",...Y,...z,textAlign:"center"},children:l})},p))})]})},Tr=y([e.jsx("path",{d:"M3 6c-.55 0-1 .45-1 1v13c0 1.1.9 2 2 2h13c.55 0 1-.45 1-1s-.45-1-1-1H4V7c0-.55-.45-1-1-1"},"0"),e.jsx("path",{d:"M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-3.54 12.01-.63-1.82H12.2l-.65 1.82c-.1.29-.38.48-.68.48-.51 0-.86-.51-.68-.98l2.73-7.27c.16-.44.6-.74 1.08-.74s.92.3 1.09.75l2.73 7.27c.18.47-.17.98-.68.98-.31 0-.58-.19-.68-.49"},"1"),e.jsx("path",{d:"m13.96 7.17-1.31 3.72h2.69l-1.3-3.72z"},"2")]),Xe=({children:t,loading:s,...r})=>s?e.jsx(ve,{variant:"rounded",animation:"wave",...r,children:t}):t,Er=()=>{const{data:t,isFetching:s}=bt({types:["table","view"]}),r=f.useMemo(()=>{if(!t||s)return null;const i={};let l=0;t.forEach(u=>{u.forEach(({type:x})=>{i[x]=(i[x]||0)+1,l+=1})});const h=[],d=new Set;let p=0;for(const[u,x]of Object.entries(i).sort((g,I)=>I[1]-g[1])){const g=x/l;h.length<3||g>=.1?h.push([u,x]):(p+=x,d.add(u))}if(p>0){const u=Array.from(d).slice(0,5),x=u.join(", ")+(u.length>5?", ...":"");h.push([`其他 (${x})`,p])}return h.map(([u,x])=>({type:u,count:x,percentage:x/l}))},[t,s]),o=r===null,n=!o&&r.length<3,c=!o&&!n;return e.jsxs(v,{sx:{aspectRatio:{xs:"2/1",ml:"2/1.2"},borderTop:"1px solid",borderColor:"divider",position:"relative"},children:[e.jsxs(a,{sx:{display:"flex",gap:j,justifyContent:"space-between",alignItems:"flex-start",p:j},children:[e.jsxs(v,{sx:{gap:1},children:[e.jsx(K,{children:"最常使用的型別"}),e.jsx(Xe,{loading:o,children:e.jsx(S,{variant:"h4",sx:{textTransform:"uppercase"},children:o?"載入中":n?"N/A":r[0].type})})]}),e.jsx(Tr,{sx:{...xe,mt:.5}})]}),e.jsxs(a,{sx:{flex:1,position:"relative"},children:[e.jsxs(a,{sx:{position:"absolute",inset:"auto 0 0 0",p:1.5,borderRadius:9,overflow:"clip"},children:[e.jsx(De,{color1:"divider",color2:"#fff0",angle:-35,stripeWidth:4}),c&&e.jsx(a,{sx:{position:"absolute",inset:0,display:"flex",alignItems:"stretch",zIndex:1},children:r.map(({type:i,count:l,percentage:h},d)=>e.jsx(J,{title:e.jsxs(S,{variant:"body1",sx:{textTransform:"uppercase"},children:[i," 型別使用了 ",l," 次"]}),children:e.jsx(a,{sx:{width:h,"&:hover":{bgcolor:"divider"},opacity:.9,transition:"all 0.2s ease-in-out"}})},d))})]}),e.jsx(a,{sx:{position:"absolute",inset:"auto 0 0 0",my:1.5,display:"grid",placeItems:"center"},children:e.jsx(a,{sx:{position:"absolute",width:1,display:"flex",alignItems:"center",scale:c?"1 1":"0 1",opacity:c?1:0,transition:ce},children:c&&r.map(({percentage:i},l)=>e.jsx(a,{sx:{width:i,px:.5,pl:l===0?1:.5,pr:l===r.length-1?1:.5},children:e.jsx(a,{sx:{py:.5,borderRadius:9,bgcolor:"primary.main",filter:`hue-rotate(-${l*30+10}deg)`}})},l))})}),e.jsx(a,{sx:{position:"absolute",inset:0,display:"flex",transformOrigin:"left",scale:c?"1 1":"1 0",transition:ce},children:c&&r.map(({type:i,percentage:l},h)=>e.jsx(a,{sx:{width:l,height:1,position:"relative"},children:e.jsx(a,{sx:{position:"absolute",inset:0,ml:h===0?1:0,mb:3,borderLeft:4,borderColor:"divider"},children:e.jsxs(a,{sx:{position:"absolute",inset:"0 auto auto 0"},children:[e.jsx(m,{variant:"body2",sx:{textTransform:"uppercase",color:"text.secondary",ml:1,...z},children:i}),e.jsxs(S,{sx:{textTransform:"uppercase",opacity:.8,ml:1},children:[Math.round(l*100),"%"]})]})})},h))}),o&&e.jsx(a,{sx:{position:"absolute",inset:0,display:"grid",placeItems:"center",pointerEvents:"none"},children:e.jsx($e,{})}),n&&e.jsx(a,{sx:{position:"absolute",inset:0,display:"grid",placeItems:"center",pointerEvents:"none"},children:e.jsx(os,{sx:{p:3,borderRadius:99},label:e.jsx(m,{variant:"h6",component:"p",sx:{color:"text.secondary"},children:"資料不足"})})})]}),e.jsx(a,{sx:{display:"flex",gap:Le,p:j,alignItems:"center",justifyContent:"space-around",width:"fit-content",minWidth:.5},children:c?r.map(({type:i},l)=>e.jsxs(a,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e.jsx(a,{sx:{borderRadius:99,width:"1rem",height:"1rem",bgcolor:"primary.main",filter:`hue-rotate(-${l*30+10}deg)`}}),e.jsx(m,{variant:"body1",component:"p",sx:{color:"text.secondary",textTransform:"uppercase",...z},children:i})]},l)):[...Array(3)].map((i,l)=>e.jsxs(a,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e.jsx(a,{sx:{borderRadius:99,width:"1rem",height:"1rem",bgcolor:"primary.main",filter:`hue-rotate(-${l*30+10}deg)`}}),e.jsx(Xe,{loading:!0,children:e.jsx(m,{variant:"body1",component:"p",children:"載入中"})})]},l))})]})},Ye=({children:t,loading:s,...r})=>s?e.jsx(ve,{variant:"rounded",animation:"wave",...r,children:t}):t,$r=t=>{const s=t.toLowerCase();return["id","create","update","delete","timestamp","modif"].some(o=>s.includes(o))},zr=1.375,Fr=()=>{const[t,s]=f.useState(!1),{data:r,isFetching:o}=bt({types:["table","view"]}),n=f.useMemo(()=>{if(!r||o)return[...Array(5)].map(()=>({field:"",count:0,percentage:0,loading:!0,noData:!1}));const c={};r.forEach(d=>{d.forEach(({name:p})=>{c[p]=(c[p]||0)+1})});const i=Object.entries(c).filter(([d])=>t||!$r(d)).toSorted((d,p)=>p[1]-d[1]).slice(0,5),l=i.reduce((d,[p,u])=>d+u,0),h=i.map(([d,p])=>({field:d,count:p,percentage:p/l,loading:!1,noData:!1}));if(h.length<5){const d=[...Array(5-h.length)].map(()=>({field:"",count:0,percentage:0,loading:!1,noData:!0}));return[...h,...d]}return h},[r,o,t]);return e.jsxs(v,{sx:{aspectRatio:{xs:"2/1",ml:"2/1.2"},borderTop:"1px solid",borderColor:"divider",position:"relative"},children:[e.jsxs(a,{sx:{display:"flex",gap:j,justifyContent:"space-between",alignItems:"flex-start",p:j},children:[e.jsx(m,{variant:"h5",component:"h3",children:"使用的欄位名稱"}),e.jsxs(v,{sx:{alignItems:"flex-end"},children:[e.jsx(Ps,{checked:t,onChange:({target:c})=>s(c.checked),control:e.jsx(Ls,{}),labelPlacement:"start",label:e.jsx(m,{variant:"body1",sx:{opacity:.9},children:"包含系統欄位"})}),e.jsx(Ht,{children:"(id, createdAt, updatedAt, ...)"})]})]}),e.jsxs(a,{sx:{position:"relative",maxWidth:1,flex:1,overflowX:"auto",overflowY:"hidden"},children:[e.jsxs(a,{sx:{display:"grid",gridTemplateColumns:"auto 1fr auto",gap:j,placeItems:"center","& > :nth-of-type(3n + 1)":{justifySelf:"flex-start"},p:j,pt:Ae,width:1,height:1},children:[e.jsx(a,{children:e.jsx(m,{variant:"body1",sx:{color:"text.secondary"},children:"最常使用"})}),e.jsx(a,{}),e.jsx(a,{children:e.jsx(m,{variant:"body1",sx:{color:"text.secondary"},children:"出現次數"})}),n.map(({field:c,count:i,percentage:l,loading:h,noData:d},p)=>e.jsxs(f.Fragment,{children:[e.jsx(a,{children:h?e.jsx(Ye,{loading:!0,children:e.jsx(m,{variant:"body1",sx:{...z,...Y,width:"6rem"},children:"載入中"})}):d?e.jsx(m,{variant:"body1",sx:{...z,width:"6rem"},children:"---"}):e.jsx(J,{title:e.jsx(m,{children:c}),children:e.jsx(m,{variant:"body1",sx:{...z,...Y,width:"6rem"},children:c})})}),e.jsx(J,{title:h||d?null:e.jsxs(a,{children:[e.jsx(m,{variant:"subtitle2",children:c}),e.jsxs(m,{children:["所有欄位名稱中的 ",`${Math.round(l*100)}%`]})]}),children:e.jsxs(a,{sx:{width:1,height:"1rem",borderRadius:99,position:"relative",overflow:"clip",display:"flex",alignItems:"center","&:hover":{bgcolor:"action.hover","& .bar-content":{opacity:1}},transition:"all 0.2s ease-in-out"},children:[e.jsx(De,{color1:"divider",color2:"#fff0",angle:-35,stripeWidth:5}),e.jsx(a,{sx:{position:"absolute",width:Math.max(0,Math.min(l*zr,1)),height:1,borderRadius:9,overflow:"clip",bgcolor:"background.paper",transition:ce},children:e.jsx(a,{className:"bar-content",sx:{position:"absolute",inset:0,bgcolor:"primary.main",opacity:p===0?.9:.65,transition:"all 0.2s ease-in-out"}})})]})}),e.jsx(a,{children:e.jsx(Ye,{loading:h,children:e.jsx(m,{variant:"body1",sx:{...z,maxWidth:"10rem"},children:h?"載入中":d?"---":fe(i)})})})]},p))]}),o&&e.jsx(a,{sx:{position:"absolute",inset:0,display:"grid",placeItems:"center",pointerEvents:"none"},children:e.jsx($e,{})})]})]})},he=500;class Lr{constructor(s){pe(this,"dbPromise",null);pe(this,"dbPath");pe(this,"storageKey");this.dbPath=s.dbPath,this.storageKey=s.storageKey}async ready(){this.dbPromise=this.dbPromise===null?this.loadDatabase():this.dbPromise,await this.dbPromise}async exec(s,r){const o=Date.now();this.dbPromise=this.dbPromise===null?this.loadDatabase():this.dbPromise;const n=await this.dbPromise;n.run("PRAGMA foreign_keys = ON;");const[{values:c}]=n.exec("PRAGMA foreign_keys;");if(c[0][0]!==1)return console.error("Failed to enable foreign keys"),this.parse([]);const i=await W((async()=>{const h=n.exec(s,r);return await this.saveDatabase(n),h})());if(i.error!==null)return console.error("Failed to execute SQL query",i.error),this.parse([]);const l=Date.now()-o;return l<he&&await new Promise(h=>setTimeout(h,he-l)),this.parse(i.data)}async reset(){const s=Date.now(),{error:r}=await W(Zt(this.storageKey)),o=Date.now()-s;o<he&&await new Promise(n=>setTimeout(n,he-o)),r?console.error("刪除本地資料庫失敗"):console.log("刪除本地資料庫成功"),this.dbPromise=this.loadDatabase()}async getDatabaseSize(){await this.ready();const{data:s,error:r}=await W(We(this.storageKey));return r?(console.error("Failed to get database size",r),0):s?s.byteLength:0}parse(s){if(s.length===0||!s[0])return[];const{columns:r,values:o}=s[0];return o.map(n=>Object.fromEntries(r.map((c,i)=>[c,n[i]])))}async loadDatabase(){const s=await Gt({locateFile:h=>`https://sql.js.org/dist/${h}`}),{data:r,error:o}=await W(We(this.storageKey));if(o&&console.error("Failed to get cached database",o),r)return new s.Database(r);const{data:n,error:c}=await W((async()=>{const d=await(await fetch(this.dbPath)).arrayBuffer();return new s.Database(new Uint8Array(d))})());if(c)return console.error("Failed to fetch database file",c),new s.Database;const i=n.export(),{error:l}=await W(Ke(this.storageKey,i));return l&&console.error("Failed to save database to IndexedDB",l),n}async saveDatabase(s){const r=s.export(),{error:o}=await W(Ke(this.storageKey,r));o&&console.error("Failed to save database to IndexedDB",o)}}const jt={forum:Xt},Ar=t=>qt(jt).includes(t);function Dr(){const{searchParams:t}=xt(),s=Fe(o=>o.setClient),r=ot();f.useEffect(()=>{let o=t.get("db");if((o===null||o.trim()==="")&&(o="forum"),!Ar(o))throw new Error(`要求資料庫 "${o}" 不存在`);const n=new Lr({dbPath:jt[o],storageKey:`sqlite-db-${o}`});s(n),r.resetQueries({queryKey:[]})},[s,t,r])}const Or=()=>e.jsxs(a,{sx:{position:"relative",mt:Be,display:"grid",gap:Be,gridTemplateColumns:{xs:"1fr",ml:"repeat(2, 1fr)"},width:1},children:[e.jsx(Br,{}),e.jsx(Er,{}),e.jsxs(v,{sx:{aspectRatio:{xs:"2/1",ml:"2/1.2"},borderTop:"1px solid",borderColor:"divider"},children:[e.jsxs(a,{sx:{display:"flex",gap:j,alignItems:"flex-end",p:j},children:[e.jsx(m,{variant:"h5",component:"h3",sx:{textWrap:"noWrap"},children:"資料表關聯圖"}),e.jsx(m,{variant:"body1",sx:{opacity:.8,...z},children:"透過視覺化的節點與連線，探索資料表彼此的結構與關聯。"})]}),e.jsx(a,{sx:{flex:1,width:1,position:"relative"},children:e.jsx(a,{sx:{position:"absolute",inset:0,p:j,pt:Ae},children:e.jsxs(a,{sx:{position:"relative",width:1,height:1,borderRadius:3,border:3,borderColor:"divider",borderStyle:"dashed"},children:[e.jsx(a,{sx:{position:"absolute",inset:0,display:"grid",placeItems:"center"},children:e.jsx(m,{variant:"body1",sx:{color:"text.secondary"},children:"資料表關聯圖正在開發中，敬請期待！"})}),e.jsx(a,{sx:{position:"absolute",inset:"auto 0 0 auto",color:"secondary.dark",translate:"1rem 50%"},children:e.jsx(X,{color:"inherit",size:"large",variant:"outlined",endIcon:e.jsx(As,{}),sx:{"&:hover":{scale:"1.02"},scale:"1.001",transition:"all 0.2s ease-in-out",bgcolor:"background.paper"},children:"查看完整關聯圖"})})]})})})]}),e.jsx(Fr,{})]}),Hr=()=>(Dr(),null);function qr(){const{isSm:t}=nt();return t?e.jsxs(Ue,{children:[e.jsx(Hr,{}),e.jsx(_s,{}),e.jsxs(a,{component:"main",sx:{position:"relative",display:"flex",height:`calc(100dvh - ${ct}px)`},children:[e.jsx(a,{sx:{position:"absolute",inset:0,bgcolor:"primary.main",opacity:.2,pointerEvents:"none"}}),e.jsx(Xs,{}),e.jsx(a,{sx:{position:"relative",flex:1,height:1,overflow:"auto"},children:e.jsxs(v,{sx:{minHeight:1,gap:3,px:6,pb:3},children:[e.jsx(ur,{}),e.jsxs(Nt,{sx:{borderRadius:4,boxShadow:"none",flex:1,p:Le},children:[e.jsx(Rr,{}),e.jsx(Or,{})]})]})})]})]}):e.jsx(Ue,{children:e.jsx(Hs,{})})}Vt.createRoot(document.getElementById("root")).render(e.jsx(f.StrictMode,{children:e.jsx(qr,{})}));
