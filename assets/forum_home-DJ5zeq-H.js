import{h as S,j as e,T as t,S as p,n as l,B as o,v as P,P as c,t as k,r as R}from"./Toast-DD81e0ZS.js";import{u as B,a as z,A as D,S as _}from"./ScrollArea-Cw1iuxp9.js";import{A as L,a as T,b as W,c as $,d as M,e as O}from"./url-C_-tYCK8.js";import{r as x}from"./routes-J5yqRWDh.js";import{N as E}from"./NewPost-YZCUjXB-.js";import{u as g,a as f,b as H,C as N}from"./post-DSmH3M5n.js";import{D as d}from"./Divider-ClZXSiHJ.js";import{S as h}from"./Skeleton-D4-wFtM2.js";import{C as m}from"./Chip-vtOh1vX2.js";import{C as b}from"./CommentRounded-DLBN9mjU.js";import{L as U,T as V,V as y,P as q,a as G,b as v,S as J,c as K}from"./PostHeader-f40iRlxx.js";import"./react-error-boundary.esm-DV-Hw4di.js";import"./ForumRounded-xcY5LMa8.js";import"./SQLiteClient-DE74qkCZ.js";import"./ExpandMoreRounded-kr-67vvG.js";import"./Tooltip-D4y8LWrL.js";import"./DarkModeRounded-BpbMOGed.js";import"./OpenInNewRounded-BZ_qpgF0.js";import"./index-mSkvzYyn.js";import"./MenuItem-MyiTB2I2.js";import"./NotificationsRounded-DQX7XNSM.js";import"./ListItemText-DLFdd-Xn.js";import"./useMutation-tmXyHxVB.js";import"./Collapse-DlXE4Kbp.js";import"./Motion-D_S2R9S0.js";import"./proxy-DTsTHhir.js";import"./array-DbSFIttQ.js";import"./PublishRounded-DgHAXhMz.js";import"./TopicAutocomplete-3_AOhCTv.js";import"./Autocomplete-sgWClysp.js";import"./EmojiMenu-BPiSk5rL.js";import"./formatters-C9bWSe0O.js";import"./with-selector-Deie_L8r.js";const j=S(e.jsx("path",{d:"M16.01 11H5c-.55 0-1 .45-1 1s.45 1 1 1h11.01v1.79c0 .45.54.67.85.35l2.78-2.79c.19-.2.19-.51 0-.71l-2.78-2.79c-.31-.32-.85-.09-.85.35z"})),w=()=>e.jsxs(e.Fragment,{children:[e.jsx(h,{variant:"rounded",animation:"wave",children:e.jsx(t,{variant:"subtitle1",component:"h3",children:"正在載入..."})}),e.jsx(h,{variant:"rounded",animation:"wave",children:e.jsx(t,{variant:"body2",component:"p",sx:{color:"text.secondary",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:"正在載入內容中. . ."})}),e.jsx(l,{endIcon:e.jsx(j,{}),sx:{width:"fit-content"},loading:!0,children:"查看更多"})]}),Q=({postId:r})=>{const{data:s,isFetching:n}=f({postId:r});return n||!s?e.jsx(w,{}):e.jsxs(e.Fragment,{children:[e.jsx(t,{variant:"subtitle1",component:"h3",children:s.title}),e.jsx(t,{variant:"body2",component:"p",sx:{color:"text.secondary",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:s.content}),e.jsx(l,{endIcon:e.jsx(j,{}),sx:{width:"fit-content"},href:`${x.forum_post}?postId=${s.id}`,children:"查看更多"})]})},I=({length:r})=>{const{data:s,isFetching:n}=g({limit:r,order:"desc",orderBy:"viewCount"});return e.jsxs(e.Fragment,{children:[e.jsx(t,{variant:"h6",component:"h2",sx:{mb:1.5},children:"本週熱門討論 🔥"}),n||!s?[...Array(r)].map((a,i)=>e.jsxs(p,{sx:{gap:.5,my:i<2?1:0},children:[e.jsx(w,{}),i<2&&e.jsx(d,{})]},i)):s.map((a,i)=>e.jsxs(p,{sx:{gap:.5,my:i<2?1:0},children:[e.jsx(Q,{postId:a}),i<2&&e.jsx(d,{})]},a))]})},X=()=>e.jsx(m,{label:e.jsx(P,{size:"1rem",sx:{mx:2,color:"divider"}})}),F=({length:r})=>{const{data:s,isFetching:n}=H(),a=s?s.slice(0,r):null;return e.jsxs(e.Fragment,{children:[e.jsx(t,{variant:"h6",component:"h2",children:"你可能會喜歡"}),e.jsx(o,{sx:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:1,mt:1},children:n||!a?[...Array(r)].map((i,u)=>e.jsx(X,{},u)):a.map(i=>e.jsx(m,{label:i,clickable:!0,component:"a",href:`${x.forum_posts}?topic=${i}`},i))}),e.jsx(l,{sx:{mt:1},endIcon:e.jsx(j,{}),href:x.forum_posts,children:"更多主題"})]})},A=({length:r})=>{const{data:s,isFetching:n}=B({limit:r,orderBy:"followerCount",order:"desc",isUnfollowed:!0}),a=s?s.pages[0]?s.pages[0].users:[]:[];return e.jsxs(e.Fragment,{children:[e.jsx(t,{variant:"h6",component:"h2",sx:{mb:1.5},children:"推薦追蹤"}),e.jsx(o,{sx:{display:"grid",gridTemplateColumns:"auto 1fr auto",alignItems:"center",gap:2},children:n||!a?[...Array(r)].map((i,u)=>e.jsx(L,{},u)):a.map(i=>e.jsx(T,{...i},i.id))})]})},Y=()=>e.jsxs(e.Fragment,{children:[e.jsx(c,{sx:{p:3,borderRadius:3,border:"1px solid",borderColor:"divider"},elevation:1,children:e.jsx(I,{length:3})}),e.jsx(c,{sx:{p:3,borderRadius:3,border:"1px solid",borderColor:"divider"},elevation:1,children:e.jsx(F,{length:5})}),e.jsx(c,{sx:{p:3,borderRadius:3,border:"1px solid",borderColor:"divider"},elevation:1,children:e.jsx(A,{length:5})})]}),Z=()=>e.jsxs(c,{sx:{borderRadius:3,border:"1px solid",borderColor:"divider"},elevation:1,children:[e.jsx(o,{sx:{p:3},children:e.jsx(I,{length:3})}),e.jsx(d,{}),e.jsxs(o,{sx:{p:3,position:"relative"},children:[e.jsx(o,{sx:{position:"absolute",inset:0,bgcolor:"divider",opacity:.35}}),e.jsx(F,{length:5})]}),e.jsx(d,{}),e.jsx(o,{sx:{p:3},children:e.jsx(A,{length:5})})]}),C=()=>e.jsxs(e.Fragment,{children:[e.jsxs(o,{sx:{p:1.5,cursor:"pointer","&:hover":{bgcolor:"action.hover"}},children:[e.jsx(U,{}),e.jsx(h,{variant:"rounded",animation:"wave",children:e.jsx(t,{variant:"h6",component:"h3",sx:{textAlign:"start"},children:"正在載入標題..."})}),e.jsx(t,{variant:"body2",component:"p",sx:{textAlign:"start",opacity:0},children:"正在載入內容..."}),e.jsx(o,{sx:{display:"flex",gap:1.5,mt:2},children:new Array(3).fill(null).map((r,s)=>e.jsx(h,{variant:"rounded",animation:"wave",children:e.jsx(m,{label:"loading...",size:"small"})},s))})]}),e.jsx(d,{flexItem:!0}),e.jsxs(o,{sx:{p:1.5,py:1,display:"flex",gap:1.5,alignItems:"center",position:"relative",color:"text.secondary"},children:[e.jsx(o,{sx:{position:"absolute",inset:0,bgcolor:"divider",opacity:.35}}),e.jsx(l,{color:"inherit",startIcon:e.jsx(V,{}),size:"small",loading:!0,children:e.jsx(t,{variant:"caption",component:"span",children:"100 個讚"})}),e.jsx(l,{color:"inherit",startIcon:e.jsx(b,{}),size:"small",loading:!0,children:e.jsx(t,{variant:"caption",component:"span",children:"100 則回覆"})}),e.jsx(l,{color:"inherit",startIcon:e.jsx(y,{}),size:"small",loading:!0,children:e.jsx(t,{variant:"caption",component:"span",children:"1000 次瀏覽"})})]}),e.jsx(d,{flexItem:!0})]}),ee=({postId:r})=>{const{data:s,isFetching:n}=f({postId:r});if(n||!s)return e.jsx(C,{});const a=()=>{window.location.href=`${x.forum_post}?postId=${s.id}`};return e.jsxs(e.Fragment,{children:[e.jsxs(o,{sx:{p:1.5,cursor:"pointer","&:hover":{bgcolor:"action.hover"}},onClick:a,children:[e.jsx(q,{post:s}),e.jsx(t,{variant:"h6",component:"h3",sx:{textAlign:"start",display:"-webkit-box",WebkitLineClamp:1,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:s.title}),e.jsx(t,{variant:"body2",component:"p",sx:{color:"text.secondary",textAlign:"start",display:"-webkit-box",WebkitLineClamp:1,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"pre-line"},children:s.content}),e.jsxs(o,{sx:{display:"flex",gap:1.5,mt:2,alignItems:"center"},children:[e.jsx(G,{post:s,displayCount:3}),(s.isFromFollowing||s.isSelf)&&e.jsxs(e.Fragment,{children:[e.jsx(o,{sx:{flex:1}}),s.isFromFollowing&&e.jsx(m,{size:"small",label:"來自追蹤者",variant:"outlined",icon:e.jsx(v,{})}),s.isSelf&&e.jsx(m,{size:"small",label:"我的貼文",variant:"outlined",icon:e.jsx(v,{})})]})]})]}),e.jsx(d,{flexItem:!0}),e.jsxs(o,{sx:{p:1.5,py:1,display:"flex",gap:1.5,alignItems:"center",position:"relative",color:"text.secondary"},children:[e.jsx(o,{sx:{position:"absolute",inset:0,bgcolor:"divider",opacity:.35}}),s.isSelf?e.jsx(J,{post:s}):e.jsx(K,{postId:s.id,likeCount:s.likeCount}),e.jsx(l,{color:"inherit",startIcon:e.jsx(b,{}),size:"small",href:`${x.forum_post}?postId=${s.id}`,children:e.jsxs(t,{variant:"caption",component:"span",children:[s.commentCount," 則回覆"]})}),e.jsx(l,{startIcon:e.jsx(y,{}),disabled:!0,size:"small",sx:{"button&.Mui-disabled":{color:"text.secondary",opacity:.8}},children:e.jsxs(t,{variant:"caption",component:"span",children:[s.viewCount," 次瀏覽"]})})]}),e.jsx(d,{flexItem:!0})]})},se=()=>{const{data:r,isFetching:s}=g({limit:5,orderBy:"createdAt",order:"desc",prioritizeFollowers:!0});return s||!r?e.jsx(p,{sx:{alignItems:"stretch",mb:1.5},children:[...Array(5)].map((n,a)=>e.jsx(C,{},a))}):e.jsx(p,{sx:{alignItems:"stretch",mb:1.5},children:r.map(n=>e.jsx(ee,{postId:n},n))})};function re(){const{isMd:r}=z();return e.jsxs(D,{children:[e.jsx(W,{}),e.jsxs(_,{children:[r?e.jsx($,{}):e.jsx(M,{}),e.jsxs(N,{maxWidth:!1,sx:{position:"relative",my:10,display:"flex",gap:4,maxWidth:1400,flexDirection:{xs:"column-reverse",md:"row"},px:0},children:[e.jsx(o,{sx:{flex:1},children:e.jsxs(c,{sx:{py:3,borderRadius:3,border:"1px solid",borderColor:"divider"},elevation:1,children:[e.jsx(E,{}),e.jsx(d,{}),e.jsx(se,{}),e.jsx(o,{sx:{mx:1.5},children:e.jsx(l,{variant:"outlined",color:"primary",fullWidth:!0,href:`${x.forum_posts}?followPrior=true&orderBy=createdAt&orderDesc=true`,endIcon:e.jsx(j,{}),children:"查看更多"})})]})}),e.jsx(p,{sx:{gap:{xs:1,md:4},maxWidth:{xs:1,md:400},width:{xs:1,md:"30vw"}},children:r?e.jsx(Y,{}):e.jsx(Z,{})})]}),e.jsx(O,{})]})]})}k.createRoot(document.getElementById("root")).render(e.jsx(R.StrictMode,{children:e.jsx(re,{})}));
