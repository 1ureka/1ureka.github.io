import{j as e,B as c,n as o,o as g,r as v,p as l,P as b,l as y,w as k}from"./Toast-6ncYA_Ld.js";import{T as I}from"./PersonPinCircleRounded-DQ582aYA.js";import{i as T,E as w,U as A}from"./AttachFileRounded-BJPpU1j0.js";import{T as j}from"./DarkModeRounded-BFg7OYNl.js";import{r as x}from"./routes-Dr3OAPvi.js";import{C as u}from"./Badge-D6o4y19V.js";import{k as S}from"./post-BBXU2v-h.js";import{f as p}from"./formatters-C9bWSe0O.js";import{S as m}from"./Skeleton-DjBj6yfl.js";const R=({postId:t,likeCount:r})=>{const{liked:n,likeCount:a,handleLike:s,disabled:i}=T(t);return e.jsx(j,{title:n?"取消喜歡":"喜歡",arrow:!0,placement:"left",children:e.jsx("span",{children:e.jsx(c,{startIcon:e.jsx(I,{}),size:"small",color:n?"primary":"inherit",onClick:s,disabled:i,children:e.jsxs(o,{variant:"caption",component:"span",children:[a??r," 個讚"]})})})})},N=({post:t,displayCount:r=3})=>{const{tags:n,id:a}=t;return e.jsxs(e.Fragment,{children:[n.map((s,i)=>i<r&&e.jsx(u,{label:s,clickable:!0,size:"small",component:"a",href:`${x.forum_posts}?topic=${s}`},s)),n.length>r&&e.jsx(u,{label:`+${n.length-r}`,clickable:!0,size:"small",variant:"outlined",component:"a",href:`${x.forum_post}?postId=${a}`})]})},z=g(e.jsx("path",{d:"M16 16h2c.55 0 1 .45 1 1s-.45 1-1 1h-2c-.55 0-1-.45-1-1s.45-1 1-1m0-8h5c.55 0 1 .45 1 1s-.45 1-1 1h-5c-.55 0-1-.45-1-1s.45-1 1-1m0 4h4c.55 0 1 .45 1 1s-.45 1-1 1h-4c-.55 0-1-.45-1-1s.45-1 1-1M3 18c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2V8H3zM13 5h-2l-.71-.71c-.18-.18-.44-.29-.7-.29H6.41c-.26 0-.52.11-.7.29L5 5H3c-.55 0-1 .45-1 1s.45 1 1 1h10c.55 0 1-.45 1-1s-.45-1-1-1"})),U=({post:t})=>{const[r,n]=v.useState(null),a=d=>n(d.currentTarget),s=()=>n(null),{mutateAsync:i,isPending:h}=S(),f=async()=>{const d=await i(t.id);if(d===null){window.location.reload();return}console.error("刪除貼文失敗"+d.error),s()};return e.jsxs(l,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e.jsx(c,{size:"small",startIcon:e.jsx(w,{}),href:`${x.forum_edit}?postId=${t.id}`,children:"編輯貼文"}),e.jsx(c,{size:"small",color:"error",startIcon:e.jsx(z,{}),onClick:a,children:"刪除貼文"}),e.jsx(b,{open:!!r,anchorEl:r,onClose:s,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},elevation:6,children:e.jsxs(l,{sx:{p:2,maxWidth:300},children:[e.jsx(o,{variant:"subtitle1",sx:{mb:1},children:"確認刪除貼文"}),e.jsx(o,{variant:"body2",sx:{mb:2,color:"text.secondary"},children:"確認刪除貼文後，將無法復原，請謹慎操作。"}),e.jsxs(l,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[e.jsx(c,{variant:"outlined",size:"small",onClick:s,color:"inherit",loading:h,children:"取消"}),e.jsx(c,{variant:"contained",color:"error",size:"small",onClick:f,loading:h,disableElevation:!0,children:"確認刪除"})]})]})})]})},_=({post:t,sx:r,...n})=>{const a=y(i=>i.breakpoints.up("md")),s=Math.abs(t.updatedAt.getTime()-t.createdAt.getTime())>1e3;return e.jsxs(l,{sx:{display:"flex",gap:1.5,mb:2,alignItems:"center",...r},...n,children:[e.jsx(A,{name:t.userName}),e.jsxs(o,{variant:"subtitle1",component:"a",href:`${x.forum_users}?user=${t.userName}`,sx:{color:"text.secondary",textDecoration:"none","&:hover":{textDecoration:"underline",color:"text.primary"}},children:["by ",t.userName]}),e.jsx(l,{sx:{flex:1}}),s?e.jsx(j,{title:`上次編輯於 ${t.updatedAt.toLocaleString()}`,arrow:!0,children:e.jsxs(o,{variant:"body2",sx:{color:"text.secondary",opacity:.9,...k},children:[a?t.createdAt.toLocaleString():p(t.createdAt)," (已編輯)"]})}):e.jsx(o,{variant:"body2",sx:{color:"text.secondary",opacity:.9},children:a?t.createdAt.toLocaleString():p(t.createdAt)})]})},O=({sx:t,...r})=>e.jsxs(l,{sx:{display:"flex",gap:1.5,mb:2,alignItems:"center",...t},...r,children:[e.jsx(m,{variant:"circular",sx:{width:"2rem",height:"2rem"},animation:"wave"}),e.jsx(m,{variant:"rounded",animation:"wave",children:e.jsx(o,{variant:"subtitle1",children:"by loading..."})}),e.jsx(l,{sx:{flex:1}}),e.jsx(m,{variant:"rounded",animation:"wave",children:e.jsx(o,{variant:"body2",children:"0000-00-00 00:00"})})]});export{O as L,_ as P,U as S,N as T,R as a};
