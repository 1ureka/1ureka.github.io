var Wc=Object.defineProperty;var Uc=(e,t,n)=>t in e?Wc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ie=(e,t,n)=>Uc(e,typeof t!="symbol"?t+"":t,n);import{R as Kc,r as H,j as P,p as pe,S as Zc,n as Ie,t as qe,ah as Qc}from"./Toast-BHa6H2vo.js";import{D as Jc}from"./DatasetRounded-BloqN2l0.js";import{u as eu}from"./with-selector-B34yPTxP.js";function se(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=se(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var tu={value:()=>{}};function Zt(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ot(n)}function Ot(e){this._=e}function nu(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ot.prototype=Zt.prototype={constructor:Ot,on:function(e,t){var n=this._,r=nu(e+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(e=r[s]).type)&&(i=ru(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(i=(e=r[s]).type)n[i]=oi(n[i],e.name,t);else if(t==null)for(i in n)n[i]=oi(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Ot(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};function ru(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function oi(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=tu,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var wr="http://www.w3.org/1999/xhtml";const si={svg:"http://www.w3.org/2000/svg",xhtml:wr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Qt(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),si.hasOwnProperty(t)?{space:si[t],local:e}:e}function iu(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===wr&&t.documentElement.namespaceURI===wr?t.createElement(e):t.createElementNS(n,e)}}function ou(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function os(e){var t=Qt(e);return(t.local?ou:iu)(t)}function su(){}function $r(e){return e==null?su:function(){return this.querySelector(e)}}function au(e){typeof e!="function"&&(e=$r(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,a=r[i]=new Array(o),c,d,u=0;u<o;++u)(c=s[u])&&(d=e.call(c,c.__data__,u,s))&&("__data__"in c&&(d.__data__=c.__data__),a[u]=d);return new le(r,this._parents)}function cu(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function uu(){return[]}function ss(e){return e==null?uu:function(){return this.querySelectorAll(e)}}function lu(e){return function(){return cu(e.apply(this,arguments))}}function du(e){typeof e=="function"?e=lu(e):e=ss(e);for(var t=this._groups,n=t.length,r=[],i=[],s=0;s<n;++s)for(var o=t[s],a=o.length,c,d=0;d<a;++d)(c=o[d])&&(r.push(e.call(c,c.__data__,d,o)),i.push(c));return new le(r,i)}function as(e){return function(){return this.matches(e)}}function cs(e){return function(t){return t.matches(e)}}var fu=Array.prototype.find;function hu(e){return function(){return fu.call(this.children,e)}}function pu(){return this.firstElementChild}function gu(e){return this.select(e==null?pu:hu(typeof e=="function"?e:cs(e)))}var mu=Array.prototype.filter;function yu(){return Array.from(this.children)}function xu(e){return function(){return mu.call(this.children,e)}}function wu(e){return this.selectAll(e==null?yu:xu(typeof e=="function"?e:cs(e)))}function vu(e){typeof e!="function"&&(e=as(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,a=r[i]=[],c,d=0;d<o;++d)(c=s[d])&&e.call(c,c.__data__,d,s)&&a.push(c);return new le(r,this._parents)}function us(e){return new Array(e.length)}function bu(){return new le(this._enter||this._groups.map(us),this._parents)}function zt(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}zt.prototype={constructor:zt,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function _u(e){return function(){return e}}function Eu(e,t,n,r,i,s){for(var o=0,a,c=t.length,d=s.length;o<d;++o)(a=t[o])?(a.__data__=s[o],r[o]=a):n[o]=new zt(e,s[o]);for(;o<c;++o)(a=t[o])&&(i[o]=a)}function Nu(e,t,n,r,i,s,o){var a,c,d=new Map,u=t.length,l=s.length,f=new Array(u),h;for(a=0;a<u;++a)(c=t[a])&&(f[a]=h=o.call(c,c.__data__,a,t)+"",d.has(h)?i[a]=c:d.set(h,c));for(a=0;a<l;++a)h=o.call(e,s[a],a,s)+"",(c=d.get(h))?(r[a]=c,c.__data__=s[a],d.delete(h)):n[a]=new zt(e,s[a]);for(a=0;a<u;++a)(c=t[a])&&d.get(f[a])===c&&(i[a]=c)}function ku(e){return e.__data__}function Su(e,t){if(!arguments.length)return Array.from(this,ku);var n=t?Nu:Eu,r=this._parents,i=this._groups;typeof e!="function"&&(e=_u(e));for(var s=i.length,o=new Array(s),a=new Array(s),c=new Array(s),d=0;d<s;++d){var u=r[d],l=i[d],f=l.length,h=Cu(e.call(u,u&&u.__data__,d,r)),m=h.length,y=a[d]=new Array(m),g=o[d]=new Array(m),w=c[d]=new Array(f);n(u,l,y,g,w,h,t);for(var b=0,p=0,x,E;b<m;++b)if(x=y[b]){for(b>=p&&(p=b+1);!(E=g[p])&&++p<m;);x._next=E||null}}return o=new le(o,r),o._enter=a,o._exit=c,o}function Cu(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Mu(){return new le(this._exit||this._groups.map(us),this._parents)}function Iu(e,t,n){var r=this.enter(),i=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function Au(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,s=r.length,o=Math.min(i,s),a=new Array(i),c=0;c<o;++c)for(var d=n[c],u=r[c],l=d.length,f=a[c]=new Array(l),h,m=0;m<l;++m)(h=d[m]||u[m])&&(f[m]=h);for(;c<i;++c)a[c]=n[c];return new le(a,this._parents)}function Tu(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function Ru(e){e||(e=Pu);function t(l,f){return l&&f?e(l.__data__,f.__data__):!l-!f}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],a=o.length,c=i[s]=new Array(a),d,u=0;u<a;++u)(d=o[u])&&(c[u]=d);c.sort(t)}return new le(i,this._parents).order()}function Pu(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function $u(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Ou(){return Array.from(this)}function Lu(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function ju(){let e=0;for(const t of this)++e;return e}function Du(){return!this.node()}function zu(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],s=0,o=i.length,a;s<o;++s)(a=i[s])&&e.call(a,a.__data__,s,i);return this}function Hu(e){return function(){this.removeAttribute(e)}}function Fu(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Bu(e,t){return function(){this.setAttribute(e,t)}}function Vu(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function qu(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Yu(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Gu(e,t){var n=Qt(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Fu:Hu:typeof t=="function"?n.local?Yu:qu:n.local?Vu:Bu)(n,t))}function ls(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Xu(e){return function(){this.style.removeProperty(e)}}function Wu(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Uu(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Ku(e,t,n){return arguments.length>1?this.each((t==null?Xu:typeof t=="function"?Uu:Wu)(e,t,n??"")):Xe(this.node(),e)}function Xe(e,t){return e.style.getPropertyValue(t)||ls(e).getComputedStyle(e,null).getPropertyValue(t)}function Zu(e){return function(){delete this[e]}}function Qu(e,t){return function(){this[e]=t}}function Ju(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function el(e,t){return arguments.length>1?this.each((t==null?Zu:typeof t=="function"?Ju:Qu)(e,t)):this.node()[e]}function ds(e){return e.trim().split(/^|\s+/)}function Or(e){return e.classList||new fs(e)}function fs(e){this._node=e,this._names=ds(e.getAttribute("class")||"")}fs.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function hs(e,t){for(var n=Or(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function ps(e,t){for(var n=Or(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function tl(e){return function(){hs(this,e)}}function nl(e){return function(){ps(this,e)}}function rl(e,t){return function(){(t.apply(this,arguments)?hs:ps)(this,e)}}function il(e,t){var n=ds(e+"");if(arguments.length<2){for(var r=Or(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?rl:t?tl:nl)(n,t))}function ol(){this.textContent=""}function sl(e){return function(){this.textContent=e}}function al(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function cl(e){return arguments.length?this.each(e==null?ol:(typeof e=="function"?al:sl)(e)):this.node().textContent}function ul(){this.innerHTML=""}function ll(e){return function(){this.innerHTML=e}}function dl(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function fl(e){return arguments.length?this.each(e==null?ul:(typeof e=="function"?dl:ll)(e)):this.node().innerHTML}function hl(){this.nextSibling&&this.parentNode.appendChild(this)}function pl(){return this.each(hl)}function gl(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ml(){return this.each(gl)}function yl(e){var t=typeof e=="function"?e:os(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function xl(){return null}function wl(e,t){var n=typeof e=="function"?e:os(e),r=t==null?xl:typeof t=="function"?t:$r(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function vl(){var e=this.parentNode;e&&e.removeChild(this)}function bl(){return this.each(vl)}function _l(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function El(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Nl(e){return this.select(e?El:_l)}function kl(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Sl(e){return function(t){e.call(this,t,this.__data__)}}function Cl(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Ml(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,s;n<i;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function Il(e,t,n){return function(){var r=this.__on,i,s=Sl(t);if(r){for(var o=0,a=r.length;o<a;++o)if((i=r[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=t;return}}this.addEventListener(e.type,s,n),i={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(i):this.__on=[i]}}function Al(e,t,n){var r=Cl(e+""),i,s=r.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,d=a.length,u;c<d;++c)for(i=0,u=a[c];i<s;++i)if((o=r[i]).type===u.type&&o.name===u.name)return u.value}return}for(a=t?Il:Ml,i=0;i<s;++i)this.each(a(r[i],t,n));return this}function gs(e,t,n){var r=ls(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function Tl(e,t){return function(){return gs(this,e,t)}}function Rl(e,t){return function(){return gs(this,e,t.apply(this,arguments))}}function Pl(e,t){return this.each((typeof t=="function"?Rl:Tl)(e,t))}function*$l(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var ms=[null];function le(e,t){this._groups=e,this._parents=t}function wt(){return new le([[document.documentElement]],ms)}function Ol(){return this}le.prototype=wt.prototype={constructor:le,select:au,selectAll:du,selectChild:gu,selectChildren:wu,filter:vu,data:Su,enter:bu,exit:Mu,join:Iu,merge:Au,selection:Ol,order:Tu,sort:Ru,call:$u,nodes:Ou,node:Lu,size:ju,empty:Du,each:zu,attr:Gu,style:Ku,property:el,classed:il,text:cl,html:fl,raise:pl,lower:ml,append:yl,insert:wl,remove:bl,clone:Nl,datum:kl,on:Al,dispatch:Pl,[Symbol.iterator]:$l};function ue(e){return typeof e=="string"?new le([[document.querySelector(e)]],[document.documentElement]):new le([[e]],ms)}function Ll(e){let t;for(;t=e.sourceEvent;)e=t;return e}function de(e,t){if(e=Ll(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const jl={passive:!1},ut={capture:!0,passive:!1};function yn(e){e.stopImmediatePropagation()}function Ye(e){e.preventDefault(),e.stopImmediatePropagation()}function ys(e){var t=e.document.documentElement,n=ue(e).on("dragstart.drag",Ye,ut);"onselectstart"in t?n.on("selectstart.drag",Ye,ut):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function xs(e,t){var n=e.document.documentElement,r=ue(e).on("dragstart.drag",null);t&&(r.on("click.drag",Ye,ut),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const St=e=>()=>e;function vr(e,{sourceEvent:t,subject:n,target:r,identifier:i,active:s,x:o,y:a,dx:c,dy:d,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:u}})}vr.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Dl(e){return!e.ctrlKey&&!e.button}function zl(){return this.parentNode}function Hl(e,t){return t??{x:e.x,y:e.y}}function Fl(){return navigator.maxTouchPoints||"ontouchstart"in this}function ws(){var e=Dl,t=zl,n=Hl,r=Fl,i={},s=Zt("start","drag","end"),o=0,a,c,d,u,l=0;function f(x){x.on("mousedown.drag",h).filter(r).on("touchstart.drag",g).on("touchmove.drag",w,jl).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(x,E){if(!(u||!e.call(this,x,E))){var k=p(this,t.call(this,x,E),x,E,"mouse");k&&(ue(x.view).on("mousemove.drag",m,ut).on("mouseup.drag",y,ut),ys(x.view),yn(x),d=!1,a=x.clientX,c=x.clientY,k("start",x))}}function m(x){if(Ye(x),!d){var E=x.clientX-a,k=x.clientY-c;d=E*E+k*k>l}i.mouse("drag",x)}function y(x){ue(x.view).on("mousemove.drag mouseup.drag",null),xs(x.view,d),Ye(x),i.mouse("end",x)}function g(x,E){if(e.call(this,x,E)){var k=x.changedTouches,S=t.call(this,x,E),_=k.length,N,C;for(N=0;N<_;++N)(C=p(this,S,x,E,k[N].identifier,k[N]))&&(yn(x),C("start",x,k[N]))}}function w(x){var E=x.changedTouches,k=E.length,S,_;for(S=0;S<k;++S)(_=i[E[S].identifier])&&(Ye(x),_("drag",x,E[S]))}function b(x){var E=x.changedTouches,k=E.length,S,_;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),S=0;S<k;++S)(_=i[E[S].identifier])&&(yn(x),_("end",x,E[S]))}function p(x,E,k,S,_,N){var C=s.copy(),M=de(N||k,E),I,D,v;if((v=n.call(x,new vr("beforestart",{sourceEvent:k,target:f,identifier:_,active:o,x:M[0],y:M[1],dx:0,dy:0,dispatch:C}),S))!=null)return I=v.x-M[0]||0,D=v.y-M[1]||0,function R(A,$,z){var L=M,V;switch(A){case"start":i[_]=R,V=o++;break;case"end":delete i[_],--o;case"drag":M=de(z||$,E),V=o;break}C.call(A,x,new vr(A,{sourceEvent:$,subject:v,target:f,identifier:_,active:V,x:M[0]+I,y:M[1]+D,dx:M[0]-L[0],dy:M[1]-L[1],dispatch:C}),S)}}return f.filter=function(x){return arguments.length?(e=typeof x=="function"?x:St(!!x),f):e},f.container=function(x){return arguments.length?(t=typeof x=="function"?x:St(x),f):t},f.subject=function(x){return arguments.length?(n=typeof x=="function"?x:St(x),f):n},f.touchable=function(x){return arguments.length?(r=typeof x=="function"?x:St(!!x),f):r},f.on=function(){var x=s.on.apply(s,arguments);return x===s?f:x},f.clickDistance=function(x){return arguments.length?(l=(x=+x)*x,f):Math.sqrt(l)},f}function Lr(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function vs(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function vt(){}var lt=.7,Ht=1/lt,Ge="\\s*([+-]?\\d+)\\s*",dt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ye="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Bl=/^#([0-9a-f]{3,8})$/,Vl=new RegExp(`^rgb\\(${Ge},${Ge},${Ge}\\)$`),ql=new RegExp(`^rgb\\(${ye},${ye},${ye}\\)$`),Yl=new RegExp(`^rgba\\(${Ge},${Ge},${Ge},${dt}\\)$`),Gl=new RegExp(`^rgba\\(${ye},${ye},${ye},${dt}\\)$`),Xl=new RegExp(`^hsl\\(${dt},${ye},${ye}\\)$`),Wl=new RegExp(`^hsla\\(${dt},${ye},${ye},${dt}\\)$`),ai={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Lr(vt,ft,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:ci,formatHex:ci,formatHex8:Ul,formatHsl:Kl,formatRgb:ui,toString:ui});function ci(){return this.rgb().formatHex()}function Ul(){return this.rgb().formatHex8()}function Kl(){return bs(this).formatHsl()}function ui(){return this.rgb().formatRgb()}function ft(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Bl.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?li(t):n===3?new ce(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Ct(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Ct(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Vl.exec(e))?new ce(t[1],t[2],t[3],1):(t=ql.exec(e))?new ce(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Yl.exec(e))?Ct(t[1],t[2],t[3],t[4]):(t=Gl.exec(e))?Ct(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Xl.exec(e))?hi(t[1],t[2]/100,t[3]/100,1):(t=Wl.exec(e))?hi(t[1],t[2]/100,t[3]/100,t[4]):ai.hasOwnProperty(e)?li(ai[e]):e==="transparent"?new ce(NaN,NaN,NaN,0):null}function li(e){return new ce(e>>16&255,e>>8&255,e&255,1)}function Ct(e,t,n,r){return r<=0&&(e=t=n=NaN),new ce(e,t,n,r)}function Zl(e){return e instanceof vt||(e=ft(e)),e?(e=e.rgb(),new ce(e.r,e.g,e.b,e.opacity)):new ce}function br(e,t,n,r){return arguments.length===1?Zl(e):new ce(e,t,n,r??1)}function ce(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Lr(ce,br,vs(vt,{brighter(e){return e=e==null?Ht:Math.pow(Ht,e),new ce(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?lt:Math.pow(lt,e),new ce(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ce(Pe(this.r),Pe(this.g),Pe(this.b),Ft(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:di,formatHex:di,formatHex8:Ql,formatRgb:fi,toString:fi}));function di(){return`#${Re(this.r)}${Re(this.g)}${Re(this.b)}`}function Ql(){return`#${Re(this.r)}${Re(this.g)}${Re(this.b)}${Re((isNaN(this.opacity)?1:this.opacity)*255)}`}function fi(){const e=Ft(this.opacity);return`${e===1?"rgb(":"rgba("}${Pe(this.r)}, ${Pe(this.g)}, ${Pe(this.b)}${e===1?")":`, ${e})`}`}function Ft(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Pe(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Re(e){return e=Pe(e),(e<16?"0":"")+e.toString(16)}function hi(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new fe(e,t,n,r)}function bs(e){if(e instanceof fe)return new fe(e.h,e.s,e.l,e.opacity);if(e instanceof vt||(e=ft(e)),!e)return new fe;if(e instanceof fe)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),o=NaN,a=s-i,c=(s+i)/2;return a?(t===s?o=(n-r)/a+(n<r)*6:n===s?o=(r-t)/a+2:o=(t-n)/a+4,a/=c<.5?s+i:2-s-i,o*=60):a=c>0&&c<1?0:o,new fe(o,a,c,e.opacity)}function Jl(e,t,n,r){return arguments.length===1?bs(e):new fe(e,t,n,r??1)}function fe(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Lr(fe,Jl,vs(vt,{brighter(e){return e=e==null?Ht:Math.pow(Ht,e),new fe(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?lt:Math.pow(lt,e),new fe(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new ce(xn(e>=240?e-240:e+120,i,r),xn(e,i,r),xn(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new fe(pi(this.h),Mt(this.s),Mt(this.l),Ft(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ft(this.opacity);return`${e===1?"hsl(":"hsla("}${pi(this.h)}, ${Mt(this.s)*100}%, ${Mt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function pi(e){return e=(e||0)%360,e<0?e+360:e}function Mt(e){return Math.max(0,Math.min(1,e||0))}function xn(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const _s=e=>()=>e;function ed(e,t){return function(n){return e+n*t}}function td(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function nd(e){return(e=+e)==1?Es:function(t,n){return n-t?td(t,n,e):_s(isNaN(t)?n:t)}}function Es(e,t){var n=t-e;return n?ed(e,n):_s(isNaN(e)?t:e)}const gi=function e(t){var n=nd(t);function r(i,s){var o=n((i=br(i)).r,(s=br(s)).r),a=n(i.g,s.g),c=n(i.b,s.b),d=Es(i.opacity,s.opacity);return function(u){return i.r=o(u),i.g=a(u),i.b=c(u),i.opacity=d(u),i+""}}return r.gamma=e,r}(1);function Ce(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var _r=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,wn=new RegExp(_r.source,"g");function rd(e){return function(){return e}}function id(e){return function(t){return e(t)+""}}function od(e,t){var n=_r.lastIndex=wn.lastIndex=0,r,i,s,o=-1,a=[],c=[];for(e=e+"",t=t+"";(r=_r.exec(e))&&(i=wn.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,c.push({i:o,x:Ce(r,i)})),n=wn.lastIndex;return n<t.length&&(s=t.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?c[0]?id(c[0].x):rd(t):(t=c.length,function(d){for(var u=0,l;u<t;++u)a[(l=c[u]).i]=l.x(d);return a.join("")})}var mi=180/Math.PI,Er={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ns(e,t,n,r,i,s){var o,a,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,c/=a),e*r<t*n&&(e=-e,t=-t,c=-c,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*mi,skewX:Math.atan(c)*mi,scaleX:o,scaleY:a}}var It;function sd(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Er:Ns(t.a,t.b,t.c,t.d,t.e,t.f)}function ad(e){return e==null||(It||(It=document.createElementNS("http://www.w3.org/2000/svg","g")),It.setAttribute("transform",e),!(e=It.transform.baseVal.consolidate()))?Er:(e=e.matrix,Ns(e.a,e.b,e.c,e.d,e.e,e.f))}function ks(e,t,n,r){function i(d){return d.length?d.pop()+" ":""}function s(d,u,l,f,h,m){if(d!==l||u!==f){var y=h.push("translate(",null,t,null,n);m.push({i:y-4,x:Ce(d,l)},{i:y-2,x:Ce(u,f)})}else(l||f)&&h.push("translate("+l+t+f+n)}function o(d,u,l,f){d!==u?(d-u>180?u+=360:u-d>180&&(d+=360),f.push({i:l.push(i(l)+"rotate(",null,r)-2,x:Ce(d,u)})):u&&l.push(i(l)+"rotate("+u+r)}function a(d,u,l,f){d!==u?f.push({i:l.push(i(l)+"skewX(",null,r)-2,x:Ce(d,u)}):u&&l.push(i(l)+"skewX("+u+r)}function c(d,u,l,f,h,m){if(d!==l||u!==f){var y=h.push(i(h)+"scale(",null,",",null,")");m.push({i:y-4,x:Ce(d,l)},{i:y-2,x:Ce(u,f)})}else(l!==1||f!==1)&&h.push(i(h)+"scale("+l+","+f+")")}return function(d,u){var l=[],f=[];return d=e(d),u=e(u),s(d.translateX,d.translateY,u.translateX,u.translateY,l,f),o(d.rotate,u.rotate,l,f),a(d.skewX,u.skewX,l,f),c(d.scaleX,d.scaleY,u.scaleX,u.scaleY,l,f),d=u=null,function(h){for(var m=-1,y=f.length,g;++m<y;)l[(g=f[m]).i]=g.x(h);return l.join("")}}}var cd=ks(sd,"px, ","px)","deg)"),ud=ks(ad,", ",")",")"),ld=1e-12;function yi(e){return((e=Math.exp(e))+1/e)/2}function dd(e){return((e=Math.exp(e))-1/e)/2}function fd(e){return((e=Math.exp(2*e))-1)/(e+1)}const hd=function e(t,n,r){function i(s,o){var a=s[0],c=s[1],d=s[2],u=o[0],l=o[1],f=o[2],h=u-a,m=l-c,y=h*h+m*m,g,w;if(y<ld)w=Math.log(f/d)/t,g=function(S){return[a+S*h,c+S*m,d*Math.exp(t*S*w)]};else{var b=Math.sqrt(y),p=(f*f-d*d+r*y)/(2*d*n*b),x=(f*f-d*d-r*y)/(2*f*n*b),E=Math.log(Math.sqrt(p*p+1)-p),k=Math.log(Math.sqrt(x*x+1)-x);w=(k-E)/t,g=function(S){var _=S*w,N=yi(E),C=d/(n*b)*(N*fd(t*_+E)-dd(E));return[a+C*h,c+C*m,d*N/yi(t*_+E)]}}return g.duration=w*1e3*t/Math.SQRT2,g}return i.rho=function(s){var o=Math.max(.001,+s),a=o*o,c=a*a;return e(o,a,c)},i}(Math.SQRT2,2,4);var We=0,ot=0,rt=0,Ss=1e3,Bt,st,Vt=0,Le=0,Jt=0,ht=typeof performance=="object"&&performance.now?performance:Date,Cs=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function jr(){return Le||(Cs(pd),Le=ht.now()+Jt)}function pd(){Le=0}function qt(){this._call=this._time=this._next=null}qt.prototype=Ms.prototype={constructor:qt,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?jr():+n)+(t==null?0:+t),!this._next&&st!==this&&(st?st._next=this:Bt=this,st=this),this._call=e,this._time=n,Nr()},stop:function(){this._call&&(this._call=null,this._time=1/0,Nr())}};function Ms(e,t,n){var r=new qt;return r.restart(e,t,n),r}function gd(){jr(),++We;for(var e=Bt,t;e;)(t=Le-e._time)>=0&&e._call.call(void 0,t),e=e._next;--We}function xi(){Le=(Vt=ht.now())+Jt,We=ot=0;try{gd()}finally{We=0,yd(),Le=0}}function md(){var e=ht.now(),t=e-Vt;t>Ss&&(Jt-=t,Vt=e)}function yd(){for(var e,t=Bt,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Bt=n);st=e,Nr(r)}function Nr(e){if(!We){ot&&(ot=clearTimeout(ot));var t=e-Le;t>24?(e<1/0&&(ot=setTimeout(xi,e-ht.now()-Jt)),rt&&(rt=clearInterval(rt))):(rt||(Vt=ht.now(),rt=setInterval(md,Ss)),We=1,Cs(xi))}}function wi(e,t,n){var r=new qt;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var xd=Zt("start","end","cancel","interrupt"),wd=[],Is=0,vi=1,kr=2,Lt=3,bi=4,Sr=5,jt=6;function en(e,t,n,r,i,s){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;vd(e,n,{name:t,index:r,group:i,on:xd,tween:wd,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Is})}function Dr(e,t){var n=me(e,t);if(n.state>Is)throw new Error("too late; already scheduled");return n}function we(e,t){var n=me(e,t);if(n.state>Lt)throw new Error("too late; already running");return n}function me(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function vd(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=Ms(s,0,n.time);function s(d){n.state=vi,n.timer.restart(o,n.delay,n.time),n.delay<=d&&o(d-n.delay)}function o(d){var u,l,f,h;if(n.state!==vi)return c();for(u in r)if(h=r[u],h.name===n.name){if(h.state===Lt)return wi(o);h.state===bi?(h.state=jt,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[u]):+u<t&&(h.state=jt,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[u])}if(wi(function(){n.state===Lt&&(n.state=bi,n.timer.restart(a,n.delay,n.time),a(d))}),n.state=kr,n.on.call("start",e,e.__data__,n.index,n.group),n.state===kr){for(n.state=Lt,i=new Array(f=n.tween.length),u=0,l=-1;u<f;++u)(h=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(i[++l]=h);i.length=l+1}}function a(d){for(var u=d<n.duration?n.ease.call(null,d/n.duration):(n.timer.restart(c),n.state=Sr,1),l=-1,f=i.length;++l<f;)i[l].call(e,u);n.state===Sr&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=jt,n.timer.stop(),delete r[t];for(var d in r)return;delete e.__transition}}function Dt(e,t){var n=e.__transition,r,i,s=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((r=n[o]).name!==t){s=!1;continue}i=r.state>kr&&r.state<Sr,r.state=jt,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[o]}s&&delete e.__transition}}function bd(e){return this.each(function(){Dt(this,e)})}function _d(e,t){var n,r;return function(){var i=we(this,e),s=i.tween;if(s!==n){r=n=s;for(var o=0,a=r.length;o<a;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function Ed(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=we(this,e),o=s.tween;if(o!==r){i=(r=o).slice();for(var a={name:t,value:n},c=0,d=i.length;c<d;++c)if(i[c].name===t){i[c]=a;break}c===d&&i.push(a)}s.tween=i}}function Nd(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=me(this.node(),n).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((t==null?_d:Ed)(n,e,t))}function zr(e,t,n){var r=e._id;return e.each(function(){var i=we(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return me(i,r).value[t]}}function As(e,t){var n;return(typeof t=="number"?Ce:t instanceof ft?gi:(n=ft(t))?(t=n,gi):od)(e,t)}function kd(e){return function(){this.removeAttribute(e)}}function Sd(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Cd(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttribute(e);return o===i?null:o===r?s:s=t(r=o,n)}}function Md(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?s:s=t(r=o,n)}}function Id(e,t,n){var r,i,s;return function(){var o,a=n(this),c;return a==null?void this.removeAttribute(e):(o=this.getAttribute(e),c=a+"",o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,a)))}}function Ad(e,t,n){var r,i,s;return function(){var o,a=n(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),c=a+"",o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,a)))}}function Td(e,t){var n=Qt(e),r=n==="transform"?ud:As;return this.attrTween(e,typeof t=="function"?(n.local?Ad:Id)(n,r,zr(this,"attr."+e,t)):t==null?(n.local?Sd:kd)(n):(n.local?Md:Cd)(n,r,t))}function Rd(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Pd(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function $d(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&Pd(e,s)),n}return i._value=t,i}function Od(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&Rd(e,s)),n}return i._value=t,i}function Ld(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Qt(e);return this.tween(n,(r.local?$d:Od)(r,t))}function jd(e,t){return function(){Dr(this,e).delay=+t.apply(this,arguments)}}function Dd(e,t){return t=+t,function(){Dr(this,e).delay=t}}function zd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?jd:Dd)(t,e)):me(this.node(),t).delay}function Hd(e,t){return function(){we(this,e).duration=+t.apply(this,arguments)}}function Fd(e,t){return t=+t,function(){we(this,e).duration=t}}function Bd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Hd:Fd)(t,e)):me(this.node(),t).duration}function Vd(e,t){if(typeof t!="function")throw new Error;return function(){we(this,e).ease=t}}function qd(e){var t=this._id;return arguments.length?this.each(Vd(t,e)):me(this.node(),t).ease}function Yd(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;we(this,e).ease=n}}function Gd(e){if(typeof e!="function")throw new Error;return this.each(Yd(this._id,e))}function Xd(e){typeof e!="function"&&(e=as(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,a=r[i]=[],c,d=0;d<o;++d)(c=s[d])&&e.call(c,c.__data__,d,s)&&a.push(c);return new Ee(r,this._parents,this._name,this._id)}function Wd(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,s=Math.min(r,i),o=new Array(r),a=0;a<s;++a)for(var c=t[a],d=n[a],u=c.length,l=o[a]=new Array(u),f,h=0;h<u;++h)(f=c[h]||d[h])&&(l[h]=f);for(;a<r;++a)o[a]=t[a];return new Ee(o,this._parents,this._name,this._id)}function Ud(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Kd(e,t,n){var r,i,s=Ud(t)?Dr:we;return function(){var o=s(this,e),a=o.on;a!==r&&(i=(r=a).copy()).on(t,n),o.on=i}}function Zd(e,t){var n=this._id;return arguments.length<2?me(this.node(),n).on.on(e):this.each(Kd(n,e,t))}function Qd(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Jd(){return this.on("end.remove",Qd(this._id))}function ef(e){var t=this._name,n=this._id;typeof e!="function"&&(e=$r(e));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var a=r[o],c=a.length,d=s[o]=new Array(c),u,l,f=0;f<c;++f)(u=a[f])&&(l=e.call(u,u.__data__,f,a))&&("__data__"in u&&(l.__data__=u.__data__),d[f]=l,en(d[f],t,n,f,d,me(u,n)));return new Ee(s,this._parents,t,n)}function tf(e){var t=this._name,n=this._id;typeof e!="function"&&(e=ss(e));for(var r=this._groups,i=r.length,s=[],o=[],a=0;a<i;++a)for(var c=r[a],d=c.length,u,l=0;l<d;++l)if(u=c[l]){for(var f=e.call(u,u.__data__,l,c),h,m=me(u,n),y=0,g=f.length;y<g;++y)(h=f[y])&&en(h,t,n,y,f,m);s.push(f),o.push(u)}return new Ee(s,o,t,n)}var nf=wt.prototype.constructor;function rf(){return new nf(this._groups,this._parents)}function of(e,t){var n,r,i;return function(){var s=Xe(this,e),o=(this.style.removeProperty(e),Xe(this,e));return s===o?null:s===n&&o===r?i:i=t(n=s,r=o)}}function Ts(e){return function(){this.style.removeProperty(e)}}function sf(e,t,n){var r,i=n+"",s;return function(){var o=Xe(this,e);return o===i?null:o===r?s:s=t(r=o,n)}}function af(e,t,n){var r,i,s;return function(){var o=Xe(this,e),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),Xe(this,e))),o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,a))}}function cf(e,t){var n,r,i,s="style."+t,o="end."+s,a;return function(){var c=we(this,e),d=c.on,u=c.value[s]==null?a||(a=Ts(t)):void 0;(d!==n||i!==u)&&(r=(n=d).copy()).on(o,i=u),c.on=r}}function uf(e,t,n){var r=(e+="")=="transform"?cd:As;return t==null?this.styleTween(e,of(e,r)).on("end.style."+e,Ts(e)):typeof t=="function"?this.styleTween(e,af(e,r,zr(this,"style."+e,t))).each(cf(this._id,e)):this.styleTween(e,sf(e,r,t),n).on("end.style."+e,null)}function lf(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function df(e,t,n){var r,i;function s(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&lf(e,o,n)),r}return s._value=t,s}function ff(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,df(e,t,n??""))}function hf(e){return function(){this.textContent=e}}function pf(e){return function(){var t=e(this);this.textContent=t??""}}function gf(e){return this.tween("text",typeof e=="function"?pf(zr(this,"text",e)):hf(e==null?"":e+""))}function mf(e){return function(t){this.textContent=e.call(this,t)}}function yf(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&mf(i)),t}return r._value=e,r}function xf(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,yf(e))}function wf(){for(var e=this._name,t=this._id,n=Rs(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,c,d=0;d<a;++d)if(c=o[d]){var u=me(c,t);en(c,e,n,d,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Ee(r,this._parents,e,n)}function vf(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var a={value:o},c={value:function(){--i===0&&s()}};n.each(function(){var d=we(this,r),u=d.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),d.on=t}),i===0&&s()})}var bf=0;function Ee(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Rs(){return++bf}var ve=wt.prototype;Ee.prototype={constructor:Ee,select:ef,selectAll:tf,selectChild:ve.selectChild,selectChildren:ve.selectChildren,filter:Xd,merge:Wd,selection:rf,transition:wf,call:ve.call,nodes:ve.nodes,node:ve.node,size:ve.size,empty:ve.empty,each:ve.each,on:Zd,attr:Td,attrTween:Ld,style:uf,styleTween:ff,text:gf,textTween:xf,remove:Jd,tween:Nd,delay:zd,duration:Bd,ease:qd,easeVarying:Gd,end:vf,[Symbol.iterator]:ve[Symbol.iterator]};function _f(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Ef={time:null,delay:0,duration:250,ease:_f};function Nf(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function kf(e){var t,n;e instanceof Ee?(t=e._id,e=e._name):(t=Rs(),(n=Ef).time=jr(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,c,d=0;d<a;++d)(c=o[d])&&en(c,e,t,d,o,n||Nf(c,t));return new Ee(r,this._parents,e,t)}wt.prototype.interrupt=bd;wt.prototype.transition=kf;const At=e=>()=>e;function Sf(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function be(e,t,n){this.k=e,this.x=t,this.y=n}be.prototype={constructor:be,scale:function(e){return e===1?this:new be(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new be(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var tn=new be(1,0,0);Ps.prototype=be.prototype;function Ps(e){for(;!e.__zoom;)if(!(e=e.parentNode))return tn;return e.__zoom}function vn(e){e.stopImmediatePropagation()}function it(e){e.preventDefault(),e.stopImmediatePropagation()}function Cf(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Mf(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function _i(){return this.__zoom||tn}function If(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Af(){return navigator.maxTouchPoints||"ontouchstart"in this}function Tf(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],o=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function $s(){var e=Cf,t=Mf,n=Tf,r=If,i=Af,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],a=250,c=hd,d=Zt("start","zoom","end"),u,l,f,h=500,m=150,y=0,g=10;function w(v){v.property("__zoom",_i).on("wheel.zoom",_,{passive:!1}).on("mousedown.zoom",N).on("dblclick.zoom",C).filter(i).on("touchstart.zoom",M).on("touchmove.zoom",I).on("touchend.zoom touchcancel.zoom",D).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}w.transform=function(v,R,A,$){var z=v.selection?v.selection():v;z.property("__zoom",_i),v!==z?E(v,R,A,$):z.interrupt().each(function(){k(this,arguments).event($).start().zoom(null,typeof R=="function"?R.apply(this,arguments):R).end()})},w.scaleBy=function(v,R,A,$){w.scaleTo(v,function(){var z=this.__zoom.k,L=typeof R=="function"?R.apply(this,arguments):R;return z*L},A,$)},w.scaleTo=function(v,R,A,$){w.transform(v,function(){var z=t.apply(this,arguments),L=this.__zoom,V=A==null?x(z):typeof A=="function"?A.apply(this,arguments):A,B=L.invert(V),Y=typeof R=="function"?R.apply(this,arguments):R;return n(p(b(L,Y),V,B),z,o)},A,$)},w.translateBy=function(v,R,A,$){w.transform(v,function(){return n(this.__zoom.translate(typeof R=="function"?R.apply(this,arguments):R,typeof A=="function"?A.apply(this,arguments):A),t.apply(this,arguments),o)},null,$)},w.translateTo=function(v,R,A,$,z){w.transform(v,function(){var L=t.apply(this,arguments),V=this.__zoom,B=$==null?x(L):typeof $=="function"?$.apply(this,arguments):$;return n(tn.translate(B[0],B[1]).scale(V.k).translate(typeof R=="function"?-R.apply(this,arguments):-R,typeof A=="function"?-A.apply(this,arguments):-A),L,o)},$,z)};function b(v,R){return R=Math.max(s[0],Math.min(s[1],R)),R===v.k?v:new be(R,v.x,v.y)}function p(v,R,A){var $=R[0]-A[0]*v.k,z=R[1]-A[1]*v.k;return $===v.x&&z===v.y?v:new be(v.k,$,z)}function x(v){return[(+v[0][0]+ +v[1][0])/2,(+v[0][1]+ +v[1][1])/2]}function E(v,R,A,$){v.on("start.zoom",function(){k(this,arguments).event($).start()}).on("interrupt.zoom end.zoom",function(){k(this,arguments).event($).end()}).tween("zoom",function(){var z=this,L=arguments,V=k(z,L).event($),B=t.apply(z,L),Y=A==null?x(B):typeof A=="function"?A.apply(z,L):A,T=Math.max(B[1][0]-B[0][0],B[1][1]-B[0][1]),O=z.__zoom,j=typeof R=="function"?R.apply(z,L):R,F=c(O.invert(Y).concat(T/O.k),j.invert(Y).concat(T/j.k));return function(q){if(q===1)q=j;else{var G=F(q),W=T/G[2];q=new be(W,Y[0]-G[0]*W,Y[1]-G[1]*W)}V.zoom(null,q)}})}function k(v,R,A){return!A&&v.__zooming||new S(v,R)}function S(v,R){this.that=v,this.args=R,this.active=0,this.sourceEvent=null,this.extent=t.apply(v,R),this.taps=0}S.prototype={event:function(v){return v&&(this.sourceEvent=v),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(v,R){return this.mouse&&v!=="mouse"&&(this.mouse[1]=R.invert(this.mouse[0])),this.touch0&&v!=="touch"&&(this.touch0[1]=R.invert(this.touch0[0])),this.touch1&&v!=="touch"&&(this.touch1[1]=R.invert(this.touch1[0])),this.that.__zoom=R,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(v){var R=ue(this.that).datum();d.call(v,this.that,new Sf(v,{sourceEvent:this.sourceEvent,target:w,transform:this.that.__zoom,dispatch:d}),R)}};function _(v,...R){if(!e.apply(this,arguments))return;var A=k(this,R).event(v),$=this.__zoom,z=Math.max(s[0],Math.min(s[1],$.k*Math.pow(2,r.apply(this,arguments)))),L=de(v);if(A.wheel)(A.mouse[0][0]!==L[0]||A.mouse[0][1]!==L[1])&&(A.mouse[1]=$.invert(A.mouse[0]=L)),clearTimeout(A.wheel);else{if($.k===z)return;A.mouse=[L,$.invert(L)],Dt(this),A.start()}it(v),A.wheel=setTimeout(V,m),A.zoom("mouse",n(p(b($,z),A.mouse[0],A.mouse[1]),A.extent,o));function V(){A.wheel=null,A.end()}}function N(v,...R){if(f||!e.apply(this,arguments))return;var A=v.currentTarget,$=k(this,R,!0).event(v),z=ue(v.view).on("mousemove.zoom",Y,!0).on("mouseup.zoom",T,!0),L=de(v,A),V=v.clientX,B=v.clientY;ys(v.view),vn(v),$.mouse=[L,this.__zoom.invert(L)],Dt(this),$.start();function Y(O){if(it(O),!$.moved){var j=O.clientX-V,F=O.clientY-B;$.moved=j*j+F*F>y}$.event(O).zoom("mouse",n(p($.that.__zoom,$.mouse[0]=de(O,A),$.mouse[1]),$.extent,o))}function T(O){z.on("mousemove.zoom mouseup.zoom",null),xs(O.view,$.moved),it(O),$.event(O).end()}}function C(v,...R){if(e.apply(this,arguments)){var A=this.__zoom,$=de(v.changedTouches?v.changedTouches[0]:v,this),z=A.invert($),L=A.k*(v.shiftKey?.5:2),V=n(p(b(A,L),$,z),t.apply(this,R),o);it(v),a>0?ue(this).transition().duration(a).call(E,V,$,v):ue(this).call(w.transform,V,$,v)}}function M(v,...R){if(e.apply(this,arguments)){var A=v.touches,$=A.length,z=k(this,R,v.changedTouches.length===$).event(v),L,V,B,Y;for(vn(v),V=0;V<$;++V)B=A[V],Y=de(B,this),Y=[Y,this.__zoom.invert(Y),B.identifier],z.touch0?!z.touch1&&z.touch0[2]!==Y[2]&&(z.touch1=Y,z.taps=0):(z.touch0=Y,L=!0,z.taps=1+!!u);u&&(u=clearTimeout(u)),L&&(z.taps<2&&(l=Y[0],u=setTimeout(function(){u=null},h)),Dt(this),z.start())}}function I(v,...R){if(this.__zooming){var A=k(this,R).event(v),$=v.changedTouches,z=$.length,L,V,B,Y;for(it(v),L=0;L<z;++L)V=$[L],B=de(V,this),A.touch0&&A.touch0[2]===V.identifier?A.touch0[0]=B:A.touch1&&A.touch1[2]===V.identifier&&(A.touch1[0]=B);if(V=A.that.__zoom,A.touch1){var T=A.touch0[0],O=A.touch0[1],j=A.touch1[0],F=A.touch1[1],q=(q=j[0]-T[0])*q+(q=j[1]-T[1])*q,G=(G=F[0]-O[0])*G+(G=F[1]-O[1])*G;V=b(V,Math.sqrt(q/G)),B=[(T[0]+j[0])/2,(T[1]+j[1])/2],Y=[(O[0]+F[0])/2,(O[1]+F[1])/2]}else if(A.touch0)B=A.touch0[0],Y=A.touch0[1];else return;A.zoom("touch",n(p(V,B,Y),A.extent,o))}}function D(v,...R){if(this.__zooming){var A=k(this,R).event(v),$=v.changedTouches,z=$.length,L,V;for(vn(v),f&&clearTimeout(f),f=setTimeout(function(){f=null},h),L=0;L<z;++L)V=$[L],A.touch0&&A.touch0[2]===V.identifier?delete A.touch0:A.touch1&&A.touch1[2]===V.identifier&&delete A.touch1;if(A.touch1&&!A.touch0&&(A.touch0=A.touch1,delete A.touch1),A.touch0)A.touch0[1]=this.__zoom.invert(A.touch0[0]);else if(A.end(),A.taps===2&&(V=de(V,this),Math.hypot(l[0]-V[0],l[1]-V[1])<g)){var B=ue(this).on("dblclick.zoom");B&&B.apply(this,arguments)}}}return w.wheelDelta=function(v){return arguments.length?(r=typeof v=="function"?v:At(+v),w):r},w.filter=function(v){return arguments.length?(e=typeof v=="function"?v:At(!!v),w):e},w.touchable=function(v){return arguments.length?(i=typeof v=="function"?v:At(!!v),w):i},w.extent=function(v){return arguments.length?(t=typeof v=="function"?v:At([[+v[0][0],+v[0][1]],[+v[1][0],+v[1][1]]]),w):t},w.scaleExtent=function(v){return arguments.length?(s[0]=+v[0],s[1]=+v[1],w):[s[0],s[1]]},w.translateExtent=function(v){return arguments.length?(o[0][0]=+v[0][0],o[1][0]=+v[1][0],o[0][1]=+v[0][1],o[1][1]=+v[1][1],w):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},w.constrain=function(v){return arguments.length?(n=v,w):n},w.duration=function(v){return arguments.length?(a=+v,w):a},w.interpolate=function(v){return arguments.length?(c=v,w):c},w.on=function(){var v=d.on.apply(d,arguments);return v===d?w:v},w.clickDistance=function(v){return arguments.length?(y=(v=+v)*v,w):Math.sqrt(y)},w.tapDistance=function(v){return arguments.length?(g=+v,w):g},w}const xe={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},pt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Os=["Enter"," ","Escape"];var Ue;(function(e){e.Strict="strict",e.Loose="loose"})(Ue||(Ue={}));var $e;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})($e||($e={}));var gt;(function(e){e.Partial="partial",e.Full="full"})(gt||(gt={}));const Ls={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var Me;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Me||(Me={}));var Yt;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Yt||(Yt={}));var U;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(U||(U={}));const Ei={[U.Left]:U.Right,[U.Right]:U.Left,[U.Top]:U.Bottom,[U.Bottom]:U.Top};function js(e){return e===null?null:e?"valid":"invalid"}const Ds=e=>"id"in e&&"source"in e&&"target"in e,Rf=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Hr=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),bt=(e,t=[0,0])=>{const{width:n,height:r}=Ne(e),i=e.origin??t,s=n*i[0],o=r*i[1];return{x:e.position.x-s,y:e.position.y-o}},Pf=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,i)=>{const s=typeof i=="string";let o=!t.nodeLookup&&!s?i:void 0;t.nodeLookup&&(o=s?t.nodeLookup.get(i):Hr(i)?i:t.nodeLookup.get(i.id));const a=o?Gt(o,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return nn(r,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return rn(n)},_t=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(r=>{if(t.filter===void 0||t.filter(r)){const i=Gt(r);n=nn(n,i)}}),rn(n)},zs=(e,t,[n,r,i]=[0,0,1],s=!1,o=!1)=>{const a={...Et(t,[n,r,i]),width:t.width/i,height:t.height/i},c=[];for(const d of e.values()){const{measured:u,selectable:l=!0,hidden:f=!1}=d;if(o&&!l||f)continue;const h=u.width??d.width??d.initialWidth??null,m=u.height??d.height??d.initialHeight??null,y=mt(a,Ze(d)),g=(h??0)*(m??0),w=s&&y>0;(!d.internals.handleBounds||w||y>=g||d.dragging)&&c.push(d)}return c},$f=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function Of(e,t){const n=new Map,r=t!=null&&t.nodes?new Set(t.nodes.map(i=>i.id)):null;return e.forEach(i=>{i.measured.width&&i.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!i.hidden)&&(!r||r.has(i.id))&&n.set(i.id,i)}),n}async function Lf({nodes:e,width:t,height:n,panZoom:r,minZoom:i,maxZoom:s},o){if(e.size===0)return Promise.resolve(!0);const a=Of(e,o),c=_t(a),d=Fr(c,t,n,(o==null?void 0:o.minZoom)??i,(o==null?void 0:o.maxZoom)??s,(o==null?void 0:o.padding)??.1);return await r.setViewport(d,{duration:o==null?void 0:o.duration}),Promise.resolve(!0)}function Hs({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:i,onError:s}){const o=n.get(e),a=o.parentId?n.get(o.parentId):void 0,{x:c,y:d}=a?a.internals.positionAbsolute:{x:0,y:0},u=o.origin??r;let l=i;if(o.extent==="parent"&&!o.expandParent)if(!a)s==null||s("005",xe.error005());else{const h=a.measured.width,m=a.measured.height;h&&m&&(l=[[c,d],[c+h,d+m]])}else a&&Qe(o.extent)&&(l=[[o.extent[0][0]+c,o.extent[0][1]+d],[o.extent[1][0]+c,o.extent[1][1]+d]]);const f=Qe(l)?je(t,l,o.measured):t;return(o.measured.width===void 0||o.measured.height===void 0)&&(s==null||s("015",xe.error015())),{position:{x:f.x-c+(o.measured.width??0)*u[0],y:f.y-d+(o.measured.height??0)*u[1]},positionAbsolute:f}}async function jf({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:i}){const s=new Set(e.map(f=>f.id)),o=[];for(const f of n){if(f.deletable===!1)continue;const h=s.has(f.id),m=!h&&f.parentId&&o.find(y=>y.id===f.parentId);(h||m)&&o.push(f)}const a=new Set(t.map(f=>f.id)),c=r.filter(f=>f.deletable!==!1),u=$f(o,c);for(const f of c)a.has(f.id)&&!u.find(m=>m.id===f.id)&&u.push(f);if(!i)return{edges:u,nodes:o};const l=await i({nodes:o,edges:u});return typeof l=="boolean"?l?{edges:u,nodes:o}:{edges:[],nodes:[]}:l}const Ke=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),je=(e={x:0,y:0},t,n)=>({x:Ke(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:Ke(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function Fs(e,t,n){const{width:r,height:i}=Ne(n),{x:s,y:o}=n.internals.positionAbsolute;return je(e,[[s,o],[s+r,o+i]],t)}const Ni=(e,t,n)=>e<t?Ke(Math.abs(e-t),1,t)/t:e>n?-Ke(Math.abs(e-n),1,t)/t:0,Bs=(e,t,n=15,r=40)=>{const i=Ni(e.x,r,t.width-r)*n,s=Ni(e.y,r,t.height-r)*n;return[i,s]},nn=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Cr=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),rn=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),Ze=(e,t=[0,0])=>{var i,s;const{x:n,y:r}=Hr(e)?e.internals.positionAbsolute:bt(e,t);return{x:n,y:r,width:((i=e.measured)==null?void 0:i.width)??e.width??e.initialWidth??0,height:((s=e.measured)==null?void 0:s.height)??e.height??e.initialHeight??0}},Gt=(e,t=[0,0])=>{var i,s;const{x:n,y:r}=Hr(e)?e.internals.positionAbsolute:bt(e,t);return{x:n,y:r,x2:n+(((i=e.measured)==null?void 0:i.width)??e.width??e.initialWidth??0),y2:r+(((s=e.measured)==null?void 0:s.height)??e.height??e.initialHeight??0)}},Vs=(e,t)=>rn(nn(Cr(e),Cr(t))),mt=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},ki=e=>he(e.width)&&he(e.height)&&he(e.x)&&he(e.y),he=e=>!isNaN(e)&&isFinite(e),Df=(e,t)=>{},on=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Et=({x:e,y:t},[n,r,i],s=!1,o=[1,1])=>{const a={x:(e-n)/i,y:(t-r)/i};return s?on(a,o):a},Xt=({x:e,y:t},[n,r,i])=>({x:e*i+n,y:t*i+r});function Fe(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function zf(e,t,n){if(typeof e=="string"||typeof e=="number"){const r=Fe(e,n),i=Fe(e,t);return{top:r,right:i,bottom:r,left:i,x:i*2,y:r*2}}if(typeof e=="object"){const r=Fe(e.top??e.y??0,n),i=Fe(e.bottom??e.y??0,n),s=Fe(e.left??e.x??0,t),o=Fe(e.right??e.x??0,t);return{top:r,right:o,bottom:i,left:s,x:s+o,y:r+i}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function Hf(e,t,n,r,i,s){const{x:o,y:a}=Xt(e,[t,n,r]),{x:c,y:d}=Xt({x:e.x+e.width,y:e.y+e.height},[t,n,r]),u=i-c,l=s-d;return{left:Math.floor(o),top:Math.floor(a),right:Math.floor(u),bottom:Math.floor(l)}}const Fr=(e,t,n,r,i,s)=>{const o=zf(s,t,n),a=(t-o.x)/e.width,c=(n-o.y)/e.height,d=Math.min(a,c),u=Ke(d,r,i),l=e.x+e.width/2,f=e.y+e.height/2,h=t/2-l*u,m=n/2-f*u,y=Hf(e,h,m,u,t,n),g={left:Math.min(y.left-o.left,0),top:Math.min(y.top-o.top,0),right:Math.min(y.right-o.right,0),bottom:Math.min(y.bottom-o.bottom,0)};return{x:h-g.left+g.right,y:m-g.top+g.bottom,zoom:u}},Wt=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function Qe(e){return e!==void 0&&e!=="parent"}function Ne(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function qs(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function Ys(e,t={width:0,height:0},n,r,i){const s={...e},o=r.get(n);if(o){const a=o.origin||i;s.x+=o.internals.positionAbsolute.x-(t.width??0)*a[0],s.y+=o.internals.positionAbsolute.y-(t.height??0)*a[1]}return s}function Si(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Ff(){let e,t;return{promise:new Promise((r,i)=>{e=r,t=i}),resolve:e,reject:t}}function at(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:i}){const{x:s,y:o}=_e(e),a=Et({x:s-((i==null?void 0:i.left)??0),y:o-((i==null?void 0:i.top)??0)},r),{x:c,y:d}=n?on(a,t):a;return{xSnapped:c,ySnapped:d,...a}}const Br=e=>({width:e.offsetWidth,height:e.offsetHeight}),Gs=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},Bf=["INPUT","SELECT","TEXTAREA"];function Xs(e){var r,i;const t=((i=(r=e.composedPath)==null?void 0:r.call(e))==null?void 0:i[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:Bf.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const Ws=e=>"clientX"in e,_e=(e,t)=>{var s,o;const n=Ws(e),r=n?e.clientX:(s=e.touches)==null?void 0:s[0].clientX,i=n?e.clientY:(o=e.touches)==null?void 0:o[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:i-((t==null?void 0:t.top)??0)}},Ci=(e,t,n,r,i)=>{const s=t.querySelectorAll(`.${e}`);return!s||!s.length?null:Array.from(s).map(o=>{const a=o.getBoundingClientRect();return{id:o.getAttribute("data-handleid"),type:e,nodeId:i,position:o.getAttribute("data-handlepos"),x:(a.left-n.left)/r,y:(a.top-n.top)/r,...Br(o)}})};function Us({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:i,sourceControlY:s,targetControlX:o,targetControlY:a}){const c=e*.125+i*.375+o*.375+n*.125,d=t*.125+s*.375+a*.375+r*.125,u=Math.abs(c-e),l=Math.abs(d-t);return[c,d,u,l]}function Tt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Mi({pos:e,x1:t,y1:n,x2:r,y2:i,c:s}){switch(e){case U.Left:return[t-Tt(t-r,s),n];case U.Right:return[t+Tt(r-t,s),n];case U.Top:return[t,n-Tt(n-i,s)];case U.Bottom:return[t,n+Tt(i-n,s)]}}function Ks({sourceX:e,sourceY:t,sourcePosition:n=U.Bottom,targetX:r,targetY:i,targetPosition:s=U.Top,curvature:o=.25}){const[a,c]=Mi({pos:n,x1:e,y1:t,x2:r,y2:i,c:o}),[d,u]=Mi({pos:s,x1:r,y1:i,x2:e,y2:t,c:o}),[l,f,h,m]=Us({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:a,sourceControlY:c,targetControlX:d,targetControlY:u});return[`M${e},${t} C${a},${c} ${d},${u} ${r},${i}`,l,f,h,m]}function Zs({sourceX:e,sourceY:t,targetX:n,targetY:r}){const i=Math.abs(n-e)/2,s=n<e?n+i:n-i,o=Math.abs(r-t)/2,a=r<t?r+o:r-o;return[s,a,i,o]}function Vf({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r=0,elevateOnSelect:i=!1}){if(!i)return r;const s=n||t.selected||e.selected,o=Math.max(e.internals.z||0,t.internals.z||0,1e3);return r+(s?o:0)}function qf({sourceNode:e,targetNode:t,width:n,height:r,transform:i}){const s=nn(Gt(e),Gt(t));s.x===s.x2&&(s.x2+=1),s.y===s.y2&&(s.y2+=1);const o={x:-i[0]/i[2],y:-i[1]/i[2],width:n/i[2],height:r/i[2]};return mt(o,rn(s))>0}const Yf=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,Gf=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Xf=(e,t)=>{if(!e.source||!e.target)return t;let n;return Ds(e)?n={...e}:n={...e,id:Yf(e)},Gf(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function Qs({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[i,s,o,a]=Zs({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,i,s,o,a]}const Ii={[U.Left]:{x:-1,y:0},[U.Right]:{x:1,y:0},[U.Top]:{x:0,y:-1},[U.Bottom]:{x:0,y:1}},Wf=({source:e,sourcePosition:t=U.Bottom,target:n})=>t===U.Left||t===U.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Ai=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Uf({source:e,sourcePosition:t=U.Bottom,target:n,targetPosition:r=U.Top,center:i,offset:s}){const o=Ii[t],a=Ii[r],c={x:e.x+o.x*s,y:e.y+o.y*s},d={x:n.x+a.x*s,y:n.y+a.y*s},u=Wf({source:c,sourcePosition:t,target:d}),l=u.x!==0?"x":"y",f=u[l];let h=[],m,y;const g={x:0,y:0},w={x:0,y:0},[b,p,x,E]=Zs({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(o[l]*a[l]===-1){m=i.x??b,y=i.y??p;const S=[{x:m,y:c.y},{x:m,y:d.y}],_=[{x:c.x,y},{x:d.x,y}];o[l]===f?h=l==="x"?S:_:h=l==="x"?_:S}else{const S=[{x:c.x,y:d.y}],_=[{x:d.x,y:c.y}];if(l==="x"?h=o.x===f?_:S:h=o.y===f?S:_,t===r){const D=Math.abs(e[l]-n[l]);if(D<=s){const v=Math.min(s-1,s-D);o[l]===f?g[l]=(c[l]>e[l]?-1:1)*v:w[l]=(d[l]>n[l]?-1:1)*v}}if(t!==r){const D=l==="x"?"y":"x",v=o[l]===a[D],R=c[D]>d[D],A=c[D]<d[D];(o[l]===1&&(!v&&R||v&&A)||o[l]!==1&&(!v&&A||v&&R))&&(h=l==="x"?S:_)}const N={x:c.x+g.x,y:c.y+g.y},C={x:d.x+w.x,y:d.y+w.y},M=Math.max(Math.abs(N.x-h[0].x),Math.abs(C.x-h[0].x)),I=Math.max(Math.abs(N.y-h[0].y),Math.abs(C.y-h[0].y));M>=I?(m=(N.x+C.x)/2,y=h[0].y):(m=h[0].x,y=(N.y+C.y)/2)}return[[e,{x:c.x+g.x,y:c.y+g.y},...h,{x:d.x+w.x,y:d.y+w.y},n],m,y,x,E]}function Kf(e,t,n,r){const i=Math.min(Ai(e,t)/2,Ai(t,n)/2,r),{x:s,y:o}=t;if(e.x===s&&s===n.x||e.y===o&&o===n.y)return`L${s} ${o}`;if(e.y===o){const d=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${s+i*d},${o}Q ${s},${o} ${s},${o+i*u}`}const a=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${s},${o+i*c}Q ${s},${o} ${s+i*a},${o}`}function Mr({sourceX:e,sourceY:t,sourcePosition:n=U.Bottom,targetX:r,targetY:i,targetPosition:s=U.Top,borderRadius:o=5,centerX:a,centerY:c,offset:d=20}){const[u,l,f,h,m]=Uf({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:i},targetPosition:s,center:{x:a,y:c},offset:d});return[u.reduce((g,w,b)=>{let p="";return b>0&&b<u.length-1?p=Kf(u[b-1],w,u[b+1],o):p=`${b===0?"M":"L"}${w.x} ${w.y}`,g+=p,g},""),l,f,h,m]}function Ti(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function Zf(e){var l;const{sourceNode:t,targetNode:n}=e;if(!Ti(t)||!Ti(n))return null;const r=t.internals.handleBounds||Ri(t.handles),i=n.internals.handleBounds||Ri(n.handles),s=Pi((r==null?void 0:r.source)??[],e.sourceHandle),o=Pi(e.connectionMode===Ue.Strict?(i==null?void 0:i.target)??[]:((i==null?void 0:i.target)??[]).concat((i==null?void 0:i.source)??[]),e.targetHandle);if(!s||!o)return(l=e.onError)==null||l.call(e,"008",xe.error008(s?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=(s==null?void 0:s.position)||U.Bottom,c=(o==null?void 0:o.position)||U.Top,d=yt(t,s,a),u=yt(n,o,c);return{sourceX:d.x,sourceY:d.y,targetX:u.x,targetY:u.y,sourcePosition:a,targetPosition:c}}function Ri(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function yt(e,t,n=U.Left,r=!1){const i=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,s=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:o,height:a}=t??Ne(e);if(r)return{x:i+o/2,y:s+a/2};switch((t==null?void 0:t.position)??n){case U.Top:return{x:i+o/2,y:s};case U.Right:return{x:i+o,y:s+a/2};case U.Bottom:return{x:i+o/2,y:s+a};case U.Left:return{x:i,y:s+a/2}}}function Pi(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function Ir(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`:""}function Qf(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:i}){const s=new Set;return e.reduce((o,a)=>([a.markerStart||r,a.markerEnd||i].forEach(c=>{if(c&&typeof c=="object"){const d=Ir(c,t);s.has(d)||(o.push({id:d,color:c.color||n,...c}),s.add(d))}}),o),[]).sort((o,a)=>o.id.localeCompare(a.id))}const Vr={nodeOrigin:[0,0],nodeExtent:pt,elevateNodesOnSelect:!0,defaults:{}},Jf={...Vr,checkEquality:!0};function qr(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function eh(e,t,n){const r=qr(Vr,n);for(const i of e.values())if(i.parentId)Yr(i,e,t,r);else{const s=bt(i,r.nodeOrigin),o=Qe(i.extent)?i.extent:r.nodeExtent,a=je(s,o,Ne(i));i.internals.positionAbsolute=a}}function Ar(e,t,n,r){var c,d;const i=qr(Jf,r);let s=e.length>0;const o=new Map(t),a=i!=null&&i.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const u of e){let l=o.get(u.id);if(i.checkEquality&&u===(l==null?void 0:l.internals.userNode))t.set(u.id,l);else{const f=bt(u,i.nodeOrigin),h=Qe(u.extent)?u.extent:i.nodeExtent,m=je(f,h,Ne(u));l={...i.defaults,...u,measured:{width:(c=u.measured)==null?void 0:c.width,height:(d=u.measured)==null?void 0:d.height},internals:{positionAbsolute:m,handleBounds:u.measured?l==null?void 0:l.internals.handleBounds:void 0,z:Js(u,a),userNode:u}},t.set(u.id,l)}(l.measured===void 0||l.measured.width===void 0||l.measured.height===void 0)&&!l.hidden&&(s=!1),u.parentId&&Yr(l,t,n,r)}return s}function th(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function Yr(e,t,n,r){const{elevateNodesOnSelect:i,nodeOrigin:s,nodeExtent:o}=qr(Vr,r),a=e.parentId,c=t.get(a);if(!c){console.warn(`Parent node ${a} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}th(e,n);const d=i?1e3:0,{x:u,y:l,z:f}=nh(e,c,s,o,d),{positionAbsolute:h}=e.internals,m=u!==h.x||l!==h.y;(m||f!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:m?{x:u,y:l}:h,z:f}})}function Js(e,t){return(he(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function nh(e,t,n,r,i){const{x:s,y:o}=t.internals.positionAbsolute,a=Ne(e),c=bt(e,n),d=Qe(e.extent)?je(c,e.extent,a):c;let u=je({x:s+d.x,y:o+d.y},r,a);e.extent==="parent"&&(u=Fs(u,a,t));const l=Js(e,i),f=t.internals.z??0;return{x:u.x,y:u.y,z:f>l?f:l}}function Gr(e,t,n,r=[0,0]){var o;const i=[],s=new Map;for(const a of e){const c=t.get(a.parentId);if(!c)continue;const d=((o=s.get(a.parentId))==null?void 0:o.expandedRect)??Ze(c),u=Vs(d,a.rect);s.set(a.parentId,{expandedRect:u,parent:c})}return s.size>0&&s.forEach(({expandedRect:a,parent:c},d)=>{var p;const u=c.internals.positionAbsolute,l=Ne(c),f=c.origin??r,h=a.x<u.x?Math.round(Math.abs(u.x-a.x)):0,m=a.y<u.y?Math.round(Math.abs(u.y-a.y)):0,y=Math.max(l.width,Math.round(a.width)),g=Math.max(l.height,Math.round(a.height)),w=(y-l.width)*f[0],b=(g-l.height)*f[1];(h>0||m>0||w||b)&&(i.push({id:d,type:"position",position:{x:c.position.x-h+w,y:c.position.y-m+b}}),(p=n.get(d))==null||p.forEach(x=>{e.some(E=>E.id===x.id)||i.push({id:x.id,type:"position",position:{x:x.position.x+h,y:x.position.y+m}})})),(l.width<a.width||l.height<a.height||h||m)&&i.push({id:d,type:"dimensions",setAttributes:!0,dimensions:{width:y+(h?f[0]*h-w:0),height:g+(m?f[1]*m-b:0)}})}),i}function rh(e,t,n,r,i,s){const o=r==null?void 0:r.querySelector(".xyflow__viewport");let a=!1;if(!o)return{changes:[],updatedInternals:a};const c=[],d=window.getComputedStyle(o),{m22:u}=new window.DOMMatrixReadOnly(d.transform),l=[];for(const f of e.values()){const h=t.get(f.id);if(!h)continue;if(h.hidden){t.set(h.id,{...h,internals:{...h.internals,handleBounds:void 0}}),a=!0;continue}const m=Br(f.nodeElement),y=h.measured.width!==m.width||h.measured.height!==m.height;if(!!(m.width&&m.height&&(y||!h.internals.handleBounds||f.force))){const w=f.nodeElement.getBoundingClientRect(),b=Qe(h.extent)?h.extent:s;let{positionAbsolute:p}=h.internals;h.parentId&&h.extent==="parent"?p=Fs(p,m,t.get(h.parentId)):b&&(p=je(p,b,m));const x={...h,measured:m,internals:{...h.internals,positionAbsolute:p,handleBounds:{source:Ci("source",f.nodeElement,w,u,h.id),target:Ci("target",f.nodeElement,w,u,h.id)}}};t.set(h.id,x),h.parentId&&Yr(x,t,n,{nodeOrigin:i}),a=!0,y&&(c.push({id:h.id,type:"dimensions",dimensions:m}),h.expandParent&&h.parentId&&l.push({id:h.id,parentId:h.parentId,rect:Ze(x,i)}))}}if(l.length>0){const f=Gr(l,t,n,i);c.push(...f)}return{changes:c,updatedInternals:a}}async function ih({delta:e,panZoom:t,transform:n,translateExtent:r,width:i,height:s}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const o=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[i,s]],r),a=!!o&&(o.x!==n[0]||o.y!==n[1]||o.k!==n[2]);return Promise.resolve(a)}function $i(e,t,n,r,i,s){let o=i;const a=r.get(o)||new Map;r.set(o,a.set(n,t)),o=`${i}-${e}`;const c=r.get(o)||new Map;if(r.set(o,c.set(n,t)),s){o=`${i}-${e}-${s}`;const d=r.get(o)||new Map;r.set(o,d.set(n,t))}}function ea(e,t,n){e.clear(),t.clear();for(const r of n){const{source:i,target:s,sourceHandle:o=null,targetHandle:a=null}=r,c={edgeId:r.id,source:i,target:s,sourceHandle:o,targetHandle:a},d=`${i}-${o}--${s}-${a}`,u=`${s}-${a}--${i}-${o}`;$i("source",c,u,e,i,o),$i("target",c,d,e,s,a),t.set(r.id,r)}}function ta(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:ta(n,t):!1}function Oi(e,t,n){var i;let r=e;do{if((i=r==null?void 0:r.matches)!=null&&i.call(r,t))return!0;if(r===n)return!1;r=r==null?void 0:r.parentElement}while(r);return!1}function oh(e,t,n,r){const i=new Map;for(const[s,o]of e)if((o.selected||o.id===r)&&(!o.parentId||!ta(o,e))&&(o.draggable||t&&typeof o.draggable>"u")){const a=e.get(s);a&&i.set(s,{id:s,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return i}function bn({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){var o,a,c;const i=[];for(const[d,u]of t){const l=(o=n.get(d))==null?void 0:o.internals.userNode;l&&i.push({...l,position:u.position,dragging:r})}if(!e)return[i[0],i];const s=(a=n.get(e))==null?void 0:a.internals.userNode;return[s?{...s,position:((c=t.get(e))==null?void 0:c.position)||s.position,dragging:r}:i[0],i]}function sh({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:i}){let s={x:null,y:null},o=0,a=new Map,c=!1,d={x:0,y:0},u=null,l=!1,f=null,h=!1;function m({noDragClassName:g,handleSelector:w,domNode:b,isSelectable:p,nodeId:x,nodeClickDistance:E=0}){f=ue(b);function k({x:C,y:M},I){const{nodeLookup:D,nodeExtent:v,snapGrid:R,snapToGrid:A,nodeOrigin:$,onNodeDrag:z,onSelectionDrag:L,onError:V,updateNodePositions:B}=t();s={x:C,y:M};let Y=!1,T={x:0,y:0,x2:0,y2:0};if(a.size>1&&v){const O=_t(a);T=Cr(O)}for(const[O,j]of a){if(!D.has(O))continue;let F={x:C-j.distance.x,y:M-j.distance.y};A&&(F=on(F,R));let q=[[v[0][0],v[0][1]],[v[1][0],v[1][1]]];if(a.size>1&&v&&!j.extent){const{positionAbsolute:Z}=j.internals,K=Z.x-T.x+v[0][0],X=Z.x+j.measured.width-T.x2+v[1][0],Q=Z.y-T.y+v[0][1],J=Z.y+j.measured.height-T.y2+v[1][1];q=[[K,Q],[X,J]]}const{position:G,positionAbsolute:W}=Hs({nodeId:O,nextPosition:F,nodeLookup:D,nodeExtent:q,nodeOrigin:$,onError:V});Y=Y||j.position.x!==G.x||j.position.y!==G.y,j.position=G,j.internals.positionAbsolute=W}if(Y&&(B(a,!0),I&&(r||z||!x&&L))){const[O,j]=bn({nodeId:x,dragItems:a,nodeLookup:D});r==null||r(I,a,O,j),z==null||z(I,O,j),x||L==null||L(I,j)}}async function S(){if(!u)return;const{transform:C,panBy:M,autoPanSpeed:I,autoPanOnNodeDrag:D}=t();if(!D){c=!1,cancelAnimationFrame(o);return}const[v,R]=Bs(d,u,I);(v!==0||R!==0)&&(s.x=(s.x??0)-v/C[2],s.y=(s.y??0)-R/C[2],await M({x:v,y:R})&&k(s,null)),o=requestAnimationFrame(S)}function _(C){var Y;const{nodeLookup:M,multiSelectionActive:I,nodesDraggable:D,transform:v,snapGrid:R,snapToGrid:A,selectNodesOnDrag:$,onNodeDragStart:z,onSelectionDragStart:L,unselectNodesAndEdges:V}=t();l=!0,(!$||!p)&&!I&&x&&((Y=M.get(x))!=null&&Y.selected||V()),p&&$&&x&&(e==null||e(x));const B=at(C.sourceEvent,{transform:v,snapGrid:R,snapToGrid:A,containerBounds:u});if(s=B,a=oh(M,D,B,x),a.size>0&&(n||z||!x&&L)){const[T,O]=bn({nodeId:x,dragItems:a,nodeLookup:M});n==null||n(C.sourceEvent,a,T,O),z==null||z(C.sourceEvent,T,O),x||L==null||L(C.sourceEvent,O)}}const N=ws().clickDistance(E).on("start",C=>{const{domNode:M,nodeDragThreshold:I,transform:D,snapGrid:v,snapToGrid:R}=t();u=(M==null?void 0:M.getBoundingClientRect())||null,h=!1,I===0&&_(C),s=at(C.sourceEvent,{transform:D,snapGrid:v,snapToGrid:R,containerBounds:u}),d=_e(C.sourceEvent,u)}).on("drag",C=>{const{autoPanOnNodeDrag:M,transform:I,snapGrid:D,snapToGrid:v,nodeDragThreshold:R,nodeLookup:A}=t(),$=at(C.sourceEvent,{transform:I,snapGrid:D,snapToGrid:v,containerBounds:u});if((C.sourceEvent.type==="touchmove"&&C.sourceEvent.touches.length>1||x&&!A.has(x))&&(h=!0),!h){if(!c&&M&&l&&(c=!0,S()),!l){const z=$.xSnapped-(s.x??0),L=$.ySnapped-(s.y??0);Math.sqrt(z*z+L*L)>R&&_(C)}(s.x!==$.xSnapped||s.y!==$.ySnapped)&&a&&l&&(d=_e(C.sourceEvent,u),k($,C.sourceEvent))}}).on("end",C=>{if(!(!l||h)&&(c=!1,l=!1,cancelAnimationFrame(o),a.size>0)){const{nodeLookup:M,updateNodePositions:I,onNodeDragStop:D,onSelectionDragStop:v}=t();if(I(a,!1),i||D||!x&&v){const[R,A]=bn({nodeId:x,dragItems:a,nodeLookup:M,dragging:!1});i==null||i(C.sourceEvent,a,R,A),D==null||D(C.sourceEvent,R,A),x||v==null||v(C.sourceEvent,A)}}}).filter(C=>{const M=C.target;return!C.button&&(!g||!Oi(M,`.${g}`,b))&&(!w||Oi(M,w,b))});f.call(N)}function y(){f==null||f.on(".drag",null)}return{update:m,destroy:y}}function ah(e,t,n){const r=[],i={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const s of t.values())mt(i,Ze(s))>0&&r.push(s);return r}const ch=250;function uh(e,t,n,r){var a,c;let i=[],s=1/0;const o=ah(e,n,t+ch);for(const d of o){const u=[...((a=d.internals.handleBounds)==null?void 0:a.source)??[],...((c=d.internals.handleBounds)==null?void 0:c.target)??[]];for(const l of u){if(r.nodeId===l.nodeId&&r.type===l.type&&r.id===l.id)continue;const{x:f,y:h}=yt(d,l,l.position,!0),m=Math.sqrt(Math.pow(f-e.x,2)+Math.pow(h-e.y,2));m>t||(m<s?(i=[{...l,x:f,y:h}],s=m):m===s&&i.push({...l,x:f,y:h}))}}if(!i.length)return null;if(i.length>1){const d=r.type==="source"?"target":"source";return i.find(u=>u.type===d)??i[0]}return i[0]}function na(e,t,n,r,i,s=!1){var d,u,l;const o=r.get(e);if(!o)return null;const a=i==="strict"?(d=o.internals.handleBounds)==null?void 0:d[t]:[...((u=o.internals.handleBounds)==null?void 0:u.source)??[],...((l=o.internals.handleBounds)==null?void 0:l.target)??[]],c=(n?a==null?void 0:a.find(f=>f.id===n):a==null?void 0:a[0])??null;return c&&s?{...c,...yt(o,c,c.position,!0)}:c}function ra(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function lh(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const ia=()=>!0;function dh(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:i,edgeUpdaterType:s,isTarget:o,domNode:a,nodeLookup:c,lib:d,autoPanOnConnect:u,flowId:l,panBy:f,cancelConnection:h,onConnectStart:m,onConnect:y,onConnectEnd:g,isValidConnection:w=ia,onReconnectEnd:b,updateConnection:p,getTransform:x,getFromHandle:E,autoPanSpeed:k}){const S=Gs(e.target);let _=0,N;const{x:C,y:M}=_e(e),I=S==null?void 0:S.elementFromPoint(C,M),D=ra(s,I),v=a==null?void 0:a.getBoundingClientRect();if(!v||!D)return;const R=na(i,D,r,c,t);if(!R)return;let A=_e(e,v),$=!1,z=null,L=!1,V=null;function B(){if(!u||!v)return;const[W,Z]=Bs(A,v,k);f({x:W,y:Z}),_=requestAnimationFrame(B)}const Y={...R,nodeId:i,type:D,position:R.position},T=c.get(i),j={inProgress:!0,isValid:null,from:yt(T,Y,U.Left,!0),fromHandle:Y,fromPosition:Y.position,fromNode:T,to:A,toHandle:null,toPosition:Ei[Y.position],toNode:null};p(j);let F=j;m==null||m(e,{nodeId:i,handleId:r,handleType:D});function q(W){if(!E()||!Y){G(W);return}const Z=x();A=_e(W,v),N=uh(Et(A,Z,!1,[1,1]),n,c,Y),$||(B(),$=!0);const K=oa(W,{handle:N,connectionMode:t,fromNodeId:i,fromHandleId:r,fromType:o?"target":"source",isValidConnection:w,doc:S,lib:d,flowId:l,nodeLookup:c});V=K.handleDomNode,z=K.connection,L=lh(!!N,K.isValid);const X={...F,isValid:L,to:N&&L?Xt({x:N.x,y:N.y},Z):A,toHandle:K.toHandle,toPosition:L&&K.toHandle?K.toHandle.position:Ei[Y.position],toNode:K.toHandle?c.get(K.toHandle.nodeId):null};L&&N&&F.toHandle&&X.toHandle&&F.toHandle.type===X.toHandle.type&&F.toHandle.nodeId===X.toHandle.nodeId&&F.toHandle.id===X.toHandle.id&&F.to.x===X.to.x&&F.to.y===X.to.y||(p(X),F=X)}function G(W){(N||V)&&z&&L&&(y==null||y(z));const{inProgress:Z,...K}=F,X={...K,toPosition:F.toHandle?F.toPosition:null};g==null||g(W,X),s&&(b==null||b(W,X)),h(),cancelAnimationFrame(_),$=!1,L=!1,z=null,V=null,S.removeEventListener("mousemove",q),S.removeEventListener("mouseup",G),S.removeEventListener("touchmove",q),S.removeEventListener("touchend",G)}S.addEventListener("mousemove",q),S.addEventListener("mouseup",G),S.addEventListener("touchmove",q),S.addEventListener("touchend",G)}function oa(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:i,fromType:s,doc:o,lib:a,flowId:c,isValidConnection:d=ia,nodeLookup:u}){const l=s==="target",f=t?o.querySelector(`.${a}-flow__handle[data-id="${c}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:h,y:m}=_e(e),y=o.elementFromPoint(h,m),g=y!=null&&y.classList.contains(`${a}-flow__handle`)?y:f,w={handleDomNode:g,isValid:!1,connection:null,toHandle:null};if(g){const b=ra(void 0,g),p=g.getAttribute("data-nodeid"),x=g.getAttribute("data-handleid"),E=g.classList.contains("connectable"),k=g.classList.contains("connectableend");if(!p||!b)return w;const S={source:l?p:r,sourceHandle:l?x:i,target:l?r:p,targetHandle:l?i:x};w.connection=S;const N=E&&k&&(n===Ue.Strict?l&&b==="source"||!l&&b==="target":p!==r||x!==i);w.isValid=N&&d(S),w.toHandle=na(p,b,x,u,n,!1)}return w}const Tr={onPointerDown:dh,isValid:oa};function fh({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const i=ue(e);function s({translateExtent:a,width:c,height:d,zoomStep:u=10,pannable:l=!0,zoomable:f=!0,inversePan:h=!1}){const m=p=>{const x=n();if(p.sourceEvent.type!=="wheel"||!t)return;const E=-p.sourceEvent.deltaY*(p.sourceEvent.deltaMode===1?.05:p.sourceEvent.deltaMode?1:.002)*u,k=x[2]*Math.pow(2,E);t.scaleTo(k)};let y=[0,0];const g=p=>{(p.sourceEvent.type==="mousedown"||p.sourceEvent.type==="touchstart")&&(y=[p.sourceEvent.clientX??p.sourceEvent.touches[0].clientX,p.sourceEvent.clientY??p.sourceEvent.touches[0].clientY])},w=p=>{const x=n();if(p.sourceEvent.type!=="mousemove"&&p.sourceEvent.type!=="touchmove"||!t)return;const E=[p.sourceEvent.clientX??p.sourceEvent.touches[0].clientX,p.sourceEvent.clientY??p.sourceEvent.touches[0].clientY],k=[E[0]-y[0],E[1]-y[1]];y=E;const S=r()*Math.max(x[2],Math.log(x[2]))*(h?-1:1),_={x:x[0]-k[0]*S,y:x[1]-k[1]*S},N=[[0,0],[c,d]];t.setViewportConstrained({x:_.x,y:_.y,zoom:x[2]},N,a)},b=$s().on("start",g).on("zoom",l?w:null).on("zoom.wheel",f?m:null);i.call(b,{})}function o(){i.on("zoom",null)}return{update:s,destroy:o,pointer:de}}const hh=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,sn=e=>({x:e.x,y:e.y,zoom:e.k}),_n=({x:e,y:t,zoom:n})=>tn.translate(e,t).scale(n),Be=(e,t)=>e.target.closest(`.${t}`),sa=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),En=(e,t=0,n=()=>{})=>{const r=typeof t=="number"&&t>0;return r||n(),r?e.transition().duration(t).on("end",n):e},aa=e=>{const t=e.ctrlKey&&Wt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function ph({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:i,panOnScrollSpeed:s,zoomOnPinch:o,onPanZoomStart:a,onPanZoom:c,onPanZoomEnd:d}){return u=>{if(Be(u,t))return!1;u.preventDefault(),u.stopImmediatePropagation();const l=n.property("__zoom").k||1;if(u.ctrlKey&&o){const g=de(u),w=aa(u),b=l*Math.pow(2,w);r.scaleTo(n,b,g,u);return}const f=u.deltaMode===1?20:1;let h=i===$e.Vertical?0:u.deltaX*f,m=i===$e.Horizontal?0:u.deltaY*f;!Wt()&&u.shiftKey&&i!==$e.Vertical&&(h=u.deltaY*f,m=0),r.translateBy(n,-(h/l)*s,-(m/l)*s,{internal:!0});const y=sn(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,a==null||a(u,y)),e.isPanScrolling&&(c==null||c(u,y),e.panScrollTimeout=setTimeout(()=>{d==null||d(u,y),e.isPanScrolling=!1},150))}}function gh({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,i){const s=r.type==="wheel",o=!t&&s&&!r.ctrlKey,a=Be(r,e);if(r.ctrlKey&&s&&a&&r.preventDefault(),o||a)return null;r.preventDefault(),n.call(this,r,i)}}function mh({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var s,o,a;if((s=r.sourceEvent)!=null&&s.internal)return;const i=sn(r.transform);e.mouseButton=((o=r.sourceEvent)==null?void 0:o.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=i,((a=r.sourceEvent)==null?void 0:a.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,i))}}function yh({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:i}){return s=>{var o,a;e.usedRightMouseButton=!!(n&&sa(t,e.mouseButton??0)),(o=s.sourceEvent)!=null&&o.sync||r([s.transform.x,s.transform.y,s.transform.k]),i&&!((a=s.sourceEvent)!=null&&a.internal)&&(i==null||i(s.sourceEvent,sn(s.transform)))}}function xh({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:i,onPaneContextMenu:s}){return o=>{var a;if(!((a=o.sourceEvent)!=null&&a.internal)&&(e.isZoomingOrPanning=!1,s&&sa(t,e.mouseButton??0)&&!e.usedRightMouseButton&&o.sourceEvent&&s(o.sourceEvent),e.usedRightMouseButton=!1,r(!1),i&&hh(e.prevViewport,o.transform))){const c=sn(o.transform);e.prevViewport=c,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{i==null||i(o.sourceEvent,c)},n?150:0)}}}function wh({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:i,zoomOnDoubleClick:s,userSelectionActive:o,noWheelClassName:a,noPanClassName:c,lib:d}){return u=>{var m;const l=e||t,f=n&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(Be(u,`${d}-flow__node`)||Be(u,`${d}-flow__edge`)))return!0;if(!r&&!l&&!i&&!s&&!n||o||Be(u,a)&&u.type==="wheel"||Be(u,c)&&(u.type!=="wheel"||i&&u.type==="wheel"&&!e)||!n&&u.ctrlKey&&u.type==="wheel")return!1;if(!n&&u.type==="touchstart"&&((m=u.touches)==null?void 0:m.length)>1)return u.preventDefault(),!1;if(!l&&!i&&!f&&u.type==="wheel"||!r&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(r)&&!r.includes(u.button)&&u.type==="mousedown")return!1;const h=Array.isArray(r)&&r.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&h}}function vh({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:r,translateExtent:i,viewport:s,onPanZoom:o,onPanZoomStart:a,onPanZoomEnd:c,onDraggingChange:d}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},l=e.getBoundingClientRect(),f=$s().clickDistance(!he(r)||r<0?0:r).scaleExtent([t,n]).translateExtent(i),h=ue(e).call(f);p({x:s.x,y:s.y,zoom:Ke(s.zoom,t,n)},[[0,0],[l.width,l.height]],i);const m=h.on("wheel.zoom"),y=h.on("dblclick.zoom");f.wheelDelta(aa);function g(I,D){return h?new Promise(v=>{f==null||f.transform(En(h,D==null?void 0:D.duration,()=>v(!0)),I)}):Promise.resolve(!1)}function w({noWheelClassName:I,noPanClassName:D,onPaneContextMenu:v,userSelectionActive:R,panOnScroll:A,panOnDrag:$,panOnScrollMode:z,panOnScrollSpeed:L,preventScrolling:V,zoomOnPinch:B,zoomOnScroll:Y,zoomOnDoubleClick:T,zoomActivationKeyPressed:O,lib:j,onTransformChange:F}){R&&!u.isZoomingOrPanning&&b();const G=A&&!O&&!R?ph({zoomPanValues:u,noWheelClassName:I,d3Selection:h,d3Zoom:f,panOnScrollMode:z,panOnScrollSpeed:L,zoomOnPinch:B,onPanZoomStart:a,onPanZoom:o,onPanZoomEnd:c}):gh({noWheelClassName:I,preventScrolling:V,d3ZoomHandler:m});if(h.on("wheel.zoom",G,{passive:!1}),!R){const Z=mh({zoomPanValues:u,onDraggingChange:d,onPanZoomStart:a});f.on("start",Z);const K=yh({zoomPanValues:u,panOnDrag:$,onPaneContextMenu:!!v,onPanZoom:o,onTransformChange:F});f.on("zoom",K);const X=xh({zoomPanValues:u,panOnDrag:$,panOnScroll:A,onPaneContextMenu:v,onPanZoomEnd:c,onDraggingChange:d});f.on("end",X)}const W=wh({zoomActivationKeyPressed:O,panOnDrag:$,zoomOnScroll:Y,panOnScroll:A,zoomOnDoubleClick:T,zoomOnPinch:B,userSelectionActive:R,noPanClassName:D,noWheelClassName:I,lib:j});f.filter(W),T?h.on("dblclick.zoom",y):h.on("dblclick.zoom",null)}function b(){f.on("zoom",null)}async function p(I,D,v){const R=_n(I),A=f==null?void 0:f.constrain()(R,D,v);return A&&await g(A),new Promise($=>$(A))}async function x(I,D){const v=_n(I);return await g(v,D),new Promise(R=>R(v))}function E(I){if(h){const D=_n(I),v=h.property("__zoom");(v.k!==I.zoom||v.x!==I.x||v.y!==I.y)&&(f==null||f.transform(h,D,null,{sync:!0}))}}function k(){const I=h?Ps(h.node()):{x:0,y:0,k:1};return{x:I.x,y:I.y,zoom:I.k}}function S(I,D){return h?new Promise(v=>{f==null||f.scaleTo(En(h,D==null?void 0:D.duration,()=>v(!0)),I)}):Promise.resolve(!1)}function _(I,D){return h?new Promise(v=>{f==null||f.scaleBy(En(h,D==null?void 0:D.duration,()=>v(!0)),I)}):Promise.resolve(!1)}function N(I){f==null||f.scaleExtent(I)}function C(I){f==null||f.translateExtent(I)}function M(I){const D=!he(I)||I<0?0:I;f==null||f.clickDistance(D)}return{update:w,destroy:b,setViewport:x,setViewportConstrained:p,getViewport:k,scaleTo:S,scaleBy:_,setScaleExtent:N,setTranslateExtent:C,syncViewport:E,setClickDistance:M}}var ct;(function(e){e.Line="line",e.Handle="handle"})(ct||(ct={}));function bh({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:i,affectsY:s}){const o=e-t,a=n-r,c=[o>0?1:o<0?-1:0,a>0?1:a<0?-1:0];return o&&i&&(c[0]=c[0]*-1),a&&s&&(c[1]=c[1]*-1),c}function _h(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),i=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:i}}function ke(e,t){return Math.max(0,t-e)}function Se(e,t){return Math.max(0,e-t)}function Rt(e,t,n){return Math.max(0,t-e,e-n)}function Li(e,t){return e?!t:t}function Eh(e,t,n,r,i,s,o,a){let{affectsX:c,affectsY:d}=t;const{isHorizontal:u,isVertical:l}=t,f=u&&l,{xSnapped:h,ySnapped:m}=n,{minWidth:y,maxWidth:g,minHeight:w,maxHeight:b}=r,{x:p,y:x,width:E,height:k,aspectRatio:S}=e;let _=Math.floor(u?h-e.pointerX:0),N=Math.floor(l?m-e.pointerY:0);const C=E+(c?-_:_),M=k+(d?-N:N),I=-s[0]*E,D=-s[1]*k;let v=Rt(C,y,g),R=Rt(M,w,b);if(o){let z=0,L=0;c&&_<0?z=ke(p+_+I,o[0][0]):!c&&_>0&&(z=Se(p+C+I,o[1][0])),d&&N<0?L=ke(x+N+D,o[0][1]):!d&&N>0&&(L=Se(x+M+D,o[1][1])),v=Math.max(v,z),R=Math.max(R,L)}if(a){let z=0,L=0;c&&_>0?z=Se(p+_,a[0][0]):!c&&_<0&&(z=ke(p+C,a[1][0])),d&&N>0?L=Se(x+N,a[0][1]):!d&&N<0&&(L=ke(x+M,a[1][1])),v=Math.max(v,z),R=Math.max(R,L)}if(i){if(u){const z=Rt(C/S,w,b)*S;if(v=Math.max(v,z),o){let L=0;!c&&!d||c&&!d&&f?L=Se(x+D+C/S,o[1][1])*S:L=ke(x+D+(c?_:-_)/S,o[0][1])*S,v=Math.max(v,L)}if(a){let L=0;!c&&!d||c&&!d&&f?L=ke(x+C/S,a[1][1])*S:L=Se(x+(c?_:-_)/S,a[0][1])*S,v=Math.max(v,L)}}if(l){const z=Rt(M*S,y,g)/S;if(R=Math.max(R,z),o){let L=0;!c&&!d||d&&!c&&f?L=Se(p+M*S+I,o[1][0])/S:L=ke(p+(d?N:-N)*S+I,o[0][0])/S,R=Math.max(R,L)}if(a){let L=0;!c&&!d||d&&!c&&f?L=ke(p+M*S,a[1][0])/S:L=Se(p+(d?N:-N)*S,a[0][0])/S,R=Math.max(R,L)}}}N=N+(N<0?R:-R),_=_+(_<0?v:-v),i&&(f?C>M*S?N=(Li(c,d)?-_:_)/S:_=(Li(c,d)?-N:N)*S:u?(N=_/S,d=c):(_=N*S,c=d));const A=c?p+_:p,$=d?x+N:x;return{width:E+(c?-_:_),height:k+(d?-N:N),x:s[0]*_*(c?-1:1)+A,y:s[1]*N*(d?-1:1)+$}}const ca={width:0,height:0,x:0,y:0},Nh={...ca,pointerX:0,pointerY:0,aspectRatio:1};function kh(e){return[[0,0],[e.measured.width,e.measured.height]]}function Sh(e,t,n){const r=t.position.x+e.position.x,i=t.position.y+e.position.y,s=e.measured.width??0,o=e.measured.height??0,a=n[0]*s,c=n[1]*o;return[[r-a,i-c],[r+s-a,i+o-c]]}function Ch({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:i}){const s=ue(e);function o({controlPosition:c,boundaries:d,keepAspectRatio:u,resizeDirection:l,onResizeStart:f,onResize:h,onResizeEnd:m,shouldResize:y}){let g={...ca},w={...Nh};const b=_h(c);let p,x=null,E=[],k,S,_;const N=ws().on("start",C=>{const{nodeLookup:M,transform:I,snapGrid:D,snapToGrid:v,nodeOrigin:R,paneDomNode:A}=n();if(p=M.get(t),!p)return;x=(A==null?void 0:A.getBoundingClientRect())??null;const{xSnapped:$,ySnapped:z}=at(C.sourceEvent,{transform:I,snapGrid:D,snapToGrid:v,containerBounds:x});g={width:p.measured.width??0,height:p.measured.height??0,x:p.position.x??0,y:p.position.y??0},w={...g,pointerX:$,pointerY:z,aspectRatio:g.width/g.height},k=void 0,p.parentId&&(p.extent==="parent"||p.expandParent)&&(k=M.get(p.parentId),S=k&&p.extent==="parent"?kh(k):void 0),E=[],_=void 0;for(const[L,V]of M)if(V.parentId===t&&(E.push({id:L,position:{...V.position},extent:V.extent}),V.extent==="parent"||V.expandParent)){const B=Sh(V,p,V.origin??R);_?_=[[Math.min(B[0][0],_[0][0]),Math.min(B[0][1],_[0][1])],[Math.max(B[1][0],_[1][0]),Math.max(B[1][1],_[1][1])]]:_=B}f==null||f(C,{...g})}).on("drag",C=>{const{transform:M,snapGrid:I,snapToGrid:D,nodeOrigin:v}=n(),R=at(C.sourceEvent,{transform:M,snapGrid:I,snapToGrid:D,containerBounds:x}),A=[];if(!p)return;const{x:$,y:z,width:L,height:V}=g,B={},Y=p.origin??v,{width:T,height:O,x:j,y:F}=Eh(w,b,R,d,u,Y,S,_),q=T!==L,G=O!==V,W=j!==$&&q,Z=F!==z&&G;if(!W&&!Z&&!q&&!G)return;if((W||Z||Y[0]===1||Y[1]===1)&&(B.x=W?j:g.x,B.y=Z?F:g.y,g.x=B.x,g.y=B.y,E.length>0)){const J=j-$,re=F-z;for(const ae of E)ae.position={x:ae.position.x-J+Y[0]*(T-L),y:ae.position.y-re+Y[1]*(O-V)},A.push(ae)}if((q||G)&&(B.width=q&&(!l||l==="horizontal")?T:g.width,B.height=G&&(!l||l==="vertical")?O:g.height,g.width=B.width,g.height=B.height),k&&p.expandParent){const J=Y[0]*(B.width??0);B.x&&B.x<J&&(g.x=J,w.x=w.x-(B.x-J));const re=Y[1]*(B.height??0);B.y&&B.y<re&&(g.y=re,w.y=w.y-(B.y-re))}const K=bh({width:g.width,prevWidth:L,height:g.height,prevHeight:V,affectsX:b.affectsX,affectsY:b.affectsY}),X={...g,direction:K};(y==null?void 0:y(C,X))!==!1&&(h==null||h(C,X),r(B,A))}).on("end",C=>{m==null||m(C,{...g}),i==null||i({...g})});s.call(N)}function a(){s.on(".drag",null)}return{update:o,destroy:a}}const Mh={},ji=e=>{let t;const n=new Set,r=(u,l)=>{const f=typeof u=="function"?u(t):u;if(!Object.is(f,t)){const h=t;t=l??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(m=>m(t,h))}},i=()=>t,c={setState:r,getState:i,getInitialState:()=>d,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(Mh?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},d=t=e(r,i,c);return c},Ih=e=>e?ji(e):ji,{useDebugValue:Ah}=Kc,{useSyncExternalStoreWithSelector:Th}=eu,Rh=e=>e;function ua(e,t=Rh,n){const r=Th(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Ah(r),r}const Di=(e,t)=>{const n=Ih(e),r=(i,s=t)=>ua(n,i,s);return Object.assign(r,n),r},Ph=(e,t)=>e?Di(e,t):Di;function ne(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,i]of e)if(!Object.is(i,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const an=H.createContext(null),$h=an.Provider,la=xe.error001();function ee(e,t){const n=H.useContext(an);if(n===null)throw new Error(la);return ua(n,e,t)}function te(){const e=H.useContext(an);if(e===null)throw new Error(la);return H.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const zi={display:"none"},Oh={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},da="react-flow__node-desc",fa="react-flow__edge-desc",Lh="react-flow__aria-live",jh=e=>e.ariaLiveMessage;function Dh({rfId:e}){const t=ee(jh);return P.jsx("div",{id:`${Lh}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Oh,children:t})}function zh({rfId:e,disableKeyboardA11y:t}){return P.jsxs(P.Fragment,{children:[P.jsxs("div",{id:`${da}-${e}`,style:zi,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),P.jsx("div",{id:`${fa}-${e}`,style:zi,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&P.jsx(Dh,{rfId:e})]})}const Hh=e=>e.userSelectionActive?"none":"all",cn=H.forwardRef(({position:e="top-left",children:t,className:n,style:r,...i},s)=>{const o=ee(Hh),a=`${e}`.split("-");return P.jsx("div",{className:se(["react-flow__panel",n,...a]),style:{...r,pointerEvents:o},ref:s,...i,children:t})});cn.displayName="Panel";function Fh({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:P.jsx(cn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:P.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const Bh=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},Pt=e=>e.id;function Vh(e,t){return ne(e.selectedNodes.map(Pt),t.selectedNodes.map(Pt))&&ne(e.selectedEdges.map(Pt),t.selectedEdges.map(Pt))}function qh({onSelectionChange:e}){const t=te(),{selectedNodes:n,selectedEdges:r}=ee(Bh,Vh);return H.useEffect(()=>{const i={nodes:n,edges:r};e==null||e(i),t.getState().onSelectionChangeHandlers.forEach(s=>s(i))},[n,r,e]),null}const Yh=e=>!!e.onSelectionChangeHandlers;function Gh({onSelectionChange:e}){const t=ee(Yh);return e||t?P.jsx(qh,{onSelectionChange:e}):null}const ha=[0,0],Xh={x:0,y:0,zoom:1},Wh=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance"],Hi=[...Wh,"rfId"],Uh=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),Fi={translateExtent:pt,nodeOrigin:ha,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function Kh(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:i,setTranslateExtent:s,setNodeExtent:o,reset:a,setDefaultNodesAndEdges:c,setPaneClickDistance:d}=ee(Uh,ne),u=te();H.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{l.current=Fi,a()}),[]);const l=H.useRef(Fi);return H.useEffect(()=>{for(const f of Hi){const h=e[f],m=l.current[f];h!==m&&(typeof e[f]>"u"||(f==="nodes"?t(h):f==="edges"?n(h):f==="minZoom"?r(h):f==="maxZoom"?i(h):f==="translateExtent"?s(h):f==="nodeExtent"?o(h):f==="paneClickDistance"?d(h):f==="fitView"?u.setState({fitViewQueued:h}):f==="fitViewOptions"?u.setState({fitViewOptions:h}):u.setState({[f]:h})))}l.current=e},Hi.map(f=>e[f])),null}function Bi(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function Zh(e){var r;const[t,n]=H.useState(e==="system"?null:e);return H.useEffect(()=>{if(e!=="system"){n(e);return}const i=Bi(),s=()=>n(i!=null&&i.matches?"dark":"light");return s(),i==null||i.addEventListener("change",s),()=>{i==null||i.removeEventListener("change",s)}},[e]),t!==null?t:(r=Bi())!=null&&r.matches?"dark":"light"}const Vi=typeof document<"u"?document:null;function xt(e=null,t={target:Vi,actInsideInputWithModifier:!0}){const[n,r]=H.useState(!1),i=H.useRef(!1),s=H.useRef(new Set([])),[o,a]=H.useMemo(()=>{if(e!==null){const d=(Array.isArray(e)?e:[e]).filter(l=>typeof l=="string").map(l=>l.replace("+",`
`).replace(`

`,`
+`).split(`
`)),u=d.reduce((l,f)=>l.concat(...f),[]);return[d,u]}return[[],[]]},[e]);return H.useEffect(()=>{const c=(t==null?void 0:t.target)||Vi;if(e!==null){const d=f=>{var y,g;if(i.current=f.ctrlKey||f.metaKey||f.shiftKey||f.altKey,(!i.current||i.current&&!t.actInsideInputWithModifier)&&Xs(f))return!1;const m=Yi(f.code,a);if(s.current.add(f[m]),qi(o,s.current,!1)){const w=((g=(y=f.composedPath)==null?void 0:y.call(f))==null?void 0:g[0])||f.target,b=(w==null?void 0:w.nodeName)==="BUTTON"||(w==null?void 0:w.nodeName)==="A";t.preventDefault!==!1&&(i.current||!b)&&f.preventDefault(),r(!0)}},u=f=>{const h=Yi(f.code,a);qi(o,s.current,!0)?(r(!1),s.current.clear()):s.current.delete(f[h]),f.key==="Meta"&&s.current.clear(),i.current=!1},l=()=>{s.current.clear(),r(!1)};return c==null||c.addEventListener("keydown",d),c==null||c.addEventListener("keyup",u),window.addEventListener("blur",l),window.addEventListener("contextmenu",l),()=>{c==null||c.removeEventListener("keydown",d),c==null||c.removeEventListener("keyup",u),window.removeEventListener("blur",l),window.removeEventListener("contextmenu",l)}}},[e,r]),n}function qi(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(i=>t.has(i)))}function Yi(e,t){return t.includes(e)?"code":"key"}const Qh=()=>{const e=te();return H.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,i,s],panZoom:o}=e.getState();return o?(await o.setViewport({x:t.x??r,y:t.y??i,zoom:t.zoom??s},{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},setCenter:async(t,n,r)=>{const{width:i,height:s,maxZoom:o,panZoom:a}=e.getState(),c=typeof(r==null?void 0:r.zoom)<"u"?r.zoom:o,d=i/2-t*c,u=s/2-n*c;return a?(await a.setViewport({x:d,y:u,zoom:c},{duration:r==null?void 0:r.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitBounds:async(t,n)=>{const{width:r,height:i,minZoom:s,maxZoom:o,panZoom:a}=e.getState(),c=Fr(t,r,i,s,o,(n==null?void 0:n.padding)??.1);return a?(await a.setViewport(c,{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:r,snapGrid:i,snapToGrid:s,domNode:o}=e.getState();if(!o)return t;const{x:a,y:c}=o.getBoundingClientRect(),d={x:t.x-a,y:t.y-c},u=n.snapGrid??i,l=n.snapToGrid??s;return Et(d,r,l,u)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:i,y:s}=r.getBoundingClientRect(),o=Xt(t,n);return{x:o.x+i,y:o.y+s}}}),[])};function pa(e,t){const n=[],r=new Map,i=[];for(const s of e)if(s.type==="add"){i.push(s);continue}else if(s.type==="remove"||s.type==="replace")r.set(s.id,[s]);else{const o=r.get(s.id);o?o.push(s):r.set(s.id,[s])}for(const s of t){const o=r.get(s.id);if(!o){n.push(s);continue}if(o[0].type==="remove")continue;if(o[0].type==="replace"){n.push({...o[0].item});continue}const a={...s};for(const c of o)Jh(c,a);n.push(a)}return i.length&&i.forEach(s=>{s.index!==void 0?n.splice(s.index,0,{...s.item}):n.push({...s.item})}),n}function Jh(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function ep(e,t){return pa(e,t)}function tp(e,t){return pa(e,t)}function Te(e,t){return{id:e,type:"select",selected:t}}function Ve(e,t=new Set,n=!1){const r=[];for(const[i,s]of e){const o=t.has(i);!(s.selected===void 0&&!o)&&s.selected!==o&&(n&&(s.selected=o),r.push(Te(s.id,o)))}return r}function Gi({items:e=[],lookup:t}){var i;const n=[],r=new Map(e.map(s=>[s.id,s]));for(const[s,o]of e.entries()){const a=t.get(o.id),c=((i=a==null?void 0:a.internals)==null?void 0:i.userNode)??a;c!==void 0&&c!==o&&n.push({id:o.id,item:o,type:"replace"}),c===void 0&&n.push({item:o,type:"add",index:s})}for(const[s]of t)r.get(s)===void 0&&n.push({id:s,type:"remove"});return n}function Xi(e){return{id:e.id,type:"remove"}}const Wi=e=>Rf(e),np=e=>Ds(e);function ga(e){return H.forwardRef(e)}const rp=typeof window<"u"?H.useLayoutEffect:H.useEffect;function Ui(e){const[t,n]=H.useState(BigInt(0)),[r]=H.useState(()=>ip(()=>n(i=>i+BigInt(1))));return rp(()=>{const i=r.get();i.length&&(e(i),r.reset())},[t]),r}function ip(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const ma=H.createContext(null);function op({children:e}){const t=te(),n=H.useCallback(a=>{const{nodes:c=[],setNodes:d,hasDefaultNodes:u,onNodesChange:l,nodeLookup:f,fitViewQueued:h}=t.getState();let m=c;for(const y of a)m=typeof y=="function"?y(m):y;if(u)d(m);else{const y=Gi({items:m,lookup:f});y.length>0?l==null||l(y):h&&window.requestAnimationFrame(()=>{const{fitViewQueued:g,nodes:w,setNodes:b}=t.getState();g&&b(w)})}},[]),r=Ui(n),i=H.useCallback(a=>{const{edges:c=[],setEdges:d,hasDefaultEdges:u,onEdgesChange:l,edgeLookup:f}=t.getState();let h=c;for(const m of a)h=typeof m=="function"?m(h):m;u?d(h):l&&l(Gi({items:h,lookup:f}))},[]),s=Ui(i),o=H.useMemo(()=>({nodeQueue:r,edgeQueue:s}),[]);return P.jsx(ma.Provider,{value:o,children:e})}function sp(){const e=H.useContext(ma);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const ap=e=>!!e.panZoom;function Xr(){const e=Qh(),t=te(),n=sp(),r=ee(ap),i=H.useMemo(()=>{const s=l=>t.getState().nodeLookup.get(l),o=l=>{n.nodeQueue.push(l)},a=l=>{n.edgeQueue.push(l)},c=l=>{var w,b;const{nodeLookup:f,nodeOrigin:h}=t.getState(),m=Wi(l)?l:f.get(l.id),y=m.parentId?Ys(m.position,m.measured,m.parentId,f,h):m.position,g={...m,position:y,width:((w=m.measured)==null?void 0:w.width)??m.width,height:((b=m.measured)==null?void 0:b.height)??m.height};return Ze(g)},d=(l,f,h={replace:!1})=>{o(m=>m.map(y=>{if(y.id===l){const g=typeof f=="function"?f(y):f;return h.replace&&Wi(g)?g:{...y,...g}}return y}))},u=(l,f,h={replace:!1})=>{a(m=>m.map(y=>{if(y.id===l){const g=typeof f=="function"?f(y):f;return h.replace&&np(g)?g:{...y,...g}}return y}))};return{getNodes:()=>t.getState().nodes.map(l=>({...l})),getNode:l=>{var f;return(f=s(l))==null?void 0:f.internals.userNode},getInternalNode:s,getEdges:()=>{const{edges:l=[]}=t.getState();return l.map(f=>({...f}))},getEdge:l=>t.getState().edgeLookup.get(l),setNodes:o,setEdges:a,addNodes:l=>{const f=Array.isArray(l)?l:[l];n.nodeQueue.push(h=>[...h,...f])},addEdges:l=>{const f=Array.isArray(l)?l:[l];n.edgeQueue.push(h=>[...h,...f])},toObject:()=>{const{nodes:l=[],edges:f=[],transform:h}=t.getState(),[m,y,g]=h;return{nodes:l.map(w=>({...w})),edges:f.map(w=>({...w})),viewport:{x:m,y,zoom:g}}},deleteElements:async({nodes:l=[],edges:f=[]})=>{const{nodes:h,edges:m,onNodesDelete:y,onEdgesDelete:g,triggerNodeChanges:w,triggerEdgeChanges:b,onDelete:p,onBeforeDelete:x}=t.getState(),{nodes:E,edges:k}=await jf({nodesToRemove:l,edgesToRemove:f,nodes:h,edges:m,onBeforeDelete:x}),S=k.length>0,_=E.length>0;if(S){const N=k.map(Xi);g==null||g(k),b(N)}if(_){const N=E.map(Xi);y==null||y(E),w(N)}return(_||S)&&(p==null||p({nodes:E,edges:k})),{deletedNodes:E,deletedEdges:k}},getIntersectingNodes:(l,f=!0,h)=>{const m=ki(l),y=m?l:c(l),g=h!==void 0;return y?(h||t.getState().nodes).filter(w=>{const b=t.getState().nodeLookup.get(w.id);if(b&&!m&&(w.id===l.id||!b.internals.positionAbsolute))return!1;const p=Ze(g?w:b),x=mt(p,y);return f&&x>0||x>=y.width*y.height}):[]},isNodeIntersecting:(l,f,h=!0)=>{const y=ki(l)?l:c(l);if(!y)return!1;const g=mt(y,f);return h&&g>0||g>=y.width*y.height},updateNode:d,updateNodeData:(l,f,h={replace:!1})=>{d(l,m=>{const y=typeof f=="function"?f(m):f;return h.replace?{...m,data:y}:{...m,data:{...m.data,...y}}},h)},updateEdge:u,updateEdgeData:(l,f,h={replace:!1})=>{u(l,m=>{const y=typeof f=="function"?f(m):f;return h.replace?{...m,data:y}:{...m,data:{...m.data,...y}}},h)},getNodesBounds:l=>{const{nodeLookup:f,nodeOrigin:h}=t.getState();return Pf(l,{nodeLookup:f,nodeOrigin:h})},getHandleConnections:({type:l,id:f,nodeId:h})=>{var m;return Array.from(((m=t.getState().connectionLookup.get(`${h}-${l}${f?`-${f}`:""}`))==null?void 0:m.values())??[])},getNodeConnections:({type:l,handleId:f,nodeId:h})=>{var m;return Array.from(((m=t.getState().connectionLookup.get(`${h}${l?f?`-${l}-${f}`:`-${l}`:""}`))==null?void 0:m.values())??[])},fitView:async l=>{const f=t.getState().fitViewResolver??Ff();return t.setState({fitViewQueued:!0,fitViewOptions:l,fitViewResolver:f}),n.nodeQueue.push(h=>[...h]),f.promise}}},[]);return H.useMemo(()=>({...i,...e,viewportInitialized:r}),[r])}const Ki=e=>e.selected,cp={actInsideInputWithModifier:!1},up=typeof window<"u"?window:void 0;function lp({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=te(),{deleteElements:r}=Xr(),i=xt(e,cp),s=xt(t,{target:up});H.useEffect(()=>{if(i){const{edges:o,nodes:a}=n.getState();r({nodes:a.filter(Ki),edges:o.filter(Ki)}),n.setState({nodesSelectionActive:!1})}},[i]),H.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])}function dp(e){const t=te();H.useEffect(()=>{const n=()=>{var i,s;if(!e.current)return!1;const r=Br(e.current);(r.height===0||r.width===0)&&((s=(i=t.getState()).onError)==null||s.call(i,"004",xe.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const un={position:"absolute",width:"100%",height:"100%",top:0,left:0},fp=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function hp({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:i=.5,panOnScrollMode:s=$e.Free,zoomOnDoubleClick:o=!0,panOnDrag:a=!0,defaultViewport:c,translateExtent:d,minZoom:u,maxZoom:l,zoomActivationKeyCode:f,preventScrolling:h=!0,children:m,noWheelClassName:y,noPanClassName:g,onViewportChange:w,isControlledViewport:b,paneClickDistance:p}){const x=te(),E=H.useRef(null),{userSelectionActive:k,lib:S}=ee(fp,ne),_=xt(f),N=H.useRef();dp(E);const C=H.useCallback(M=>{w==null||w({x:M[0],y:M[1],zoom:M[2]}),b||x.setState({transform:M})},[w,b]);return H.useEffect(()=>{if(E.current){N.current=vh({domNode:E.current,minZoom:u,maxZoom:l,translateExtent:d,viewport:c,paneClickDistance:p,onDraggingChange:v=>x.setState({paneDragging:v}),onPanZoomStart:(v,R)=>{const{onViewportChangeStart:A,onMoveStart:$}=x.getState();$==null||$(v,R),A==null||A(R)},onPanZoom:(v,R)=>{const{onViewportChange:A,onMove:$}=x.getState();$==null||$(v,R),A==null||A(R)},onPanZoomEnd:(v,R)=>{const{onViewportChangeEnd:A,onMoveEnd:$}=x.getState();$==null||$(v,R),A==null||A(R)}});const{x:M,y:I,zoom:D}=N.current.getViewport();return x.setState({panZoom:N.current,transform:[M,I,D],domNode:E.current.closest(".react-flow")}),()=>{var v;(v=N.current)==null||v.destroy()}}},[]),H.useEffect(()=>{var M;(M=N.current)==null||M.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:i,panOnScrollMode:s,zoomOnDoubleClick:o,panOnDrag:a,zoomActivationKeyPressed:_,preventScrolling:h,noPanClassName:g,userSelectionActive:k,noWheelClassName:y,lib:S,onTransformChange:C})},[e,t,n,r,i,s,o,a,_,h,g,k,y,S,C]),P.jsx("div",{className:"react-flow__renderer",ref:E,style:un,children:m})}const pp=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function gp(){const{userSelectionActive:e,userSelectionRect:t}=ee(pp,ne);return e&&t?P.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const Nn=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},mp=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function yp({isSelecting:e,selectionKeyPressed:t,selectionMode:n=gt.Full,panOnDrag:r,selectionOnDrag:i,onSelectionStart:s,onSelectionEnd:o,onPaneClick:a,onPaneContextMenu:c,onPaneScroll:d,onPaneMouseEnter:u,onPaneMouseMove:l,onPaneMouseLeave:f,children:h}){const m=te(),{userSelectionActive:y,elementsSelectable:g,dragging:w,connectionInProgress:b}=ee(mp,ne),p=g&&(e||y),x=H.useRef(null),E=H.useRef(),k=H.useRef(new Set),S=H.useRef(new Set),_=H.useRef(!1),N=H.useRef(!1),C=$=>{if(_.current||b){_.current=!1;return}a==null||a($),m.getState().resetSelectedElements(),m.setState({nodesSelectionActive:!1})},M=$=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){$.preventDefault();return}c==null||c($)},I=d?$=>d($):void 0,D=$=>{var Y,T;const{resetSelectedElements:z,domNode:L}=m.getState();if(E.current=L==null?void 0:L.getBoundingClientRect(),!g||!e||$.button!==0||$.target!==x.current||!E.current)return;(T=(Y=$.target)==null?void 0:Y.setPointerCapture)==null||T.call(Y,$.pointerId),N.current=!0,_.current=!1;const{x:V,y:B}=_e($.nativeEvent,E.current);z(),m.setState({userSelectionRect:{width:0,height:0,startX:V,startY:B,x:V,y:B}}),s==null||s($)},v=$=>{const{userSelectionRect:z,transform:L,nodeLookup:V,edgeLookup:B,connectionLookup:Y,triggerNodeChanges:T,triggerEdgeChanges:O,defaultEdgeOptions:j}=m.getState();if(!E.current||!z)return;_.current=!0;const{x:F,y:q}=_e($.nativeEvent,E.current),{startX:G,startY:W}=z,Z={startX:G,startY:W,x:F<G?F:G,y:q<W?q:W,width:Math.abs(F-G),height:Math.abs(q-W)},K=k.current,X=S.current;k.current=new Set(zs(V,Z,L,n===gt.Partial,!0).map(J=>J.id)),S.current=new Set;const Q=(j==null?void 0:j.selectable)??!0;for(const J of k.current){const re=Y.get(J);if(re)for(const{edgeId:ae}of re.values()){const De=B.get(ae);De&&(De.selectable??Q)&&S.current.add(ae)}}if(!Si(K,k.current)){const J=Ve(V,k.current,!0);T(J)}if(!Si(X,S.current)){const J=Ve(B,S.current);O(J)}m.setState({userSelectionRect:Z,userSelectionActive:!0,nodesSelectionActive:!1})},R=$=>{var L,V;if($.button!==0||!N.current)return;(V=(L=$.target)==null?void 0:L.releasePointerCapture)==null||V.call(L,$.pointerId);const{userSelectionRect:z}=m.getState();!y&&z&&$.target===x.current&&(C==null||C($)),m.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:k.current.size>0}),o==null||o($),(t||i)&&(_.current=!1),N.current=!1},A=r===!0||Array.isArray(r)&&r.includes(0);return P.jsxs("div",{className:se(["react-flow__pane",{draggable:A,dragging:w,selection:e}]),onClick:p?void 0:Nn(C,x),onContextMenu:Nn(M,x),onWheel:Nn(I,x),onPointerEnter:p?void 0:u,onPointerDown:p?D:l,onPointerMove:p?v:l,onPointerUp:p?R:void 0,onPointerLeave:f,ref:x,style:un,children:[h,P.jsx(gp,{})]})}function Rr({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:i,unselectNodesAndEdges:s,multiSelectionActive:o,nodeLookup:a,onError:c}=t.getState(),d=a.get(e);if(!d){c==null||c("012",xe.error012(e));return}t.setState({nodesSelectionActive:!1}),d.selected?(n||d.selected&&o)&&(s({nodes:[d],edges:[]}),requestAnimationFrame(()=>{var u;return(u=r==null?void 0:r.current)==null?void 0:u.blur()})):i([e])}function ya({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:i,isSelectable:s,nodeClickDistance:o}){const a=te(),[c,d]=H.useState(!1),u=H.useRef();return H.useEffect(()=>{u.current=sh({getStoreItems:()=>a.getState(),onNodeMouseDown:l=>{Rr({id:l,store:a,nodeRef:e})},onDragStart:()=>{d(!0)},onDragStop:()=>{d(!1)}})},[]),H.useEffect(()=>{var l,f;if(t)(l=u.current)==null||l.destroy();else if(e.current)return(f=u.current)==null||f.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:s,nodeId:i,nodeClickDistance:o}),()=>{var h;(h=u.current)==null||h.destroy()}},[n,r,t,s,e,i]),c}const xp=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function xa(){const e=te();return H.useCallback(n=>{const{nodeExtent:r,snapToGrid:i,snapGrid:s,nodesDraggable:o,onError:a,updateNodePositions:c,nodeLookup:d,nodeOrigin:u}=e.getState(),l=new Map,f=xp(o),h=i?s[0]:5,m=i?s[1]:5,y=n.direction.x*h*n.factor,g=n.direction.y*m*n.factor;for(const[,w]of d){if(!f(w))continue;let b={x:w.internals.positionAbsolute.x+y,y:w.internals.positionAbsolute.y+g};i&&(b=on(b,s));const{position:p,positionAbsolute:x}=Hs({nodeId:w.id,nextPosition:b,nodeLookup:d,nodeExtent:r,nodeOrigin:u,onError:a});w.position=p,w.internals.positionAbsolute=x,l.set(w.id,w)}c(l)},[])}const Wr=H.createContext(null),wp=Wr.Provider;Wr.Consumer;const wa=()=>H.useContext(Wr),vp=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),bp=(e,t,n)=>r=>{const{connectionClickStartHandle:i,connectionMode:s,connection:o}=r,{fromHandle:a,toHandle:c,isValid:d}=o,u=(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.id)===t&&(c==null?void 0:c.type)===n;return{connectingFrom:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,connectingTo:u,clickConnecting:(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.id)===t&&(i==null?void 0:i.type)===n,isPossibleEndHandle:s===Ue.Strict?(a==null?void 0:a.type)!==n:e!==(a==null?void 0:a.nodeId)||t!==(a==null?void 0:a.id),connectionInProcess:!!a,clickConnectionInProcess:!!i,valid:u&&d}};function _p({type:e="source",position:t=U.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:i=!0,isConnectableEnd:s=!0,id:o,onConnect:a,children:c,className:d,onMouseDown:u,onTouchStart:l,...f},h){var R,A;const m=o||null,y=e==="target",g=te(),w=wa(),{connectOnClick:b,noPanClassName:p,rfId:x}=ee(vp,ne),{connectingFrom:E,connectingTo:k,clickConnecting:S,isPossibleEndHandle:_,connectionInProcess:N,clickConnectionInProcess:C,valid:M}=ee(bp(w,m,e),ne);w||(A=(R=g.getState()).onError)==null||A.call(R,"010",xe.error010());const I=$=>{const{defaultEdgeOptions:z,onConnect:L,hasDefaultEdges:V}=g.getState(),B={...z,...$};if(V){const{edges:Y,setEdges:T}=g.getState();T(Xf(B,Y))}L==null||L(B),a==null||a(B)},D=$=>{if(!w)return;const z=Ws($.nativeEvent);if(i&&(z&&$.button===0||!z)){const L=g.getState();Tr.onPointerDown($.nativeEvent,{autoPanOnConnect:L.autoPanOnConnect,connectionMode:L.connectionMode,connectionRadius:L.connectionRadius,domNode:L.domNode,nodeLookup:L.nodeLookup,lib:L.lib,isTarget:y,handleId:m,nodeId:w,flowId:L.rfId,panBy:L.panBy,cancelConnection:L.cancelConnection,onConnectStart:L.onConnectStart,onConnectEnd:L.onConnectEnd,updateConnection:L.updateConnection,onConnect:I,isValidConnection:n||L.isValidConnection,getTransform:()=>g.getState().transform,getFromHandle:()=>g.getState().connection.fromHandle,autoPanSpeed:L.autoPanSpeed})}z?u==null||u($):l==null||l($)},v=$=>{const{onClickConnectStart:z,onClickConnectEnd:L,connectionClickStartHandle:V,connectionMode:B,isValidConnection:Y,lib:T,rfId:O,nodeLookup:j,connection:F}=g.getState();if(!w||!V&&!i)return;if(!V){z==null||z($.nativeEvent,{nodeId:w,handleId:m,handleType:e}),g.setState({connectionClickStartHandle:{nodeId:w,type:e,id:m}});return}const q=Gs($.target),G=n||Y,{connection:W,isValid:Z}=Tr.isValid($.nativeEvent,{handle:{nodeId:w,id:m,type:e},connectionMode:B,fromNodeId:V.nodeId,fromHandleId:V.id||null,fromType:V.type,isValidConnection:G,flowId:O,doc:q,lib:T,nodeLookup:j});Z&&W&&I(W);const K=structuredClone(F);delete K.inProgress,K.toPosition=K.toHandle?K.toHandle.position:null,L==null||L($,K),g.setState({connectionClickStartHandle:null})};return P.jsx("div",{"data-handleid":m,"data-nodeid":w,"data-handlepos":t,"data-id":`${x}-${w}-${m}-${e}`,className:se(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",p,d,{source:!y,target:y,connectable:r,connectablestart:i,connectableend:s,clickconnecting:S,connectingfrom:E,connectingto:k,valid:M,connectionindicator:r&&(!N||_)&&(N||C?s:i)}]),onMouseDown:D,onTouchStart:D,onClick:b?v:void 0,ref:h,...f,children:c})}const Oe=H.memo(ga(_p));function Ep({data:e,isConnectable:t,sourcePosition:n=U.Bottom}){return P.jsxs(P.Fragment,{children:[e==null?void 0:e.label,P.jsx(Oe,{type:"source",position:n,isConnectable:t})]})}function Np({data:e,isConnectable:t,targetPosition:n=U.Top,sourcePosition:r=U.Bottom}){return P.jsxs(P.Fragment,{children:[P.jsx(Oe,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,P.jsx(Oe,{type:"source",position:r,isConnectable:t})]})}function kp(){return null}function Sp({data:e,isConnectable:t,targetPosition:n=U.Top}){return P.jsxs(P.Fragment,{children:[P.jsx(Oe,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const Ut={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Zi={input:Ep,default:Np,output:Sp,group:kp};function Cp(e){var t,n,r,i;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((i=e.style)==null?void 0:i.height)}}const Mp=e=>{const{width:t,height:n,x:r,y:i}=_t(e.nodeLookup,{filter:s=>!!s.selected});return{width:he(t)?t:null,height:he(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${i}px)`}};function Ip({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=te(),{width:i,height:s,transformString:o,userSelectionActive:a}=ee(Mp,ne),c=xa(),d=H.useRef(null);if(H.useEffect(()=>{var f;n||(f=d.current)==null||f.focus({preventScroll:!0})},[n]),ya({nodeRef:d}),a||!i||!s)return null;const u=e?f=>{const h=r.getState().nodes.filter(m=>m.selected);e(f,h)}:void 0,l=f=>{Object.prototype.hasOwnProperty.call(Ut,f.key)&&(f.preventDefault(),c({direction:Ut[f.key],factor:f.shiftKey?4:1}))};return P.jsx("div",{className:se(["react-flow__nodesselection","react-flow__container",t]),style:{transform:o},children:P.jsx("div",{ref:d,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:n?void 0:-1,onKeyDown:n?void 0:l,style:{width:i,height:s}})})}const Qi=typeof window<"u"?window:void 0,Ap=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function va({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,paneClickDistance:a,deleteKeyCode:c,selectionKeyCode:d,selectionOnDrag:u,selectionMode:l,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:m,panActivationKeyCode:y,zoomActivationKeyCode:g,elementsSelectable:w,zoomOnScroll:b,zoomOnPinch:p,panOnScroll:x,panOnScrollSpeed:E,panOnScrollMode:k,zoomOnDoubleClick:S,panOnDrag:_,defaultViewport:N,translateExtent:C,minZoom:M,maxZoom:I,preventScrolling:D,onSelectionContextMenu:v,noWheelClassName:R,noPanClassName:A,disableKeyboardA11y:$,onViewportChange:z,isControlledViewport:L}){const{nodesSelectionActive:V,userSelectionActive:B}=ee(Ap),Y=xt(d,{target:Qi}),T=xt(y,{target:Qi}),O=T||_,j=T||x,F=u&&O!==!0,q=Y||B||F;return lp({deleteKeyCode:c,multiSelectionKeyCode:m}),P.jsx(hp,{onPaneContextMenu:s,elementsSelectable:w,zoomOnScroll:b,zoomOnPinch:p,panOnScroll:j,panOnScrollSpeed:E,panOnScrollMode:k,zoomOnDoubleClick:S,panOnDrag:!Y&&O,defaultViewport:N,translateExtent:C,minZoom:M,maxZoom:I,zoomActivationKeyCode:g,preventScrolling:D,noWheelClassName:R,noPanClassName:A,onViewportChange:z,isControlledViewport:L,paneClickDistance:a,children:P.jsxs(yp,{onSelectionStart:f,onSelectionEnd:h,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,panOnDrag:O,isSelecting:!!q,selectionMode:l,selectionKeyPressed:Y,selectionOnDrag:F,children:[e,V&&P.jsx(Ip,{onSelectionContextMenu:v,noPanClassName:A,disableKeyboardA11y:$})]})})}va.displayName="FlowRenderer";const Tp=H.memo(va),Rp=e=>t=>e?zs(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Pp(e){return ee(H.useCallback(Rp(e),[e]),ne)}const $p=e=>e.updateNodeInternals;function Op(){const e=ee($p),[t]=H.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(i=>{const s=i.target.getAttribute("data-id");r.set(s,{id:s,nodeElement:i.target,force:!0})}),e(r)}));return H.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function Lp({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const i=te(),s=H.useRef(null),o=H.useRef(null),a=H.useRef(e.sourcePosition),c=H.useRef(e.targetPosition),d=H.useRef(t),u=n&&!!e.internals.handleBounds;return H.useEffect(()=>{s.current&&!e.hidden&&(!u||o.current!==s.current)&&(o.current&&(r==null||r.unobserve(o.current)),r==null||r.observe(s.current),o.current=s.current)},[u,e.hidden]),H.useEffect(()=>()=>{o.current&&(r==null||r.unobserve(o.current),o.current=null)},[]),H.useEffect(()=>{if(s.current){const l=d.current!==t,f=a.current!==e.sourcePosition,h=c.current!==e.targetPosition;(l||f||h)&&(d.current=t,a.current=e.sourcePosition,c.current=e.targetPosition,i.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:s.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),s}function jp({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:i,onContextMenu:s,onDoubleClick:o,nodesDraggable:a,elementsSelectable:c,nodesConnectable:d,nodesFocusable:u,resizeObserver:l,noDragClassName:f,noPanClassName:h,disableKeyboardA11y:m,rfId:y,nodeTypes:g,nodeClickDistance:w,onError:b}){const{node:p,internals:x,isParent:E}=ee(q=>{const G=q.nodeLookup.get(e),W=q.parentLookup.has(e);return{node:G,internals:G.internals,isParent:W}},ne);let k=p.type||"default",S=(g==null?void 0:g[k])||Zi[k];S===void 0&&(b==null||b("003",xe.error003(k)),k="default",S=Zi.default);const _=!!(p.draggable||a&&typeof p.draggable>"u"),N=!!(p.selectable||c&&typeof p.selectable>"u"),C=!!(p.connectable||d&&typeof p.connectable>"u"),M=!!(p.focusable||u&&typeof p.focusable>"u"),I=te(),D=qs(p),v=Lp({node:p,nodeType:k,hasDimensions:D,resizeObserver:l}),R=ya({nodeRef:v,disabled:p.hidden||!_,noDragClassName:f,handleSelector:p.dragHandle,nodeId:e,isSelectable:N,nodeClickDistance:w}),A=xa();if(p.hidden)return null;const $=Ne(p),z=Cp(p),L=N||_||t||n||r||i,V=n?q=>n(q,{...x.userNode}):void 0,B=r?q=>r(q,{...x.userNode}):void 0,Y=i?q=>i(q,{...x.userNode}):void 0,T=s?q=>s(q,{...x.userNode}):void 0,O=o?q=>o(q,{...x.userNode}):void 0,j=q=>{const{selectNodesOnDrag:G,nodeDragThreshold:W}=I.getState();N&&(!G||!_||W>0)&&Rr({id:e,store:I,nodeRef:v}),t&&t(q,{...x.userNode})},F=q=>{if(!(Xs(q.nativeEvent)||m))if(Os.includes(q.key)&&N){const G=q.key==="Escape";Rr({id:e,store:I,unselect:G,nodeRef:v})}else _&&p.selected&&Object.prototype.hasOwnProperty.call(Ut,q.key)&&(q.preventDefault(),I.setState({ariaLiveMessage:`Moved selected node ${q.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~x.positionAbsolute.x}, y: ${~~x.positionAbsolute.y}`}),A({direction:Ut[q.key],factor:q.shiftKey?4:1}))};return P.jsx("div",{className:se(["react-flow__node",`react-flow__node-${k}`,{[h]:_},p.className,{selected:p.selected,selectable:N,parent:E,draggable:_,dragging:R}]),ref:v,style:{zIndex:x.z,transform:`translate(${x.positionAbsolute.x}px,${x.positionAbsolute.y}px)`,pointerEvents:L?"all":"none",visibility:D?"visible":"hidden",...p.style,...z},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:V,onMouseMove:B,onMouseLeave:Y,onContextMenu:T,onClick:j,onDoubleClick:O,onKeyDown:M?F:void 0,tabIndex:M?0:void 0,role:M?"button":void 0,"aria-describedby":m?void 0:`${da}-${y}`,"aria-label":p.ariaLabel,children:P.jsx(wp,{value:e,children:P.jsx(S,{id:e,data:p.data,type:k,positionAbsoluteX:x.positionAbsolute.x,positionAbsoluteY:x.positionAbsolute.y,selected:p.selected??!1,selectable:N,draggable:_,deletable:p.deletable??!0,isConnectable:C,sourcePosition:p.sourcePosition,targetPosition:p.targetPosition,dragging:R,dragHandle:p.dragHandle,zIndex:x.z,parentId:p.parentId,...$})})})}const Dp=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function ba(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:i,onError:s}=ee(Dp,ne),o=Pp(e.onlyRenderVisibleElements),a=Op();return P.jsx("div",{className:"react-flow__nodes",style:un,children:o.map(c=>P.jsx(jp,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:i,nodeClickDistance:e.nodeClickDistance,onError:s},c))})}ba.displayName="NodeRenderer";const zp=H.memo(ba);function Hp(e){return ee(H.useCallback(n=>{if(!e)return n.edges.map(i=>i.id);const r=[];if(n.width&&n.height)for(const i of n.edges){const s=n.nodeLookup.get(i.source),o=n.nodeLookup.get(i.target);s&&o&&qf({sourceNode:s,targetNode:o,width:n.width,height:n.height,transform:n.transform})&&r.push(i.id)}return r},[e]),ne)}const Fp=({color:e="none",strokeWidth:t=1})=>P.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),Bp=({color:e="none",strokeWidth:t=1})=>P.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Ji={[Yt.Arrow]:Fp,[Yt.ArrowClosed]:Bp};function Vp(e){const t=te();return H.useMemo(()=>{var i,s;return Object.prototype.hasOwnProperty.call(Ji,e)?Ji[e]:((s=(i=t.getState()).onError)==null||s.call(i,"009",xe.error009(e)),null)},[e])}const qp=({id:e,type:t,color:n,width:r=12.5,height:i=12.5,markerUnits:s="strokeWidth",strokeWidth:o,orient:a="auto-start-reverse"})=>{const c=Vp(t);return c?P.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:a,refX:"0",refY:"0",children:P.jsx(c,{color:n,strokeWidth:o})}):null},_a=({defaultColor:e,rfId:t})=>{const n=ee(s=>s.edges),r=ee(s=>s.defaultEdgeOptions),i=H.useMemo(()=>Qf(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return i.length?P.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:P.jsx("defs",{children:i.map(s=>P.jsx(qp,{id:s.id,type:s.type,color:s.color,width:s.width,height:s.height,markerUnits:s.markerUnits,strokeWidth:s.strokeWidth,orient:s.orient},s.id))})}):null};_a.displayName="MarkerDefinitions";var Yp=H.memo(_a);function Ea({x:e,y:t,label:n,labelStyle:r,labelShowBg:i=!0,labelBgStyle:s,labelBgPadding:o=[2,4],labelBgBorderRadius:a=2,children:c,className:d,...u}){const[l,f]=H.useState({x:1,y:0,width:0,height:0}),h=se(["react-flow__edge-textwrapper",d]),m=H.useRef(null);return H.useEffect(()=>{if(m.current){const y=m.current.getBBox();f({x:y.x,y:y.y,width:y.width,height:y.height})}},[n]),n?P.jsxs("g",{transform:`translate(${e-l.width/2} ${t-l.height/2})`,className:h,visibility:l.width?"visible":"hidden",...u,children:[i&&P.jsx("rect",{width:l.width+2*o[0],x:-o[0],y:-o[1],height:l.height+2*o[1],className:"react-flow__edge-textbg",style:s,rx:a,ry:a}),P.jsx("text",{className:"react-flow__edge-text",y:l.height/2,dy:"0.3em",ref:m,style:r,children:n}),c]}):null}Ea.displayName="EdgeText";const Gp=H.memo(Ea);function ln({path:e,labelX:t,labelY:n,label:r,labelStyle:i,labelShowBg:s,labelBgStyle:o,labelBgPadding:a,labelBgBorderRadius:c,interactionWidth:d=20,...u}){return P.jsxs(P.Fragment,{children:[P.jsx("path",{...u,d:e,fill:"none",className:se(["react-flow__edge-path",u.className])}),d&&P.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:d,className:"react-flow__edge-interaction"}),r&&he(t)&&he(n)?P.jsx(Gp,{x:t,y:n,label:r,labelStyle:i,labelShowBg:s,labelBgStyle:o,labelBgPadding:a,labelBgBorderRadius:c}):null]})}function eo({pos:e,x1:t,y1:n,x2:r,y2:i}){return e===U.Left||e===U.Right?[.5*(t+r),n]:[t,.5*(n+i)]}function Na({sourceX:e,sourceY:t,sourcePosition:n=U.Bottom,targetX:r,targetY:i,targetPosition:s=U.Top}){const[o,a]=eo({pos:n,x1:e,y1:t,x2:r,y2:i}),[c,d]=eo({pos:s,x1:r,y1:i,x2:e,y2:t}),[u,l,f,h]=Us({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:o,sourceControlY:a,targetControlX:c,targetControlY:d});return[`M${e},${t} C${o},${a} ${c},${d} ${r},${i}`,u,l,f,h]}function ka(e){return H.memo(({id:t,sourceX:n,sourceY:r,targetX:i,targetY:s,sourcePosition:o,targetPosition:a,label:c,labelStyle:d,labelShowBg:u,labelBgStyle:l,labelBgPadding:f,labelBgBorderRadius:h,style:m,markerEnd:y,markerStart:g,interactionWidth:w})=>{const[b,p,x]=Na({sourceX:n,sourceY:r,sourcePosition:o,targetX:i,targetY:s,targetPosition:a}),E=e.isInternal?void 0:t;return P.jsx(ln,{id:E,path:b,labelX:p,labelY:x,label:c,labelStyle:d,labelShowBg:u,labelBgStyle:l,labelBgPadding:f,labelBgBorderRadius:h,style:m,markerEnd:y,markerStart:g,interactionWidth:w})})}const Xp=ka({isInternal:!1}),Sa=ka({isInternal:!0});Xp.displayName="SimpleBezierEdge";Sa.displayName="SimpleBezierEdgeInternal";function Ca(e){return H.memo(({id:t,sourceX:n,sourceY:r,targetX:i,targetY:s,label:o,labelStyle:a,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:l,style:f,sourcePosition:h=U.Bottom,targetPosition:m=U.Top,markerEnd:y,markerStart:g,pathOptions:w,interactionWidth:b})=>{const[p,x,E]=Mr({sourceX:n,sourceY:r,sourcePosition:h,targetX:i,targetY:s,targetPosition:m,borderRadius:w==null?void 0:w.borderRadius,offset:w==null?void 0:w.offset}),k=e.isInternal?void 0:t;return P.jsx(ln,{id:k,path:p,labelX:x,labelY:E,label:o,labelStyle:a,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:l,style:f,markerEnd:y,markerStart:g,interactionWidth:b})})}const Ma=Ca({isInternal:!1}),Ia=Ca({isInternal:!0});Ma.displayName="SmoothStepEdge";Ia.displayName="SmoothStepEdgeInternal";function Aa(e){return H.memo(({id:t,...n})=>{var i;const r=e.isInternal?void 0:t;return P.jsx(Ma,{...n,id:r,pathOptions:H.useMemo(()=>{var s;return{borderRadius:0,offset:(s=n.pathOptions)==null?void 0:s.offset}},[(i=n.pathOptions)==null?void 0:i.offset])})})}const Wp=Aa({isInternal:!1}),Ta=Aa({isInternal:!0});Wp.displayName="StepEdge";Ta.displayName="StepEdgeInternal";function Ra(e){return H.memo(({id:t,sourceX:n,sourceY:r,targetX:i,targetY:s,label:o,labelStyle:a,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:l,style:f,markerEnd:h,markerStart:m,interactionWidth:y})=>{const[g,w,b]=Qs({sourceX:n,sourceY:r,targetX:i,targetY:s}),p=e.isInternal?void 0:t;return P.jsx(ln,{id:p,path:g,labelX:w,labelY:b,label:o,labelStyle:a,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:l,style:f,markerEnd:h,markerStart:m,interactionWidth:y})})}const Up=Ra({isInternal:!1}),Pa=Ra({isInternal:!0});Up.displayName="StraightEdge";Pa.displayName="StraightEdgeInternal";function $a(e){return H.memo(({id:t,sourceX:n,sourceY:r,targetX:i,targetY:s,sourcePosition:o=U.Bottom,targetPosition:a=U.Top,label:c,labelStyle:d,labelShowBg:u,labelBgStyle:l,labelBgPadding:f,labelBgBorderRadius:h,style:m,markerEnd:y,markerStart:g,pathOptions:w,interactionWidth:b})=>{const[p,x,E]=Ks({sourceX:n,sourceY:r,sourcePosition:o,targetX:i,targetY:s,targetPosition:a,curvature:w==null?void 0:w.curvature}),k=e.isInternal?void 0:t;return P.jsx(ln,{id:k,path:p,labelX:x,labelY:E,label:c,labelStyle:d,labelShowBg:u,labelBgStyle:l,labelBgPadding:f,labelBgBorderRadius:h,style:m,markerEnd:y,markerStart:g,interactionWidth:b})})}const Kp=$a({isInternal:!1}),Oa=$a({isInternal:!0});Kp.displayName="BezierEdge";Oa.displayName="BezierEdgeInternal";const to={default:Oa,straight:Pa,step:Ta,smoothstep:Ia,simplebezier:Sa},no={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},Zp=(e,t,n)=>n===U.Left?e-t:n===U.Right?e+t:e,Qp=(e,t,n)=>n===U.Top?e-t:n===U.Bottom?e+t:e,ro="react-flow__edgeupdater";function io({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:i,onMouseEnter:s,onMouseOut:o,type:a}){return P.jsx("circle",{onMouseDown:i,onMouseEnter:s,onMouseOut:o,className:se([ro,`${ro}-${a}`]),cx:Zp(t,r,e),cy:Qp(n,r,e),r,stroke:"transparent",fill:"transparent"})}function Jp({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:i,targetX:s,targetY:o,sourcePosition:a,targetPosition:c,onReconnect:d,onReconnectStart:u,onReconnectEnd:l,setReconnecting:f,setUpdateHover:h}){const m=te(),y=(x,E)=>{if(x.button!==0)return;const{autoPanOnConnect:k,domNode:S,isValidConnection:_,connectionMode:N,connectionRadius:C,lib:M,onConnectStart:I,onConnectEnd:D,cancelConnection:v,nodeLookup:R,rfId:A,panBy:$,updateConnection:z}=m.getState(),L=E.type==="target";f(!0),u==null||u(x,n,E.type);const V=(Y,T)=>{f(!1),l==null||l(Y,n,E.type,T)},B=Y=>d==null?void 0:d(n,Y);Tr.onPointerDown(x.nativeEvent,{autoPanOnConnect:k,connectionMode:N,connectionRadius:C,domNode:S,handleId:E.id,nodeId:E.nodeId,nodeLookup:R,isTarget:L,edgeUpdaterType:E.type,lib:M,flowId:A,cancelConnection:v,panBy:$,isValidConnection:_,onConnect:B,onConnectStart:I,onConnectEnd:D,onReconnectEnd:V,updateConnection:z,getTransform:()=>m.getState().transform,getFromHandle:()=>m.getState().connection.fromHandle})},g=x=>y(x,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),w=x=>y(x,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),b=()=>h(!0),p=()=>h(!1);return P.jsxs(P.Fragment,{children:[(e===!0||e==="source")&&P.jsx(io,{position:a,centerX:r,centerY:i,radius:t,onMouseDown:g,onMouseEnter:b,onMouseOut:p,type:"source"}),(e===!0||e==="target")&&P.jsx(io,{position:c,centerX:s,centerY:o,radius:t,onMouseDown:w,onMouseEnter:b,onMouseOut:p,type:"target"})]})}function eg({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:i,onDoubleClick:s,onContextMenu:o,onMouseEnter:a,onMouseMove:c,onMouseLeave:d,reconnectRadius:u,onReconnect:l,onReconnectStart:f,onReconnectEnd:h,rfId:m,edgeTypes:y,noPanClassName:g,onError:w,disableKeyboardA11y:b}){let p=ee(X=>X.edgeLookup.get(e));const x=ee(X=>X.defaultEdgeOptions);p=x?{...x,...p}:p;let E=p.type||"default",k=(y==null?void 0:y[E])||to[E];k===void 0&&(w==null||w("011",xe.error011(E)),E="default",k=to.default);const S=!!(p.focusable||t&&typeof p.focusable>"u"),_=typeof l<"u"&&(p.reconnectable||n&&typeof p.reconnectable>"u"),N=!!(p.selectable||r&&typeof p.selectable>"u"),C=H.useRef(null),[M,I]=H.useState(!1),[D,v]=H.useState(!1),R=te(),{zIndex:A,sourceX:$,sourceY:z,targetX:L,targetY:V,sourcePosition:B,targetPosition:Y}=ee(H.useCallback(X=>{const Q=X.nodeLookup.get(p.source),J=X.nodeLookup.get(p.target);if(!Q||!J)return{zIndex:p.zIndex,...no};const re=Zf({id:e,sourceNode:Q,targetNode:J,sourceHandle:p.sourceHandle||null,targetHandle:p.targetHandle||null,connectionMode:X.connectionMode,onError:w});return{zIndex:Vf({selected:p.selected,zIndex:p.zIndex,sourceNode:Q,targetNode:J,elevateOnSelect:X.elevateEdgesOnSelect}),...re||no}},[p.source,p.target,p.sourceHandle,p.targetHandle,p.selected,p.zIndex]),ne),T=H.useMemo(()=>p.markerStart?`url('#${Ir(p.markerStart,m)}')`:void 0,[p.markerStart,m]),O=H.useMemo(()=>p.markerEnd?`url('#${Ir(p.markerEnd,m)}')`:void 0,[p.markerEnd,m]);if(p.hidden||$===null||z===null||L===null||V===null)return null;const j=X=>{var ae;const{addSelectedEdges:Q,unselectNodesAndEdges:J,multiSelectionActive:re}=R.getState();N&&(R.setState({nodesSelectionActive:!1}),p.selected&&re?(J({nodes:[],edges:[p]}),(ae=C.current)==null||ae.blur()):Q([e])),i&&i(X,p)},F=s?X=>{s(X,{...p})}:void 0,q=o?X=>{o(X,{...p})}:void 0,G=a?X=>{a(X,{...p})}:void 0,W=c?X=>{c(X,{...p})}:void 0,Z=d?X=>{d(X,{...p})}:void 0,K=X=>{var Q;if(!b&&Os.includes(X.key)&&N){const{unselectNodesAndEdges:J,addSelectedEdges:re}=R.getState();X.key==="Escape"?((Q=C.current)==null||Q.blur(),J({edges:[p]})):re([e])}};return P.jsx("svg",{style:{zIndex:A},children:P.jsxs("g",{className:se(["react-flow__edge",`react-flow__edge-${E}`,p.className,g,{selected:p.selected,animated:p.animated,inactive:!N&&!i,updating:M,selectable:N}]),onClick:j,onDoubleClick:F,onContextMenu:q,onMouseEnter:G,onMouseMove:W,onMouseLeave:Z,onKeyDown:S?K:void 0,tabIndex:S?0:void 0,role:S?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":p.ariaLabel===null?void 0:p.ariaLabel||`Edge from ${p.source} to ${p.target}`,"aria-describedby":S?`${fa}-${m}`:void 0,ref:C,children:[!D&&P.jsx(k,{id:e,source:p.source,target:p.target,type:p.type,selected:p.selected,animated:p.animated,selectable:N,deletable:p.deletable??!0,label:p.label,labelStyle:p.labelStyle,labelShowBg:p.labelShowBg,labelBgStyle:p.labelBgStyle,labelBgPadding:p.labelBgPadding,labelBgBorderRadius:p.labelBgBorderRadius,sourceX:$,sourceY:z,targetX:L,targetY:V,sourcePosition:B,targetPosition:Y,data:p.data,style:p.style,sourceHandleId:p.sourceHandle,targetHandleId:p.targetHandle,markerStart:T,markerEnd:O,pathOptions:"pathOptions"in p?p.pathOptions:void 0,interactionWidth:p.interactionWidth}),_&&P.jsx(Jp,{edge:p,isReconnectable:_,reconnectRadius:u,onReconnect:l,onReconnectStart:f,onReconnectEnd:h,sourceX:$,sourceY:z,targetX:L,targetY:V,sourcePosition:B,targetPosition:Y,setUpdateHover:I,setReconnecting:v})]})})}const tg=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function La({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:i,onReconnect:s,onEdgeContextMenu:o,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:d,onEdgeClick:u,reconnectRadius:l,onEdgeDoubleClick:f,onReconnectStart:h,onReconnectEnd:m,disableKeyboardA11y:y}){const{edgesFocusable:g,edgesReconnectable:w,elementsSelectable:b,onError:p}=ee(tg,ne),x=Hp(t);return P.jsxs("div",{className:"react-flow__edges",children:[P.jsx(Yp,{defaultColor:e,rfId:n}),x.map(E=>P.jsx(eg,{id:E,edgesFocusable:g,edgesReconnectable:w,elementsSelectable:b,noPanClassName:i,onReconnect:s,onContextMenu:o,onMouseEnter:a,onMouseMove:c,onMouseLeave:d,onClick:u,reconnectRadius:l,onDoubleClick:f,onReconnectStart:h,onReconnectEnd:m,rfId:n,onError:p,edgeTypes:r,disableKeyboardA11y:y},E))]})}La.displayName="EdgeRenderer";const ng=H.memo(La),rg=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function ig({children:e}){const t=ee(rg);return P.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function og(e){const t=Xr(),n=H.useRef(!1);H.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const sg=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function ag(e){const t=ee(sg),n=te();return H.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function cg(e){return e.connection.inProgress?{...e.connection,to:Et(e.connection.to,e.transform)}:{...e.connection}}function ug(e){return cg}function lg(e){const t=ug();return ee(t,ne)}const dg=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function fg({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:i,width:s,height:o,isValid:a,inProgress:c}=ee(dg,ne);return!(s&&i&&c)?null:P.jsx("svg",{style:e,width:s,height:o,className:"react-flow__connectionline react-flow__container",children:P.jsx("g",{className:se(["react-flow__connection",js(a)]),children:P.jsx(ja,{style:t,type:n,CustomComponent:r,isValid:a})})})}const ja=({style:e,type:t=Me.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:i,from:s,fromNode:o,fromHandle:a,fromPosition:c,to:d,toNode:u,toHandle:l,toPosition:f}=lg();if(!i)return;if(n)return P.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:o,fromHandle:a,fromX:s.x,fromY:s.y,toX:d.x,toY:d.y,fromPosition:c,toPosition:f,connectionStatus:js(r),toNode:u,toHandle:l});let h="";const m={sourceX:s.x,sourceY:s.y,sourcePosition:c,targetX:d.x,targetY:d.y,targetPosition:f};switch(t){case Me.Bezier:[h]=Ks(m);break;case Me.SimpleBezier:[h]=Na(m);break;case Me.Step:[h]=Mr({...m,borderRadius:0});break;case Me.SmoothStep:[h]=Mr(m);break;default:[h]=Qs(m)}return P.jsx("path",{d:h,fill:"none",className:"react-flow__connection-path",style:e})};ja.displayName="ConnectionLine";const hg={};function oo(e=hg){H.useRef(e),te(),H.useEffect(()=>{},[e])}function pg(){te(),H.useRef(!1),H.useEffect(()=>{},[])}function Da({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:i,onNodeDoubleClick:s,onEdgeDoubleClick:o,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:d,onNodeContextMenu:u,onSelectionContextMenu:l,onSelectionStart:f,onSelectionEnd:h,connectionLineType:m,connectionLineStyle:y,connectionLineComponent:g,connectionLineContainerStyle:w,selectionKeyCode:b,selectionOnDrag:p,selectionMode:x,multiSelectionKeyCode:E,panActivationKeyCode:k,zoomActivationKeyCode:S,deleteKeyCode:_,onlyRenderVisibleElements:N,elementsSelectable:C,defaultViewport:M,translateExtent:I,minZoom:D,maxZoom:v,preventScrolling:R,defaultMarkerColor:A,zoomOnScroll:$,zoomOnPinch:z,panOnScroll:L,panOnScrollSpeed:V,panOnScrollMode:B,zoomOnDoubleClick:Y,panOnDrag:T,onPaneClick:O,onPaneMouseEnter:j,onPaneMouseMove:F,onPaneMouseLeave:q,onPaneScroll:G,onPaneContextMenu:W,paneClickDistance:Z,nodeClickDistance:K,onEdgeContextMenu:X,onEdgeMouseEnter:Q,onEdgeMouseMove:J,onEdgeMouseLeave:re,reconnectRadius:ae,onReconnect:De,onReconnectStart:dn,onReconnectEnd:fn,noDragClassName:et,noWheelClassName:hn,noPanClassName:tt,disableKeyboardA11y:nt,nodeExtent:pn,rfId:ze,viewport:He,onViewportChange:Nt}){return oo(e),oo(t),pg(),og(n),ag(He),P.jsx(Tp,{onPaneClick:O,onPaneMouseEnter:j,onPaneMouseMove:F,onPaneMouseLeave:q,onPaneContextMenu:W,onPaneScroll:G,paneClickDistance:Z,deleteKeyCode:_,selectionKeyCode:b,selectionOnDrag:p,selectionMode:x,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:E,panActivationKeyCode:k,zoomActivationKeyCode:S,elementsSelectable:C,zoomOnScroll:$,zoomOnPinch:z,zoomOnDoubleClick:Y,panOnScroll:L,panOnScrollSpeed:V,panOnScrollMode:B,panOnDrag:T,defaultViewport:M,translateExtent:I,minZoom:D,maxZoom:v,onSelectionContextMenu:l,preventScrolling:R,noDragClassName:et,noWheelClassName:hn,noPanClassName:tt,disableKeyboardA11y:nt,onViewportChange:Nt,isControlledViewport:!!He,children:P.jsxs(ig,{children:[P.jsx(ng,{edgeTypes:t,onEdgeClick:i,onEdgeDoubleClick:o,onReconnect:De,onReconnectStart:dn,onReconnectEnd:fn,onlyRenderVisibleElements:N,onEdgeContextMenu:X,onEdgeMouseEnter:Q,onEdgeMouseMove:J,onEdgeMouseLeave:re,reconnectRadius:ae,defaultMarkerColor:A,noPanClassName:tt,disableKeyboardA11y:nt,rfId:ze}),P.jsx(fg,{style:y,type:m,component:g,containerStyle:w}),P.jsx("div",{className:"react-flow__edgelabel-renderer"}),P.jsx(zp,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:d,onNodeContextMenu:u,nodeClickDistance:K,onlyRenderVisibleElements:N,noPanClassName:tt,noDragClassName:et,disableKeyboardA11y:nt,nodeExtent:pn,rfId:ze}),P.jsx("div",{className:"react-flow__viewport-portal"})]})})}Da.displayName="GraphView";const gg=H.memo(Da),so=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:i,height:s,fitView:o,fitViewOptions:a,minZoom:c=.5,maxZoom:d=2,nodeOrigin:u,nodeExtent:l}={})=>{const f=new Map,h=new Map,m=new Map,y=new Map,g=r??t??[],w=n??e??[],b=u??[0,0],p=l??pt;ea(m,y,g);const x=Ar(w,f,h,{nodeOrigin:b,nodeExtent:p,elevateNodesOnSelect:!1});let E=[0,0,1];if(o&&i&&s){const k=_t(f,{filter:C=>!!((C.width||C.initialWidth)&&(C.height||C.initialHeight))}),{x:S,y:_,zoom:N}=Fr(k,i,s,c,d,(a==null?void 0:a.padding)??.1);E=[S,_,N]}return{rfId:"1",width:0,height:0,transform:E,nodes:w,nodesInitialized:x,nodeLookup:f,parentLookup:h,edges:g,edgeLookup:y,connectionLookup:m,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:c,maxZoom:d,translateExtent:pt,nodeExtent:p,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Ue.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:b,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:o??!1,fitViewOptions:a,fitViewResolver:null,connection:{...Ls},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanSpeed:15,connectionRadius:20,onError:Df,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}},mg=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:i,height:s,fitView:o,fitViewOptions:a,minZoom:c,maxZoom:d,nodeOrigin:u,nodeExtent:l})=>Ph((f,h)=>{async function m(){const{nodeLookup:y,panZoom:g,fitViewOptions:w,fitViewResolver:b,width:p,height:x,minZoom:E,maxZoom:k}=h();g&&(await Lf({nodes:y,width:p,height:x,panZoom:g,minZoom:E,maxZoom:k},w),b==null||b.resolve(!0),f({fitViewResolver:null}))}return{...so({nodes:e,edges:t,width:i,height:s,fitView:o,fitViewOptions:a,minZoom:c,maxZoom:d,nodeOrigin:u,nodeExtent:l,defaultNodes:n,defaultEdges:r}),setNodes:y=>{const{nodeLookup:g,parentLookup:w,nodeOrigin:b,elevateNodesOnSelect:p,fitViewQueued:x}=h(),E=Ar(y,g,w,{nodeOrigin:b,nodeExtent:l,elevateNodesOnSelect:p,checkEquality:!0});x&&E?(m(),f({nodes:y,nodesInitialized:E,fitViewQueued:!1,fitViewOptions:void 0})):f({nodes:y,nodesInitialized:E})},setEdges:y=>{const{connectionLookup:g,edgeLookup:w}=h();ea(g,w,y),f({edges:y})},setDefaultNodesAndEdges:(y,g)=>{if(y){const{setNodes:w}=h();w(y),f({hasDefaultNodes:!0})}if(g){const{setEdges:w}=h();w(g),f({hasDefaultEdges:!0})}},updateNodeInternals:y=>{const{triggerNodeChanges:g,nodeLookup:w,parentLookup:b,domNode:p,nodeOrigin:x,nodeExtent:E,debug:k,fitViewQueued:S}=h(),{changes:_,updatedInternals:N}=rh(y,w,b,p,x,E);N&&(eh(w,b,{nodeOrigin:x,nodeExtent:E}),S?(m(),f({fitViewQueued:!1,fitViewOptions:void 0})):f({}),(_==null?void 0:_.length)>0&&(k&&console.log("React Flow: trigger node changes",_),g==null||g(_)))},updateNodePositions:(y,g=!1)=>{const w=[],b=[],{nodeLookup:p,triggerNodeChanges:x}=h();for(const[E,k]of y){const S=p.get(E),_=!!(S!=null&&S.expandParent&&(S!=null&&S.parentId)&&(k!=null&&k.position)),N={id:E,type:"position",position:_?{x:Math.max(0,k.position.x),y:Math.max(0,k.position.y)}:k.position,dragging:g};_&&S.parentId&&w.push({id:E,parentId:S.parentId,rect:{...k.internals.positionAbsolute,width:k.measured.width??0,height:k.measured.height??0}}),b.push(N)}if(w.length>0){const{parentLookup:E,nodeOrigin:k}=h(),S=Gr(w,p,E,k);b.push(...S)}x(b)},triggerNodeChanges:y=>{const{onNodesChange:g,setNodes:w,nodes:b,hasDefaultNodes:p,debug:x}=h();if(y!=null&&y.length){if(p){const E=ep(y,b);w(E)}x&&console.log("React Flow: trigger node changes",y),g==null||g(y)}},triggerEdgeChanges:y=>{const{onEdgesChange:g,setEdges:w,edges:b,hasDefaultEdges:p,debug:x}=h();if(y!=null&&y.length){if(p){const E=tp(y,b);w(E)}x&&console.log("React Flow: trigger edge changes",y),g==null||g(y)}},addSelectedNodes:y=>{const{multiSelectionActive:g,edgeLookup:w,nodeLookup:b,triggerNodeChanges:p,triggerEdgeChanges:x}=h();if(g){const E=y.map(k=>Te(k,!0));p(E);return}p(Ve(b,new Set([...y]),!0)),x(Ve(w))},addSelectedEdges:y=>{const{multiSelectionActive:g,edgeLookup:w,nodeLookup:b,triggerNodeChanges:p,triggerEdgeChanges:x}=h();if(g){const E=y.map(k=>Te(k,!0));x(E);return}x(Ve(w,new Set([...y]))),p(Ve(b,new Set,!0))},unselectNodesAndEdges:({nodes:y,edges:g}={})=>{const{edges:w,nodes:b,nodeLookup:p,triggerNodeChanges:x,triggerEdgeChanges:E}=h(),k=y||b,S=g||w,_=k.map(C=>{const M=p.get(C.id);return M&&(M.selected=!1),Te(C.id,!1)}),N=S.map(C=>Te(C.id,!1));x(_),E(N)},setMinZoom:y=>{const{panZoom:g,maxZoom:w}=h();g==null||g.setScaleExtent([y,w]),f({minZoom:y})},setMaxZoom:y=>{const{panZoom:g,minZoom:w}=h();g==null||g.setScaleExtent([w,y]),f({maxZoom:y})},setTranslateExtent:y=>{var g;(g=h().panZoom)==null||g.setTranslateExtent(y),f({translateExtent:y})},setPaneClickDistance:y=>{var g;(g=h().panZoom)==null||g.setClickDistance(y)},resetSelectedElements:()=>{const{edges:y,nodes:g,triggerNodeChanges:w,triggerEdgeChanges:b,elementsSelectable:p}=h();if(!p)return;const x=g.reduce((k,S)=>S.selected?[...k,Te(S.id,!1)]:k,[]),E=y.reduce((k,S)=>S.selected?[...k,Te(S.id,!1)]:k,[]);w(x),b(E)},setNodeExtent:y=>{const{nodes:g,nodeLookup:w,parentLookup:b,nodeOrigin:p,elevateNodesOnSelect:x,nodeExtent:E}=h();y[0][0]===E[0][0]&&y[0][1]===E[0][1]&&y[1][0]===E[1][0]&&y[1][1]===E[1][1]||(Ar(g,w,b,{nodeOrigin:p,nodeExtent:y,elevateNodesOnSelect:x,checkEquality:!1}),f({nodeExtent:y}))},panBy:y=>{const{transform:g,width:w,height:b,panZoom:p,translateExtent:x}=h();return ih({delta:y,panZoom:p,transform:g,translateExtent:x,width:w,height:b})},cancelConnection:()=>{f({connection:{...Ls}})},updateConnection:y=>{f({connection:y})},reset:()=>f({...so()})}},Object.is);function yg({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:i,initialHeight:s,initialMinZoom:o,initialMaxZoom:a,initialFitViewOptions:c,fitView:d,nodeOrigin:u,nodeExtent:l,children:f}){const[h]=H.useState(()=>mg({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:i,height:s,fitView:d,minZoom:o,maxZoom:a,fitViewOptions:c,nodeOrigin:u,nodeExtent:l}));return P.jsx($h,{value:h,children:P.jsx(op,{children:f})})}function xg({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:i,width:s,height:o,fitView:a,fitViewOptions:c,minZoom:d,maxZoom:u,nodeOrigin:l,nodeExtent:f}){return H.useContext(an)?P.jsx(P.Fragment,{children:e}):P.jsx(yg,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:i,initialWidth:s,initialHeight:o,fitView:a,initialFitViewOptions:c,initialMinZoom:d,initialMaxZoom:u,nodeOrigin:l,nodeExtent:f,children:e})}const wg={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function vg({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:i,nodeTypes:s,edgeTypes:o,onNodeClick:a,onEdgeClick:c,onInit:d,onMove:u,onMoveStart:l,onMoveEnd:f,onConnect:h,onConnectStart:m,onConnectEnd:y,onClickConnectStart:g,onClickConnectEnd:w,onNodeMouseEnter:b,onNodeMouseMove:p,onNodeMouseLeave:x,onNodeContextMenu:E,onNodeDoubleClick:k,onNodeDragStart:S,onNodeDrag:_,onNodeDragStop:N,onNodesDelete:C,onEdgesDelete:M,onDelete:I,onSelectionChange:D,onSelectionDragStart:v,onSelectionDrag:R,onSelectionDragStop:A,onSelectionContextMenu:$,onSelectionStart:z,onSelectionEnd:L,onBeforeDelete:V,connectionMode:B,connectionLineType:Y=Me.Bezier,connectionLineStyle:T,connectionLineComponent:O,connectionLineContainerStyle:j,deleteKeyCode:F="Backspace",selectionKeyCode:q="Shift",selectionOnDrag:G=!1,selectionMode:W=gt.Full,panActivationKeyCode:Z="Space",multiSelectionKeyCode:K=Wt()?"Meta":"Control",zoomActivationKeyCode:X=Wt()?"Meta":"Control",snapToGrid:Q,snapGrid:J,onlyRenderVisibleElements:re=!1,selectNodesOnDrag:ae,nodesDraggable:De,nodesConnectable:dn,nodesFocusable:fn,nodeOrigin:et=ha,edgesFocusable:hn,edgesReconnectable:tt,elementsSelectable:nt=!0,defaultViewport:pn=Xh,minZoom:ze=.5,maxZoom:He=2,translateExtent:Nt=pt,preventScrolling:Wa=!0,nodeExtent:gn,defaultMarkerColor:Ua="#b1b1b7",zoomOnScroll:Ka=!0,zoomOnPinch:Za=!0,panOnScroll:Qa=!1,panOnScrollSpeed:Ja=.5,panOnScrollMode:ec=$e.Free,zoomOnDoubleClick:tc=!0,panOnDrag:nc=!0,onPaneClick:rc,onPaneMouseEnter:ic,onPaneMouseMove:oc,onPaneMouseLeave:sc,onPaneScroll:ac,onPaneContextMenu:cc,paneClickDistance:Qr=0,nodeClickDistance:uc=0,children:lc,onReconnect:dc,onReconnectStart:fc,onReconnectEnd:hc,onEdgeContextMenu:pc,onEdgeDoubleClick:gc,onEdgeMouseEnter:mc,onEdgeMouseMove:yc,onEdgeMouseLeave:xc,reconnectRadius:wc=10,onNodesChange:vc,onEdgesChange:bc,noDragClassName:_c="nodrag",noWheelClassName:Ec="nowheel",noPanClassName:Jr="nopan",fitView:ei,fitViewOptions:ti,connectOnClick:Nc,attributionPosition:kc,proOptions:Sc,defaultEdgeOptions:Cc,elevateNodesOnSelect:Mc,elevateEdgesOnSelect:Ic,disableKeyboardA11y:ni=!1,autoPanOnConnect:Ac,autoPanOnNodeDrag:Tc,autoPanSpeed:Rc,connectionRadius:Pc,isValidConnection:$c,onError:Oc,style:Lc,id:ri,nodeDragThreshold:jc,viewport:Dc,onViewportChange:zc,width:Hc,height:Fc,colorMode:Bc="light",debug:Vc,onScroll:kt,...qc},Yc){const mn=ri||"1",Gc=Zh(Bc),Xc=H.useCallback(ii=>{ii.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),kt==null||kt(ii)},[kt]);return P.jsx("div",{"data-testid":"rf__wrapper",...qc,onScroll:Xc,style:{...Lc,...wg},ref:Yc,className:se(["react-flow",i,Gc]),id:ri,children:P.jsxs(xg,{nodes:e,edges:t,width:Hc,height:Fc,fitView:ei,fitViewOptions:ti,minZoom:ze,maxZoom:He,nodeOrigin:et,nodeExtent:gn,children:[P.jsx(gg,{onInit:d,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:b,onNodeMouseMove:p,onNodeMouseLeave:x,onNodeContextMenu:E,onNodeDoubleClick:k,nodeTypes:s,edgeTypes:o,connectionLineType:Y,connectionLineStyle:T,connectionLineComponent:O,connectionLineContainerStyle:j,selectionKeyCode:q,selectionOnDrag:G,selectionMode:W,deleteKeyCode:F,multiSelectionKeyCode:K,panActivationKeyCode:Z,zoomActivationKeyCode:X,onlyRenderVisibleElements:re,defaultViewport:pn,translateExtent:Nt,minZoom:ze,maxZoom:He,preventScrolling:Wa,zoomOnScroll:Ka,zoomOnPinch:Za,zoomOnDoubleClick:tc,panOnScroll:Qa,panOnScrollSpeed:Ja,panOnScrollMode:ec,panOnDrag:nc,onPaneClick:rc,onPaneMouseEnter:ic,onPaneMouseMove:oc,onPaneMouseLeave:sc,onPaneScroll:ac,onPaneContextMenu:cc,paneClickDistance:Qr,nodeClickDistance:uc,onSelectionContextMenu:$,onSelectionStart:z,onSelectionEnd:L,onReconnect:dc,onReconnectStart:fc,onReconnectEnd:hc,onEdgeContextMenu:pc,onEdgeDoubleClick:gc,onEdgeMouseEnter:mc,onEdgeMouseMove:yc,onEdgeMouseLeave:xc,reconnectRadius:wc,defaultMarkerColor:Ua,noDragClassName:_c,noWheelClassName:Ec,noPanClassName:Jr,rfId:mn,disableKeyboardA11y:ni,nodeExtent:gn,viewport:Dc,onViewportChange:zc}),P.jsx(Kh,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:h,onConnectStart:m,onConnectEnd:y,onClickConnectStart:g,onClickConnectEnd:w,nodesDraggable:De,nodesConnectable:dn,nodesFocusable:fn,edgesFocusable:hn,edgesReconnectable:tt,elementsSelectable:nt,elevateNodesOnSelect:Mc,elevateEdgesOnSelect:Ic,minZoom:ze,maxZoom:He,nodeExtent:gn,onNodesChange:vc,onEdgesChange:bc,snapToGrid:Q,snapGrid:J,connectionMode:B,translateExtent:Nt,connectOnClick:Nc,defaultEdgeOptions:Cc,fitView:ei,fitViewOptions:ti,onNodesDelete:C,onEdgesDelete:M,onDelete:I,onNodeDragStart:S,onNodeDrag:_,onNodeDragStop:N,onSelectionDrag:R,onSelectionDragStart:v,onSelectionDragStop:A,onMove:u,onMoveStart:l,onMoveEnd:f,noPanClassName:Jr,nodeOrigin:et,rfId:mn,autoPanOnConnect:Ac,autoPanOnNodeDrag:Tc,autoPanSpeed:Rc,onError:Oc,connectionRadius:Pc,isValidConnection:$c,selectNodesOnDrag:ae,nodeDragThreshold:jc,onBeforeDelete:V,paneClickDistance:Qr,debug:Vc}),P.jsx(Gh,{onSelectionChange:D}),lc,P.jsx(Fh,{proOptions:Sc,position:kc}),P.jsx(zh,{rfId:mn,disableKeyboardA11y:ni})]})})}var j0=ga(vg);function bg({dimensions:e,lineWidth:t,variant:n,className:r}){return P.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:se(["react-flow__background-pattern",n,r])})}function _g({radius:e,className:t}){return P.jsx("circle",{cx:e,cy:e,r:e,className:se(["react-flow__background-pattern","dots",t])})}var Ae;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Ae||(Ae={}));const Eg={[Ae.Dots]:1,[Ae.Lines]:1,[Ae.Cross]:6},Ng=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function za({id:e,variant:t=Ae.Dots,gap:n=20,size:r,lineWidth:i=1,offset:s=0,color:o,bgColor:a,style:c,className:d,patternClassName:u}){const l=H.useRef(null),{transform:f,patternId:h}=ee(Ng,ne),m=r||Eg[t],y=t===Ae.Dots,g=t===Ae.Cross,w=Array.isArray(n)?n:[n,n],b=[w[0]*f[2]||1,w[1]*f[2]||1],p=m*f[2],x=Array.isArray(s)?s:[s,s],E=g?[p,p]:b,k=[x[0]*f[2]||1+E[0]/2,x[1]*f[2]||1+E[1]/2],S=`${h}${e||""}`;return P.jsxs("svg",{className:se(["react-flow__background",d]),style:{...c,...un,"--xy-background-color-props":a,"--xy-background-pattern-color-props":o},ref:l,"data-testid":"rf__background",children:[P.jsx("pattern",{id:S,x:f[0]%b[0],y:f[1]%b[1],width:b[0],height:b[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${k[0]},-${k[1]})`,children:y?P.jsx(_g,{radius:p/2,className:u}):P.jsx(bg,{dimensions:E,lineWidth:i,variant:t,className:u})}),P.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${S})`})]})}za.displayName="Background";const D0=H.memo(za);function kg(){return P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:P.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Sg(){return P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:P.jsx("path",{d:"M0 0h32v4.2H0z"})})}function Cg(){return P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:P.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function Mg(){return P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:P.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Ig(){return P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:P.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function $t({children:e,className:t,...n}){return P.jsx("button",{type:"button",className:se(["react-flow__controls-button",t]),...n,children:e})}const Ag=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function Ha({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:i,onZoomIn:s,onZoomOut:o,onFitView:a,onInteractiveChange:c,className:d,children:u,position:l="bottom-left",orientation:f="vertical","aria-label":h="React Flow controls"}){const m=te(),{isInteractive:y,minZoomReached:g,maxZoomReached:w}=ee(Ag,ne),{zoomIn:b,zoomOut:p,fitView:x}=Xr(),E=()=>{b(),s==null||s()},k=()=>{p(),o==null||o()},S=()=>{x(i),a==null||a()},_=()=>{m.setState({nodesDraggable:!y,nodesConnectable:!y,elementsSelectable:!y}),c==null||c(!y)},N=f==="horizontal"?"horizontal":"vertical";return P.jsxs(cn,{className:se(["react-flow__controls",N,d]),position:l,style:e,"data-testid":"rf__controls","aria-label":h,children:[t&&P.jsxs(P.Fragment,{children:[P.jsx($t,{onClick:E,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:w,children:P.jsx(kg,{})}),P.jsx($t,{onClick:k,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:g,children:P.jsx(Sg,{})})]}),n&&P.jsx($t,{className:"react-flow__controls-fitview",onClick:S,title:"fit view","aria-label":"fit view",children:P.jsx(Cg,{})}),r&&P.jsx($t,{className:"react-flow__controls-interactive",onClick:_,title:"toggle interactivity","aria-label":"toggle interactivity",children:y?P.jsx(Ig,{}):P.jsx(Mg,{})}),u]})}Ha.displayName="Controls";H.memo(Ha);function Tg({id:e,x:t,y:n,width:r,height:i,style:s,color:o,strokeColor:a,strokeWidth:c,className:d,borderRadius:u,shapeRendering:l,selected:f,onClick:h}){const{background:m,backgroundColor:y}=s||{},g=o||m||y;return P.jsx("rect",{className:se(["react-flow__minimap-node",{selected:f},d]),x:t,y:n,rx:u,ry:u,width:r,height:i,style:{fill:g,stroke:a,strokeWidth:c},shapeRendering:l,onClick:h?w=>h(w,e):void 0})}const Rg=H.memo(Tg),Pg=e=>e.nodes.map(t=>t.id),kn=e=>e instanceof Function?e:()=>e;function $g({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:i,nodeComponent:s=Rg,onClick:o}){const a=ee(Pg,ne),c=kn(t),d=kn(e),u=kn(n),l=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return P.jsx(P.Fragment,{children:a.map(f=>P.jsx(Lg,{id:f,nodeColorFunc:c,nodeStrokeColorFunc:d,nodeClassNameFunc:u,nodeBorderRadius:r,nodeStrokeWidth:i,NodeComponent:s,onClick:o,shapeRendering:l},f))})}function Og({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:i,nodeStrokeWidth:s,shapeRendering:o,NodeComponent:a,onClick:c}){const{node:d,x:u,y:l,width:f,height:h}=ee(m=>{const{internals:y}=m.nodeLookup.get(e),g=y.userNode,{x:w,y:b}=y.positionAbsolute,{width:p,height:x}=Ne(g);return{node:g,x:w,y:b,width:p,height:x}},ne);return!d||d.hidden||!qs(d)?null:P.jsx(a,{x:u,y:l,width:f,height:h,style:d.style,selected:!!d.selected,className:r(d),color:t(d),borderRadius:i,strokeColor:n(d),strokeWidth:s,shapeRendering:o,onClick:c,id:d.id})}const Lg=H.memo(Og);var jg=H.memo($g);const Dg=200,zg=150,Hg=e=>!e.hidden,Fg=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?Vs(_t(e.nodeLookup,{filter:Hg}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}},Bg="react-flow__minimap-desc";function Fa({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:i="",nodeBorderRadius:s=5,nodeStrokeWidth:o,nodeComponent:a,bgColor:c,maskColor:d,maskStrokeColor:u,maskStrokeWidth:l,position:f="bottom-right",onClick:h,onNodeClick:m,pannable:y=!1,zoomable:g=!1,ariaLabel:w="React Flow mini map",inversePan:b,zoomStep:p=10,offsetScale:x=5}){const E=te(),k=H.useRef(null),{boundingRect:S,viewBB:_,rfId:N,panZoom:C,translateExtent:M,flowWidth:I,flowHeight:D}=ee(Fg,ne),v=(e==null?void 0:e.width)??Dg,R=(e==null?void 0:e.height)??zg,A=S.width/v,$=S.height/R,z=Math.max(A,$),L=z*v,V=z*R,B=x*z,Y=S.x-(L-S.width)/2-B,T=S.y-(V-S.height)/2-B,O=L+B*2,j=V+B*2,F=`${Bg}-${N}`,q=H.useRef(0),G=H.useRef();q.current=z,H.useEffect(()=>{if(k.current&&C)return G.current=fh({domNode:k.current,panZoom:C,getTransform:()=>E.getState().transform,getViewScale:()=>q.current}),()=>{var K;(K=G.current)==null||K.destroy()}},[C]),H.useEffect(()=>{var K;(K=G.current)==null||K.update({translateExtent:M,width:I,height:D,inversePan:b,pannable:y,zoomStep:p,zoomable:g})},[y,g,b,p,M,I,D]);const W=h?K=>{var J;const[X,Q]=((J=G.current)==null?void 0:J.pointer(K))||[0,0];h(K,{x:X,y:Q})}:void 0,Z=m?H.useCallback((K,X)=>{const Q=E.getState().nodeLookup.get(X).internals.userNode;m(K,Q)},[]):void 0;return P.jsx(cn,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof d=="string"?d:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof l=="number"?l*z:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof o=="number"?o:void 0},className:se(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:P.jsxs("svg",{width:v,height:R,viewBox:`${Y} ${T} ${O} ${j}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":F,ref:k,onClick:W,children:[w&&P.jsx("title",{id:F,children:w}),P.jsx(jg,{onClick:Z,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:i,nodeStrokeWidth:o,nodeComponent:a}),P.jsx("path",{className:"react-flow__minimap-mask",d:`M${Y-B},${T-B}h${O+B*2}v${j+B*2}h${-O-B*2}z
        M${_.x},${_.y}h${_.width}v${_.height}h${-_.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}Fa.displayName="MiniMap";H.memo(Fa);function Vg({nodeId:e,position:t,variant:n=ct.Handle,className:r,style:i={},children:s,color:o,minWidth:a=10,minHeight:c=10,maxWidth:d=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:l=!1,resizeDirection:f,shouldResize:h,onResizeStart:m,onResize:y,onResizeEnd:g}){const w=wa(),b=typeof e=="string"?e:w,p=te(),x=H.useRef(null),E=n===ct.Line?"right":"bottom-right",k=t??E,S=H.useRef(null);H.useEffect(()=>{if(!(!x.current||!b))return S.current||(S.current=Ch({domNode:x.current,nodeId:b,getStoreItems:()=>{const{nodeLookup:M,transform:I,snapGrid:D,snapToGrid:v,nodeOrigin:R,domNode:A}=p.getState();return{nodeLookup:M,transform:I,snapGrid:D,snapToGrid:v,nodeOrigin:R,paneDomNode:A}},onChange:(M,I)=>{const{triggerNodeChanges:D,nodeLookup:v,parentLookup:R,nodeOrigin:A}=p.getState(),$=[],z={x:M.x,y:M.y},L=v.get(b);if(L&&L.expandParent&&L.parentId){const V=L.origin??A,B=M.width??L.measured.width??0,Y=M.height??L.measured.height??0,T={id:L.id,parentId:L.parentId,rect:{width:B,height:Y,...Ys({x:M.x??L.position.x,y:M.y??L.position.y},{width:B,height:Y},L.parentId,v,V)}},O=Gr([T],v,R,A);$.push(...O),z.x=M.x?Math.max(V[0]*B,M.x):void 0,z.y=M.y?Math.max(V[1]*Y,M.y):void 0}if(z.x!==void 0&&z.y!==void 0){const V={id:b,type:"position",position:{...z}};$.push(V)}if(M.width!==void 0&&M.height!==void 0){const B={id:b,type:"dimensions",resizing:!0,setAttributes:f?f==="horizontal"?"width":"height":!0,dimensions:{width:M.width,height:M.height}};$.push(B)}for(const V of I){const B={...V,type:"position"};$.push(B)}D($)},onEnd:({width:M,height:I})=>{const D={id:b,type:"dimensions",resizing:!1,dimensions:{width:M,height:I}};p.getState().triggerNodeChanges([D])}})),S.current.update({controlPosition:k,boundaries:{minWidth:a,minHeight:c,maxWidth:d,maxHeight:u},keepAspectRatio:l,resizeDirection:f,onResizeStart:m,onResize:y,onResizeEnd:g,shouldResize:h}),()=>{var M;(M=S.current)==null||M.destroy()}},[k,a,c,d,u,l,m,y,g,h]);const _=k.split("-"),N=n===ct.Line?"borderColor":"backgroundColor",C=o?{...i,[N]:o}:i;return P.jsx("div",{className:se(["react-flow__resize-control","nodrag",..._,n,r]),ref:x,style:C,children:s})}H.memo(Vg);const Pr=1.5,Je=1,Ur=.5,Kr=1.5,ao=({sx:e,...t})=>P.jsx(pe,{sx:{position:"absolute",inset:0,pointerEvents:"none",borderRadius:Kr*1.5,...e},...t}),co=({sx:e,...t})=>P.jsx(pe,{sx:{position:"absolute",inset:0,pointerEvents:"none",bgcolor:"primary.main",...e},...t}),qg=H.memo(({tableName:e,tableType:t,hueIndex:n})=>P.jsxs(pe,{sx:{position:"relative",borderRadius:Kr,borderBottomLeftRadius:0,borderBottomRightRadius:0,overflow:"hidden",p:Pr,py:Je},children:[P.jsx(co,{sx:{filter:`hue-rotate(${n*20}deg)`,opacity:.35}}),P.jsxs(pe,{sx:{display:"flex",alignItems:"flex-end",gap:Je,position:"relative"},children:[P.jsx(Jc,{sx:{color:"text.primary",fontSize:"1.2rem"}}),P.jsx(Ie,{variant:"body1",component:"h6",sx:{lineHeight:1,...qe},children:e}),P.jsx(pe,{sx:{flexGrow:1}}),P.jsx(Ie,{variant:"caption",sx:{lineHeight:1,alignSelf:"center",p:Ur,bgcolor:"background.paper",borderRadius:1,textTransform:"uppercase"},children:t})]}),P.jsx(co,{sx:{filter:`hue-rotate(${n*20}deg)`,opacity:.35}})]})),Yg=H.memo(()=>P.jsxs(pe,{sx:{position:"relative",display:"flex",alignItems:"center",justifyContent:"space-between",gap:Je,p:Je,my:Ur},children:[P.jsx(Ie,{variant:"body2",sx:{...qe,opacity:.85},children:"名稱"}),P.jsxs(pe,{sx:{display:"flex",alignItems:"center"},children:[P.jsx(Ie,{variant:"body2",sx:{opacity:.85,width:"5rem",textAlign:"end",...qe},children:"型別"}),P.jsx(Ie,{variant:"body2",sx:{opacity:.85,width:"3rem",textAlign:"end",...qe},children:"空值"})]}),P.jsx(pe,{sx:{position:"absolute",inset:0,pointerEvents:"none",borderRadius:1,bgcolor:"divider",opacity:.5}})]})),uo={color:"text.secondary",opacity:.85,textAlign:"end",...qe},Gg=H.memo(({fieldName:e,fieldType:t,nullable:n})=>P.jsxs(P.Fragment,{children:[P.jsx(Ie,{variant:"body2",sx:{...qe,opacity:.85},children:e}),P.jsxs(pe,{sx:{display:"flex",alignItems:"center"},children:[P.jsx(Ie,{variant:"caption",sx:{textTransform:"uppercase",width:"5rem",...uo},children:t}),P.jsx(Ie,{variant:"caption",sx:{width:"3rem",...uo},children:{yes:"可",no:"否",pk:"主鍵"}[n]})]})]})),z0=({selected:e,data:t})=>P.jsxs(pe,{sx:{cursor:"move",width:300,p:Ur,borderRadius:Kr*1.5,bgcolor:"background.paper"},children:[P.jsx(ao,{sx:{boxShadow:2,opacity:.35}}),P.jsx(ao,{sx:{outline:e?2:1,outlineColor:e?"primary.main":"divider",filter:`hue-rotate(${t.hueIndex*20}deg)`,opacity:.85}}),P.jsx(qg,{tableName:t.tableName,tableType:t.tableType,hueIndex:t.hueIndex}),P.jsx(Yg,{}),P.jsx(Zc,{sx:{gap:Pr,alignItems:"stretch",p:Pr,pt:Je},children:t.fields.map(({fieldName:n,fieldType:r,nullable:i,isSource:s,isTarget:o},a)=>P.jsxs(pe,{sx:{position:"relative",display:"flex",alignItems:"center",justifyContent:"space-between",gap:Je},children:[P.jsx(Gg,{fieldName:n,fieldType:r,nullable:i}),o&&P.jsx(Oe,{id:n,type:"target",position:U.Left,style:{marginLeft:`calc(var(--mui-spacing) * ${-1.5})`,opacity:0,pointerEvents:"none"}}),o&&P.jsx(Oe,{id:n+"_self",type:"target",position:U.Right,style:{marginRight:`calc(var(--mui-spacing) * ${-1.5})`,opacity:0,pointerEvents:"none"}}),s&&P.jsx(Oe,{id:n,type:"source",position:U.Right,style:{marginRight:"calc(var(--mui-spacing) * -2)",width:`calc(var(--mui-spacing) * ${1.5})`,height:"auto",aspectRatio:"1/1",background:"var(--mui-palette-background-paper)",border:"1px solid var(--mui-palette-divider)",boxShadow:"var(--mui-shadows-1)",pointerEvents:"none"}})]},a))})]});var Sn,lo;function Zr(){if(lo)return Sn;lo=1;var e="\0",t="\0",n="";class r{constructor(u){ie(this,"_isDirected",!0);ie(this,"_isMultigraph",!1);ie(this,"_isCompound",!1);ie(this,"_label");ie(this,"_defaultNodeLabelFn",()=>{});ie(this,"_defaultEdgeLabelFn",()=>{});ie(this,"_nodes",{});ie(this,"_in",{});ie(this,"_preds",{});ie(this,"_out",{});ie(this,"_sucs",{});ie(this,"_edgeObjs",{});ie(this,"_edgeLabels",{});ie(this,"_nodeCount",0);ie(this,"_edgeCount",0);ie(this,"_parent");ie(this,"_children");u&&(this._isDirected=Object.hasOwn(u,"directed")?u.directed:!0,this._isMultigraph=Object.hasOwn(u,"multigraph")?u.multigraph:!1,this._isCompound=Object.hasOwn(u,"compound")?u.compound:!1),this._isCompound&&(this._parent={},this._children={},this._children[t]={})}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(u){return this._label=u,this}graph(){return this._label}setDefaultNodeLabel(u){return this._defaultNodeLabelFn=u,typeof u!="function"&&(this._defaultNodeLabelFn=()=>u),this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var u=this;return this.nodes().filter(l=>Object.keys(u._in[l]).length===0)}sinks(){var u=this;return this.nodes().filter(l=>Object.keys(u._out[l]).length===0)}setNodes(u,l){var f=arguments,h=this;return u.forEach(function(m){f.length>1?h.setNode(m,l):h.setNode(m)}),this}setNode(u,l){return Object.hasOwn(this._nodes,u)?(arguments.length>1&&(this._nodes[u]=l),this):(this._nodes[u]=arguments.length>1?l:this._defaultNodeLabelFn(u),this._isCompound&&(this._parent[u]=t,this._children[u]={},this._children[t][u]=!0),this._in[u]={},this._preds[u]={},this._out[u]={},this._sucs[u]={},++this._nodeCount,this)}node(u){return this._nodes[u]}hasNode(u){return Object.hasOwn(this._nodes,u)}removeNode(u){var l=this;if(Object.hasOwn(this._nodes,u)){var f=h=>l.removeEdge(l._edgeObjs[h]);delete this._nodes[u],this._isCompound&&(this._removeFromParentsChildList(u),delete this._parent[u],this.children(u).forEach(function(h){l.setParent(h)}),delete this._children[u]),Object.keys(this._in[u]).forEach(f),delete this._in[u],delete this._preds[u],Object.keys(this._out[u]).forEach(f),delete this._out[u],delete this._sucs[u],--this._nodeCount}return this}setParent(u,l){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(l===void 0)l=t;else{l+="";for(var f=l;f!==void 0;f=this.parent(f))if(f===u)throw new Error("Setting "+l+" as parent of "+u+" would create a cycle");this.setNode(l)}return this.setNode(u),this._removeFromParentsChildList(u),this._parent[u]=l,this._children[l][u]=!0,this}_removeFromParentsChildList(u){delete this._children[this._parent[u]][u]}parent(u){if(this._isCompound){var l=this._parent[u];if(l!==t)return l}}children(u=t){if(this._isCompound){var l=this._children[u];if(l)return Object.keys(l)}else{if(u===t)return this.nodes();if(this.hasNode(u))return[]}}predecessors(u){var l=this._preds[u];if(l)return Object.keys(l)}successors(u){var l=this._sucs[u];if(l)return Object.keys(l)}neighbors(u){var l=this.predecessors(u);if(l){const h=new Set(l);for(var f of this.successors(u))h.add(f);return Array.from(h.values())}}isLeaf(u){var l;return this.isDirected()?l=this.successors(u):l=this.neighbors(u),l.length===0}filterNodes(u){var l=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});l.setGraph(this.graph());var f=this;Object.entries(this._nodes).forEach(function([y,g]){u(y)&&l.setNode(y,g)}),Object.values(this._edgeObjs).forEach(function(y){l.hasNode(y.v)&&l.hasNode(y.w)&&l.setEdge(y,f.edge(y))});var h={};function m(y){var g=f.parent(y);return g===void 0||l.hasNode(g)?(h[y]=g,g):g in h?h[g]:m(g)}return this._isCompound&&l.nodes().forEach(y=>l.setParent(y,m(y))),l}setDefaultEdgeLabel(u){return this._defaultEdgeLabelFn=u,typeof u!="function"&&(this._defaultEdgeLabelFn=()=>u),this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(u,l){var f=this,h=arguments;return u.reduce(function(m,y){return h.length>1?f.setEdge(m,y,l):f.setEdge(m,y),y}),this}setEdge(){var u,l,f,h,m=!1,y=arguments[0];typeof y=="object"&&y!==null&&"v"in y?(u=y.v,l=y.w,f=y.name,arguments.length===2&&(h=arguments[1],m=!0)):(u=y,l=arguments[1],f=arguments[3],arguments.length>2&&(h=arguments[2],m=!0)),u=""+u,l=""+l,f!==void 0&&(f=""+f);var g=o(this._isDirected,u,l,f);if(Object.hasOwn(this._edgeLabels,g))return m&&(this._edgeLabels[g]=h),this;if(f!==void 0&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(u),this.setNode(l),this._edgeLabels[g]=m?h:this._defaultEdgeLabelFn(u,l,f);var w=a(this._isDirected,u,l,f);return u=w.v,l=w.w,Object.freeze(w),this._edgeObjs[g]=w,i(this._preds[l],u),i(this._sucs[u],l),this._in[l][g]=w,this._out[u][g]=w,this._edgeCount++,this}edge(u,l,f){var h=arguments.length===1?c(this._isDirected,arguments[0]):o(this._isDirected,u,l,f);return this._edgeLabels[h]}edgeAsObj(){const u=this.edge(...arguments);return typeof u!="object"?{label:u}:u}hasEdge(u,l,f){var h=arguments.length===1?c(this._isDirected,arguments[0]):o(this._isDirected,u,l,f);return Object.hasOwn(this._edgeLabels,h)}removeEdge(u,l,f){var h=arguments.length===1?c(this._isDirected,arguments[0]):o(this._isDirected,u,l,f),m=this._edgeObjs[h];return m&&(u=m.v,l=m.w,delete this._edgeLabels[h],delete this._edgeObjs[h],s(this._preds[l],u),s(this._sucs[u],l),delete this._in[l][h],delete this._out[u][h],this._edgeCount--),this}inEdges(u,l){var f=this._in[u];if(f){var h=Object.values(f);return l?h.filter(m=>m.v===l):h}}outEdges(u,l){var f=this._out[u];if(f){var h=Object.values(f);return l?h.filter(m=>m.w===l):h}}nodeEdges(u,l){var f=this.inEdges(u,l);if(f)return f.concat(this.outEdges(u,l))}}function i(d,u){d[u]?d[u]++:d[u]=1}function s(d,u){--d[u]||delete d[u]}function o(d,u,l,f){var h=""+u,m=""+l;if(!d&&h>m){var y=h;h=m,m=y}return h+n+m+n+(f===void 0?e:f)}function a(d,u,l,f){var h=""+u,m=""+l;if(!d&&h>m){var y=h;h=m,m=y}var g={v:h,w:m};return f&&(g.name=f),g}function c(d,u){return o(d,u.v,u.w,u.name)}return Sn=r,Sn}var Cn,fo;function Xg(){return fo||(fo=1,Cn="2.2.4"),Cn}var Mn,ho;function Wg(){return ho||(ho=1,Mn={Graph:Zr(),version:Xg()}),Mn}var In,po;function Ug(){if(po)return In;po=1;var e=Zr();In={write:t,read:i};function t(s){var o={options:{directed:s.isDirected(),multigraph:s.isMultigraph(),compound:s.isCompound()},nodes:n(s),edges:r(s)};return s.graph()!==void 0&&(o.value=structuredClone(s.graph())),o}function n(s){return s.nodes().map(function(o){var a=s.node(o),c=s.parent(o),d={v:o};return a!==void 0&&(d.value=a),c!==void 0&&(d.parent=c),d})}function r(s){return s.edges().map(function(o){var a=s.edge(o),c={v:o.v,w:o.w};return o.name!==void 0&&(c.name=o.name),a!==void 0&&(c.value=a),c})}function i(s){var o=new e(s.options).setGraph(s.value);return s.nodes.forEach(function(a){o.setNode(a.v,a.value),a.parent&&o.setParent(a.v,a.parent)}),s.edges.forEach(function(a){o.setEdge({v:a.v,w:a.w,name:a.name},a.value)}),o}return In}var An,go;function Kg(){if(go)return An;go=1,An=e;function e(t){var n={},r=[],i;function s(o){Object.hasOwn(n,o)||(n[o]=!0,i.push(o),t.successors(o).forEach(s),t.predecessors(o).forEach(s))}return t.nodes().forEach(function(o){i=[],s(o),i.length&&r.push(i)}),r}return An}var Tn,mo;function Ba(){if(mo)return Tn;mo=1;class e{constructor(){ie(this,"_arr",[]);ie(this,"_keyIndices",{})}size(){return this._arr.length}keys(){return this._arr.map(function(n){return n.key})}has(n){return Object.hasOwn(this._keyIndices,n)}priority(n){var r=this._keyIndices[n];if(r!==void 0)return this._arr[r].priority}min(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key}add(n,r){var i=this._keyIndices;if(n=String(n),!Object.hasOwn(i,n)){var s=this._arr,o=s.length;return i[n]=o,s.push({key:n,priority:r}),this._decrease(o),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var n=this._arr.pop();return delete this._keyIndices[n.key],this._heapify(0),n.key}decrease(n,r){var i=this._keyIndices[n];if(r>this._arr[i].priority)throw new Error("New priority is greater than current priority. Key: "+n+" Old: "+this._arr[i].priority+" New: "+r);this._arr[i].priority=r,this._decrease(i)}_heapify(n){var r=this._arr,i=2*n,s=i+1,o=n;i<r.length&&(o=r[i].priority<r[o].priority?i:o,s<r.length&&(o=r[s].priority<r[o].priority?s:o),o!==n&&(this._swap(n,o),this._heapify(o)))}_decrease(n){for(var r=this._arr,i=r[n].priority,s;n!==0&&(s=n>>1,!(r[s].priority<i));)this._swap(n,s),n=s}_swap(n,r){var i=this._arr,s=this._keyIndices,o=i[n],a=i[r];i[n]=a,i[r]=o,s[a.key]=n,s[o.key]=r}}return Tn=e,Tn}var Rn,yo;function Va(){if(yo)return Rn;yo=1;var e=Ba();Rn=n;var t=()=>1;function n(i,s,o,a){return r(i,String(s),o||t,a||function(c){return i.outEdges(c)})}function r(i,s,o,a){var c={},d=new e,u,l,f=function(h){var m=h.v!==u?h.v:h.w,y=c[m],g=o(h),w=l.distance+g;if(g<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+h+" Weight: "+g);w<y.distance&&(y.distance=w,y.predecessor=u,d.decrease(m,w))};for(i.nodes().forEach(function(h){var m=h===s?0:Number.POSITIVE_INFINITY;c[h]={distance:m},d.add(h,m)});d.size()>0&&(u=d.removeMin(),l=c[u],l.distance!==Number.POSITIVE_INFINITY);)a(u).forEach(f);return c}return Rn}var Pn,xo;function Zg(){if(xo)return Pn;xo=1;var e=Va();Pn=t;function t(n,r,i){return n.nodes().reduce(function(s,o){return s[o]=e(n,o,r,i),s},{})}return Pn}var $n,wo;function qa(){if(wo)return $n;wo=1,$n=e;function e(t){var n=0,r=[],i={},s=[];function o(a){var c=i[a]={onStack:!0,lowlink:n,index:n++};if(r.push(a),t.successors(a).forEach(function(l){Object.hasOwn(i,l)?i[l].onStack&&(c.lowlink=Math.min(c.lowlink,i[l].index)):(o(l),c.lowlink=Math.min(c.lowlink,i[l].lowlink))}),c.lowlink===c.index){var d=[],u;do u=r.pop(),i[u].onStack=!1,d.push(u);while(a!==u);s.push(d)}}return t.nodes().forEach(function(a){Object.hasOwn(i,a)||o(a)}),s}return $n}var On,vo;function Qg(){if(vo)return On;vo=1;var e=qa();On=t;function t(n){return e(n).filter(function(r){return r.length>1||r.length===1&&n.hasEdge(r[0],r[0])})}return On}var Ln,bo;function Jg(){if(bo)return Ln;bo=1,Ln=t;var e=()=>1;function t(r,i,s){return n(r,i||e,s||function(o){return r.outEdges(o)})}function n(r,i,s){var o={},a=r.nodes();return a.forEach(function(c){o[c]={},o[c][c]={distance:0},a.forEach(function(d){c!==d&&(o[c][d]={distance:Number.POSITIVE_INFINITY})}),s(c).forEach(function(d){var u=d.v===c?d.w:d.v,l=i(d);o[c][u]={distance:l,predecessor:c}})}),a.forEach(function(c){var d=o[c];a.forEach(function(u){var l=o[u];a.forEach(function(f){var h=l[c],m=d[f],y=l[f],g=h.distance+m.distance;g<y.distance&&(y.distance=g,y.predecessor=m.predecessor)})})}),o}return Ln}var jn,_o;function Ya(){if(_o)return jn;_o=1;function e(n){var r={},i={},s=[];function o(a){if(Object.hasOwn(i,a))throw new t;Object.hasOwn(r,a)||(i[a]=!0,r[a]=!0,n.predecessors(a).forEach(o),delete i[a],s.push(a))}if(n.sinks().forEach(o),Object.keys(r).length!==n.nodeCount())throw new t;return s}class t extends Error{constructor(){super(...arguments)}}return jn=e,e.CycleException=t,jn}var Dn,Eo;function e0(){if(Eo)return Dn;Eo=1;var e=Ya();Dn=t;function t(n){try{e(n)}catch(r){if(r instanceof e.CycleException)return!1;throw r}return!0}return Dn}var zn,No;function Ga(){if(No)return zn;No=1,zn=e;function e(i,s,o){Array.isArray(s)||(s=[s]);var a=i.isDirected()?l=>i.successors(l):l=>i.neighbors(l),c=o==="post"?t:n,d=[],u={};return s.forEach(l=>{if(!i.hasNode(l))throw new Error("Graph does not have node: "+l);c(l,a,u,d)}),d}function t(i,s,o,a){for(var c=[[i,!1]];c.length>0;){var d=c.pop();d[1]?a.push(d[0]):Object.hasOwn(o,d[0])||(o[d[0]]=!0,c.push([d[0],!0]),r(s(d[0]),u=>c.push([u,!1])))}}function n(i,s,o,a){for(var c=[i];c.length>0;){var d=c.pop();Object.hasOwn(o,d)||(o[d]=!0,a.push(d),r(s(d),u=>c.push(u)))}}function r(i,s){for(var o=i.length;o--;)s(i[o],o,i);return i}return zn}var Hn,ko;function t0(){if(ko)return Hn;ko=1;var e=Ga();Hn=t;function t(n,r){return e(n,r,"post")}return Hn}var Fn,So;function n0(){if(So)return Fn;So=1;var e=Ga();Fn=t;function t(n,r){return e(n,r,"pre")}return Fn}var Bn,Co;function r0(){if(Co)return Bn;Co=1;var e=Zr(),t=Ba();Bn=n;function n(r,i){var s=new e,o={},a=new t,c;function d(l){var f=l.v===c?l.w:l.v,h=a.priority(f);if(h!==void 0){var m=i(l);m<h&&(o[f]=c,a.decrease(f,m))}}if(r.nodeCount()===0)return s;r.nodes().forEach(function(l){a.add(l,Number.POSITIVE_INFINITY),s.setNode(l)}),a.decrease(r.nodes()[0],0);for(var u=!1;a.size()>0;){if(c=a.removeMin(),Object.hasOwn(o,c))s.setEdge(c,o[c]);else{if(u)throw new Error("Input graph is not connected: "+r);u=!0}r.nodeEdges(c).forEach(d)}return s}return Bn}var Vn,Mo;function i0(){return Mo||(Mo=1,Vn={components:Kg(),dijkstra:Va(),dijkstraAll:Zg(),findCycles:Qg(),floydWarshall:Jg(),isAcyclic:e0(),postorder:t0(),preorder:n0(),prim:r0(),tarjan:qa(),topsort:Ya()}),Vn}var qn,Io;function ge(){if(Io)return qn;Io=1;var e=Wg();return qn={Graph:e.Graph,json:Ug(),alg:i0(),version:e.version},qn}var Yn,Ao;function o0(){if(Ao)return Yn;Ao=1;class e{constructor(){let i={};i._next=i._prev=i,this._sentinel=i}dequeue(){let i=this._sentinel,s=i._prev;if(s!==i)return t(s),s}enqueue(i){let s=this._sentinel;i._prev&&i._next&&t(i),i._next=s._next,s._next._prev=i,s._next=i,i._prev=s}toString(){let i=[],s=this._sentinel,o=s._prev;for(;o!==s;)i.push(JSON.stringify(o,n)),o=o._prev;return"["+i.join(", ")+"]"}}function t(r){r._prev._next=r._next,r._next._prev=r._prev,delete r._next,delete r._prev}function n(r,i){if(r!=="_next"&&r!=="_prev")return i}return Yn=e,Yn}var Gn,To;function s0(){if(To)return Gn;To=1;let e=ge().Graph,t=o0();Gn=r;let n=()=>1;function r(d,u){if(d.nodeCount()<=1)return[];let l=o(d,u||n);return i(l.graph,l.buckets,l.zeroIdx).flatMap(h=>d.outEdges(h.v,h.w))}function i(d,u,l){let f=[],h=u[u.length-1],m=u[0],y;for(;d.nodeCount();){for(;y=m.dequeue();)s(d,u,l,y);for(;y=h.dequeue();)s(d,u,l,y);if(d.nodeCount()){for(let g=u.length-2;g>0;--g)if(y=u[g].dequeue(),y){f=f.concat(s(d,u,l,y,!0));break}}}return f}function s(d,u,l,f,h){let m=h?[]:void 0;return d.inEdges(f.v).forEach(y=>{let g=d.edge(y),w=d.node(y.v);h&&m.push({v:y.v,w:y.w}),w.out-=g,a(u,l,w)}),d.outEdges(f.v).forEach(y=>{let g=d.edge(y),w=y.w,b=d.node(w);b.in-=g,a(u,l,b)}),d.removeNode(f.v),m}function o(d,u){let l=new e,f=0,h=0;d.nodes().forEach(g=>{l.setNode(g,{v:g,in:0,out:0})}),d.edges().forEach(g=>{let w=l.edge(g.v,g.w)||0,b=u(g),p=w+b;l.setEdge(g.v,g.w,p),h=Math.max(h,l.node(g.v).out+=b),f=Math.max(f,l.node(g.w).in+=b)});let m=c(h+f+3).map(()=>new t),y=f+1;return l.nodes().forEach(g=>{a(m,y,l.node(g))}),{graph:l,buckets:m,zeroIdx:y}}function a(d,u,l){l.out?l.in?d[l.out-l.in+u].enqueue(l):d[d.length-1].enqueue(l):d[0].enqueue(l)}function c(d){const u=[];for(let l=0;l<d;l++)u.push(l);return u}return Gn}var Xn,Ro;function oe(){if(Ro)return Xn;Ro=1;let e=ge().Graph;Xn={addBorderNode:u,addDummyNode:t,applyWithChunking:h,asNonCompoundGraph:r,buildLayerMatrix:a,intersectRect:o,mapValues:k,maxRank:m,normalizeRanks:c,notime:w,partition:y,pick:E,predecessorWeights:s,range:x,removeEmptyRanks:d,simplify:n,successorWeights:i,time:g,uniqueId:p,zipObject:S};function t(_,N,C,M){let I;do I=p(M);while(_.hasNode(I));return C.dummy=N,_.setNode(I,C),I}function n(_){let N=new e().setGraph(_.graph());return _.nodes().forEach(C=>N.setNode(C,_.node(C))),_.edges().forEach(C=>{let M=N.edge(C.v,C.w)||{weight:0,minlen:1},I=_.edge(C);N.setEdge(C.v,C.w,{weight:M.weight+I.weight,minlen:Math.max(M.minlen,I.minlen)})}),N}function r(_){let N=new e({multigraph:_.isMultigraph()}).setGraph(_.graph());return _.nodes().forEach(C=>{_.children(C).length||N.setNode(C,_.node(C))}),_.edges().forEach(C=>{N.setEdge(C,_.edge(C))}),N}function i(_){let N=_.nodes().map(C=>{let M={};return _.outEdges(C).forEach(I=>{M[I.w]=(M[I.w]||0)+_.edge(I).weight}),M});return S(_.nodes(),N)}function s(_){let N=_.nodes().map(C=>{let M={};return _.inEdges(C).forEach(I=>{M[I.v]=(M[I.v]||0)+_.edge(I).weight}),M});return S(_.nodes(),N)}function o(_,N){let C=_.x,M=_.y,I=N.x-C,D=N.y-M,v=_.width/2,R=_.height/2;if(!I&&!D)throw new Error("Not possible to find intersection inside of the rectangle");let A,$;return Math.abs(D)*v>Math.abs(I)*R?(D<0&&(R=-R),A=R*I/D,$=R):(I<0&&(v=-v),A=v,$=v*D/I),{x:C+A,y:M+$}}function a(_){let N=x(m(_)+1).map(()=>[]);return _.nodes().forEach(C=>{let M=_.node(C),I=M.rank;I!==void 0&&(N[I][M.order]=C)}),N}function c(_){let N=_.nodes().map(M=>{let I=_.node(M).rank;return I===void 0?Number.MAX_VALUE:I}),C=h(Math.min,N);_.nodes().forEach(M=>{let I=_.node(M);Object.hasOwn(I,"rank")&&(I.rank-=C)})}function d(_){let N=_.nodes().map(v=>_.node(v).rank),C=h(Math.min,N),M=[];_.nodes().forEach(v=>{let R=_.node(v).rank-C;M[R]||(M[R]=[]),M[R].push(v)});let I=0,D=_.graph().nodeRankFactor;Array.from(M).forEach((v,R)=>{v===void 0&&R%D!==0?--I:v!==void 0&&I&&v.forEach(A=>_.node(A).rank+=I)})}function u(_,N,C,M){let I={width:0,height:0};return arguments.length>=4&&(I.rank=C,I.order=M),t(_,"border",I,N)}function l(_,N=f){const C=[];for(let M=0;M<_.length;M+=N){const I=_.slice(M,M+N);C.push(I)}return C}const f=65535;function h(_,N){if(N.length>f){const C=l(N);return _.apply(null,C.map(M=>_.apply(null,M)))}else return _.apply(null,N)}function m(_){const C=_.nodes().map(M=>{let I=_.node(M).rank;return I===void 0?Number.MIN_VALUE:I});return h(Math.max,C)}function y(_,N){let C={lhs:[],rhs:[]};return _.forEach(M=>{N(M)?C.lhs.push(M):C.rhs.push(M)}),C}function g(_,N){let C=Date.now();try{return N()}finally{console.log(_+" time: "+(Date.now()-C)+"ms")}}function w(_,N){return N()}let b=0;function p(_){var N=++b;return toString(_)+N}function x(_,N,C=1){N==null&&(N=_,_=0);let M=D=>D<N;C<0&&(M=D=>N<D);const I=[];for(let D=_;M(D);D+=C)I.push(D);return I}function E(_,N){const C={};for(const M of N)_[M]!==void 0&&(C[M]=_[M]);return C}function k(_,N){let C=N;return typeof N=="string"&&(C=M=>M[N]),Object.entries(_).reduce((M,[I,D])=>(M[I]=C(D,I),M),{})}function S(_,N){return _.reduce((C,M,I)=>(C[M]=N[I],C),{})}return Xn}var Wn,Po;function a0(){if(Po)return Wn;Po=1;let e=s0(),t=oe().uniqueId;Wn={run:n,undo:i};function n(s){(s.graph().acyclicer==="greedy"?e(s,a(s)):r(s)).forEach(c=>{let d=s.edge(c);s.removeEdge(c),d.forwardName=c.name,d.reversed=!0,s.setEdge(c.w,c.v,d,t("rev"))});function a(c){return d=>c.edge(d).weight}}function r(s){let o=[],a={},c={};function d(u){Object.hasOwn(c,u)||(c[u]=!0,a[u]=!0,s.outEdges(u).forEach(l=>{Object.hasOwn(a,l.w)?o.push(l):d(l.w)}),delete a[u])}return s.nodes().forEach(d),o}function i(s){s.edges().forEach(o=>{let a=s.edge(o);if(a.reversed){s.removeEdge(o);let c=a.forwardName;delete a.reversed,delete a.forwardName,s.setEdge(o.w,o.v,a,c)}})}return Wn}var Un,$o;function c0(){if($o)return Un;$o=1;let e=oe();Un={run:t,undo:r};function t(i){i.graph().dummyChains=[],i.edges().forEach(s=>n(i,s))}function n(i,s){let o=s.v,a=i.node(o).rank,c=s.w,d=i.node(c).rank,u=s.name,l=i.edge(s),f=l.labelRank;if(d===a+1)return;i.removeEdge(s);let h,m,y;for(y=0,++a;a<d;++y,++a)l.points=[],m={width:0,height:0,edgeLabel:l,edgeObj:s,rank:a},h=e.addDummyNode(i,"edge",m,"_d"),a===f&&(m.width=l.width,m.height=l.height,m.dummy="edge-label",m.labelpos=l.labelpos),i.setEdge(o,h,{weight:l.weight},u),y===0&&i.graph().dummyChains.push(h),o=h;i.setEdge(o,c,{weight:l.weight},u)}function r(i){i.graph().dummyChains.forEach(s=>{let o=i.node(s),a=o.edgeLabel,c;for(i.setEdge(o.edgeObj,a);o.dummy;)c=i.successors(s)[0],i.removeNode(s),a.points.push({x:o.x,y:o.y}),o.dummy==="edge-label"&&(a.x=o.x,a.y=o.y,a.width=o.width,a.height=o.height),s=c,o=i.node(s)})}return Un}var Kn,Oo;function Kt(){if(Oo)return Kn;Oo=1;const{applyWithChunking:e}=oe();Kn={longestPath:t,slack:n};function t(r){var i={};function s(o){var a=r.node(o);if(Object.hasOwn(i,o))return a.rank;i[o]=!0;let c=r.outEdges(o).map(u=>u==null?Number.POSITIVE_INFINITY:s(u.w)-r.edge(u).minlen);var d=e(Math.min,c);return d===Number.POSITIVE_INFINITY&&(d=0),a.rank=d}r.sources().forEach(s)}function n(r,i){return r.node(i.w).rank-r.node(i.v).rank-r.edge(i).minlen}return Kn}var Zn,Lo;function Xa(){if(Lo)return Zn;Lo=1;var e=ge().Graph,t=Kt().slack;Zn=n;function n(o){var a=new e({directed:!1}),c=o.nodes()[0],d=o.nodeCount();a.setNode(c,{});for(var u,l;r(a,o)<d;)u=i(a,o),l=a.hasNode(u.v)?t(o,u):-t(o,u),s(a,o,l);return a}function r(o,a){function c(d){a.nodeEdges(d).forEach(u=>{var l=u.v,f=d===l?u.w:l;!o.hasNode(f)&&!t(a,u)&&(o.setNode(f,{}),o.setEdge(d,f,{}),c(f))})}return o.nodes().forEach(c),o.nodeCount()}function i(o,a){return a.edges().reduce((d,u)=>{let l=Number.POSITIVE_INFINITY;return o.hasNode(u.v)!==o.hasNode(u.w)&&(l=t(a,u)),l<d[0]?[l,u]:d},[Number.POSITIVE_INFINITY,null])[1]}function s(o,a,c){o.nodes().forEach(d=>a.node(d).rank+=c)}return Zn}var Qn,jo;function u0(){if(jo)return Qn;jo=1;var e=Xa(),t=Kt().slack,n=Kt().longestPath,r=ge().alg.preorder,i=ge().alg.postorder,s=oe().simplify;Qn=o,o.initLowLimValues=u,o.initCutValues=a,o.calcCutValue=d,o.leaveEdge=f,o.enterEdge=h,o.exchangeEdges=m;function o(b){b=s(b),n(b);var p=e(b);u(p),a(p,b);for(var x,E;x=f(p);)E=h(p,b,x),m(p,b,x,E)}function a(b,p){var x=i(b,b.nodes());x=x.slice(0,x.length-1),x.forEach(E=>c(b,p,E))}function c(b,p,x){var E=b.node(x),k=E.parent;b.edge(x,k).cutvalue=d(b,p,x)}function d(b,p,x){var E=b.node(x),k=E.parent,S=!0,_=p.edge(x,k),N=0;return _||(S=!1,_=p.edge(k,x)),N=_.weight,p.nodeEdges(x).forEach(C=>{var M=C.v===x,I=M?C.w:C.v;if(I!==k){var D=M===S,v=p.edge(C).weight;if(N+=D?v:-v,g(b,x,I)){var R=b.edge(x,I).cutvalue;N+=D?-R:R}}}),N}function u(b,p){arguments.length<2&&(p=b.nodes()[0]),l(b,{},1,p)}function l(b,p,x,E,k){var S=x,_=b.node(E);return p[E]=!0,b.neighbors(E).forEach(N=>{Object.hasOwn(p,N)||(x=l(b,p,x,N,E))}),_.low=S,_.lim=x++,k?_.parent=k:delete _.parent,x}function f(b){return b.edges().find(p=>b.edge(p).cutvalue<0)}function h(b,p,x){var E=x.v,k=x.w;p.hasEdge(E,k)||(E=x.w,k=x.v);var S=b.node(E),_=b.node(k),N=S,C=!1;S.lim>_.lim&&(N=_,C=!0);var M=p.edges().filter(I=>C===w(b,b.node(I.v),N)&&C!==w(b,b.node(I.w),N));return M.reduce((I,D)=>t(p,D)<t(p,I)?D:I)}function m(b,p,x,E){var k=x.v,S=x.w;b.removeEdge(k,S),b.setEdge(E.v,E.w,{}),u(b),a(b,p),y(b,p)}function y(b,p){var x=b.nodes().find(k=>!p.node(k).parent),E=r(b,x);E=E.slice(1),E.forEach(k=>{var S=b.node(k).parent,_=p.edge(k,S),N=!1;_||(_=p.edge(S,k),N=!0),p.node(k).rank=p.node(S).rank+(N?_.minlen:-_.minlen)})}function g(b,p,x){return b.hasEdge(p,x)}function w(b,p,x){return x.low<=p.lim&&p.lim<=x.lim}return Qn}var Jn,Do;function l0(){if(Do)return Jn;Do=1;var e=Kt(),t=e.longestPath,n=Xa(),r=u0();Jn=i;function i(c){switch(c.graph().ranker){case"network-simplex":a(c);break;case"tight-tree":o(c);break;case"longest-path":s(c);break;default:a(c)}}var s=t;function o(c){t(c),n(c)}function a(c){r(c)}return Jn}var er,zo;function d0(){if(zo)return er;zo=1,er=e;function e(r){let i=n(r);r.graph().dummyChains.forEach(s=>{let o=r.node(s),a=o.edgeObj,c=t(r,i,a.v,a.w),d=c.path,u=c.lca,l=0,f=d[l],h=!0;for(;s!==a.w;){if(o=r.node(s),h){for(;(f=d[l])!==u&&r.node(f).maxRank<o.rank;)l++;f===u&&(h=!1)}if(!h){for(;l<d.length-1&&r.node(f=d[l+1]).minRank<=o.rank;)l++;f=d[l]}r.setParent(s,f),s=r.successors(s)[0]}})}function t(r,i,s,o){let a=[],c=[],d=Math.min(i[s].low,i[o].low),u=Math.max(i[s].lim,i[o].lim),l,f;l=s;do l=r.parent(l),a.push(l);while(l&&(i[l].low>d||u>i[l].lim));for(f=l,l=o;(l=r.parent(l))!==f;)c.push(l);return{path:a.concat(c.reverse()),lca:f}}function n(r){let i={},s=0;function o(a){let c=s;r.children(a).forEach(o),i[a]={low:c,lim:s++}}return r.children().forEach(o),i}return er}var tr,Ho;function f0(){if(Ho)return tr;Ho=1;let e=oe();tr={run:t,cleanup:s};function t(o){let a=e.addDummyNode(o,"root",{},"_root"),c=r(o),d=Object.values(c),u=e.applyWithChunking(Math.max,d)-1,l=2*u+1;o.graph().nestingRoot=a,o.edges().forEach(h=>o.edge(h).minlen*=l);let f=i(o)+1;o.children().forEach(h=>n(o,a,l,f,u,c,h)),o.graph().nodeRankFactor=l}function n(o,a,c,d,u,l,f){let h=o.children(f);if(!h.length){f!==a&&o.setEdge(a,f,{weight:0,minlen:c});return}let m=e.addBorderNode(o,"_bt"),y=e.addBorderNode(o,"_bb"),g=o.node(f);o.setParent(m,f),g.borderTop=m,o.setParent(y,f),g.borderBottom=y,h.forEach(w=>{n(o,a,c,d,u,l,w);let b=o.node(w),p=b.borderTop?b.borderTop:w,x=b.borderBottom?b.borderBottom:w,E=b.borderTop?d:2*d,k=p!==x?1:u-l[f]+1;o.setEdge(m,p,{weight:E,minlen:k,nestingEdge:!0}),o.setEdge(x,y,{weight:E,minlen:k,nestingEdge:!0})}),o.parent(f)||o.setEdge(a,m,{weight:0,minlen:u+l[f]})}function r(o){var a={};function c(d,u){var l=o.children(d);l&&l.length&&l.forEach(f=>c(f,u+1)),a[d]=u}return o.children().forEach(d=>c(d,1)),a}function i(o){return o.edges().reduce((a,c)=>a+o.edge(c).weight,0)}function s(o){var a=o.graph();o.removeNode(a.nestingRoot),delete a.nestingRoot,o.edges().forEach(c=>{var d=o.edge(c);d.nestingEdge&&o.removeEdge(c)})}return tr}var nr,Fo;function h0(){if(Fo)return nr;Fo=1;let e=oe();nr=t;function t(r){function i(s){let o=r.children(s),a=r.node(s);if(o.length&&o.forEach(i),Object.hasOwn(a,"minRank")){a.borderLeft=[],a.borderRight=[];for(let c=a.minRank,d=a.maxRank+1;c<d;++c)n(r,"borderLeft","_bl",s,a,c),n(r,"borderRight","_br",s,a,c)}}r.children().forEach(i)}function n(r,i,s,o,a,c){let d={width:0,height:0,rank:c,borderType:i},u=a[i][c-1],l=e.addDummyNode(r,"border",d,s);a[i][c]=l,r.setParent(l,o),u&&r.setEdge(u,l,{weight:1})}return nr}var rr,Bo;function p0(){if(Bo)return rr;Bo=1,rr={adjust:e,undo:t};function e(c){let d=c.graph().rankdir.toLowerCase();(d==="lr"||d==="rl")&&n(c)}function t(c){let d=c.graph().rankdir.toLowerCase();(d==="bt"||d==="rl")&&i(c),(d==="lr"||d==="rl")&&(o(c),n(c))}function n(c){c.nodes().forEach(d=>r(c.node(d))),c.edges().forEach(d=>r(c.edge(d)))}function r(c){let d=c.width;c.width=c.height,c.height=d}function i(c){c.nodes().forEach(d=>s(c.node(d))),c.edges().forEach(d=>{let u=c.edge(d);u.points.forEach(s),Object.hasOwn(u,"y")&&s(u)})}function s(c){c.y=-c.y}function o(c){c.nodes().forEach(d=>a(c.node(d))),c.edges().forEach(d=>{let u=c.edge(d);u.points.forEach(a),Object.hasOwn(u,"x")&&a(u)})}function a(c){let d=c.x;c.x=c.y,c.y=d}return rr}var ir,Vo;function g0(){if(Vo)return ir;Vo=1;let e=oe();ir=t;function t(n){let r={},i=n.nodes().filter(u=>!n.children(u).length),s=i.map(u=>n.node(u).rank),o=e.applyWithChunking(Math.max,s),a=e.range(o+1).map(()=>[]);function c(u){if(r[u])return;r[u]=!0;let l=n.node(u);a[l.rank].push(u),n.successors(u).forEach(c)}return i.sort((u,l)=>n.node(u).rank-n.node(l).rank).forEach(c),a}return ir}var or,qo;function m0(){if(qo)return or;qo=1;let e=oe().zipObject;or=t;function t(r,i){let s=0;for(let o=1;o<i.length;++o)s+=n(r,i[o-1],i[o]);return s}function n(r,i,s){let o=e(s,s.map((f,h)=>h)),a=i.flatMap(f=>r.outEdges(f).map(h=>({pos:o[h.w],weight:r.edge(h).weight})).sort((h,m)=>h.pos-m.pos)),c=1;for(;c<s.length;)c<<=1;let d=2*c-1;c-=1;let u=new Array(d).fill(0),l=0;return a.forEach(f=>{let h=f.pos+c;u[h]+=f.weight;let m=0;for(;h>0;)h%2&&(m+=u[h+1]),h=h-1>>1,u[h]+=f.weight;l+=f.weight*m}),l}return or}var sr,Yo;function y0(){if(Yo)return sr;Yo=1,sr=e;function e(t,n=[]){return n.map(r=>{let i=t.inEdges(r);if(i.length){let s=i.reduce((o,a)=>{let c=t.edge(a),d=t.node(a.v);return{sum:o.sum+c.weight*d.order,weight:o.weight+c.weight}},{sum:0,weight:0});return{v:r,barycenter:s.sum/s.weight,weight:s.weight}}else return{v:r}})}return sr}var ar,Go;function x0(){if(Go)return ar;Go=1;let e=oe();ar=t;function t(i,s){let o={};i.forEach((c,d)=>{let u=o[c.v]={indegree:0,in:[],out:[],vs:[c.v],i:d};c.barycenter!==void 0&&(u.barycenter=c.barycenter,u.weight=c.weight)}),s.edges().forEach(c=>{let d=o[c.v],u=o[c.w];d!==void 0&&u!==void 0&&(u.indegree++,d.out.push(o[c.w]))});let a=Object.values(o).filter(c=>!c.indegree);return n(a)}function n(i){let s=[];function o(c){return d=>{d.merged||(d.barycenter===void 0||c.barycenter===void 0||d.barycenter>=c.barycenter)&&r(c,d)}}function a(c){return d=>{d.in.push(c),--d.indegree===0&&i.push(d)}}for(;i.length;){let c=i.pop();s.push(c),c.in.reverse().forEach(o(c)),c.out.forEach(a(c))}return s.filter(c=>!c.merged).map(c=>e.pick(c,["vs","i","barycenter","weight"]))}function r(i,s){let o=0,a=0;i.weight&&(o+=i.barycenter*i.weight,a+=i.weight),s.weight&&(o+=s.barycenter*s.weight,a+=s.weight),i.vs=s.vs.concat(i.vs),i.barycenter=o/a,i.weight=a,i.i=Math.min(s.i,i.i),s.merged=!0}return ar}var cr,Xo;function w0(){if(Xo)return cr;Xo=1;let e=oe();cr=t;function t(i,s){let o=e.partition(i,m=>Object.hasOwn(m,"barycenter")),a=o.lhs,c=o.rhs.sort((m,y)=>y.i-m.i),d=[],u=0,l=0,f=0;a.sort(r(!!s)),f=n(d,c,f),a.forEach(m=>{f+=m.vs.length,d.push(m.vs),u+=m.barycenter*m.weight,l+=m.weight,f=n(d,c,f)});let h={vs:d.flat(!0)};return l&&(h.barycenter=u/l,h.weight=l),h}function n(i,s,o){let a;for(;s.length&&(a=s[s.length-1]).i<=o;)s.pop(),i.push(a.vs),o++;return o}function r(i){return(s,o)=>s.barycenter<o.barycenter?-1:s.barycenter>o.barycenter?1:i?o.i-s.i:s.i-o.i}return cr}var ur,Wo;function v0(){if(Wo)return ur;Wo=1;let e=y0(),t=x0(),n=w0();ur=r;function r(o,a,c,d){let u=o.children(a),l=o.node(a),f=l?l.borderLeft:void 0,h=l?l.borderRight:void 0,m={};f&&(u=u.filter(b=>b!==f&&b!==h));let y=e(o,u);y.forEach(b=>{if(o.children(b.v).length){let p=r(o,b.v,c,d);m[b.v]=p,Object.hasOwn(p,"barycenter")&&s(b,p)}});let g=t(y,c);i(g,m);let w=n(g,d);if(f&&(w.vs=[f,w.vs,h].flat(!0),o.predecessors(f).length)){let b=o.node(o.predecessors(f)[0]),p=o.node(o.predecessors(h)[0]);Object.hasOwn(w,"barycenter")||(w.barycenter=0,w.weight=0),w.barycenter=(w.barycenter*w.weight+b.order+p.order)/(w.weight+2),w.weight+=2}return w}function i(o,a){o.forEach(c=>{c.vs=c.vs.flatMap(d=>a[d]?a[d].vs:d)})}function s(o,a){o.barycenter!==void 0?(o.barycenter=(o.barycenter*o.weight+a.barycenter*a.weight)/(o.weight+a.weight),o.weight+=a.weight):(o.barycenter=a.barycenter,o.weight=a.weight)}return ur}var lr,Uo;function b0(){if(Uo)return lr;Uo=1;let e=ge().Graph,t=oe();lr=n;function n(i,s,o){let a=r(i),c=new e({compound:!0}).setGraph({root:a}).setDefaultNodeLabel(d=>i.node(d));return i.nodes().forEach(d=>{let u=i.node(d),l=i.parent(d);(u.rank===s||u.minRank<=s&&s<=u.maxRank)&&(c.setNode(d),c.setParent(d,l||a),i[o](d).forEach(f=>{let h=f.v===d?f.w:f.v,m=c.edge(h,d),y=m!==void 0?m.weight:0;c.setEdge(h,d,{weight:i.edge(f).weight+y})}),Object.hasOwn(u,"minRank")&&c.setNode(d,{borderLeft:u.borderLeft[s],borderRight:u.borderRight[s]}))}),c}function r(i){for(var s;i.hasNode(s=t.uniqueId("_root")););return s}return lr}var dr,Ko;function _0(){if(Ko)return dr;Ko=1,dr=e;function e(t,n,r){let i={},s;r.forEach(o=>{let a=t.parent(o),c,d;for(;a;){if(c=t.parent(a),c?(d=i[c],i[c]=a):(d=s,s=a),d&&d!==a){n.setEdge(d,a);return}a=c}})}return dr}var fr,Zo;function E0(){if(Zo)return fr;Zo=1;let e=g0(),t=m0(),n=v0(),r=b0(),i=_0(),s=ge().Graph,o=oe();fr=a;function a(l,f){if(f&&typeof f.customOrder=="function"){f.customOrder(l,a);return}let h=o.maxRank(l),m=c(l,o.range(1,h+1),"inEdges"),y=c(l,o.range(h-1,-1,-1),"outEdges"),g=e(l);if(u(l,g),f&&f.disableOptimalOrderHeuristic)return;let w=Number.POSITIVE_INFINITY,b;for(let p=0,x=0;x<4;++p,++x){d(p%2?m:y,p%4>=2),g=o.buildLayerMatrix(l);let E=t(l,g);E<w&&(x=0,b=Object.assign({},g),w=E)}u(l,b)}function c(l,f,h){return f.map(function(m){return r(l,m,h)})}function d(l,f){let h=new s;l.forEach(function(m){let y=m.graph().root,g=n(m,y,h,f);g.vs.forEach((w,b)=>m.node(w).order=b),i(m,h,g.vs)})}function u(l,f){Object.values(f).forEach(h=>h.forEach((m,y)=>l.node(m).order=y))}return fr}var hr,Qo;function N0(){if(Qo)return hr;Qo=1;let e=ge().Graph,t=oe();hr={positionX:h,findType1Conflicts:n,findType2Conflicts:r,addConflict:s,hasConflict:o,verticalAlignment:a,horizontalCompaction:c,alignCoordinates:l,findSmallestWidthAlignment:u,balance:f};function n(g,w){let b={};function p(x,E){let k=0,S=0,_=x.length,N=E[E.length-1];return E.forEach((C,M)=>{let I=i(g,C),D=I?g.node(I).order:_;(I||C===N)&&(E.slice(S,M+1).forEach(v=>{g.predecessors(v).forEach(R=>{let A=g.node(R),$=A.order;($<k||D<$)&&!(A.dummy&&g.node(v).dummy)&&s(b,R,v)})}),S=M+1,k=D)}),E}return w.length&&w.reduce(p),b}function r(g,w){let b={};function p(E,k,S,_,N){let C;t.range(k,S).forEach(M=>{C=E[M],g.node(C).dummy&&g.predecessors(C).forEach(I=>{let D=g.node(I);D.dummy&&(D.order<_||D.order>N)&&s(b,I,C)})})}function x(E,k){let S=-1,_,N=0;return k.forEach((C,M)=>{if(g.node(C).dummy==="border"){let I=g.predecessors(C);I.length&&(_=g.node(I[0]).order,p(k,N,M,S,_),N=M,S=_)}p(k,N,k.length,_,E.length)}),k}return w.length&&w.reduce(x),b}function i(g,w){if(g.node(w).dummy)return g.predecessors(w).find(b=>g.node(b).dummy)}function s(g,w,b){if(w>b){let x=w;w=b,b=x}let p=g[w];p||(g[w]=p={}),p[b]=!0}function o(g,w,b){if(w>b){let p=w;w=b,b=p}return!!g[w]&&Object.hasOwn(g[w],b)}function a(g,w,b,p){let x={},E={},k={};return w.forEach(S=>{S.forEach((_,N)=>{x[_]=_,E[_]=_,k[_]=N})}),w.forEach(S=>{let _=-1;S.forEach(N=>{let C=p(N);if(C.length){C=C.sort((I,D)=>k[I]-k[D]);let M=(C.length-1)/2;for(let I=Math.floor(M),D=Math.ceil(M);I<=D;++I){let v=C[I];E[N]===N&&_<k[v]&&!o(b,N,v)&&(E[v]=N,E[N]=x[N]=x[v],_=k[v])}}})}),{root:x,align:E}}function c(g,w,b,p,x){let E={},k=d(g,w,b,x),S=x?"borderLeft":"borderRight";function _(M,I){let D=k.nodes(),v=D.pop(),R={};for(;v;)R[v]?M(v):(R[v]=!0,D.push(v),D=D.concat(I(v))),v=D.pop()}function N(M){E[M]=k.inEdges(M).reduce((I,D)=>Math.max(I,E[D.v]+k.edge(D)),0)}function C(M){let I=k.outEdges(M).reduce((v,R)=>Math.min(v,E[R.w]-k.edge(R)),Number.POSITIVE_INFINITY),D=g.node(M);I!==Number.POSITIVE_INFINITY&&D.borderType!==S&&(E[M]=Math.max(E[M],I))}return _(N,k.predecessors.bind(k)),_(C,k.successors.bind(k)),Object.keys(p).forEach(M=>E[M]=E[b[M]]),E}function d(g,w,b,p){let x=new e,E=g.graph(),k=m(E.nodesep,E.edgesep,p);return w.forEach(S=>{let _;S.forEach(N=>{let C=b[N];if(x.setNode(C),_){var M=b[_],I=x.edge(M,C);x.setEdge(M,C,Math.max(k(g,N,_),I||0))}_=N})}),x}function u(g,w){return Object.values(w).reduce((b,p)=>{let x=Number.NEGATIVE_INFINITY,E=Number.POSITIVE_INFINITY;Object.entries(p).forEach(([S,_])=>{let N=y(g,S)/2;x=Math.max(_+N,x),E=Math.min(_-N,E)});const k=x-E;return k<b[0]&&(b=[k,p]),b},[Number.POSITIVE_INFINITY,null])[1]}function l(g,w){let b=Object.values(w),p=t.applyWithChunking(Math.min,b),x=t.applyWithChunking(Math.max,b);["u","d"].forEach(E=>{["l","r"].forEach(k=>{let S=E+k,_=g[S];if(_===w)return;let N=Object.values(_),C=p-t.applyWithChunking(Math.min,N);k!=="l"&&(C=x-t.applyWithChunking(Math.max,N)),C&&(g[S]=t.mapValues(_,M=>M+C))})})}function f(g,w){return t.mapValues(g.ul,(b,p)=>{if(w)return g[w.toLowerCase()][p];{let x=Object.values(g).map(E=>E[p]).sort((E,k)=>E-k);return(x[1]+x[2])/2}})}function h(g){let w=t.buildLayerMatrix(g),b=Object.assign(n(g,w),r(g,w)),p={},x;["u","d"].forEach(k=>{x=k==="u"?w:Object.values(w).reverse(),["l","r"].forEach(S=>{S==="r"&&(x=x.map(M=>Object.values(M).reverse()));let _=(k==="u"?g.predecessors:g.successors).bind(g),N=a(g,x,b,_),C=c(g,x,N.root,N.align,S==="r");S==="r"&&(C=t.mapValues(C,M=>-M)),p[k+S]=C})});let E=u(g,p);return l(p,E),f(p,g.graph().align)}function m(g,w,b){return(p,x,E)=>{let k=p.node(x),S=p.node(E),_=0,N;if(_+=k.width/2,Object.hasOwn(k,"labelpos"))switch(k.labelpos.toLowerCase()){case"l":N=-k.width/2;break;case"r":N=k.width/2;break}if(N&&(_+=b?N:-N),N=0,_+=(k.dummy?w:g)/2,_+=(S.dummy?w:g)/2,_+=S.width/2,Object.hasOwn(S,"labelpos"))switch(S.labelpos.toLowerCase()){case"l":N=S.width/2;break;case"r":N=-S.width/2;break}return N&&(_+=b?N:-N),N=0,_}}function y(g,w){return g.node(w).width}return hr}var pr,Jo;function k0(){if(Jo)return pr;Jo=1;let e=oe(),t=N0().positionX;pr=n;function n(i){i=e.asNonCompoundGraph(i),r(i),Object.entries(t(i)).forEach(([s,o])=>i.node(s).x=o)}function r(i){let s=e.buildLayerMatrix(i),o=i.graph().ranksep,a=0;s.forEach(c=>{const d=c.reduce((u,l)=>{const f=i.node(l).height;return u>f?u:f},0);c.forEach(u=>i.node(u).y=a+d/2),a+=d+o})}return pr}var gr,es;function S0(){if(es)return gr;es=1;let e=a0(),t=c0(),n=l0(),r=oe().normalizeRanks,i=d0(),s=oe().removeEmptyRanks,o=f0(),a=h0(),c=p0(),d=E0(),u=k0(),l=oe(),f=ge().Graph;gr=h;function h(T,O){let j=O&&O.debugTiming?l.time:l.notime;j("layout",()=>{let F=j("  buildLayoutGraph",()=>_(T));j("  runLayout",()=>m(F,j,O)),j("  updateInputGraph",()=>y(T,F))})}function m(T,O,j){O("    makeSpaceForEdgeLabels",()=>N(T)),O("    removeSelfEdges",()=>z(T)),O("    acyclic",()=>e.run(T)),O("    nestingGraph.run",()=>o.run(T)),O("    rank",()=>n(l.asNonCompoundGraph(T))),O("    injectEdgeLabelProxies",()=>C(T)),O("    removeEmptyRanks",()=>s(T)),O("    nestingGraph.cleanup",()=>o.cleanup(T)),O("    normalizeRanks",()=>r(T)),O("    assignRankMinMax",()=>M(T)),O("    removeEdgeLabelProxies",()=>I(T)),O("    normalize.run",()=>t.run(T)),O("    parentDummyChains",()=>i(T)),O("    addBorderSegments",()=>a(T)),O("    order",()=>d(T,j)),O("    insertSelfEdges",()=>L(T)),O("    adjustCoordinateSystem",()=>c.adjust(T)),O("    position",()=>u(T)),O("    positionSelfEdges",()=>V(T)),O("    removeBorderNodes",()=>$(T)),O("    normalize.undo",()=>t.undo(T)),O("    fixupEdgeLabelCoords",()=>R(T)),O("    undoCoordinateSystem",()=>c.undo(T)),O("    translateGraph",()=>D(T)),O("    assignNodeIntersects",()=>v(T)),O("    reversePoints",()=>A(T)),O("    acyclic.undo",()=>e.undo(T))}function y(T,O){T.nodes().forEach(j=>{let F=T.node(j),q=O.node(j);F&&(F.x=q.x,F.y=q.y,F.rank=q.rank,O.children(j).length&&(F.width=q.width,F.height=q.height))}),T.edges().forEach(j=>{let F=T.edge(j),q=O.edge(j);F.points=q.points,Object.hasOwn(q,"x")&&(F.x=q.x,F.y=q.y)}),T.graph().width=O.graph().width,T.graph().height=O.graph().height}let g=["nodesep","edgesep","ranksep","marginx","marginy"],w={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},b=["acyclicer","ranker","rankdir","align"],p=["width","height"],x={width:0,height:0},E=["minlen","weight","width","height","labeloffset"],k={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},S=["labelpos"];function _(T){let O=new f({multigraph:!0,compound:!0}),j=Y(T.graph());return O.setGraph(Object.assign({},w,B(j,g),l.pick(j,b))),T.nodes().forEach(F=>{let q=Y(T.node(F));const G=B(q,p);Object.keys(x).forEach(W=>{G[W]===void 0&&(G[W]=x[W])}),O.setNode(F,G),O.setParent(F,T.parent(F))}),T.edges().forEach(F=>{let q=Y(T.edge(F));O.setEdge(F,Object.assign({},k,B(q,E),l.pick(q,S)))}),O}function N(T){let O=T.graph();O.ranksep/=2,T.edges().forEach(j=>{let F=T.edge(j);F.minlen*=2,F.labelpos.toLowerCase()!=="c"&&(O.rankdir==="TB"||O.rankdir==="BT"?F.width+=F.labeloffset:F.height+=F.labeloffset)})}function C(T){T.edges().forEach(O=>{let j=T.edge(O);if(j.width&&j.height){let F=T.node(O.v),G={rank:(T.node(O.w).rank-F.rank)/2+F.rank,e:O};l.addDummyNode(T,"edge-proxy",G,"_ep")}})}function M(T){let O=0;T.nodes().forEach(j=>{let F=T.node(j);F.borderTop&&(F.minRank=T.node(F.borderTop).rank,F.maxRank=T.node(F.borderBottom).rank,O=Math.max(O,F.maxRank))}),T.graph().maxRank=O}function I(T){T.nodes().forEach(O=>{let j=T.node(O);j.dummy==="edge-proxy"&&(T.edge(j.e).labelRank=j.rank,T.removeNode(O))})}function D(T){let O=Number.POSITIVE_INFINITY,j=0,F=Number.POSITIVE_INFINITY,q=0,G=T.graph(),W=G.marginx||0,Z=G.marginy||0;function K(X){let Q=X.x,J=X.y,re=X.width,ae=X.height;O=Math.min(O,Q-re/2),j=Math.max(j,Q+re/2),F=Math.min(F,J-ae/2),q=Math.max(q,J+ae/2)}T.nodes().forEach(X=>K(T.node(X))),T.edges().forEach(X=>{let Q=T.edge(X);Object.hasOwn(Q,"x")&&K(Q)}),O-=W,F-=Z,T.nodes().forEach(X=>{let Q=T.node(X);Q.x-=O,Q.y-=F}),T.edges().forEach(X=>{let Q=T.edge(X);Q.points.forEach(J=>{J.x-=O,J.y-=F}),Object.hasOwn(Q,"x")&&(Q.x-=O),Object.hasOwn(Q,"y")&&(Q.y-=F)}),G.width=j-O+W,G.height=q-F+Z}function v(T){T.edges().forEach(O=>{let j=T.edge(O),F=T.node(O.v),q=T.node(O.w),G,W;j.points?(G=j.points[0],W=j.points[j.points.length-1]):(j.points=[],G=q,W=F),j.points.unshift(l.intersectRect(F,G)),j.points.push(l.intersectRect(q,W))})}function R(T){T.edges().forEach(O=>{let j=T.edge(O);if(Object.hasOwn(j,"x"))switch((j.labelpos==="l"||j.labelpos==="r")&&(j.width-=j.labeloffset),j.labelpos){case"l":j.x-=j.width/2+j.labeloffset;break;case"r":j.x+=j.width/2+j.labeloffset;break}})}function A(T){T.edges().forEach(O=>{let j=T.edge(O);j.reversed&&j.points.reverse()})}function $(T){T.nodes().forEach(O=>{if(T.children(O).length){let j=T.node(O),F=T.node(j.borderTop),q=T.node(j.borderBottom),G=T.node(j.borderLeft[j.borderLeft.length-1]),W=T.node(j.borderRight[j.borderRight.length-1]);j.width=Math.abs(W.x-G.x),j.height=Math.abs(q.y-F.y),j.x=G.x+j.width/2,j.y=F.y+j.height/2}}),T.nodes().forEach(O=>{T.node(O).dummy==="border"&&T.removeNode(O)})}function z(T){T.edges().forEach(O=>{if(O.v===O.w){var j=T.node(O.v);j.selfEdges||(j.selfEdges=[]),j.selfEdges.push({e:O,label:T.edge(O)}),T.removeEdge(O)}})}function L(T){var O=l.buildLayerMatrix(T);O.forEach(j=>{var F=0;j.forEach((q,G)=>{var W=T.node(q);W.order=G+F,(W.selfEdges||[]).forEach(Z=>{l.addDummyNode(T,"selfedge",{width:Z.label.width,height:Z.label.height,rank:W.rank,order:G+ ++F,e:Z.e,label:Z.label},"_se")}),delete W.selfEdges})})}function V(T){T.nodes().forEach(O=>{var j=T.node(O);if(j.dummy==="selfedge"){var F=T.node(j.e.v),q=F.x+F.width/2,G=F.y,W=j.x-q,Z=F.height/2;T.setEdge(j.e,j.label),T.removeNode(O),j.label.points=[{x:q+2*W/3,y:G-Z},{x:q+5*W/6,y:G-Z},{x:q+W,y:G},{x:q+5*W/6,y:G+Z},{x:q+2*W/3,y:G+Z}],j.label.x=j.x,j.label.y=j.y}})}function B(T,O){return l.mapValues(l.pick(T,O),Number)}function Y(T){var O={};return T&&Object.entries(T).forEach(([j,F])=>{typeof j=="string"&&(j=j.toLowerCase()),O[j]=F}),O}return gr}var mr,ts;function C0(){if(ts)return mr;ts=1;let e=oe(),t=ge().Graph;mr={debugOrdering:n};function n(r){let i=e.buildLayerMatrix(r),s=new t({compound:!0,multigraph:!0}).setGraph({});return r.nodes().forEach(o=>{s.setNode(o,{label:o}),s.setParent(o,"layer"+r.node(o).rank)}),r.edges().forEach(o=>s.setEdge(o.v,o.w,{},o.name)),i.forEach((o,a)=>{let c="layer"+a;s.setNode(c,{rank:"same"}),o.reduce((d,u)=>(s.setEdge(d,u,{style:"invis"}),u))}),s}return mr}var yr,ns;function M0(){return ns||(ns=1,yr="1.1.4"),yr}var xr,rs;function I0(){return rs||(rs=1,xr={graphlib:ge(),layout:S0(),debug:C0(),util:{time:oe().time,notime:oe().notime},version:M0()}),xr}var A0=I0();const is=Qc(A0),T0=(e,t)=>{const n=new Set;return t.forEach(r=>{n.add(r.source),n.add(r.target)}),e.filter(r=>!n.has(r.id))},R0=(e,t=0,n=0,r=50,i=50)=>{if(e.length===0)return[];const s=Math.max(...e.map(u=>{var l;return((l=u.measured)==null?void 0:l.width)??0})),o=Math.max(...e.map(u=>{var l;return((l=u.measured)==null?void 0:l.height)??0})),a=s+r,c=o+i,d=Math.ceil(Math.sqrt(e.length));return e.map((u,l)=>{var g,w;const f=l%d,h=Math.floor(l/d),m=((g=u.measured)==null?void 0:g.width)??0,y=((w=u.measured)==null?void 0:w.height)??0;return{...u,position:{x:t+f*a+(s-m)/2,y:n+h*c+(o-y)/2}}})},H0=(e,t,n)=>{const r=new is.graphlib.Graph().setDefaultEdgeLabel(()=>({}));r.setGraph({rankdir:n==="horizontal"?"LR":"TB",nodesep:150,ranksep:100,marginx:20,marginy:20,align:"UL"}),t.forEach(l=>r.setEdge(l.source,l.target)),e.forEach(l=>{var f,h;r.setNode(l.id,{...l,width:((f=l.measured)==null?void 0:f.width)??0,height:((h=l.measured)==null?void 0:h.height)??0})}),is.layout(r);const i=T0(e,t),s=e.filter(l=>!i.includes(l)).map(l=>{const f=r.node(l.id);if(!l.measured||!f)return l;const h=f.x-(l.measured.width??0)/2,m=f.y-(l.measured.height??0)/2;return{...l,position:{x:h,y:m}}}),o=Math.max(...s.map(l=>{var f,h;return(((f=l.position)==null?void 0:f.x)??0)+(((h=l.measured)==null?void 0:h.width)??0)})),a=Math.max(...s.map(l=>{var f,h;return(((f=l.position)==null?void 0:f.y)??0)+(((h=l.measured)==null?void 0:h.height)??0)})),c=n==="horizontal"?o+200:0,d=n==="horizontal"?0:a+200,u=R0(i,c,d);return{nodes:[...s,...u],edges:t}};export{D0 as B,Yt as M,cn as P,yg as R,z0 as T,ep as a,tp as b,Xf as c,H0 as g,j0 as i,Xr as u};
