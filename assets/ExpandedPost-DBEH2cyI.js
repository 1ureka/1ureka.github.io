import{j as e,B as s,T as i,q as o,D as v,y as p}from"./routes-CadzfG2E.js";import{C as m}from"./CommentRounded-B_Jl-FgD.js";import{L as b,T as w,V as j,P as y,a as I,A as C,S as k,b as B}from"./PostHeader-DeGR_Wzm.js";import{F as W}from"./url-DTt2Bjh-.js";import{a as T}from"./post-CLX4ZffY.js";import{S as n}from"./Skeleton-Pg_F8lei.js";import{C as r}from"./Chip-DcZTGwOD.js";import{D as l}from"./Divider-DVObFO2h.js";import{S as h}from"./DarkModeRounded-BeOhhBQh.js";import{T as d}from"./useMutation-Ctl-1Wtr.js";const $=()=>e.jsxs(e.Fragment,{children:[e.jsxs(s,{sx:{p:1.5,cursor:"pointer","&:hover":{bgcolor:"action.hover"}},children:[e.jsx(b,{}),e.jsx(n,{variant:"rounded",animation:"wave",children:e.jsx(i,{variant:"h6",component:"h3",sx:{textAlign:"start"},children:"正在載入標題..."})}),e.jsx(n,{variant:"text",sx:{width:.8},animation:"wave"}),e.jsx(n,{variant:"text",sx:{width:.7},animation:"wave"}),e.jsx(n,{variant:"text",sx:{width:.2},animation:"wave"}),e.jsx(s,{sx:{display:"flex",gap:1.5,mt:2},children:new Array(3).fill(null).map((c,t)=>e.jsx(n,{variant:"rounded",animation:"wave",children:e.jsx(r,{label:"loading...",size:"small"})},t))})]}),e.jsx(l,{flexItem:!0}),e.jsxs(s,{sx:{p:1.5,py:1,display:"flex",gap:1.5,alignItems:"center",position:"relative",color:"text.secondary",flexWrap:"wrap"},children:[e.jsx(s,{sx:{position:"absolute",inset:0,bgcolor:"divider",opacity:.35}}),e.jsx(o,{color:"inherit",startIcon:e.jsx(w,{}),size:"small",loading:!0,children:e.jsx(i,{variant:"caption",component:"span",children:"100 個讚"})}),e.jsx(o,{color:"inherit",startIcon:e.jsx(m,{}),size:"small",loading:!0,children:e.jsx(i,{variant:"caption",component:"span",children:"100 則回覆"})}),e.jsx(s,{sx:{flex:1}}),e.jsx(o,{color:"inherit",startIcon:e.jsx(j,{}),size:"small",loading:!0,children:e.jsx(i,{variant:"caption",component:"span",children:"1000 次瀏覽"})})]}),e.jsx(l,{flexItem:!0})]}),_=({postId:c})=>{const{data:t,isFetching:u}=T({postId:c});if(u||!t)return e.jsx($,{});const f=()=>{window.location.href=`${p.forum_post}?postId=${t.id}`};return e.jsxs(e.Fragment,{children:[e.jsxs(s,{sx:{p:1.5,cursor:"pointer","&:hover":{bgcolor:"action.hover"}},onClick:f,children:[e.jsx(y,{post:t}),e.jsxs(h,{sx:{gap:1.5,flexDirection:{xs:"column",md:"row"},justifyContent:"space-between",mb:2},children:[e.jsxs(s,{sx:{flex:1},children:[e.jsx(i,{variant:"h6",component:"h3",sx:{textAlign:"start",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:t.title}),e.jsx(i,{variant:"body2",component:"p",sx:{color:"text.secondary",textAlign:"start",display:"-webkit-box",WebkitLineClamp:4,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"pre-line"},children:t.content})]}),t.photos&&t.photos.length>0&&e.jsxs(s,{sx:{flex:.5,display:"flex",gap:1,mt:1,flexWrap:"wrap",justifyContent:{xs:"flex-start",md:"flex-end"}},children:[t.photos.slice(0,3).map(({name:a,url:x},g)=>e.jsx(d,{title:"查看圖片",arrow:!0,placement:"top",children:e.jsx(v,{sx:{position:"relative",width:100,height:100,bgcolor:"divider",borderRadius:1,overflow:"hidden"},children:e.jsx(s,{sx:{position:"absolute",inset:"auto 0 0 0",pb:1,display:"grid",placeItems:"center"},children:e.jsx(s,{sx:{maxWidth:90},children:e.jsx(r,{label:a,size:"small"})})})})},`${x}${g}`)),t.photos.length>3&&e.jsx(d,{title:"查看更多圖片",arrow:!0,placement:"top",children:e.jsxs(o,{color:"inherit",sx:{position:"relative",width:100,height:100,bgcolor:"divider",borderRadius:1},children:["+",t.photos.length-3]})})]})]}),e.jsxs(h,{sx:{gap:1.5,flexDirection:{xs:"column",md:"row"},justifyContent:"space-between",alignItems:{xs:"flex-start",md:"flex-end"},mt:1},children:[e.jsx(s,{sx:{display:"flex",gap:1.5,flexWrap:"wrap"},children:e.jsx(I,{post:t,displayCount:5})}),t.attachments&&t.attachments.length>0&&e.jsxs(s,{sx:{display:"flex",gap:1,flexWrap:"wrap",justifyContent:{xs:"flex-start",md:"flex-end"}},children:[t.attachments.slice(0,3).map((a,x)=>e.jsx(d,{title:"下載附件",arrow:!0,placement:"top",children:e.jsx(r,{label:`${a.name} (${(a.size/1024).toFixed(1)}KB)`,clickable:!0,icon:e.jsx(C,{})})},x)),t.attachments.length>3&&e.jsx(r,{label:`+${t.attachments.length-3}`,variant:"outlined",clickable:!0})]})]})]}),e.jsx(l,{flexItem:!0}),e.jsxs(s,{sx:{p:1.5,py:1,display:"flex",gap:1.5,alignItems:"center",position:"relative",color:"text.secondary",flexWrap:"wrap"},children:[e.jsx(s,{sx:{position:"absolute",inset:0,bgcolor:"divider",opacity:.35}}),t.isSelf?e.jsx(k,{post:t}):e.jsxs(e.Fragment,{children:[e.jsx(B,{postId:t.id,likeCount:t.likeCount}),e.jsx(W,{postId:t.id})]}),e.jsx(o,{color:"inherit",startIcon:e.jsx(m,{}),size:"small",href:`${p.forum_post}?postId=${t.id}`,children:e.jsxs(i,{variant:"caption",component:"span",children:[t.commentCount," 則回覆"]})}),e.jsx(s,{sx:{flex:1}}),e.jsx(o,{startIcon:e.jsx(j,{}),disabled:!0,size:"small",sx:{"button&.Mui-disabled":{color:"text.secondary",opacity:.8}},children:e.jsxs(i,{variant:"caption",component:"span",children:[t.viewCount," 次瀏覽"]})})]}),e.jsx(l,{flexItem:!0})]})};export{$ as E,_ as a};
