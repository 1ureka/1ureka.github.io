import{j as t,B as s,T as i,t as o,D as v,y as p}from"./routes-HNxAJ3wC.js";import{C as m}from"./CommentRounded-B7KNlNhE.js";import{L as b,T as w,V as j,P as y,a as I,S as C,b as k}from"./PostHeader-CbNOLaPr.js";import{f as B,F as W}from"./url-CZ-hGQae.js";import{a as T}from"./post-BSkPOABJ.js";import{S as n}from"./Skeleton-ClRS8rvl.js";import{C as r}from"./Chip-ClU5wa3A.js";import{D as l}from"./Divider-Bxx0iyhR.js";import{S as h}from"./DarkModeRounded-BcFV06RJ.js";import{T as d}from"./useMutation-DHV1DfwY.js";const $=()=>t.jsxs(t.Fragment,{children:[t.jsxs(s,{sx:{p:1.5,cursor:"pointer","&:hover":{bgcolor:"action.hover"}},children:[t.jsx(b,{}),t.jsx(n,{variant:"rounded",animation:"wave",children:t.jsx(i,{variant:"h6",component:"h3",sx:{textAlign:"start"},children:"正在載入標題..."})}),t.jsx(n,{variant:"text",sx:{width:.8},animation:"wave"}),t.jsx(n,{variant:"text",sx:{width:.7},animation:"wave"}),t.jsx(n,{variant:"text",sx:{width:.2},animation:"wave"}),t.jsx(s,{sx:{display:"flex",gap:1.5,mt:2},children:new Array(3).fill(null).map((c,e)=>t.jsx(n,{variant:"rounded",animation:"wave",children:t.jsx(r,{label:"loading...",size:"small"})},e))})]}),t.jsx(l,{flexItem:!0}),t.jsxs(s,{sx:{p:1.5,py:1,display:"flex",gap:1.5,alignItems:"center",position:"relative",color:"text.secondary",flexWrap:"wrap"},children:[t.jsx(s,{sx:{position:"absolute",inset:0,bgcolor:"divider",opacity:.35}}),t.jsx(o,{color:"inherit",startIcon:t.jsx(w,{}),size:"small",loading:!0,children:t.jsx(i,{variant:"caption",component:"span",children:"100 個讚"})}),t.jsx(o,{color:"inherit",startIcon:t.jsx(m,{}),size:"small",loading:!0,children:t.jsx(i,{variant:"caption",component:"span",children:"100 則回覆"})}),t.jsx(s,{sx:{flex:1}}),t.jsx(o,{color:"inherit",startIcon:t.jsx(j,{}),size:"small",loading:!0,children:t.jsx(i,{variant:"caption",component:"span",children:"1000 次瀏覽"})})]}),t.jsx(l,{flexItem:!0})]}),_=({postId:c})=>{const{data:e,isFetching:u}=T({postId:c});if(u||!e)return t.jsx($,{});const f=()=>{window.location.href=`${p.forum_post}?postId=${e.id}`};return t.jsxs(t.Fragment,{children:[t.jsxs(s,{sx:{p:1.5,cursor:"pointer","&:hover":{bgcolor:"action.hover"}},onClick:f,children:[t.jsx(y,{post:e}),t.jsxs(h,{sx:{gap:1.5,flexDirection:{xs:"column",md:"row"},justifyContent:"space-between",mb:2},children:[t.jsxs(s,{sx:{flex:1},children:[t.jsx(i,{variant:"h6",component:"h3",sx:{textAlign:"start",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:e.title}),t.jsx(i,{variant:"body2",component:"p",sx:{color:"text.secondary",textAlign:"start",display:"-webkit-box",WebkitLineClamp:4,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"pre-line"},children:e.content})]}),e.photos&&e.photos.length>0&&t.jsxs(s,{sx:{flex:.5,display:"flex",gap:1,mt:1,flexWrap:"wrap",justifyContent:{xs:"flex-start",md:"flex-end"}},children:[e.photos.slice(0,3).map(({name:a,url:x},g)=>t.jsx(d,{title:"查看圖片",arrow:!0,placement:"top",children:t.jsx(v,{sx:{position:"relative",width:100,height:100,bgcolor:"divider",borderRadius:1,overflow:"hidden"},children:t.jsx(s,{sx:{position:"absolute",inset:"auto 0 0 0",pb:1,display:"grid",placeItems:"center"},children:t.jsx(s,{sx:{maxWidth:90},children:t.jsx(r,{label:a,size:"small"})})})})},`${x}${g}`)),e.photos.length>3&&t.jsx(d,{title:"查看更多圖片",arrow:!0,placement:"top",children:t.jsxs(o,{color:"inherit",sx:{position:"relative",width:100,height:100,bgcolor:"divider",borderRadius:1},children:["+",e.photos.length-3]})})]})]}),t.jsxs(h,{sx:{gap:1.5,flexDirection:{xs:"column",md:"row"},justifyContent:"space-between",alignItems:{xs:"flex-start",md:"flex-end"},mt:1},children:[t.jsx(s,{sx:{display:"flex",gap:1.5,flexWrap:"wrap"},children:t.jsx(I,{post:e,displayCount:5})}),e.attachments&&e.attachments.length>0&&t.jsxs(s,{sx:{display:"flex",gap:1,flexWrap:"wrap",justifyContent:{xs:"flex-start",md:"flex-end"}},children:[e.attachments.slice(0,3).map((a,x)=>t.jsx(d,{title:"下載附件",arrow:!0,placement:"top",children:t.jsx(r,{label:`${a.name} (${(a.size/1024).toFixed(1)}KB)`,clickable:!0,icon:t.jsx(B,{})})},x)),e.attachments.length>3&&t.jsx(r,{label:`+${e.attachments.length-3}`,variant:"outlined",clickable:!0})]})]})]}),t.jsx(l,{flexItem:!0}),t.jsxs(s,{sx:{p:1.5,py:1,display:"flex",gap:1.5,alignItems:"center",position:"relative",color:"text.secondary",flexWrap:"wrap"},children:[t.jsx(s,{sx:{position:"absolute",inset:0,bgcolor:"divider",opacity:.35}}),e.isSelf?t.jsx(C,{post:e}):t.jsxs(t.Fragment,{children:[t.jsx(k,{postId:e.id,likeCount:e.likeCount}),t.jsx(W,{postId:e.id})]}),t.jsx(o,{color:"inherit",startIcon:t.jsx(m,{}),size:"small",href:`${p.forum_post}?postId=${e.id}`,children:t.jsxs(i,{variant:"caption",component:"span",children:[e.commentCount," 則回覆"]})}),t.jsx(s,{sx:{flex:1}}),t.jsx(o,{startIcon:t.jsx(j,{}),disabled:!0,size:"small",sx:{"button&.Mui-disabled":{color:"text.secondary",opacity:.8}},children:t.jsxs(i,{variant:"caption",component:"span",children:[e.viewCount," 次瀏覽"]})})]}),t.jsx(l,{flexItem:!0})]})};export{$ as E,_ as a};
