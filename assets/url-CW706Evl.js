import{r}from"./routes-D5lITBrd.js";const p=new Event("locationchange"),v=window.history.pushState,R=window.history.replaceState;window.history.pushState=function(...t){v.apply(this,t),window.dispatchEvent(p)};window.history.replaceState=function(...t){R.apply(this,t),window.dispatchEvent(p)};const u=t=>t.startsWith("/")?t:"/"+t;function h(t,l=!1){document.startViewTransition&&!l?document.startViewTransition(t):t()}const w="__preserved__path__key__";function y(){const[t,l]=r.useState(new URLSearchParams(window.location.search)),[i,f]=r.useState(window.location.pathname),c=r.useRef(new Set),m=r.useMemo(()=>({get:e=>(c.current.add(e),t.get(e)),getAll:e=>(c.current.add(e),t.getAll(e)),has:e=>(c.current.add(e),t.has(e))}),[t]),P=r.useMemo(()=>({get:()=>(c.current.add(w),i.replace(/\/$/,"")),getParts:()=>(c.current.add(w),i.replace(/^\/|\/$/g,"").split("/").filter(e=>e!==""))}),[i]),S=r.useCallback((e,a=!1)=>{const n=new URL(window.location.href);Object.entries(e).forEach(([s,o])=>{o===null?n.searchParams.delete(s):n.searchParams.set(s,o)}),h(()=>window.history.pushState({},"",n),a)},[]),g=r.useCallback((e,a=!1)=>{const n=new URL(window.location.href);n.pathname=u(e),h(()=>window.history.pushState({},"",n),a)},[]),E=r.useCallback((e,a,n=!1)=>{const s=new URL(window.location.href);s.pathname=u(e),Object.entries(a).forEach(([o,d])=>{d===null?s.searchParams.delete(o):s.searchParams.set(o,d)}),h(()=>window.history.pushState({},"",s),n)},[]),L=r.useCallback((e=!1)=>{const a=new URL(window.location.href);a.search="",h(()=>window.history.pushState({},"",a),e)},[]);return r.useEffect(()=>{const e=()=>{const a=new URLSearchParams(window.location.search),n=window.location.pathname;let s=!1;c.current.forEach(o=>{(o===w&&i!==n||t.get(o)!==a.get(o))&&(s=!0)}),s&&(l(a),f(n))};return window.addEventListener("popstate",e),window.addEventListener("locationchange",e),()=>{window.removeEventListener("popstate",e),window.removeEventListener("locationchange",e)}},[t,c,i]),{pathname:P,searchParams:m,updatePath:g,updateSearchParams:S,updatePathAndSearchParams:E,clearSearchParams:L}}export{y as u};
