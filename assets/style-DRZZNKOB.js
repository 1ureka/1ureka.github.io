var Wc=Object.defineProperty;var Uc=(e,t,n)=>t in e?Wc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ie=(e,t,n)=>Uc(e,typeof t!="symbol"?t+"":t,n);import{R as Kc,r as H,j as P,B as pe,S as Qc,T as Ie,ar as Be,ah as Zc}from"./routes-DSS9LKLr.js";import{D as Jc}from"./DatasetRounded-j-QIoIvE.js";import{u as eu}from"./with-selector-DgkZje48.js";function se(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=se(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var tu={value:()=>{}};function Qt(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ot(n)}function Ot(e){this._=e}function nu(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ot.prototype=Qt.prototype={constructor:Ot,on:function(e,t){var n=this._,r=nu(e+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(e=r[s]).type)&&(i=ru(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(i=(e=r[s]).type)n[i]=ii(n[i],e.name,t);else if(t==null)for(i in n)n[i]=ii(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Ot(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};function ru(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function ii(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=tu,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var wr="http://www.w3.org/1999/xhtml";const oi={svg:"http://www.w3.org/2000/svg",xhtml:wr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Zt(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),oi.hasOwnProperty(t)?{space:oi[t],local:e}:e}function iu(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===wr&&t.documentElement.namespaceURI===wr?t.createElement(e):t.createElementNS(n,e)}}function ou(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function is(e){var t=Zt(e);return(t.local?ou:iu)(t)}function su(){}function $r(e){return e==null?su:function(){return this.querySelector(e)}}function au(e){typeof e!="function"&&(e=$r(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,a=r[i]=new Array(o),u,d,c=0;c<o;++c)(u=s[c])&&(d=e.call(u,u.__data__,c,s))&&("__data__"in u&&(d.__data__=u.__data__),a[c]=d);return new le(r,this._parents)}function cu(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function uu(){return[]}function os(e){return e==null?uu:function(){return this.querySelectorAll(e)}}function lu(e){return function(){return cu(e.apply(this,arguments))}}function du(e){typeof e=="function"?e=lu(e):e=os(e);for(var t=this._groups,n=t.length,r=[],i=[],s=0;s<n;++s)for(var o=t[s],a=o.length,u,d=0;d<a;++d)(u=o[d])&&(r.push(e.call(u,u.__data__,d,o)),i.push(u));return new le(r,i)}function ss(e){return function(){return this.matches(e)}}function as(e){return function(t){return t.matches(e)}}var fu=Array.prototype.find;function hu(e){return function(){return fu.call(this.children,e)}}function pu(){return this.firstElementChild}function gu(e){return this.select(e==null?pu:hu(typeof e=="function"?e:as(e)))}var mu=Array.prototype.filter;function yu(){return Array.from(this.children)}function xu(e){return function(){return mu.call(this.children,e)}}function wu(e){return this.selectAll(e==null?yu:xu(typeof e=="function"?e:as(e)))}function vu(e){typeof e!="function"&&(e=ss(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,a=r[i]=[],u,d=0;d<o;++d)(u=s[d])&&e.call(u,u.__data__,d,s)&&a.push(u);return new le(r,this._parents)}function cs(e){return new Array(e.length)}function bu(){return new le(this._enter||this._groups.map(cs),this._parents)}function zt(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}zt.prototype={constructor:zt,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function _u(e){return function(){return e}}function Eu(e,t,n,r,i,s){for(var o=0,a,u=t.length,d=s.length;o<d;++o)(a=t[o])?(a.__data__=s[o],r[o]=a):n[o]=new zt(e,s[o]);for(;o<u;++o)(a=t[o])&&(i[o]=a)}function Nu(e,t,n,r,i,s,o){var a,u,d=new Map,c=t.length,l=s.length,f=new Array(c),h;for(a=0;a<c;++a)(u=t[a])&&(f[a]=h=o.call(u,u.__data__,a,t)+"",d.has(h)?i[a]=u:d.set(h,u));for(a=0;a<l;++a)h=o.call(e,s[a],a,s)+"",(u=d.get(h))?(r[a]=u,u.__data__=s[a],d.delete(h)):n[a]=new zt(e,s[a]);for(a=0;a<c;++a)(u=t[a])&&d.get(f[a])===u&&(i[a]=u)}function ku(e){return e.__data__}function Su(e,t){if(!arguments.length)return Array.from(this,ku);var n=t?Nu:Eu,r=this._parents,i=this._groups;typeof e!="function"&&(e=_u(e));for(var s=i.length,o=new Array(s),a=new Array(s),u=new Array(s),d=0;d<s;++d){var c=r[d],l=i[d],f=l.length,h=Cu(e.call(c,c&&c.__data__,d,r)),p=h.length,m=a[d]=new Array(p),w=o[d]=new Array(p),x=u[d]=new Array(f);n(c,l,m,w,x,h,t);for(var v=0,g=0,y,N;v<p;++v)if(y=m[v]){for(v>=g&&(g=v+1);!(N=w[g])&&++g<p;);y._next=N||null}}return o=new le(o,r),o._enter=a,o._exit=u,o}function Cu(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Mu(){return new le(this._exit||this._groups.map(cs),this._parents)}function Iu(e,t,n){var r=this.enter(),i=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function Au(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,s=r.length,o=Math.min(i,s),a=new Array(i),u=0;u<o;++u)for(var d=n[u],c=r[u],l=d.length,f=a[u]=new Array(l),h,p=0;p<l;++p)(h=d[p]||c[p])&&(f[p]=h);for(;u<i;++u)a[u]=n[u];return new le(a,this._parents)}function Tu(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function Ru(e){e||(e=Pu);function t(l,f){return l&&f?e(l.__data__,f.__data__):!l-!f}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],a=o.length,u=i[s]=new Array(a),d,c=0;c<a;++c)(d=o[c])&&(u[c]=d);u.sort(t)}return new le(i,this._parents).order()}function Pu(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function $u(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Ou(){return Array.from(this)}function Lu(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function ju(){let e=0;for(const t of this)++e;return e}function Du(){return!this.node()}function zu(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],s=0,o=i.length,a;s<o;++s)(a=i[s])&&e.call(a,a.__data__,s,i);return this}function Hu(e){return function(){this.removeAttribute(e)}}function Vu(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Bu(e,t){return function(){this.setAttribute(e,t)}}function Fu(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function qu(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Yu(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Gu(e,t){var n=Zt(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Vu:Hu:typeof t=="function"?n.local?Yu:qu:n.local?Fu:Bu)(n,t))}function us(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Xu(e){return function(){this.style.removeProperty(e)}}function Wu(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Uu(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Ku(e,t,n){return arguments.length>1?this.each((t==null?Xu:typeof t=="function"?Uu:Wu)(e,t,n??"")):Ye(this.node(),e)}function Ye(e,t){return e.style.getPropertyValue(t)||us(e).getComputedStyle(e,null).getPropertyValue(t)}function Qu(e){return function(){delete this[e]}}function Zu(e,t){return function(){this[e]=t}}function Ju(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function el(e,t){return arguments.length>1?this.each((t==null?Qu:typeof t=="function"?Ju:Zu)(e,t)):this.node()[e]}function ls(e){return e.trim().split(/^|\s+/)}function Or(e){return e.classList||new ds(e)}function ds(e){this._node=e,this._names=ls(e.getAttribute("class")||"")}ds.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function fs(e,t){for(var n=Or(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function hs(e,t){for(var n=Or(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function tl(e){return function(){fs(this,e)}}function nl(e){return function(){hs(this,e)}}function rl(e,t){return function(){(t.apply(this,arguments)?fs:hs)(this,e)}}function il(e,t){var n=ls(e+"");if(arguments.length<2){for(var r=Or(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?rl:t?tl:nl)(n,t))}function ol(){this.textContent=""}function sl(e){return function(){this.textContent=e}}function al(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function cl(e){return arguments.length?this.each(e==null?ol:(typeof e=="function"?al:sl)(e)):this.node().textContent}function ul(){this.innerHTML=""}function ll(e){return function(){this.innerHTML=e}}function dl(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function fl(e){return arguments.length?this.each(e==null?ul:(typeof e=="function"?dl:ll)(e)):this.node().innerHTML}function hl(){this.nextSibling&&this.parentNode.appendChild(this)}function pl(){return this.each(hl)}function gl(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ml(){return this.each(gl)}function yl(e){var t=typeof e=="function"?e:is(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function xl(){return null}function wl(e,t){var n=typeof e=="function"?e:is(e),r=t==null?xl:typeof t=="function"?t:$r(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function vl(){var e=this.parentNode;e&&e.removeChild(this)}function bl(){return this.each(vl)}function _l(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function El(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Nl(e){return this.select(e?El:_l)}function kl(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Sl(e){return function(t){e.call(this,t,this.__data__)}}function Cl(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Ml(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,s;n<i;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function Il(e,t,n){return function(){var r=this.__on,i,s=Sl(t);if(r){for(var o=0,a=r.length;o<a;++o)if((i=r[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=t;return}}this.addEventListener(e.type,s,n),i={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(i):this.__on=[i]}}function Al(e,t,n){var r=Cl(e+""),i,s=r.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var u=0,d=a.length,c;u<d;++u)for(i=0,c=a[u];i<s;++i)if((o=r[i]).type===c.type&&o.name===c.name)return c.value}return}for(a=t?Il:Ml,i=0;i<s;++i)this.each(a(r[i],t,n));return this}function ps(e,t,n){var r=us(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function Tl(e,t){return function(){return ps(this,e,t)}}function Rl(e,t){return function(){return ps(this,e,t.apply(this,arguments))}}function Pl(e,t){return this.each((typeof t=="function"?Rl:Tl)(e,t))}function*$l(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var gs=[null];function le(e,t){this._groups=e,this._parents=t}function wt(){return new le([[document.documentElement]],gs)}function Ol(){return this}le.prototype=wt.prototype={constructor:le,select:au,selectAll:du,selectChild:gu,selectChildren:wu,filter:vu,data:Su,enter:bu,exit:Mu,join:Iu,merge:Au,selection:Ol,order:Tu,sort:Ru,call:$u,nodes:Ou,node:Lu,size:ju,empty:Du,each:zu,attr:Gu,style:Ku,property:el,classed:il,text:cl,html:fl,raise:pl,lower:ml,append:yl,insert:wl,remove:bl,clone:Nl,datum:kl,on:Al,dispatch:Pl,[Symbol.iterator]:$l};function ue(e){return typeof e=="string"?new le([[document.querySelector(e)]],[document.documentElement]):new le([[e]],gs)}function Ll(e){let t;for(;t=e.sourceEvent;)e=t;return e}function de(e,t){if(e=Ll(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const jl={passive:!1},ut={capture:!0,passive:!1};function yn(e){e.stopImmediatePropagation()}function Fe(e){e.preventDefault(),e.stopImmediatePropagation()}function ms(e){var t=e.document.documentElement,n=ue(e).on("dragstart.drag",Fe,ut);"onselectstart"in t?n.on("selectstart.drag",Fe,ut):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function ys(e,t){var n=e.document.documentElement,r=ue(e).on("dragstart.drag",null);t&&(r.on("click.drag",Fe,ut),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const St=e=>()=>e;function vr(e,{sourceEvent:t,subject:n,target:r,identifier:i,active:s,x:o,y:a,dx:u,dy:d,dispatch:c}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:u,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:c}})}vr.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Dl(e){return!e.ctrlKey&&!e.button}function zl(){return this.parentNode}function Hl(e,t){return t??{x:e.x,y:e.y}}function Vl(){return navigator.maxTouchPoints||"ontouchstart"in this}function xs(){var e=Dl,t=zl,n=Hl,r=Vl,i={},s=Qt("start","drag","end"),o=0,a,u,d,c,l=0;function f(y){y.on("mousedown.drag",h).filter(r).on("touchstart.drag",w).on("touchmove.drag",x,jl).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(y,N){if(!(c||!e.call(this,y,N))){var S=g(this,t.call(this,y,N),y,N,"mouse");S&&(ue(y.view).on("mousemove.drag",p,ut).on("mouseup.drag",m,ut),ms(y.view),yn(y),d=!1,a=y.clientX,u=y.clientY,S("start",y))}}function p(y){if(Fe(y),!d){var N=y.clientX-a,S=y.clientY-u;d=N*N+S*S>l}i.mouse("drag",y)}function m(y){ue(y.view).on("mousemove.drag mouseup.drag",null),ys(y.view,d),Fe(y),i.mouse("end",y)}function w(y,N){if(e.call(this,y,N)){var S=y.changedTouches,C=t.call(this,y,N),_=S.length,E,k;for(E=0;E<_;++E)(k=g(this,C,y,N,S[E].identifier,S[E]))&&(yn(y),k("start",y,S[E]))}}function x(y){var N=y.changedTouches,S=N.length,C,_;for(C=0;C<S;++C)(_=i[N[C].identifier])&&(Fe(y),_("drag",y,N[C]))}function v(y){var N=y.changedTouches,S=N.length,C,_;for(c&&clearTimeout(c),c=setTimeout(function(){c=null},500),C=0;C<S;++C)(_=i[N[C].identifier])&&(yn(y),_("end",y,N[C]))}function g(y,N,S,C,_,E){var k=s.copy(),M=de(E||S,N),I,D,b;if((b=n.call(y,new vr("beforestart",{sourceEvent:S,target:f,identifier:_,active:o,x:M[0],y:M[1],dx:0,dy:0,dispatch:k}),C))!=null)return I=b.x-M[0]||0,D=b.y-M[1]||0,function R(A,$,z){var O=M,V;switch(A){case"start":i[_]=R,V=o++;break;case"end":delete i[_],--o;case"drag":M=de(z||$,N),V=o;break}k.call(A,y,new vr(A,{sourceEvent:$,subject:b,target:f,identifier:_,active:V,x:M[0]+I,y:M[1]+D,dx:M[0]-O[0],dy:M[1]-O[1],dispatch:k}),C)}}return f.filter=function(y){return arguments.length?(e=typeof y=="function"?y:St(!!y),f):e},f.container=function(y){return arguments.length?(t=typeof y=="function"?y:St(y),f):t},f.subject=function(y){return arguments.length?(n=typeof y=="function"?y:St(y),f):n},f.touchable=function(y){return arguments.length?(r=typeof y=="function"?y:St(!!y),f):r},f.on=function(){var y=s.on.apply(s,arguments);return y===s?f:y},f.clickDistance=function(y){return arguments.length?(l=(y=+y)*y,f):Math.sqrt(l)},f}function Lr(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function ws(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function vt(){}var lt=.7,Ht=1/lt,qe="\\s*([+-]?\\d+)\\s*",dt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ye="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Bl=/^#([0-9a-f]{3,8})$/,Fl=new RegExp(`^rgb\\(${qe},${qe},${qe}\\)$`),ql=new RegExp(`^rgb\\(${ye},${ye},${ye}\\)$`),Yl=new RegExp(`^rgba\\(${qe},${qe},${qe},${dt}\\)$`),Gl=new RegExp(`^rgba\\(${ye},${ye},${ye},${dt}\\)$`),Xl=new RegExp(`^hsl\\(${dt},${ye},${ye}\\)$`),Wl=new RegExp(`^hsla\\(${dt},${ye},${ye},${dt}\\)$`),si={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Lr(vt,ft,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:ai,formatHex:ai,formatHex8:Ul,formatHsl:Kl,formatRgb:ci,toString:ci});function ai(){return this.rgb().formatHex()}function Ul(){return this.rgb().formatHex8()}function Kl(){return vs(this).formatHsl()}function ci(){return this.rgb().formatRgb()}function ft(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Bl.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?ui(t):n===3?new ce(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Ct(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Ct(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Fl.exec(e))?new ce(t[1],t[2],t[3],1):(t=ql.exec(e))?new ce(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Yl.exec(e))?Ct(t[1],t[2],t[3],t[4]):(t=Gl.exec(e))?Ct(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Xl.exec(e))?fi(t[1],t[2]/100,t[3]/100,1):(t=Wl.exec(e))?fi(t[1],t[2]/100,t[3]/100,t[4]):si.hasOwnProperty(e)?ui(si[e]):e==="transparent"?new ce(NaN,NaN,NaN,0):null}function ui(e){return new ce(e>>16&255,e>>8&255,e&255,1)}function Ct(e,t,n,r){return r<=0&&(e=t=n=NaN),new ce(e,t,n,r)}function Ql(e){return e instanceof vt||(e=ft(e)),e?(e=e.rgb(),new ce(e.r,e.g,e.b,e.opacity)):new ce}function br(e,t,n,r){return arguments.length===1?Ql(e):new ce(e,t,n,r??1)}function ce(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Lr(ce,br,ws(vt,{brighter(e){return e=e==null?Ht:Math.pow(Ht,e),new ce(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?lt:Math.pow(lt,e),new ce(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ce(Pe(this.r),Pe(this.g),Pe(this.b),Vt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:li,formatHex:li,formatHex8:Zl,formatRgb:di,toString:di}));function li(){return`#${Re(this.r)}${Re(this.g)}${Re(this.b)}`}function Zl(){return`#${Re(this.r)}${Re(this.g)}${Re(this.b)}${Re((isNaN(this.opacity)?1:this.opacity)*255)}`}function di(){const e=Vt(this.opacity);return`${e===1?"rgb(":"rgba("}${Pe(this.r)}, ${Pe(this.g)}, ${Pe(this.b)}${e===1?")":`, ${e})`}`}function Vt(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Pe(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Re(e){return e=Pe(e),(e<16?"0":"")+e.toString(16)}function fi(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new fe(e,t,n,r)}function vs(e){if(e instanceof fe)return new fe(e.h,e.s,e.l,e.opacity);if(e instanceof vt||(e=ft(e)),!e)return new fe;if(e instanceof fe)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),o=NaN,a=s-i,u=(s+i)/2;return a?(t===s?o=(n-r)/a+(n<r)*6:n===s?o=(r-t)/a+2:o=(t-n)/a+4,a/=u<.5?s+i:2-s-i,o*=60):a=u>0&&u<1?0:o,new fe(o,a,u,e.opacity)}function Jl(e,t,n,r){return arguments.length===1?vs(e):new fe(e,t,n,r??1)}function fe(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Lr(fe,Jl,ws(vt,{brighter(e){return e=e==null?Ht:Math.pow(Ht,e),new fe(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?lt:Math.pow(lt,e),new fe(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new ce(xn(e>=240?e-240:e+120,i,r),xn(e,i,r),xn(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new fe(hi(this.h),Mt(this.s),Mt(this.l),Vt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Vt(this.opacity);return`${e===1?"hsl(":"hsla("}${hi(this.h)}, ${Mt(this.s)*100}%, ${Mt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function hi(e){return e=(e||0)%360,e<0?e+360:e}function Mt(e){return Math.max(0,Math.min(1,e||0))}function xn(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const bs=e=>()=>e;function ed(e,t){return function(n){return e+n*t}}function td(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function nd(e){return(e=+e)==1?_s:function(t,n){return n-t?td(t,n,e):bs(isNaN(t)?n:t)}}function _s(e,t){var n=t-e;return n?ed(e,n):bs(isNaN(e)?t:e)}const pi=function e(t){var n=nd(t);function r(i,s){var o=n((i=br(i)).r,(s=br(s)).r),a=n(i.g,s.g),u=n(i.b,s.b),d=_s(i.opacity,s.opacity);return function(c){return i.r=o(c),i.g=a(c),i.b=u(c),i.opacity=d(c),i+""}}return r.gamma=e,r}(1);function Ce(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var _r=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,wn=new RegExp(_r.source,"g");function rd(e){return function(){return e}}function id(e){return function(t){return e(t)+""}}function od(e,t){var n=_r.lastIndex=wn.lastIndex=0,r,i,s,o=-1,a=[],u=[];for(e=e+"",t=t+"";(r=_r.exec(e))&&(i=wn.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,u.push({i:o,x:Ce(r,i)})),n=wn.lastIndex;return n<t.length&&(s=t.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?u[0]?id(u[0].x):rd(t):(t=u.length,function(d){for(var c=0,l;c<t;++c)a[(l=u[c]).i]=l.x(d);return a.join("")})}var gi=180/Math.PI,Er={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Es(e,t,n,r,i,s){var o,a,u;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,u/=a),e*r<t*n&&(e=-e,t=-t,u=-u,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*gi,skewX:Math.atan(u)*gi,scaleX:o,scaleY:a}}var It;function sd(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Er:Es(t.a,t.b,t.c,t.d,t.e,t.f)}function ad(e){return e==null||(It||(It=document.createElementNS("http://www.w3.org/2000/svg","g")),It.setAttribute("transform",e),!(e=It.transform.baseVal.consolidate()))?Er:(e=e.matrix,Es(e.a,e.b,e.c,e.d,e.e,e.f))}function Ns(e,t,n,r){function i(d){return d.length?d.pop()+" ":""}function s(d,c,l,f,h,p){if(d!==l||c!==f){var m=h.push("translate(",null,t,null,n);p.push({i:m-4,x:Ce(d,l)},{i:m-2,x:Ce(c,f)})}else(l||f)&&h.push("translate("+l+t+f+n)}function o(d,c,l,f){d!==c?(d-c>180?c+=360:c-d>180&&(d+=360),f.push({i:l.push(i(l)+"rotate(",null,r)-2,x:Ce(d,c)})):c&&l.push(i(l)+"rotate("+c+r)}function a(d,c,l,f){d!==c?f.push({i:l.push(i(l)+"skewX(",null,r)-2,x:Ce(d,c)}):c&&l.push(i(l)+"skewX("+c+r)}function u(d,c,l,f,h,p){if(d!==l||c!==f){var m=h.push(i(h)+"scale(",null,",",null,")");p.push({i:m-4,x:Ce(d,l)},{i:m-2,x:Ce(c,f)})}else(l!==1||f!==1)&&h.push(i(h)+"scale("+l+","+f+")")}return function(d,c){var l=[],f=[];return d=e(d),c=e(c),s(d.translateX,d.translateY,c.translateX,c.translateY,l,f),o(d.rotate,c.rotate,l,f),a(d.skewX,c.skewX,l,f),u(d.scaleX,d.scaleY,c.scaleX,c.scaleY,l,f),d=c=null,function(h){for(var p=-1,m=f.length,w;++p<m;)l[(w=f[p]).i]=w.x(h);return l.join("")}}}var cd=Ns(sd,"px, ","px)","deg)"),ud=Ns(ad,", ",")",")"),ld=1e-12;function mi(e){return((e=Math.exp(e))+1/e)/2}function dd(e){return((e=Math.exp(e))-1/e)/2}function fd(e){return((e=Math.exp(2*e))-1)/(e+1)}const hd=function e(t,n,r){function i(s,o){var a=s[0],u=s[1],d=s[2],c=o[0],l=o[1],f=o[2],h=c-a,p=l-u,m=h*h+p*p,w,x;if(m<ld)x=Math.log(f/d)/t,w=function(C){return[a+C*h,u+C*p,d*Math.exp(t*C*x)]};else{var v=Math.sqrt(m),g=(f*f-d*d+r*m)/(2*d*n*v),y=(f*f-d*d-r*m)/(2*f*n*v),N=Math.log(Math.sqrt(g*g+1)-g),S=Math.log(Math.sqrt(y*y+1)-y);x=(S-N)/t,w=function(C){var _=C*x,E=mi(N),k=d/(n*v)*(E*fd(t*_+N)-dd(N));return[a+k*h,u+k*p,d*E/mi(t*_+N)]}}return w.duration=x*1e3*t/Math.SQRT2,w}return i.rho=function(s){var o=Math.max(.001,+s),a=o*o,u=a*a;return e(o,a,u)},i}(Math.SQRT2,2,4);var Ge=0,ot=0,rt=0,ks=1e3,Bt,st,Ft=0,Le=0,Jt=0,ht=typeof performance=="object"&&performance.now?performance:Date,Ss=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function jr(){return Le||(Ss(pd),Le=ht.now()+Jt)}function pd(){Le=0}function qt(){this._call=this._time=this._next=null}qt.prototype=Cs.prototype={constructor:qt,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?jr():+n)+(t==null?0:+t),!this._next&&st!==this&&(st?st._next=this:Bt=this,st=this),this._call=e,this._time=n,Nr()},stop:function(){this._call&&(this._call=null,this._time=1/0,Nr())}};function Cs(e,t,n){var r=new qt;return r.restart(e,t,n),r}function gd(){jr(),++Ge;for(var e=Bt,t;e;)(t=Le-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ge}function yi(){Le=(Ft=ht.now())+Jt,Ge=ot=0;try{gd()}finally{Ge=0,yd(),Le=0}}function md(){var e=ht.now(),t=e-Ft;t>ks&&(Jt-=t,Ft=e)}function yd(){for(var e,t=Bt,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Bt=n);st=e,Nr(r)}function Nr(e){if(!Ge){ot&&(ot=clearTimeout(ot));var t=e-Le;t>24?(e<1/0&&(ot=setTimeout(yi,e-ht.now()-Jt)),rt&&(rt=clearInterval(rt))):(rt||(Ft=ht.now(),rt=setInterval(md,ks)),Ge=1,Ss(yi))}}function xi(e,t,n){var r=new qt;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var xd=Qt("start","end","cancel","interrupt"),wd=[],Ms=0,wi=1,kr=2,Lt=3,vi=4,Sr=5,jt=6;function en(e,t,n,r,i,s){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;vd(e,n,{name:t,index:r,group:i,on:xd,tween:wd,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Ms})}function Dr(e,t){var n=me(e,t);if(n.state>Ms)throw new Error("too late; already scheduled");return n}function we(e,t){var n=me(e,t);if(n.state>Lt)throw new Error("too late; already running");return n}function me(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function vd(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=Cs(s,0,n.time);function s(d){n.state=wi,n.timer.restart(o,n.delay,n.time),n.delay<=d&&o(d-n.delay)}function o(d){var c,l,f,h;if(n.state!==wi)return u();for(c in r)if(h=r[c],h.name===n.name){if(h.state===Lt)return xi(o);h.state===vi?(h.state=jt,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[c]):+c<t&&(h.state=jt,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[c])}if(xi(function(){n.state===Lt&&(n.state=vi,n.timer.restart(a,n.delay,n.time),a(d))}),n.state=kr,n.on.call("start",e,e.__data__,n.index,n.group),n.state===kr){for(n.state=Lt,i=new Array(f=n.tween.length),c=0,l=-1;c<f;++c)(h=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(i[++l]=h);i.length=l+1}}function a(d){for(var c=d<n.duration?n.ease.call(null,d/n.duration):(n.timer.restart(u),n.state=Sr,1),l=-1,f=i.length;++l<f;)i[l].call(e,c);n.state===Sr&&(n.on.call("end",e,e.__data__,n.index,n.group),u())}function u(){n.state=jt,n.timer.stop(),delete r[t];for(var d in r)return;delete e.__transition}}function Dt(e,t){var n=e.__transition,r,i,s=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((r=n[o]).name!==t){s=!1;continue}i=r.state>kr&&r.state<Sr,r.state=jt,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[o]}s&&delete e.__transition}}function bd(e){return this.each(function(){Dt(this,e)})}function _d(e,t){var n,r;return function(){var i=we(this,e),s=i.tween;if(s!==n){r=n=s;for(var o=0,a=r.length;o<a;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function Ed(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=we(this,e),o=s.tween;if(o!==r){i=(r=o).slice();for(var a={name:t,value:n},u=0,d=i.length;u<d;++u)if(i[u].name===t){i[u]=a;break}u===d&&i.push(a)}s.tween=i}}function Nd(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=me(this.node(),n).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((t==null?_d:Ed)(n,e,t))}function zr(e,t,n){var r=e._id;return e.each(function(){var i=we(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return me(i,r).value[t]}}function Is(e,t){var n;return(typeof t=="number"?Ce:t instanceof ft?pi:(n=ft(t))?(t=n,pi):od)(e,t)}function kd(e){return function(){this.removeAttribute(e)}}function Sd(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Cd(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttribute(e);return o===i?null:o===r?s:s=t(r=o,n)}}function Md(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?s:s=t(r=o,n)}}function Id(e,t,n){var r,i,s;return function(){var o,a=n(this),u;return a==null?void this.removeAttribute(e):(o=this.getAttribute(e),u=a+"",o===u?null:o===r&&u===i?s:(i=u,s=t(r=o,a)))}}function Ad(e,t,n){var r,i,s;return function(){var o,a=n(this),u;return a==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),u=a+"",o===u?null:o===r&&u===i?s:(i=u,s=t(r=o,a)))}}function Td(e,t){var n=Zt(e),r=n==="transform"?ud:Is;return this.attrTween(e,typeof t=="function"?(n.local?Ad:Id)(n,r,zr(this,"attr."+e,t)):t==null?(n.local?Sd:kd)(n):(n.local?Md:Cd)(n,r,t))}function Rd(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Pd(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function $d(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&Pd(e,s)),n}return i._value=t,i}function Od(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&Rd(e,s)),n}return i._value=t,i}function Ld(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Zt(e);return this.tween(n,(r.local?$d:Od)(r,t))}function jd(e,t){return function(){Dr(this,e).delay=+t.apply(this,arguments)}}function Dd(e,t){return t=+t,function(){Dr(this,e).delay=t}}function zd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?jd:Dd)(t,e)):me(this.node(),t).delay}function Hd(e,t){return function(){we(this,e).duration=+t.apply(this,arguments)}}function Vd(e,t){return t=+t,function(){we(this,e).duration=t}}function Bd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Hd:Vd)(t,e)):me(this.node(),t).duration}function Fd(e,t){if(typeof t!="function")throw new Error;return function(){we(this,e).ease=t}}function qd(e){var t=this._id;return arguments.length?this.each(Fd(t,e)):me(this.node(),t).ease}function Yd(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;we(this,e).ease=n}}function Gd(e){if(typeof e!="function")throw new Error;return this.each(Yd(this._id,e))}function Xd(e){typeof e!="function"&&(e=ss(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,a=r[i]=[],u,d=0;d<o;++d)(u=s[d])&&e.call(u,u.__data__,d,s)&&a.push(u);return new Ee(r,this._parents,this._name,this._id)}function Wd(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,s=Math.min(r,i),o=new Array(r),a=0;a<s;++a)for(var u=t[a],d=n[a],c=u.length,l=o[a]=new Array(c),f,h=0;h<c;++h)(f=u[h]||d[h])&&(l[h]=f);for(;a<r;++a)o[a]=t[a];return new Ee(o,this._parents,this._name,this._id)}function Ud(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Kd(e,t,n){var r,i,s=Ud(t)?Dr:we;return function(){var o=s(this,e),a=o.on;a!==r&&(i=(r=a).copy()).on(t,n),o.on=i}}function Qd(e,t){var n=this._id;return arguments.length<2?me(this.node(),n).on.on(e):this.each(Kd(n,e,t))}function Zd(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Jd(){return this.on("end.remove",Zd(this._id))}function ef(e){var t=this._name,n=this._id;typeof e!="function"&&(e=$r(e));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var a=r[o],u=a.length,d=s[o]=new Array(u),c,l,f=0;f<u;++f)(c=a[f])&&(l=e.call(c,c.__data__,f,a))&&("__data__"in c&&(l.__data__=c.__data__),d[f]=l,en(d[f],t,n,f,d,me(c,n)));return new Ee(s,this._parents,t,n)}function tf(e){var t=this._name,n=this._id;typeof e!="function"&&(e=os(e));for(var r=this._groups,i=r.length,s=[],o=[],a=0;a<i;++a)for(var u=r[a],d=u.length,c,l=0;l<d;++l)if(c=u[l]){for(var f=e.call(c,c.__data__,l,u),h,p=me(c,n),m=0,w=f.length;m<w;++m)(h=f[m])&&en(h,t,n,m,f,p);s.push(f),o.push(c)}return new Ee(s,o,t,n)}var nf=wt.prototype.constructor;function rf(){return new nf(this._groups,this._parents)}function of(e,t){var n,r,i;return function(){var s=Ye(this,e),o=(this.style.removeProperty(e),Ye(this,e));return s===o?null:s===n&&o===r?i:i=t(n=s,r=o)}}function As(e){return function(){this.style.removeProperty(e)}}function sf(e,t,n){var r,i=n+"",s;return function(){var o=Ye(this,e);return o===i?null:o===r?s:s=t(r=o,n)}}function af(e,t,n){var r,i,s;return function(){var o=Ye(this,e),a=n(this),u=a+"";return a==null&&(u=a=(this.style.removeProperty(e),Ye(this,e))),o===u?null:o===r&&u===i?s:(i=u,s=t(r=o,a))}}function cf(e,t){var n,r,i,s="style."+t,o="end."+s,a;return function(){var u=we(this,e),d=u.on,c=u.value[s]==null?a||(a=As(t)):void 0;(d!==n||i!==c)&&(r=(n=d).copy()).on(o,i=c),u.on=r}}function uf(e,t,n){var r=(e+="")=="transform"?cd:Is;return t==null?this.styleTween(e,of(e,r)).on("end.style."+e,As(e)):typeof t=="function"?this.styleTween(e,af(e,r,zr(this,"style."+e,t))).each(cf(this._id,e)):this.styleTween(e,sf(e,r,t),n).on("end.style."+e,null)}function lf(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function df(e,t,n){var r,i;function s(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&lf(e,o,n)),r}return s._value=t,s}function ff(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,df(e,t,n??""))}function hf(e){return function(){this.textContent=e}}function pf(e){return function(){var t=e(this);this.textContent=t??""}}function gf(e){return this.tween("text",typeof e=="function"?pf(zr(this,"text",e)):hf(e==null?"":e+""))}function mf(e){return function(t){this.textContent=e.call(this,t)}}function yf(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&mf(i)),t}return r._value=e,r}function xf(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,yf(e))}function wf(){for(var e=this._name,t=this._id,n=Ts(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,u,d=0;d<a;++d)if(u=o[d]){var c=me(u,t);en(u,e,n,d,o,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Ee(r,this._parents,e,n)}function vf(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var a={value:o},u={value:function(){--i===0&&s()}};n.each(function(){var d=we(this,r),c=d.on;c!==e&&(t=(e=c).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(u)),d.on=t}),i===0&&s()})}var bf=0;function Ee(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Ts(){return++bf}var ve=wt.prototype;Ee.prototype={constructor:Ee,select:ef,selectAll:tf,selectChild:ve.selectChild,selectChildren:ve.selectChildren,filter:Xd,merge:Wd,selection:rf,transition:wf,call:ve.call,nodes:ve.nodes,node:ve.node,size:ve.size,empty:ve.empty,each:ve.each,on:Qd,attr:Td,attrTween:Ld,style:uf,styleTween:ff,text:gf,textTween:xf,remove:Jd,tween:Nd,delay:zd,duration:Bd,ease:qd,easeVarying:Gd,end:vf,[Symbol.iterator]:ve[Symbol.iterator]};function _f(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Ef={time:null,delay:0,duration:250,ease:_f};function Nf(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function kf(e){var t,n;e instanceof Ee?(t=e._id,e=e._name):(t=Ts(),(n=Ef).time=jr(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,u,d=0;d<a;++d)(u=o[d])&&en(u,e,t,d,o,n||Nf(u,t));return new Ee(r,this._parents,e,t)}wt.prototype.interrupt=bd;wt.prototype.transition=kf;const At=e=>()=>e;function Sf(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function be(e,t,n){this.k=e,this.x=t,this.y=n}be.prototype={constructor:be,scale:function(e){return e===1?this:new be(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new be(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var tn=new be(1,0,0);Rs.prototype=be.prototype;function Rs(e){for(;!e.__zoom;)if(!(e=e.parentNode))return tn;return e.__zoom}function vn(e){e.stopImmediatePropagation()}function it(e){e.preventDefault(),e.stopImmediatePropagation()}function Cf(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Mf(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function bi(){return this.__zoom||tn}function If(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Af(){return navigator.maxTouchPoints||"ontouchstart"in this}function Tf(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],o=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function Ps(){var e=Cf,t=Mf,n=Tf,r=If,i=Af,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],a=250,u=hd,d=Qt("start","zoom","end"),c,l,f,h=500,p=150,m=0,w=10;function x(b){b.property("__zoom",bi).on("wheel.zoom",_,{passive:!1}).on("mousedown.zoom",E).on("dblclick.zoom",k).filter(i).on("touchstart.zoom",M).on("touchmove.zoom",I).on("touchend.zoom touchcancel.zoom",D).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}x.transform=function(b,R,A,$){var z=b.selection?b.selection():b;z.property("__zoom",bi),b!==z?N(b,R,A,$):z.interrupt().each(function(){S(this,arguments).event($).start().zoom(null,typeof R=="function"?R.apply(this,arguments):R).end()})},x.scaleBy=function(b,R,A,$){x.scaleTo(b,function(){var z=this.__zoom.k,O=typeof R=="function"?R.apply(this,arguments):R;return z*O},A,$)},x.scaleTo=function(b,R,A,$){x.transform(b,function(){var z=t.apply(this,arguments),O=this.__zoom,V=A==null?y(z):typeof A=="function"?A.apply(this,arguments):A,q=O.invert(V),Y=typeof R=="function"?R.apply(this,arguments):R;return n(g(v(O,Y),V,q),z,o)},A,$)},x.translateBy=function(b,R,A,$){x.transform(b,function(){return n(this.__zoom.translate(typeof R=="function"?R.apply(this,arguments):R,typeof A=="function"?A.apply(this,arguments):A),t.apply(this,arguments),o)},null,$)},x.translateTo=function(b,R,A,$,z){x.transform(b,function(){var O=t.apply(this,arguments),V=this.__zoom,q=$==null?y(O):typeof $=="function"?$.apply(this,arguments):$;return n(tn.translate(q[0],q[1]).scale(V.k).translate(typeof R=="function"?-R.apply(this,arguments):-R,typeof A=="function"?-A.apply(this,arguments):-A),O,o)},$,z)};function v(b,R){return R=Math.max(s[0],Math.min(s[1],R)),R===b.k?b:new be(R,b.x,b.y)}function g(b,R,A){var $=R[0]-A[0]*b.k,z=R[1]-A[1]*b.k;return $===b.x&&z===b.y?b:new be(b.k,$,z)}function y(b){return[(+b[0][0]+ +b[1][0])/2,(+b[0][1]+ +b[1][1])/2]}function N(b,R,A,$){b.on("start.zoom",function(){S(this,arguments).event($).start()}).on("interrupt.zoom end.zoom",function(){S(this,arguments).event($).end()}).tween("zoom",function(){var z=this,O=arguments,V=S(z,O).event($),q=t.apply(z,O),Y=A==null?y(q):typeof A=="function"?A.apply(z,O):A,T=Math.max(q[1][0]-q[0][0],q[1][1]-q[0][1]),L=z.__zoom,j=typeof R=="function"?R.apply(z,O):R,B=u(L.invert(Y).concat(T/L.k),j.invert(Y).concat(T/j.k));return function(F){if(F===1)F=j;else{var G=B(F),X=T/G[2];F=new be(X,Y[0]-G[0]*X,Y[1]-G[1]*X)}V.zoom(null,F)}})}function S(b,R,A){return!A&&b.__zooming||new C(b,R)}function C(b,R){this.that=b,this.args=R,this.active=0,this.sourceEvent=null,this.extent=t.apply(b,R),this.taps=0}C.prototype={event:function(b){return b&&(this.sourceEvent=b),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(b,R){return this.mouse&&b!=="mouse"&&(this.mouse[1]=R.invert(this.mouse[0])),this.touch0&&b!=="touch"&&(this.touch0[1]=R.invert(this.touch0[0])),this.touch1&&b!=="touch"&&(this.touch1[1]=R.invert(this.touch1[0])),this.that.__zoom=R,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(b){var R=ue(this.that).datum();d.call(b,this.that,new Sf(b,{sourceEvent:this.sourceEvent,target:x,transform:this.that.__zoom,dispatch:d}),R)}};function _(b,...R){if(!e.apply(this,arguments))return;var A=S(this,R).event(b),$=this.__zoom,z=Math.max(s[0],Math.min(s[1],$.k*Math.pow(2,r.apply(this,arguments)))),O=de(b);if(A.wheel)(A.mouse[0][0]!==O[0]||A.mouse[0][1]!==O[1])&&(A.mouse[1]=$.invert(A.mouse[0]=O)),clearTimeout(A.wheel);else{if($.k===z)return;A.mouse=[O,$.invert(O)],Dt(this),A.start()}it(b),A.wheel=setTimeout(V,p),A.zoom("mouse",n(g(v($,z),A.mouse[0],A.mouse[1]),A.extent,o));function V(){A.wheel=null,A.end()}}function E(b,...R){if(f||!e.apply(this,arguments))return;var A=b.currentTarget,$=S(this,R,!0).event(b),z=ue(b.view).on("mousemove.zoom",Y,!0).on("mouseup.zoom",T,!0),O=de(b,A),V=b.clientX,q=b.clientY;ms(b.view),vn(b),$.mouse=[O,this.__zoom.invert(O)],Dt(this),$.start();function Y(L){if(it(L),!$.moved){var j=L.clientX-V,B=L.clientY-q;$.moved=j*j+B*B>m}$.event(L).zoom("mouse",n(g($.that.__zoom,$.mouse[0]=de(L,A),$.mouse[1]),$.extent,o))}function T(L){z.on("mousemove.zoom mouseup.zoom",null),ys(L.view,$.moved),it(L),$.event(L).end()}}function k(b,...R){if(e.apply(this,arguments)){var A=this.__zoom,$=de(b.changedTouches?b.changedTouches[0]:b,this),z=A.invert($),O=A.k*(b.shiftKey?.5:2),V=n(g(v(A,O),$,z),t.apply(this,R),o);it(b),a>0?ue(this).transition().duration(a).call(N,V,$,b):ue(this).call(x.transform,V,$,b)}}function M(b,...R){if(e.apply(this,arguments)){var A=b.touches,$=A.length,z=S(this,R,b.changedTouches.length===$).event(b),O,V,q,Y;for(vn(b),V=0;V<$;++V)q=A[V],Y=de(q,this),Y=[Y,this.__zoom.invert(Y),q.identifier],z.touch0?!z.touch1&&z.touch0[2]!==Y[2]&&(z.touch1=Y,z.taps=0):(z.touch0=Y,O=!0,z.taps=1+!!c);c&&(c=clearTimeout(c)),O&&(z.taps<2&&(l=Y[0],c=setTimeout(function(){c=null},h)),Dt(this),z.start())}}function I(b,...R){if(this.__zooming){var A=S(this,R).event(b),$=b.changedTouches,z=$.length,O,V,q,Y;for(it(b),O=0;O<z;++O)V=$[O],q=de(V,this),A.touch0&&A.touch0[2]===V.identifier?A.touch0[0]=q:A.touch1&&A.touch1[2]===V.identifier&&(A.touch1[0]=q);if(V=A.that.__zoom,A.touch1){var T=A.touch0[0],L=A.touch0[1],j=A.touch1[0],B=A.touch1[1],F=(F=j[0]-T[0])*F+(F=j[1]-T[1])*F,G=(G=B[0]-L[0])*G+(G=B[1]-L[1])*G;V=v(V,Math.sqrt(F/G)),q=[(T[0]+j[0])/2,(T[1]+j[1])/2],Y=[(L[0]+B[0])/2,(L[1]+B[1])/2]}else if(A.touch0)q=A.touch0[0],Y=A.touch0[1];else return;A.zoom("touch",n(g(V,q,Y),A.extent,o))}}function D(b,...R){if(this.__zooming){var A=S(this,R).event(b),$=b.changedTouches,z=$.length,O,V;for(vn(b),f&&clearTimeout(f),f=setTimeout(function(){f=null},h),O=0;O<z;++O)V=$[O],A.touch0&&A.touch0[2]===V.identifier?delete A.touch0:A.touch1&&A.touch1[2]===V.identifier&&delete A.touch1;if(A.touch1&&!A.touch0&&(A.touch0=A.touch1,delete A.touch1),A.touch0)A.touch0[1]=this.__zoom.invert(A.touch0[0]);else if(A.end(),A.taps===2&&(V=de(V,this),Math.hypot(l[0]-V[0],l[1]-V[1])<w)){var q=ue(this).on("dblclick.zoom");q&&q.apply(this,arguments)}}}return x.wheelDelta=function(b){return arguments.length?(r=typeof b=="function"?b:At(+b),x):r},x.filter=function(b){return arguments.length?(e=typeof b=="function"?b:At(!!b),x):e},x.touchable=function(b){return arguments.length?(i=typeof b=="function"?b:At(!!b),x):i},x.extent=function(b){return arguments.length?(t=typeof b=="function"?b:At([[+b[0][0],+b[0][1]],[+b[1][0],+b[1][1]]]),x):t},x.scaleExtent=function(b){return arguments.length?(s[0]=+b[0],s[1]=+b[1],x):[s[0],s[1]]},x.translateExtent=function(b){return arguments.length?(o[0][0]=+b[0][0],o[1][0]=+b[1][0],o[0][1]=+b[0][1],o[1][1]=+b[1][1],x):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},x.constrain=function(b){return arguments.length?(n=b,x):n},x.duration=function(b){return arguments.length?(a=+b,x):a},x.interpolate=function(b){return arguments.length?(u=b,x):u},x.on=function(){var b=d.on.apply(d,arguments);return b===d?x:b},x.clickDistance=function(b){return arguments.length?(m=(b=+b)*b,x):Math.sqrt(m)},x.tapDistance=function(b){return arguments.length?(w=+b,x):w},x}const xe={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},pt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],$s=["Enter"," ","Escape"];var Xe;(function(e){e.Strict="strict",e.Loose="loose"})(Xe||(Xe={}));var $e;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})($e||($e={}));var gt;(function(e){e.Partial="partial",e.Full="full"})(gt||(gt={}));const Os={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var Me;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Me||(Me={}));var Yt;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Yt||(Yt={}));var U;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(U||(U={}));const _i={[U.Left]:U.Right,[U.Right]:U.Left,[U.Top]:U.Bottom,[U.Bottom]:U.Top};function Ls(e){return e===null?null:e?"valid":"invalid"}const js=e=>"id"in e&&"source"in e&&"target"in e,Rf=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Hr=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),bt=(e,t=[0,0])=>{const{width:n,height:r}=Ne(e),i=e.origin??t,s=n*i[0],o=r*i[1];return{x:e.position.x-s,y:e.position.y-o}},Pf=(e,t={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,i)=>{const s=typeof i=="string";let o=!t.nodeLookup&&!s?i:void 0;t.nodeLookup&&(o=s?t.nodeLookup.get(i):Hr(i)?i:t.nodeLookup.get(i.id));const a=o?Gt(o,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return nn(r,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return rn(n)},_t=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(r=>{if(t.filter===void 0||t.filter(r)){const i=Gt(r);n=nn(n,i)}}),rn(n)},Ds=(e,t,[n,r,i]=[0,0,1],s=!1,o=!1)=>{const a={...Et(t,[n,r,i]),width:t.width/i,height:t.height/i},u=[];for(const d of e.values()){const{measured:c,selectable:l=!0,hidden:f=!1}=d;if(o&&!l||f)continue;const h=c.width??d.width??d.initialWidth??null,p=c.height??d.height??d.initialHeight??null,m=mt(a,Ue(d)),w=(h??0)*(p??0),x=s&&m>0;(!d.internals.handleBounds||x||m>=w||d.dragging)&&u.push(d)}return u},$f=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function Of(e,t){const n=new Map,r=t!=null&&t.nodes?new Set(t.nodes.map(i=>i.id)):null;return e.forEach(i=>{i.measured.width&&i.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!i.hidden)&&(!r||r.has(i.id))&&n.set(i.id,i)}),n}async function Lf({nodes:e,width:t,height:n,panZoom:r,minZoom:i,maxZoom:s},o){if(e.size===0)return Promise.resolve(!0);const a=Of(e,o),u=_t(a),d=Vr(u,t,n,(o==null?void 0:o.minZoom)??i,(o==null?void 0:o.maxZoom)??s,(o==null?void 0:o.padding)??.1);return await r.setViewport(d,{duration:o==null?void 0:o.duration}),Promise.resolve(!0)}function zs({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:i,onError:s}){const o=n.get(e),a=o.parentId?n.get(o.parentId):void 0,{x:u,y:d}=a?a.internals.positionAbsolute:{x:0,y:0},c=o.origin??r;let l=i;if(o.extent==="parent"&&!o.expandParent)if(!a)s==null||s("005",xe.error005());else{const h=a.measured.width,p=a.measured.height;h&&p&&(l=[[u,d],[u+h,d+p]])}else a&&Ke(o.extent)&&(l=[[o.extent[0][0]+u,o.extent[0][1]+d],[o.extent[1][0]+u,o.extent[1][1]+d]]);const f=Ke(l)?je(t,l,o.measured):t;return(o.measured.width===void 0||o.measured.height===void 0)&&(s==null||s("015",xe.error015())),{position:{x:f.x-u+(o.measured.width??0)*c[0],y:f.y-d+(o.measured.height??0)*c[1]},positionAbsolute:f}}async function jf({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:i}){const s=new Set(e.map(f=>f.id)),o=[];for(const f of n){if(f.deletable===!1)continue;const h=s.has(f.id),p=!h&&f.parentId&&o.find(m=>m.id===f.parentId);(h||p)&&o.push(f)}const a=new Set(t.map(f=>f.id)),u=r.filter(f=>f.deletable!==!1),c=$f(o,u);for(const f of u)a.has(f.id)&&!c.find(p=>p.id===f.id)&&c.push(f);if(!i)return{edges:c,nodes:o};const l=await i({nodes:o,edges:c});return typeof l=="boolean"?l?{edges:c,nodes:o}:{edges:[],nodes:[]}:l}const We=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),je=(e={x:0,y:0},t,n)=>({x:We(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:We(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function Hs(e,t,n){const{width:r,height:i}=Ne(n),{x:s,y:o}=n.internals.positionAbsolute;return je(e,[[s,o],[s+r,o+i]],t)}const Ei=(e,t,n)=>e<t?We(Math.abs(e-t),1,t)/t:e>n?-We(Math.abs(e-n),1,t)/t:0,Vs=(e,t,n=15,r=40)=>{const i=Ei(e.x,r,t.width-r)*n,s=Ei(e.y,r,t.height-r)*n;return[i,s]},nn=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Cr=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),rn=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),Ue=(e,t=[0,0])=>{var i,s;const{x:n,y:r}=Hr(e)?e.internals.positionAbsolute:bt(e,t);return{x:n,y:r,width:((i=e.measured)==null?void 0:i.width)??e.width??e.initialWidth??0,height:((s=e.measured)==null?void 0:s.height)??e.height??e.initialHeight??0}},Gt=(e,t=[0,0])=>{var i,s;const{x:n,y:r}=Hr(e)?e.internals.positionAbsolute:bt(e,t);return{x:n,y:r,x2:n+(((i=e.measured)==null?void 0:i.width)??e.width??e.initialWidth??0),y2:r+(((s=e.measured)==null?void 0:s.height)??e.height??e.initialHeight??0)}},Bs=(e,t)=>rn(nn(Cr(e),Cr(t))),mt=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},Ni=e=>he(e.width)&&he(e.height)&&he(e.x)&&he(e.y),he=e=>!isNaN(e)&&isFinite(e),Df=(e,t)=>{},on=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Et=({x:e,y:t},[n,r,i],s=!1,o=[1,1])=>{const a={x:(e-n)/i,y:(t-r)/i};return s?on(a,o):a},Xt=({x:e,y:t},[n,r,i])=>({x:e*i+n,y:t*i+r});function ze(e,t){if(typeof e=="number")return Math.floor(t-t/(1+e));if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function zf(e,t,n){if(typeof e=="string"||typeof e=="number"){const r=ze(e,n),i=ze(e,t);return{top:r,right:i,bottom:r,left:i,x:i*2,y:r*2}}if(typeof e=="object"){const r=ze(e.top??e.y??0,n),i=ze(e.bottom??e.y??0,n),s=ze(e.left??e.x??0,t),o=ze(e.right??e.x??0,t);return{top:r,right:o,bottom:i,left:s,x:s+o,y:r+i}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function Hf(e,t,n,r,i,s){const{x:o,y:a}=Xt(e,[t,n,r]),{x:u,y:d}=Xt({x:e.x+e.width,y:e.y+e.height},[t,n,r]),c=i-u,l=s-d;return{left:Math.floor(o),top:Math.floor(a),right:Math.floor(c),bottom:Math.floor(l)}}const Vr=(e,t,n,r,i,s)=>{const o=zf(s,t,n),a=(t-o.x)/e.width,u=(n-o.y)/e.height,d=Math.min(a,u),c=We(d,r,i),l=e.x+e.width/2,f=e.y+e.height/2,h=t/2-l*c,p=n/2-f*c,m=Hf(e,h,p,c,t,n),w={left:Math.min(m.left-o.left,0),top:Math.min(m.top-o.top,0),right:Math.min(m.right-o.right,0),bottom:Math.min(m.bottom-o.bottom,0)};return{x:h-w.left+w.right,y:p-w.top+w.bottom,zoom:c}},Wt=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function Ke(e){return e!==void 0&&e!=="parent"}function Ne(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function Fs(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function qs(e,t={width:0,height:0},n,r,i){const s={...e},o=r.get(n);if(o){const a=o.origin||i;s.x+=o.internals.positionAbsolute.x-(t.width??0)*a[0],s.y+=o.internals.positionAbsolute.y-(t.height??0)*a[1]}return s}function ki(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function at(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:i}){const{x:s,y:o}=_e(e),a=Et({x:s-((i==null?void 0:i.left)??0),y:o-((i==null?void 0:i.top)??0)},r),{x:u,y:d}=n?on(a,t):a;return{xSnapped:u,ySnapped:d,...a}}const Br=e=>({width:e.offsetWidth,height:e.offsetHeight}),Ys=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},Vf=["INPUT","SELECT","TEXTAREA"];function Gs(e){var r,i;const t=((i=(r=e.composedPath)==null?void 0:r.call(e))==null?void 0:i[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:Vf.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const Xs=e=>"clientX"in e,_e=(e,t)=>{var s,o;const n=Xs(e),r=n?e.clientX:(s=e.touches)==null?void 0:s[0].clientX,i=n?e.clientY:(o=e.touches)==null?void 0:o[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:i-((t==null?void 0:t.top)??0)}},Si=(e,t,n,r,i)=>{const s=t.querySelectorAll(`.${e}`);return!s||!s.length?null:Array.from(s).map(o=>{const a=o.getBoundingClientRect();return{id:o.getAttribute("data-handleid"),type:e,nodeId:i,position:o.getAttribute("data-handlepos"),x:(a.left-n.left)/r,y:(a.top-n.top)/r,...Br(o)}})};function Ws({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:i,sourceControlY:s,targetControlX:o,targetControlY:a}){const u=e*.125+i*.375+o*.375+n*.125,d=t*.125+s*.375+a*.375+r*.125,c=Math.abs(u-e),l=Math.abs(d-t);return[u,d,c,l]}function Tt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Ci({pos:e,x1:t,y1:n,x2:r,y2:i,c:s}){switch(e){case U.Left:return[t-Tt(t-r,s),n];case U.Right:return[t+Tt(r-t,s),n];case U.Top:return[t,n-Tt(n-i,s)];case U.Bottom:return[t,n+Tt(i-n,s)]}}function Us({sourceX:e,sourceY:t,sourcePosition:n=U.Bottom,targetX:r,targetY:i,targetPosition:s=U.Top,curvature:o=.25}){const[a,u]=Ci({pos:n,x1:e,y1:t,x2:r,y2:i,c:o}),[d,c]=Ci({pos:s,x1:r,y1:i,x2:e,y2:t,c:o}),[l,f,h,p]=Ws({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:a,sourceControlY:u,targetControlX:d,targetControlY:c});return[`M${e},${t} C${a},${u} ${d},${c} ${r},${i}`,l,f,h,p]}function Ks({sourceX:e,sourceY:t,targetX:n,targetY:r}){const i=Math.abs(n-e)/2,s=n<e?n+i:n-i,o=Math.abs(r-t)/2,a=r<t?r+o:r-o;return[s,a,i,o]}function Bf({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r=0,elevateOnSelect:i=!1}){if(!i)return r;const s=n||t.selected||e.selected,o=Math.max(e.internals.z||0,t.internals.z||0,1e3);return r+(s?o:0)}function Ff({sourceNode:e,targetNode:t,width:n,height:r,transform:i}){const s=nn(Gt(e),Gt(t));s.x===s.x2&&(s.x2+=1),s.y===s.y2&&(s.y2+=1);const o={x:-i[0]/i[2],y:-i[1]/i[2],width:n/i[2],height:r/i[2]};return mt(o,rn(s))>0}const qf=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,Yf=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Gf=(e,t)=>{if(!e.source||!e.target)return t;let n;return js(e)?n={...e}:n={...e,id:qf(e)},Yf(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function Qs({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[i,s,o,a]=Ks({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,i,s,o,a]}const Mi={[U.Left]:{x:-1,y:0},[U.Right]:{x:1,y:0},[U.Top]:{x:0,y:-1},[U.Bottom]:{x:0,y:1}},Xf=({source:e,sourcePosition:t=U.Bottom,target:n})=>t===U.Left||t===U.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Ii=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Wf({source:e,sourcePosition:t=U.Bottom,target:n,targetPosition:r=U.Top,center:i,offset:s}){const o=Mi[t],a=Mi[r],u={x:e.x+o.x*s,y:e.y+o.y*s},d={x:n.x+a.x*s,y:n.y+a.y*s},c=Xf({source:u,sourcePosition:t,target:d}),l=c.x!==0?"x":"y",f=c[l];let h=[],p,m;const w={x:0,y:0},x={x:0,y:0},[v,g,y,N]=Ks({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(o[l]*a[l]===-1){p=i.x??v,m=i.y??g;const C=[{x:p,y:u.y},{x:p,y:d.y}],_=[{x:u.x,y:m},{x:d.x,y:m}];o[l]===f?h=l==="x"?C:_:h=l==="x"?_:C}else{const C=[{x:u.x,y:d.y}],_=[{x:d.x,y:u.y}];if(l==="x"?h=o.x===f?_:C:h=o.y===f?C:_,t===r){const D=Math.abs(e[l]-n[l]);if(D<=s){const b=Math.min(s-1,s-D);o[l]===f?w[l]=(u[l]>e[l]?-1:1)*b:x[l]=(d[l]>n[l]?-1:1)*b}}if(t!==r){const D=l==="x"?"y":"x",b=o[l]===a[D],R=u[D]>d[D],A=u[D]<d[D];(o[l]===1&&(!b&&R||b&&A)||o[l]!==1&&(!b&&A||b&&R))&&(h=l==="x"?C:_)}const E={x:u.x+w.x,y:u.y+w.y},k={x:d.x+x.x,y:d.y+x.y},M=Math.max(Math.abs(E.x-h[0].x),Math.abs(k.x-h[0].x)),I=Math.max(Math.abs(E.y-h[0].y),Math.abs(k.y-h[0].y));M>=I?(p=(E.x+k.x)/2,m=h[0].y):(p=h[0].x,m=(E.y+k.y)/2)}return[[e,{x:u.x+w.x,y:u.y+w.y},...h,{x:d.x+x.x,y:d.y+x.y},n],p,m,y,N]}function Uf(e,t,n,r){const i=Math.min(Ii(e,t)/2,Ii(t,n)/2,r),{x:s,y:o}=t;if(e.x===s&&s===n.x||e.y===o&&o===n.y)return`L${s} ${o}`;if(e.y===o){const d=e.x<n.x?-1:1,c=e.y<n.y?1:-1;return`L ${s+i*d},${o}Q ${s},${o} ${s},${o+i*c}`}const a=e.x<n.x?1:-1,u=e.y<n.y?-1:1;return`L ${s},${o+i*u}Q ${s},${o} ${s+i*a},${o}`}function Mr({sourceX:e,sourceY:t,sourcePosition:n=U.Bottom,targetX:r,targetY:i,targetPosition:s=U.Top,borderRadius:o=5,centerX:a,centerY:u,offset:d=20}){const[c,l,f,h,p]=Wf({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:i},targetPosition:s,center:{x:a,y:u},offset:d});return[c.reduce((w,x,v)=>{let g="";return v>0&&v<c.length-1?g=Uf(c[v-1],x,c[v+1],o):g=`${v===0?"M":"L"}${x.x} ${x.y}`,w+=g,w},""),l,f,h,p]}function Ai(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function Kf(e){var l;const{sourceNode:t,targetNode:n}=e;if(!Ai(t)||!Ai(n))return null;const r=t.internals.handleBounds||Ti(t.handles),i=n.internals.handleBounds||Ti(n.handles),s=Ri((r==null?void 0:r.source)??[],e.sourceHandle),o=Ri(e.connectionMode===Xe.Strict?(i==null?void 0:i.target)??[]:((i==null?void 0:i.target)??[]).concat((i==null?void 0:i.source)??[]),e.targetHandle);if(!s||!o)return(l=e.onError)==null||l.call(e,"008",xe.error008(s?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=(s==null?void 0:s.position)||U.Bottom,u=(o==null?void 0:o.position)||U.Top,d=yt(t,s,a),c=yt(n,o,u);return{sourceX:d.x,sourceY:d.y,targetX:c.x,targetY:c.y,sourcePosition:a,targetPosition:u}}function Ti(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function yt(e,t,n=U.Left,r=!1){const i=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,s=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:o,height:a}=t??Ne(e);if(r)return{x:i+o/2,y:s+a/2};switch((t==null?void 0:t.position)??n){case U.Top:return{x:i+o/2,y:s};case U.Right:return{x:i+o,y:s+a/2};case U.Bottom:return{x:i+o/2,y:s+a};case U.Left:return{x:i,y:s+a/2}}}function Ri(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function Ir(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`:""}function Qf(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:i}){const s=new Set;return e.reduce((o,a)=>([a.markerStart||r,a.markerEnd||i].forEach(u=>{if(u&&typeof u=="object"){const d=Ir(u,t);s.has(d)||(o.push({id:d,color:u.color||n,...u}),s.add(d))}}),o),[]).sort((o,a)=>o.id.localeCompare(a.id))}const Fr={nodeOrigin:[0,0],nodeExtent:pt,elevateNodesOnSelect:!0,defaults:{}},Zf={...Fr,checkEquality:!0};function qr(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function Jf(e,t,n){const r=qr(Fr,n);for(const i of e.values())if(i.parentId)Yr(i,e,t,r);else{const s=bt(i,r.nodeOrigin),o=Ke(i.extent)?i.extent:r.nodeExtent,a=je(s,o,Ne(i));i.internals.positionAbsolute=a}}function Ar(e,t,n,r){var u,d;const i=qr(Zf,r);let s=!0;const o=new Map(t),a=i!=null&&i.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const c of e){let l=o.get(c.id);if(i.checkEquality&&c===(l==null?void 0:l.internals.userNode))t.set(c.id,l);else{const f=bt(c,i.nodeOrigin),h=Ke(c.extent)?c.extent:i.nodeExtent,p=je(f,h,Ne(c));l={...i.defaults,...c,measured:{width:(u=c.measured)==null?void 0:u.width,height:(d=c.measured)==null?void 0:d.height},internals:{positionAbsolute:p,handleBounds:c.measured?l==null?void 0:l.internals.handleBounds:void 0,z:Zs(c,a),userNode:c}},t.set(c.id,l)}(!l.measured||!l.measured.width||!l.measured.height)&&!l.hidden&&(s=!1),c.parentId&&Yr(l,t,n,r)}return s}function eh(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function Yr(e,t,n,r){const{elevateNodesOnSelect:i,nodeOrigin:s,nodeExtent:o}=qr(Fr,r),a=e.parentId,u=t.get(a);if(!u){console.warn(`Parent node ${a} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}eh(e,n);const d=i?1e3:0,{x:c,y:l,z:f}=th(e,u,s,o,d),{positionAbsolute:h}=e.internals,p=c!==h.x||l!==h.y;(p||f!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:p?{x:c,y:l}:h,z:f}})}function Zs(e,t){return(he(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function th(e,t,n,r,i){const{x:s,y:o}=t.internals.positionAbsolute,a=Ne(e),u=bt(e,n),d=Ke(e.extent)?je(u,e.extent,a):u;let c=je({x:s+d.x,y:o+d.y},r,a);e.extent==="parent"&&(c=Hs(c,a,t));const l=Zs(e,i),f=t.internals.z??0;return{x:c.x,y:c.y,z:f>l?f:l}}function Gr(e,t,n,r=[0,0]){var o;const i=[],s=new Map;for(const a of e){const u=t.get(a.parentId);if(!u)continue;const d=((o=s.get(a.parentId))==null?void 0:o.expandedRect)??Ue(u),c=Bs(d,a.rect);s.set(a.parentId,{expandedRect:c,parent:u})}return s.size>0&&s.forEach(({expandedRect:a,parent:u},d)=>{var g;const c=u.internals.positionAbsolute,l=Ne(u),f=u.origin??r,h=a.x<c.x?Math.round(Math.abs(c.x-a.x)):0,p=a.y<c.y?Math.round(Math.abs(c.y-a.y)):0,m=Math.max(l.width,Math.round(a.width)),w=Math.max(l.height,Math.round(a.height)),x=(m-l.width)*f[0],v=(w-l.height)*f[1];(h>0||p>0||x||v)&&(i.push({id:d,type:"position",position:{x:u.position.x-h+x,y:u.position.y-p+v}}),(g=n.get(d))==null||g.forEach(y=>{e.some(N=>N.id===y.id)||i.push({id:y.id,type:"position",position:{x:y.position.x+h,y:y.position.y+p}})})),(l.width<a.width||l.height<a.height||h||p)&&i.push({id:d,type:"dimensions",setAttributes:!0,dimensions:{width:m+(h?f[0]*h-x:0),height:w+(p?f[1]*p-v:0)}})}),i}function nh(e,t,n,r,i,s){const o=r==null?void 0:r.querySelector(".xyflow__viewport");let a=!1;if(!o)return{changes:[],updatedInternals:a};const u=[],d=window.getComputedStyle(o),{m22:c}=new window.DOMMatrixReadOnly(d.transform),l=[];for(const f of e.values()){const h=t.get(f.id);if(!h)continue;if(h.hidden){t.set(h.id,{...h,internals:{...h.internals,handleBounds:void 0}}),a=!0;continue}const p=Br(f.nodeElement),m=h.measured.width!==p.width||h.measured.height!==p.height;if(!!(p.width&&p.height&&(m||!h.internals.handleBounds||f.force))){const x=f.nodeElement.getBoundingClientRect(),v=Ke(h.extent)?h.extent:s;let{positionAbsolute:g}=h.internals;h.parentId&&h.extent==="parent"?g=Hs(g,p,t.get(h.parentId)):v&&(g=je(g,v,p));const y={...h,measured:p,internals:{...h.internals,positionAbsolute:g,handleBounds:{source:Si("source",f.nodeElement,x,c,h.id),target:Si("target",f.nodeElement,x,c,h.id)}}};t.set(h.id,y),h.parentId&&Yr(y,t,n,{nodeOrigin:i}),a=!0,m&&(u.push({id:h.id,type:"dimensions",dimensions:p}),h.expandParent&&h.parentId&&l.push({id:h.id,parentId:h.parentId,rect:Ue(y,i)}))}}if(l.length>0){const f=Gr(l,t,n,i);u.push(...f)}return{changes:u,updatedInternals:a}}async function rh({delta:e,panZoom:t,transform:n,translateExtent:r,width:i,height:s}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const o=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[i,s]],r),a=!!o&&(o.x!==n[0]||o.y!==n[1]||o.k!==n[2]);return Promise.resolve(a)}function Pi(e,t,n,r,i,s){let o=i;const a=r.get(o)||new Map;r.set(o,a.set(n,t)),o=`${i}-${e}`;const u=r.get(o)||new Map;if(r.set(o,u.set(n,t)),s){o=`${i}-${e}-${s}`;const d=r.get(o)||new Map;r.set(o,d.set(n,t))}}function Js(e,t,n){e.clear(),t.clear();for(const r of n){const{source:i,target:s,sourceHandle:o=null,targetHandle:a=null}=r,u={edgeId:r.id,source:i,target:s,sourceHandle:o,targetHandle:a},d=`${i}-${o}--${s}-${a}`,c=`${s}-${a}--${i}-${o}`;Pi("source",u,c,e,i,o),Pi("target",u,d,e,s,a),t.set(r.id,r)}}function ea(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:ea(n,t):!1}function $i(e,t,n){var i;let r=e;do{if((i=r==null?void 0:r.matches)!=null&&i.call(r,t))return!0;if(r===n)return!1;r=r==null?void 0:r.parentElement}while(r);return!1}function ih(e,t,n,r){const i=new Map;for(const[s,o]of e)if((o.selected||o.id===r)&&(!o.parentId||!ea(o,e))&&(o.draggable||t&&typeof o.draggable>"u")){const a=e.get(s);a&&i.set(s,{id:s,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return i}function bn({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){var o,a,u;const i=[];for(const[d,c]of t){const l=(o=n.get(d))==null?void 0:o.internals.userNode;l&&i.push({...l,position:c.position,dragging:r})}if(!e)return[i[0],i];const s=(a=n.get(e))==null?void 0:a.internals.userNode;return[s?{...s,position:((u=t.get(e))==null?void 0:u.position)||s.position,dragging:r}:i[0],i]}function oh({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:i}){let s={x:null,y:null},o=0,a=new Map,u=!1,d={x:0,y:0},c=null,l=!1,f=null,h=!1;function p({noDragClassName:w,handleSelector:x,domNode:v,isSelectable:g,nodeId:y,nodeClickDistance:N=0}){f=ue(v);function S({x:k,y:M},I){const{nodeLookup:D,nodeExtent:b,snapGrid:R,snapToGrid:A,nodeOrigin:$,onNodeDrag:z,onSelectionDrag:O,onError:V,updateNodePositions:q}=t();s={x:k,y:M};let Y=!1,T={x:0,y:0,x2:0,y2:0};if(a.size>1&&b){const L=_t(a);T=Cr(L)}for(const[L,j]of a){if(!D.has(L))continue;let B={x:k-j.distance.x,y:M-j.distance.y};A&&(B=on(B,R));let F=[[b[0][0],b[0][1]],[b[1][0],b[1][1]]];if(a.size>1&&b&&!j.extent){const{positionAbsolute:Z}=j.internals,K=Z.x-T.x+b[0][0],W=Z.x+j.measured.width-T.x2+b[1][0],Q=Z.y-T.y+b[0][1],J=Z.y+j.measured.height-T.y2+b[1][1];F=[[K,Q],[W,J]]}const{position:G,positionAbsolute:X}=zs({nodeId:L,nextPosition:B,nodeLookup:D,nodeExtent:F,nodeOrigin:$,onError:V});Y=Y||j.position.x!==G.x||j.position.y!==G.y,j.position=G,j.internals.positionAbsolute=X}if(Y&&(q(a,!0),I&&(r||z||!y&&O))){const[L,j]=bn({nodeId:y,dragItems:a,nodeLookup:D});r==null||r(I,a,L,j),z==null||z(I,L,j),y||O==null||O(I,j)}}async function C(){if(!c)return;const{transform:k,panBy:M,autoPanSpeed:I,autoPanOnNodeDrag:D}=t();if(!D){u=!1,cancelAnimationFrame(o);return}const[b,R]=Vs(d,c,I);(b!==0||R!==0)&&(s.x=(s.x??0)-b/k[2],s.y=(s.y??0)-R/k[2],await M({x:b,y:R})&&S(s,null)),o=requestAnimationFrame(C)}function _(k){var Y;const{nodeLookup:M,multiSelectionActive:I,nodesDraggable:D,transform:b,snapGrid:R,snapToGrid:A,selectNodesOnDrag:$,onNodeDragStart:z,onSelectionDragStart:O,unselectNodesAndEdges:V}=t();l=!0,(!$||!g)&&!I&&y&&((Y=M.get(y))!=null&&Y.selected||V()),g&&$&&y&&(e==null||e(y));const q=at(k.sourceEvent,{transform:b,snapGrid:R,snapToGrid:A,containerBounds:c});if(s=q,a=ih(M,D,q,y),a.size>0&&(n||z||!y&&O)){const[T,L]=bn({nodeId:y,dragItems:a,nodeLookup:M});n==null||n(k.sourceEvent,a,T,L),z==null||z(k.sourceEvent,T,L),y||O==null||O(k.sourceEvent,L)}}const E=xs().clickDistance(N).on("start",k=>{const{domNode:M,nodeDragThreshold:I,transform:D,snapGrid:b,snapToGrid:R}=t();c=(M==null?void 0:M.getBoundingClientRect())||null,h=!1,I===0&&_(k),s=at(k.sourceEvent,{transform:D,snapGrid:b,snapToGrid:R,containerBounds:c}),d=_e(k.sourceEvent,c)}).on("drag",k=>{const{autoPanOnNodeDrag:M,transform:I,snapGrid:D,snapToGrid:b,nodeDragThreshold:R,nodeLookup:A}=t(),$=at(k.sourceEvent,{transform:I,snapGrid:D,snapToGrid:b,containerBounds:c});if((k.sourceEvent.type==="touchmove"&&k.sourceEvent.touches.length>1||y&&!A.has(y))&&(h=!0),!h){if(!u&&M&&l&&(u=!0,C()),!l){const z=$.xSnapped-(s.x??0),O=$.ySnapped-(s.y??0);Math.sqrt(z*z+O*O)>R&&_(k)}(s.x!==$.xSnapped||s.y!==$.ySnapped)&&a&&l&&(d=_e(k.sourceEvent,c),S($,k.sourceEvent))}}).on("end",k=>{if(!(!l||h)&&(u=!1,l=!1,cancelAnimationFrame(o),a.size>0)){const{nodeLookup:M,updateNodePositions:I,onNodeDragStop:D,onSelectionDragStop:b}=t();if(I(a,!1),i||D||!y&&b){const[R,A]=bn({nodeId:y,dragItems:a,nodeLookup:M,dragging:!1});i==null||i(k.sourceEvent,a,R,A),D==null||D(k.sourceEvent,R,A),y||b==null||b(k.sourceEvent,A)}}}).filter(k=>{const M=k.target;return!k.button&&(!w||!$i(M,`.${w}`,v))&&(!x||$i(M,x,v))});f.call(E)}function m(){f==null||f.on(".drag",null)}return{update:p,destroy:m}}function sh(e,t,n){const r=[],i={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const s of t.values())mt(i,Ue(s))>0&&r.push(s);return r}const ah=250;function ch(e,t,n,r){var a,u;let i=[],s=1/0;const o=sh(e,n,t+ah);for(const d of o){const c=[...((a=d.internals.handleBounds)==null?void 0:a.source)??[],...((u=d.internals.handleBounds)==null?void 0:u.target)??[]];for(const l of c){if(r.nodeId===l.nodeId&&r.type===l.type&&r.id===l.id)continue;const{x:f,y:h}=yt(d,l,l.position,!0),p=Math.sqrt(Math.pow(f-e.x,2)+Math.pow(h-e.y,2));p>t||(p<s?(i=[{...l,x:f,y:h}],s=p):p===s&&i.push({...l,x:f,y:h}))}}if(!i.length)return null;if(i.length>1){const d=r.type==="source"?"target":"source";return i.find(c=>c.type===d)??i[0]}return i[0]}function ta(e,t,n,r,i,s=!1){var d,c,l;const o=r.get(e);if(!o)return null;const a=i==="strict"?(d=o.internals.handleBounds)==null?void 0:d[t]:[...((c=o.internals.handleBounds)==null?void 0:c.source)??[],...((l=o.internals.handleBounds)==null?void 0:l.target)??[]],u=(n?a==null?void 0:a.find(f=>f.id===n):a==null?void 0:a[0])??null;return u&&s?{...u,...yt(o,u,u.position,!0)}:u}function na(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function uh(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const ra=()=>!0;function lh(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:i,edgeUpdaterType:s,isTarget:o,domNode:a,nodeLookup:u,lib:d,autoPanOnConnect:c,flowId:l,panBy:f,cancelConnection:h,onConnectStart:p,onConnect:m,onConnectEnd:w,isValidConnection:x=ra,onReconnectEnd:v,updateConnection:g,getTransform:y,getFromHandle:N,autoPanSpeed:S}){const C=Ys(e.target);let _=0,E;const{x:k,y:M}=_e(e),I=C==null?void 0:C.elementFromPoint(k,M),D=na(s,I),b=a==null?void 0:a.getBoundingClientRect();if(!b||!D)return;const R=ta(i,D,r,u,t);if(!R)return;let A=_e(e,b),$=!1,z=null,O=!1,V=null;function q(){if(!c||!b)return;const[X,Z]=Vs(A,b,S);f({x:X,y:Z}),_=requestAnimationFrame(q)}const Y={...R,nodeId:i,type:D,position:R.position},T=u.get(i),j={inProgress:!0,isValid:null,from:yt(T,Y,U.Left,!0),fromHandle:Y,fromPosition:Y.position,fromNode:T,to:A,toHandle:null,toPosition:_i[Y.position],toNode:null};g(j);let B=j;p==null||p(e,{nodeId:i,handleId:r,handleType:D});function F(X){if(!N()||!Y){G(X);return}const Z=y();A=_e(X,b),E=ch(Et(A,Z,!1,[1,1]),n,u,Y),$||(q(),$=!0);const K=ia(X,{handle:E,connectionMode:t,fromNodeId:i,fromHandleId:r,fromType:o?"target":"source",isValidConnection:x,doc:C,lib:d,flowId:l,nodeLookup:u});V=K.handleDomNode,z=K.connection,O=uh(!!E,K.isValid);const W={...B,isValid:O,to:E&&O?Xt({x:E.x,y:E.y},Z):A,toHandle:K.toHandle,toPosition:O&&K.toHandle?K.toHandle.position:_i[Y.position],toNode:K.toHandle?u.get(K.toHandle.nodeId):null};O&&E&&B.toHandle&&W.toHandle&&B.toHandle.type===W.toHandle.type&&B.toHandle.nodeId===W.toHandle.nodeId&&B.toHandle.id===W.toHandle.id&&B.to.x===W.to.x&&B.to.y===W.to.y||(g(W),B=W)}function G(X){(E||V)&&z&&O&&(m==null||m(z));const{inProgress:Z,...K}=B,W={...K,toPosition:B.toHandle?B.toPosition:null};w==null||w(X,W),s&&(v==null||v(X,W)),h(),cancelAnimationFrame(_),$=!1,O=!1,z=null,V=null,C.removeEventListener("mousemove",F),C.removeEventListener("mouseup",G),C.removeEventListener("touchmove",F),C.removeEventListener("touchend",G)}C.addEventListener("mousemove",F),C.addEventListener("mouseup",G),C.addEventListener("touchmove",F),C.addEventListener("touchend",G)}function ia(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:i,fromType:s,doc:o,lib:a,flowId:u,isValidConnection:d=ra,nodeLookup:c}){const l=s==="target",f=t?o.querySelector(`.${a}-flow__handle[data-id="${u}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:h,y:p}=_e(e),m=o.elementFromPoint(h,p),w=m!=null&&m.classList.contains(`${a}-flow__handle`)?m:f,x={handleDomNode:w,isValid:!1,connection:null,toHandle:null};if(w){const v=na(void 0,w),g=w.getAttribute("data-nodeid"),y=w.getAttribute("data-handleid"),N=w.classList.contains("connectable"),S=w.classList.contains("connectableend");if(!g||!v)return x;const C={source:l?g:r,sourceHandle:l?y:i,target:l?r:g,targetHandle:l?i:y};x.connection=C;const E=N&&S&&(n===Xe.Strict?l&&v==="source"||!l&&v==="target":g!==r||y!==i);x.isValid=E&&d(C),x.toHandle=ta(g,v,y,c,n,!1)}return x}const Tr={onPointerDown:lh,isValid:ia};function dh({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const i=ue(e);function s({translateExtent:a,width:u,height:d,zoomStep:c=10,pannable:l=!0,zoomable:f=!0,inversePan:h=!1}){const p=g=>{const y=n();if(g.sourceEvent.type!=="wheel"||!t)return;const N=-g.sourceEvent.deltaY*(g.sourceEvent.deltaMode===1?.05:g.sourceEvent.deltaMode?1:.002)*c,S=y[2]*Math.pow(2,N);t.scaleTo(S)};let m=[0,0];const w=g=>{(g.sourceEvent.type==="mousedown"||g.sourceEvent.type==="touchstart")&&(m=[g.sourceEvent.clientX??g.sourceEvent.touches[0].clientX,g.sourceEvent.clientY??g.sourceEvent.touches[0].clientY])},x=g=>{const y=n();if(g.sourceEvent.type!=="mousemove"&&g.sourceEvent.type!=="touchmove"||!t)return;const N=[g.sourceEvent.clientX??g.sourceEvent.touches[0].clientX,g.sourceEvent.clientY??g.sourceEvent.touches[0].clientY],S=[N[0]-m[0],N[1]-m[1]];m=N;const C=r()*Math.max(y[2],Math.log(y[2]))*(h?-1:1),_={x:y[0]-S[0]*C,y:y[1]-S[1]*C},E=[[0,0],[u,d]];t.setViewportConstrained({x:_.x,y:_.y,zoom:y[2]},E,a)},v=Ps().on("start",w).on("zoom",l?x:null).on("zoom.wheel",f?p:null);i.call(v,{})}function o(){i.on("zoom",null)}return{update:s,destroy:o,pointer:de}}const fh=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,sn=e=>({x:e.x,y:e.y,zoom:e.k}),_n=({x:e,y:t,zoom:n})=>tn.translate(e,t).scale(n),He=(e,t)=>e.target.closest(`.${t}`),oa=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),En=(e,t=0,n=()=>{})=>{const r=typeof t=="number"&&t>0;return r||n(),r?e.transition().duration(t).on("end",n):e},sa=e=>{const t=e.ctrlKey&&Wt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function hh({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:i,panOnScrollSpeed:s,zoomOnPinch:o,onPanZoomStart:a,onPanZoom:u,onPanZoomEnd:d}){return c=>{if(He(c,t))return!1;c.preventDefault(),c.stopImmediatePropagation();const l=n.property("__zoom").k||1;if(c.ctrlKey&&o){const w=de(c),x=sa(c),v=l*Math.pow(2,x);r.scaleTo(n,v,w,c);return}const f=c.deltaMode===1?20:1;let h=i===$e.Vertical?0:c.deltaX*f,p=i===$e.Horizontal?0:c.deltaY*f;!Wt()&&c.shiftKey&&i!==$e.Vertical&&(h=c.deltaY*f,p=0),r.translateBy(n,-(h/l)*s,-(p/l)*s,{internal:!0});const m=sn(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,a==null||a(c,m)),e.isPanScrolling&&(u==null||u(c,m),e.panScrollTimeout=setTimeout(()=>{d==null||d(c,m),e.isPanScrolling=!1},150))}}function ph({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,i){const s=r.type==="wheel",o=!t&&s&&!r.ctrlKey,a=He(r,e);if(r.ctrlKey&&s&&a&&r.preventDefault(),o||a)return null;r.preventDefault(),n.call(this,r,i)}}function gh({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var s,o,a;if((s=r.sourceEvent)!=null&&s.internal)return;const i=sn(r.transform);e.mouseButton=((o=r.sourceEvent)==null?void 0:o.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=i,((a=r.sourceEvent)==null?void 0:a.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,i))}}function mh({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:i}){return s=>{var o,a;e.usedRightMouseButton=!!(n&&oa(t,e.mouseButton??0)),(o=s.sourceEvent)!=null&&o.sync||r([s.transform.x,s.transform.y,s.transform.k]),i&&!((a=s.sourceEvent)!=null&&a.internal)&&(i==null||i(s.sourceEvent,sn(s.transform)))}}function yh({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:i,onPaneContextMenu:s}){return o=>{var a;if(!((a=o.sourceEvent)!=null&&a.internal)&&(e.isZoomingOrPanning=!1,s&&oa(t,e.mouseButton??0)&&!e.usedRightMouseButton&&o.sourceEvent&&s(o.sourceEvent),e.usedRightMouseButton=!1,r(!1),i&&fh(e.prevViewport,o.transform))){const u=sn(o.transform);e.prevViewport=u,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{i==null||i(o.sourceEvent,u)},n?150:0)}}}function xh({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:i,zoomOnDoubleClick:s,userSelectionActive:o,noWheelClassName:a,noPanClassName:u,lib:d}){return c=>{var p;const l=e||t,f=n&&c.ctrlKey;if(c.button===1&&c.type==="mousedown"&&(He(c,`${d}-flow__node`)||He(c,`${d}-flow__edge`)))return!0;if(!r&&!l&&!i&&!s&&!n||o||He(c,a)&&c.type==="wheel"||He(c,u)&&(c.type!=="wheel"||i&&c.type==="wheel"&&!e)||!n&&c.ctrlKey&&c.type==="wheel")return!1;if(!n&&c.type==="touchstart"&&((p=c.touches)==null?void 0:p.length)>1)return c.preventDefault(),!1;if(!l&&!i&&!f&&c.type==="wheel"||!r&&(c.type==="mousedown"||c.type==="touchstart")||Array.isArray(r)&&!r.includes(c.button)&&c.type==="mousedown")return!1;const h=Array.isArray(r)&&r.includes(c.button)||!c.button||c.button<=1;return(!c.ctrlKey||c.type==="wheel")&&h}}function wh({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:r,translateExtent:i,viewport:s,onPanZoom:o,onPanZoomStart:a,onPanZoomEnd:u,onDraggingChange:d}){const c={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},l=e.getBoundingClientRect(),f=Ps().clickDistance(!he(r)||r<0?0:r).scaleExtent([t,n]).translateExtent(i),h=ue(e).call(f);g({x:s.x,y:s.y,zoom:We(s.zoom,t,n)},[[0,0],[l.width,l.height]],i);const p=h.on("wheel.zoom"),m=h.on("dblclick.zoom");f.wheelDelta(sa);function w(I,D){return h?new Promise(b=>{f==null||f.transform(En(h,D==null?void 0:D.duration,()=>b(!0)),I)}):Promise.resolve(!1)}function x({noWheelClassName:I,noPanClassName:D,onPaneContextMenu:b,userSelectionActive:R,panOnScroll:A,panOnDrag:$,panOnScrollMode:z,panOnScrollSpeed:O,preventScrolling:V,zoomOnPinch:q,zoomOnScroll:Y,zoomOnDoubleClick:T,zoomActivationKeyPressed:L,lib:j,onTransformChange:B}){R&&!c.isZoomingOrPanning&&v();const G=A&&!L&&!R?hh({zoomPanValues:c,noWheelClassName:I,d3Selection:h,d3Zoom:f,panOnScrollMode:z,panOnScrollSpeed:O,zoomOnPinch:q,onPanZoomStart:a,onPanZoom:o,onPanZoomEnd:u}):ph({noWheelClassName:I,preventScrolling:V,d3ZoomHandler:p});if(h.on("wheel.zoom",G,{passive:!1}),!R){const Z=gh({zoomPanValues:c,onDraggingChange:d,onPanZoomStart:a});f.on("start",Z);const K=mh({zoomPanValues:c,panOnDrag:$,onPaneContextMenu:!!b,onPanZoom:o,onTransformChange:B});f.on("zoom",K);const W=yh({zoomPanValues:c,panOnDrag:$,panOnScroll:A,onPaneContextMenu:b,onPanZoomEnd:u,onDraggingChange:d});f.on("end",W)}const X=xh({zoomActivationKeyPressed:L,panOnDrag:$,zoomOnScroll:Y,panOnScroll:A,zoomOnDoubleClick:T,zoomOnPinch:q,userSelectionActive:R,noPanClassName:D,noWheelClassName:I,lib:j});f.filter(X),T?h.on("dblclick.zoom",m):h.on("dblclick.zoom",null)}function v(){f.on("zoom",null)}async function g(I,D,b){const R=_n(I),A=f==null?void 0:f.constrain()(R,D,b);return A&&await w(A),new Promise($=>$(A))}async function y(I,D){const b=_n(I);return await w(b,D),new Promise(R=>R(b))}function N(I){if(h){const D=_n(I),b=h.property("__zoom");(b.k!==I.zoom||b.x!==I.x||b.y!==I.y)&&(f==null||f.transform(h,D,null,{sync:!0}))}}function S(){const I=h?Rs(h.node()):{x:0,y:0,k:1};return{x:I.x,y:I.y,zoom:I.k}}function C(I,D){return h?new Promise(b=>{f==null||f.scaleTo(En(h,D==null?void 0:D.duration,()=>b(!0)),I)}):Promise.resolve(!1)}function _(I,D){return h?new Promise(b=>{f==null||f.scaleBy(En(h,D==null?void 0:D.duration,()=>b(!0)),I)}):Promise.resolve(!1)}function E(I){f==null||f.scaleExtent(I)}function k(I){f==null||f.translateExtent(I)}function M(I){const D=!he(I)||I<0?0:I;f==null||f.clickDistance(D)}return{update:x,destroy:v,setViewport:y,setViewportConstrained:g,getViewport:S,scaleTo:C,scaleBy:_,setScaleExtent:E,setTranslateExtent:k,syncViewport:N,setClickDistance:M}}var ct;(function(e){e.Line="line",e.Handle="handle"})(ct||(ct={}));function vh({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:i,affectsY:s}){const o=e-t,a=n-r,u=[o>0?1:o<0?-1:0,a>0?1:a<0?-1:0];return o&&i&&(u[0]=u[0]*-1),a&&s&&(u[1]=u[1]*-1),u}function bh(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),i=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:i}}function ke(e,t){return Math.max(0,t-e)}function Se(e,t){return Math.max(0,e-t)}function Rt(e,t,n){return Math.max(0,t-e,e-n)}function Oi(e,t){return e?!t:t}function _h(e,t,n,r,i,s,o,a){let{affectsX:u,affectsY:d}=t;const{isHorizontal:c,isVertical:l}=t,f=c&&l,{xSnapped:h,ySnapped:p}=n,{minWidth:m,maxWidth:w,minHeight:x,maxHeight:v}=r,{x:g,y,width:N,height:S,aspectRatio:C}=e;let _=Math.floor(c?h-e.pointerX:0),E=Math.floor(l?p-e.pointerY:0);const k=N+(u?-_:_),M=S+(d?-E:E),I=-s[0]*N,D=-s[1]*S;let b=Rt(k,m,w),R=Rt(M,x,v);if(o){let z=0,O=0;u&&_<0?z=ke(g+_+I,o[0][0]):!u&&_>0&&(z=Se(g+k+I,o[1][0])),d&&E<0?O=ke(y+E+D,o[0][1]):!d&&E>0&&(O=Se(y+M+D,o[1][1])),b=Math.max(b,z),R=Math.max(R,O)}if(a){let z=0,O=0;u&&_>0?z=Se(g+_,a[0][0]):!u&&_<0&&(z=ke(g+k,a[1][0])),d&&E>0?O=Se(y+E,a[0][1]):!d&&E<0&&(O=ke(y+M,a[1][1])),b=Math.max(b,z),R=Math.max(R,O)}if(i){if(c){const z=Rt(k/C,x,v)*C;if(b=Math.max(b,z),o){let O=0;!u&&!d||u&&!d&&f?O=Se(y+D+k/C,o[1][1])*C:O=ke(y+D+(u?_:-_)/C,o[0][1])*C,b=Math.max(b,O)}if(a){let O=0;!u&&!d||u&&!d&&f?O=ke(y+k/C,a[1][1])*C:O=Se(y+(u?_:-_)/C,a[0][1])*C,b=Math.max(b,O)}}if(l){const z=Rt(M*C,m,w)/C;if(R=Math.max(R,z),o){let O=0;!u&&!d||d&&!u&&f?O=Se(g+M*C+I,o[1][0])/C:O=ke(g+(d?E:-E)*C+I,o[0][0])/C,R=Math.max(R,O)}if(a){let O=0;!u&&!d||d&&!u&&f?O=ke(g+M*C,a[1][0])/C:O=Se(g+(d?E:-E)*C,a[0][0])/C,R=Math.max(R,O)}}}E=E+(E<0?R:-R),_=_+(_<0?b:-b),i&&(f?k>M*C?E=(Oi(u,d)?-_:_)/C:_=(Oi(u,d)?-E:E)*C:c?(E=_/C,d=u):(_=E*C,u=d));const A=u?g+_:g,$=d?y+E:y;return{width:N+(u?-_:_),height:S+(d?-E:E),x:s[0]*_*(u?-1:1)+A,y:s[1]*E*(d?-1:1)+$}}const aa={width:0,height:0,x:0,y:0},Eh={...aa,pointerX:0,pointerY:0,aspectRatio:1};function Nh(e){return[[0,0],[e.measured.width,e.measured.height]]}function kh(e,t,n){const r=t.position.x+e.position.x,i=t.position.y+e.position.y,s=e.measured.width??0,o=e.measured.height??0,a=n[0]*s,u=n[1]*o;return[[r-a,i-u],[r+s-a,i+o-u]]}function Sh({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:i}){const s=ue(e);function o({controlPosition:u,boundaries:d,keepAspectRatio:c,onResizeStart:l,onResize:f,onResizeEnd:h,shouldResize:p}){let m={...aa},w={...Eh};const x=bh(u);let v,g=null,y=[],N,S,C;const _=xs().on("start",E=>{const{nodeLookup:k,transform:M,snapGrid:I,snapToGrid:D,nodeOrigin:b,paneDomNode:R}=n();if(v=k.get(t),!v)return;g=(R==null?void 0:R.getBoundingClientRect())??null;const{xSnapped:A,ySnapped:$}=at(E.sourceEvent,{transform:M,snapGrid:I,snapToGrid:D,containerBounds:g});m={width:v.measured.width??0,height:v.measured.height??0,x:v.position.x??0,y:v.position.y??0},w={...m,pointerX:A,pointerY:$,aspectRatio:m.width/m.height},N=void 0,v.parentId&&(v.extent==="parent"||v.expandParent)&&(N=k.get(v.parentId),S=N&&v.extent==="parent"?Nh(N):void 0),y=[],C=void 0;for(const[z,O]of k)if(O.parentId===t&&(y.push({id:z,position:{...O.position},extent:O.extent}),O.extent==="parent"||O.expandParent)){const V=kh(O,v,O.origin??b);C?C=[[Math.min(V[0][0],C[0][0]),Math.min(V[0][1],C[0][1])],[Math.max(V[1][0],C[1][0]),Math.max(V[1][1],C[1][1])]]:C=V}l==null||l(E,{...m})}).on("drag",E=>{const{transform:k,snapGrid:M,snapToGrid:I,nodeOrigin:D}=n(),b=at(E.sourceEvent,{transform:k,snapGrid:M,snapToGrid:I,containerBounds:g}),R=[];if(!v)return;const{x:A,y:$,width:z,height:O}=m,V={},q=v.origin??D,{width:Y,height:T,x:L,y:j}=_h(w,x,b,d,c,q,S,C),B=Y!==z,F=T!==O,G=L!==A&&B,X=j!==$&&F;if(!G&&!X&&!B&&!F)return;if((G||X||q[0]===1||q[1]===1)&&(V.x=G?L:m.x,V.y=X?j:m.y,m.x=V.x,m.y=V.y,y.length>0)){const Q=L-A,J=j-$;for(const re of y)re.position={x:re.position.x-Q+q[0]*(Y-z),y:re.position.y-J+q[1]*(T-O)},R.push(re)}if((B||F)&&(V.width=B?Y:m.width,V.height=F?T:m.height,m.width=V.width,m.height=V.height),N&&v.expandParent){const Q=q[0]*(V.width??0);V.x&&V.x<Q&&(m.x=Q,w.x=w.x-(V.x-Q));const J=q[1]*(V.height??0);V.y&&V.y<J&&(m.y=J,w.y=w.y-(V.y-J))}const Z=vh({width:m.width,prevWidth:z,height:m.height,prevHeight:O,affectsX:x.affectsX,affectsY:x.affectsY}),K={...m,direction:Z};(p==null?void 0:p(E,K))!==!1&&(f==null||f(E,K),r(V,R))}).on("end",E=>{h==null||h(E,{...m}),i==null||i({...m})});s.call(_)}function a(){s.on(".drag",null)}return{update:o,destroy:a}}const Ch={},Li=e=>{let t;const n=new Set,r=(c,l)=>{const f=typeof c=="function"?c(t):c;if(!Object.is(f,t)){const h=t;t=l??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(p=>p(t,h))}},i=()=>t,u={setState:r,getState:i,getInitialState:()=>d,subscribe:c=>(n.add(c),()=>n.delete(c)),destroy:()=>{(Ch?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},d=t=e(r,i,u);return u},Mh=e=>e?Li(e):Li,{useDebugValue:Ih}=Kc,{useSyncExternalStoreWithSelector:Ah}=eu,Th=e=>e;function ca(e,t=Th,n){const r=Ah(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Ih(r),r}const ji=(e,t)=>{const n=Mh(e),r=(i,s=t)=>ca(n,i,s);return Object.assign(r,n),r},Rh=(e,t)=>e?ji(e,t):ji;function ne(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,i]of e)if(!Object.is(i,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const an=H.createContext(null),Ph=an.Provider,ua=xe.error001();function ee(e,t){const n=H.useContext(an);if(n===null)throw new Error(ua);return ca(n,e,t)}function te(){const e=H.useContext(an);if(e===null)throw new Error(ua);return H.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const Di={display:"none"},$h={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},la="react-flow__node-desc",da="react-flow__edge-desc",Oh="react-flow__aria-live",Lh=e=>e.ariaLiveMessage;function jh({rfId:e}){const t=ee(Lh);return P.jsx("div",{id:`${Oh}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:$h,children:t})}function Dh({rfId:e,disableKeyboardA11y:t}){return P.jsxs(P.Fragment,{children:[P.jsxs("div",{id:`${la}-${e}`,style:Di,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),P.jsx("div",{id:`${da}-${e}`,style:Di,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&P.jsx(jh,{rfId:e})]})}const zh=e=>e.userSelectionActive?"none":"all",cn=H.forwardRef(({position:e="top-left",children:t,className:n,style:r,...i},s)=>{const o=ee(zh),a=`${e}`.split("-");return P.jsx("div",{className:se(["react-flow__panel",n,...a]),style:{...r,pointerEvents:o},ref:s,...i,children:t})});cn.displayName="Panel";function Hh({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:P.jsx(cn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:P.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const Vh=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},Pt=e=>e.id;function Bh(e,t){return ne(e.selectedNodes.map(Pt),t.selectedNodes.map(Pt))&&ne(e.selectedEdges.map(Pt),t.selectedEdges.map(Pt))}function Fh({onSelectionChange:e}){const t=te(),{selectedNodes:n,selectedEdges:r}=ee(Vh,Bh);return H.useEffect(()=>{const i={nodes:n,edges:r};e==null||e(i),t.getState().onSelectionChangeHandlers.forEach(s=>s(i))},[n,r,e]),null}const qh=e=>!!e.onSelectionChangeHandlers;function Yh({onSelectionChange:e}){const t=ee(qh);return e||t?P.jsx(Fh,{onSelectionChange:e}):null}const fa=[0,0],Gh={x:0,y:0,zoom:1},Xh=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance"],zi=[...Xh,"rfId"],Wh=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),Hi={translateExtent:pt,nodeOrigin:fa,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function Uh(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:i,setTranslateExtent:s,setNodeExtent:o,reset:a,setDefaultNodesAndEdges:u,setPaneClickDistance:d}=ee(Wh,ne),c=te();H.useEffect(()=>(u(e.defaultNodes,e.defaultEdges),()=>{l.current=Hi,a()}),[]);const l=H.useRef(Hi);return H.useEffect(()=>{for(const f of zi){const h=e[f],p=l.current[f];h!==p&&(typeof e[f]>"u"||(f==="nodes"?t(h):f==="edges"?n(h):f==="minZoom"?r(h):f==="maxZoom"?i(h):f==="translateExtent"?s(h):f==="nodeExtent"?o(h):f==="paneClickDistance"?d(h):f==="fitView"?c.setState({fitViewQueued:h}):f==="fitViewOptions"?c.setState({fitViewOptions:h}):c.setState({[f]:h})))}l.current=e},zi.map(f=>e[f])),null}function Vi(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function Kh(e){var r;const[t,n]=H.useState(e==="system"?null:e);return H.useEffect(()=>{if(e!=="system"){n(e);return}const i=Vi(),s=()=>n(i!=null&&i.matches?"dark":"light");return s(),i==null||i.addEventListener("change",s),()=>{i==null||i.removeEventListener("change",s)}},[e]),t!==null?t:(r=Vi())!=null&&r.matches?"dark":"light"}const Bi=typeof document<"u"?document:null;function xt(e=null,t={target:Bi,actInsideInputWithModifier:!0}){const[n,r]=H.useState(!1),i=H.useRef(!1),s=H.useRef(new Set([])),[o,a]=H.useMemo(()=>{if(e!==null){const d=(Array.isArray(e)?e:[e]).filter(l=>typeof l=="string").map(l=>l.replace("+",`
`).replace(`

`,`
+`).split(`
`)),c=d.reduce((l,f)=>l.concat(...f),[]);return[d,c]}return[[],[]]},[e]);return H.useEffect(()=>{const u=(t==null?void 0:t.target)||Bi;if(e!==null){const d=f=>{var m,w;if(i.current=f.ctrlKey||f.metaKey||f.shiftKey||f.altKey,(!i.current||i.current&&!t.actInsideInputWithModifier)&&Gs(f))return!1;const p=qi(f.code,a);if(s.current.add(f[p]),Fi(o,s.current,!1)){const x=((w=(m=f.composedPath)==null?void 0:m.call(f))==null?void 0:w[0])||f.target,v=(x==null?void 0:x.nodeName)==="BUTTON"||(x==null?void 0:x.nodeName)==="A";t.preventDefault!==!1&&(i.current||!v)&&f.preventDefault(),r(!0)}},c=f=>{const h=qi(f.code,a);Fi(o,s.current,!0)?(r(!1),s.current.clear()):s.current.delete(f[h]),f.key==="Meta"&&s.current.clear(),i.current=!1},l=()=>{s.current.clear(),r(!1)};return u==null||u.addEventListener("keydown",d),u==null||u.addEventListener("keyup",c),window.addEventListener("blur",l),window.addEventListener("contextmenu",l),()=>{u==null||u.removeEventListener("keydown",d),u==null||u.removeEventListener("keyup",c),window.removeEventListener("blur",l),window.removeEventListener("contextmenu",l)}}},[e,r]),n}function Fi(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(i=>t.has(i)))}function qi(e,t){return t.includes(e)?"code":"key"}const Qh=()=>{const e=te();return H.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,i,s],panZoom:o}=e.getState();return o?(await o.setViewport({x:t.x??r,y:t.y??i,zoom:t.zoom??s},{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},setCenter:async(t,n,r)=>{const{width:i,height:s,maxZoom:o,panZoom:a}=e.getState(),u=typeof(r==null?void 0:r.zoom)<"u"?r.zoom:o,d=i/2-t*u,c=s/2-n*u;return a?(await a.setViewport({x:d,y:c,zoom:u},{duration:r==null?void 0:r.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitBounds:async(t,n)=>{const{width:r,height:i,minZoom:s,maxZoom:o,panZoom:a}=e.getState(),u=Vr(t,r,i,s,o,(n==null?void 0:n.padding)??.1);return a?(await a.setViewport(u,{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:r,snapGrid:i,snapToGrid:s,domNode:o}=e.getState();if(!o)return t;const{x:a,y:u}=o.getBoundingClientRect(),d={x:t.x-a,y:t.y-u},c=n.snapGrid??i,l=n.snapToGrid??s;return Et(d,r,l,c)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:i,y:s}=r.getBoundingClientRect(),o=Xt(t,n);return{x:o.x+i,y:o.y+s}}}),[])};function ha(e,t){const n=[],r=new Map,i=[];for(const s of e)if(s.type==="add"){i.push(s);continue}else if(s.type==="remove"||s.type==="replace")r.set(s.id,[s]);else{const o=r.get(s.id);o?o.push(s):r.set(s.id,[s])}for(const s of t){const o=r.get(s.id);if(!o){n.push(s);continue}if(o[0].type==="remove")continue;if(o[0].type==="replace"){n.push({...o[0].item});continue}const a={...s};for(const u of o)Zh(u,a);n.push(a)}return i.length&&i.forEach(s=>{s.index!==void 0?n.splice(s.index,0,{...s.item}):n.push({...s.item})}),n}function Zh(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&(t.width=e.dimensions.width,t.height=e.dimensions.height)),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Jh(e,t){return ha(e,t)}function ep(e,t){return ha(e,t)}function Te(e,t){return{id:e,type:"select",selected:t}}function Ve(e,t=new Set,n=!1){const r=[];for(const[i,s]of e){const o=t.has(i);!(s.selected===void 0&&!o)&&s.selected!==o&&(n&&(s.selected=o),r.push(Te(s.id,o)))}return r}function Yi({items:e=[],lookup:t}){var i;const n=[],r=new Map(e.map(s=>[s.id,s]));for(const[s,o]of e.entries()){const a=t.get(o.id),u=((i=a==null?void 0:a.internals)==null?void 0:i.userNode)??a;u!==void 0&&u!==o&&n.push({id:o.id,item:o,type:"replace"}),u===void 0&&n.push({item:o,type:"add",index:s})}for(const[s]of t)r.get(s)===void 0&&n.push({id:s,type:"remove"});return n}function Gi(e){return{id:e.id,type:"remove"}}const Xi=e=>Rf(e),tp=e=>js(e);function pa(e){return H.forwardRef(e)}const np=typeof window<"u"?H.useLayoutEffect:H.useEffect;function Wi(e){const[t,n]=H.useState(BigInt(0)),[r]=H.useState(()=>rp(()=>n(i=>i+BigInt(1))));return np(()=>{const i=r.get();i.length&&(e(i),r.reset())},[t]),r}function rp(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const ga=H.createContext(null);function ip({children:e}){const t=te(),n=H.useCallback(a=>{const{nodes:u=[],setNodes:d,hasDefaultNodes:c,onNodesChange:l,nodeLookup:f,fitViewQueued:h}=t.getState();let p=u;for(const m of a)p=typeof m=="function"?m(p):m;if(c)d(p);else{const m=Yi({items:p,lookup:f});m.length>0?l==null||l(m):h&&window.requestAnimationFrame(()=>{const{fitViewQueued:w,nodes:x,setNodes:v}=t.getState();w&&v(x)})}},[]),r=Wi(n),i=H.useCallback(a=>{const{edges:u=[],setEdges:d,hasDefaultEdges:c,onEdgesChange:l,edgeLookup:f}=t.getState();let h=u;for(const p of a)h=typeof p=="function"?p(h):p;c?d(h):l&&l(Yi({items:h,lookup:f}))},[]),s=Wi(i),o=H.useMemo(()=>({nodeQueue:r,edgeQueue:s}),[]);return P.jsx(ga.Provider,{value:o,children:e})}function op(){const e=H.useContext(ga);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const sp=e=>!!e.panZoom;function Xr(){const e=Qh(),t=te(),n=op(),r=ee(sp),i=H.useMemo(()=>{const s=l=>t.getState().nodeLookup.get(l),o=l=>{n.nodeQueue.push(l)},a=l=>{n.edgeQueue.push(l)},u=l=>{var x,v;const{nodeLookup:f,nodeOrigin:h}=t.getState(),p=Xi(l)?l:f.get(l.id),m=p.parentId?qs(p.position,p.measured,p.parentId,f,h):p.position,w={...p,position:m,width:((x=p.measured)==null?void 0:x.width)??p.width,height:((v=p.measured)==null?void 0:v.height)??p.height};return Ue(w)},d=(l,f,h={replace:!1})=>{o(p=>p.map(m=>{if(m.id===l){const w=typeof f=="function"?f(m):f;return h.replace&&Xi(w)?w:{...m,...w}}return m}))},c=(l,f,h={replace:!1})=>{a(p=>p.map(m=>{if(m.id===l){const w=typeof f=="function"?f(m):f;return h.replace&&tp(w)?w:{...m,...w}}return m}))};return{getNodes:()=>t.getState().nodes.map(l=>({...l})),getNode:l=>{var f;return(f=s(l))==null?void 0:f.internals.userNode},getInternalNode:s,getEdges:()=>{const{edges:l=[]}=t.getState();return l.map(f=>({...f}))},getEdge:l=>t.getState().edgeLookup.get(l),setNodes:o,setEdges:a,addNodes:l=>{const f=Array.isArray(l)?l:[l];n.nodeQueue.push(h=>[...h,...f])},addEdges:l=>{const f=Array.isArray(l)?l:[l];n.edgeQueue.push(h=>[...h,...f])},toObject:()=>{const{nodes:l=[],edges:f=[],transform:h}=t.getState(),[p,m,w]=h;return{nodes:l.map(x=>({...x})),edges:f.map(x=>({...x})),viewport:{x:p,y:m,zoom:w}}},deleteElements:async({nodes:l=[],edges:f=[]})=>{const{nodes:h,edges:p,onNodesDelete:m,onEdgesDelete:w,triggerNodeChanges:x,triggerEdgeChanges:v,onDelete:g,onBeforeDelete:y}=t.getState(),{nodes:N,edges:S}=await jf({nodesToRemove:l,edgesToRemove:f,nodes:h,edges:p,onBeforeDelete:y}),C=S.length>0,_=N.length>0;if(C){const E=S.map(Gi);w==null||w(S),v(E)}if(_){const E=N.map(Gi);m==null||m(N),x(E)}return(_||C)&&(g==null||g({nodes:N,edges:S})),{deletedNodes:N,deletedEdges:S}},getIntersectingNodes:(l,f=!0,h)=>{const p=Ni(l),m=p?l:u(l),w=h!==void 0;return m?(h||t.getState().nodes).filter(x=>{const v=t.getState().nodeLookup.get(x.id);if(v&&!p&&(x.id===l.id||!v.internals.positionAbsolute))return!1;const g=Ue(w?x:v),y=mt(g,m);return f&&y>0||y>=m.width*m.height}):[]},isNodeIntersecting:(l,f,h=!0)=>{const m=Ni(l)?l:u(l);if(!m)return!1;const w=mt(m,f);return h&&w>0||w>=m.width*m.height},updateNode:d,updateNodeData:(l,f,h={replace:!1})=>{d(l,p=>{const m=typeof f=="function"?f(p):f;return h.replace?{...p,data:m}:{...p,data:{...p.data,...m}}},h)},updateEdge:c,updateEdgeData:(l,f,h={replace:!1})=>{c(l,p=>{const m=typeof f=="function"?f(p):f;return h.replace?{...p,data:m}:{...p,data:{...p.data,...m}}},h)},getNodesBounds:l=>{const{nodeLookup:f,nodeOrigin:h}=t.getState();return Pf(l,{nodeLookup:f,nodeOrigin:h})},getHandleConnections:({type:l,id:f,nodeId:h})=>{var p;return Array.from(((p=t.getState().connectionLookup.get(`${h}-${l}${f?`-${f}`:""}`))==null?void 0:p.values())??[])},getNodeConnections:({type:l,handleId:f,nodeId:h})=>{var p;return Array.from(((p=t.getState().connectionLookup.get(`${h}${l?f?`-${l}-${f}`:`-${l}`:""}`))==null?void 0:p.values())??[])},fitView:async l=>{const f=t.getState().fitViewResolver??Promise.withResolvers();return t.setState({fitViewQueued:!0,fitViewOptions:l,fitViewResolver:f}),n.nodeQueue.push(h=>[...h]),f.promise}}},[]);return H.useMemo(()=>({...i,...e,viewportInitialized:r}),[r])}const Ui=e=>e.selected,ap={actInsideInputWithModifier:!1},cp=typeof window<"u"?window:void 0;function up({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=te(),{deleteElements:r}=Xr(),i=xt(e,ap),s=xt(t,{target:cp});H.useEffect(()=>{if(i){const{edges:o,nodes:a}=n.getState();r({nodes:a.filter(Ui),edges:o.filter(Ui)}),n.setState({nodesSelectionActive:!1})}},[i]),H.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])}function lp(e){const t=te();H.useEffect(()=>{const n=()=>{var i,s;if(!e.current)return!1;const r=Br(e.current);(r.height===0||r.width===0)&&((s=(i=t.getState()).onError)==null||s.call(i,"004",xe.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const un={position:"absolute",width:"100%",height:"100%",top:0,left:0},dp=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function fp({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:i=.5,panOnScrollMode:s=$e.Free,zoomOnDoubleClick:o=!0,panOnDrag:a=!0,defaultViewport:u,translateExtent:d,minZoom:c,maxZoom:l,zoomActivationKeyCode:f,preventScrolling:h=!0,children:p,noWheelClassName:m,noPanClassName:w,onViewportChange:x,isControlledViewport:v,paneClickDistance:g}){const y=te(),N=H.useRef(null),{userSelectionActive:S,lib:C}=ee(dp,ne),_=xt(f),E=H.useRef();lp(N);const k=H.useCallback(M=>{x==null||x({x:M[0],y:M[1],zoom:M[2]}),v||y.setState({transform:M})},[x,v]);return H.useEffect(()=>{if(N.current){E.current=wh({domNode:N.current,minZoom:c,maxZoom:l,translateExtent:d,viewport:u,paneClickDistance:g,onDraggingChange:b=>y.setState({paneDragging:b}),onPanZoomStart:(b,R)=>{const{onViewportChangeStart:A,onMoveStart:$}=y.getState();$==null||$(b,R),A==null||A(R)},onPanZoom:(b,R)=>{const{onViewportChange:A,onMove:$}=y.getState();$==null||$(b,R),A==null||A(R)},onPanZoomEnd:(b,R)=>{const{onViewportChangeEnd:A,onMoveEnd:$}=y.getState();$==null||$(b,R),A==null||A(R)}});const{x:M,y:I,zoom:D}=E.current.getViewport();return y.setState({panZoom:E.current,transform:[M,I,D],domNode:N.current.closest(".react-flow")}),()=>{var b;(b=E.current)==null||b.destroy()}}},[]),H.useEffect(()=>{var M;(M=E.current)==null||M.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:i,panOnScrollMode:s,zoomOnDoubleClick:o,panOnDrag:a,zoomActivationKeyPressed:_,preventScrolling:h,noPanClassName:w,userSelectionActive:S,noWheelClassName:m,lib:C,onTransformChange:k})},[e,t,n,r,i,s,o,a,_,h,w,S,m,C,k]),P.jsx("div",{className:"react-flow__renderer",ref:N,style:un,children:p})}const hp=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function pp(){const{userSelectionActive:e,userSelectionRect:t}=ee(hp,ne);return e&&t?P.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const Nn=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},gp=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function mp({isSelecting:e,selectionKeyPressed:t,selectionMode:n=gt.Full,panOnDrag:r,selectionOnDrag:i,onSelectionStart:s,onSelectionEnd:o,onPaneClick:a,onPaneContextMenu:u,onPaneScroll:d,onPaneMouseEnter:c,onPaneMouseMove:l,onPaneMouseLeave:f,children:h}){const p=te(),{userSelectionActive:m,elementsSelectable:w,dragging:x,connectionInProgress:v}=ee(gp,ne),g=w&&(e||m),y=H.useRef(null),N=H.useRef(),S=H.useRef(new Set),C=H.useRef(new Set),_=H.useRef(!1),E=H.useRef(!1),k=$=>{if(_.current||v){_.current=!1;return}a==null||a($),p.getState().resetSelectedElements(),p.setState({nodesSelectionActive:!1})},M=$=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){$.preventDefault();return}u==null||u($)},I=d?$=>d($):void 0,D=$=>{var Y,T;const{resetSelectedElements:z,domNode:O}=p.getState();if(N.current=O==null?void 0:O.getBoundingClientRect(),!w||!e||$.button!==0||$.target!==y.current||!N.current)return;(T=(Y=$.target)==null?void 0:Y.setPointerCapture)==null||T.call(Y,$.pointerId),E.current=!0,_.current=!1;const{x:V,y:q}=_e($.nativeEvent,N.current);z(),p.setState({userSelectionRect:{width:0,height:0,startX:V,startY:q,x:V,y:q}}),s==null||s($)},b=$=>{const{userSelectionRect:z,transform:O,nodeLookup:V,edgeLookup:q,connectionLookup:Y,triggerNodeChanges:T,triggerEdgeChanges:L,defaultEdgeOptions:j}=p.getState();if(!N.current||!z)return;_.current=!0;const{x:B,y:F}=_e($.nativeEvent,N.current),{startX:G,startY:X}=z,Z={startX:G,startY:X,x:B<G?B:G,y:F<X?F:X,width:Math.abs(B-G),height:Math.abs(F-X)},K=S.current,W=C.current;S.current=new Set(Ds(V,Z,O,n===gt.Partial,!0).map(J=>J.id)),C.current=new Set;const Q=(j==null?void 0:j.selectable)??!0;for(const J of S.current){const re=Y.get(J);if(re)for(const{edgeId:ae}of re.values()){const De=q.get(ae);De&&(De.selectable??Q)&&C.current.add(ae)}}if(!ki(K,S.current)){const J=Ve(V,S.current,!0);T(J)}if(!ki(W,C.current)){const J=Ve(q,C.current);L(J)}p.setState({userSelectionRect:Z,userSelectionActive:!0,nodesSelectionActive:!1})},R=$=>{var O,V;if($.button!==0||!E.current)return;(V=(O=$.target)==null?void 0:O.releasePointerCapture)==null||V.call(O,$.pointerId);const{userSelectionRect:z}=p.getState();!m&&z&&$.target===y.current&&(k==null||k($)),p.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:S.current.size>0}),o==null||o($),(t||i)&&(_.current=!1),E.current=!1},A=r===!0||Array.isArray(r)&&r.includes(0);return P.jsxs("div",{className:se(["react-flow__pane",{draggable:A,dragging:x,selection:e}]),onClick:g?void 0:Nn(k,y),onContextMenu:Nn(M,y),onWheel:Nn(I,y),onPointerEnter:g?void 0:c,onPointerDown:g?D:l,onPointerMove:g?b:l,onPointerUp:g?R:void 0,onPointerLeave:f,ref:y,style:un,children:[h,P.jsx(pp,{})]})}function Rr({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:i,unselectNodesAndEdges:s,multiSelectionActive:o,nodeLookup:a,onError:u}=t.getState(),d=a.get(e);if(!d){u==null||u("012",xe.error012(e));return}t.setState({nodesSelectionActive:!1}),d.selected?(n||d.selected&&o)&&(s({nodes:[d],edges:[]}),requestAnimationFrame(()=>{var c;return(c=r==null?void 0:r.current)==null?void 0:c.blur()})):i([e])}function ma({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:i,isSelectable:s,nodeClickDistance:o}){const a=te(),[u,d]=H.useState(!1),c=H.useRef();return H.useEffect(()=>{c.current=oh({getStoreItems:()=>a.getState(),onNodeMouseDown:l=>{Rr({id:l,store:a,nodeRef:e})},onDragStart:()=>{d(!0)},onDragStop:()=>{d(!1)}})},[]),H.useEffect(()=>{var l,f;if(t)(l=c.current)==null||l.destroy();else if(e.current)return(f=c.current)==null||f.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:s,nodeId:i,nodeClickDistance:o}),()=>{var h;(h=c.current)==null||h.destroy()}},[n,r,t,s,e,i]),u}const yp=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function ya(){const e=te();return H.useCallback(n=>{const{nodeExtent:r,snapToGrid:i,snapGrid:s,nodesDraggable:o,onError:a,updateNodePositions:u,nodeLookup:d,nodeOrigin:c}=e.getState(),l=new Map,f=yp(o),h=i?s[0]:5,p=i?s[1]:5,m=n.direction.x*h*n.factor,w=n.direction.y*p*n.factor;for(const[,x]of d){if(!f(x))continue;let v={x:x.internals.positionAbsolute.x+m,y:x.internals.positionAbsolute.y+w};i&&(v=on(v,s));const{position:g,positionAbsolute:y}=zs({nodeId:x.id,nextPosition:v,nodeLookup:d,nodeExtent:r,nodeOrigin:c,onError:a});x.position=g,x.internals.positionAbsolute=y,l.set(x.id,x)}u(l)},[])}const Wr=H.createContext(null),xp=Wr.Provider;Wr.Consumer;const xa=()=>H.useContext(Wr),wp=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),vp=(e,t,n)=>r=>{const{connectionClickStartHandle:i,connectionMode:s,connection:o}=r,{fromHandle:a,toHandle:u,isValid:d}=o,c=(u==null?void 0:u.nodeId)===e&&(u==null?void 0:u.id)===t&&(u==null?void 0:u.type)===n;return{connectingFrom:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,connectingTo:c,clickConnecting:(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.id)===t&&(i==null?void 0:i.type)===n,isPossibleEndHandle:s===Xe.Strict?(a==null?void 0:a.type)!==n:e!==(a==null?void 0:a.nodeId)||t!==(a==null?void 0:a.id),connectionInProcess:!!a,clickConnectionInProcess:!!i,valid:c&&d}};function bp({type:e="source",position:t=U.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:i=!0,isConnectableEnd:s=!0,id:o,onConnect:a,children:u,className:d,onMouseDown:c,onTouchStart:l,...f},h){var R,A;const p=o||null,m=e==="target",w=te(),x=xa(),{connectOnClick:v,noPanClassName:g,rfId:y}=ee(wp,ne),{connectingFrom:N,connectingTo:S,clickConnecting:C,isPossibleEndHandle:_,connectionInProcess:E,clickConnectionInProcess:k,valid:M}=ee(vp(x,p,e),ne);x||(A=(R=w.getState()).onError)==null||A.call(R,"010",xe.error010());const I=$=>{const{defaultEdgeOptions:z,onConnect:O,hasDefaultEdges:V}=w.getState(),q={...z,...$};if(V){const{edges:Y,setEdges:T}=w.getState();T(Gf(q,Y))}O==null||O(q),a==null||a(q)},D=$=>{if(!x)return;const z=Xs($.nativeEvent);if(i&&(z&&$.button===0||!z)){const O=w.getState();Tr.onPointerDown($.nativeEvent,{autoPanOnConnect:O.autoPanOnConnect,connectionMode:O.connectionMode,connectionRadius:O.connectionRadius,domNode:O.domNode,nodeLookup:O.nodeLookup,lib:O.lib,isTarget:m,handleId:p,nodeId:x,flowId:O.rfId,panBy:O.panBy,cancelConnection:O.cancelConnection,onConnectStart:O.onConnectStart,onConnectEnd:O.onConnectEnd,updateConnection:O.updateConnection,onConnect:I,isValidConnection:n||O.isValidConnection,getTransform:()=>w.getState().transform,getFromHandle:()=>w.getState().connection.fromHandle,autoPanSpeed:O.autoPanSpeed})}z?c==null||c($):l==null||l($)},b=$=>{const{onClickConnectStart:z,onClickConnectEnd:O,connectionClickStartHandle:V,connectionMode:q,isValidConnection:Y,lib:T,rfId:L,nodeLookup:j,connection:B}=w.getState();if(!x||!V&&!i)return;if(!V){z==null||z($.nativeEvent,{nodeId:x,handleId:p,handleType:e}),w.setState({connectionClickStartHandle:{nodeId:x,type:e,id:p}});return}const F=Ys($.target),G=n||Y,{connection:X,isValid:Z}=Tr.isValid($.nativeEvent,{handle:{nodeId:x,id:p,type:e},connectionMode:q,fromNodeId:V.nodeId,fromHandleId:V.id||null,fromType:V.type,isValidConnection:G,flowId:L,doc:F,lib:T,nodeLookup:j});Z&&X&&I(X);const K=structuredClone(B);delete K.inProgress,K.toPosition=K.toHandle?K.toHandle.position:null,O==null||O($,K),w.setState({connectionClickStartHandle:null})};return P.jsx("div",{"data-handleid":p,"data-nodeid":x,"data-handlepos":t,"data-id":`${y}-${x}-${p}-${e}`,className:se(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",g,d,{source:!m,target:m,connectable:r,connectablestart:i,connectableend:s,clickconnecting:C,connectingfrom:N,connectingto:S,valid:M,connectionindicator:r&&(!E||_)&&(E||k?s:i)}]),onMouseDown:D,onTouchStart:D,onClick:v?b:void 0,ref:h,...f,children:u})}const Oe=H.memo(pa(bp));function _p({data:e,isConnectable:t,sourcePosition:n=U.Bottom}){return P.jsxs(P.Fragment,{children:[e==null?void 0:e.label,P.jsx(Oe,{type:"source",position:n,isConnectable:t})]})}function Ep({data:e,isConnectable:t,targetPosition:n=U.Top,sourcePosition:r=U.Bottom}){return P.jsxs(P.Fragment,{children:[P.jsx(Oe,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,P.jsx(Oe,{type:"source",position:r,isConnectable:t})]})}function Np(){return null}function kp({data:e,isConnectable:t,targetPosition:n=U.Top}){return P.jsxs(P.Fragment,{children:[P.jsx(Oe,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const Ut={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Ki={input:_p,default:Ep,output:kp,group:Np};function Sp(e){var t,n,r,i;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((i=e.style)==null?void 0:i.height)}}const Cp=e=>{const{width:t,height:n,x:r,y:i}=_t(e.nodeLookup,{filter:s=>!!s.selected});return{width:he(t)?t:null,height:he(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${i}px)`}};function Mp({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=te(),{width:i,height:s,transformString:o,userSelectionActive:a}=ee(Cp,ne),u=ya(),d=H.useRef(null);if(H.useEffect(()=>{var f;n||(f=d.current)==null||f.focus({preventScroll:!0})},[n]),ma({nodeRef:d}),a||!i||!s)return null;const c=e?f=>{const h=r.getState().nodes.filter(p=>p.selected);e(f,h)}:void 0,l=f=>{Object.prototype.hasOwnProperty.call(Ut,f.key)&&(f.preventDefault(),u({direction:Ut[f.key],factor:f.shiftKey?4:1}))};return P.jsx("div",{className:se(["react-flow__nodesselection","react-flow__container",t]),style:{transform:o},children:P.jsx("div",{ref:d,className:"react-flow__nodesselection-rect",onContextMenu:c,tabIndex:n?void 0:-1,onKeyDown:n?void 0:l,style:{width:i,height:s}})})}const Qi=typeof window<"u"?window:void 0,Ip=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function wa({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,paneClickDistance:a,deleteKeyCode:u,selectionKeyCode:d,selectionOnDrag:c,selectionMode:l,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:p,panActivationKeyCode:m,zoomActivationKeyCode:w,elementsSelectable:x,zoomOnScroll:v,zoomOnPinch:g,panOnScroll:y,panOnScrollSpeed:N,panOnScrollMode:S,zoomOnDoubleClick:C,panOnDrag:_,defaultViewport:E,translateExtent:k,minZoom:M,maxZoom:I,preventScrolling:D,onSelectionContextMenu:b,noWheelClassName:R,noPanClassName:A,disableKeyboardA11y:$,onViewportChange:z,isControlledViewport:O}){const{nodesSelectionActive:V,userSelectionActive:q}=ee(Ip),Y=xt(d,{target:Qi}),T=xt(m,{target:Qi}),L=T||_,j=T||y,B=c&&L!==!0,F=Y||q||B;return up({deleteKeyCode:u,multiSelectionKeyCode:p}),P.jsx(fp,{onPaneContextMenu:s,elementsSelectable:x,zoomOnScroll:v,zoomOnPinch:g,panOnScroll:j,panOnScrollSpeed:N,panOnScrollMode:S,zoomOnDoubleClick:C,panOnDrag:!Y&&L,defaultViewport:E,translateExtent:k,minZoom:M,maxZoom:I,zoomActivationKeyCode:w,preventScrolling:D,noWheelClassName:R,noPanClassName:A,onViewportChange:z,isControlledViewport:O,paneClickDistance:a,children:P.jsxs(mp,{onSelectionStart:f,onSelectionEnd:h,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,panOnDrag:L,isSelecting:!!F,selectionMode:l,selectionKeyPressed:Y,selectionOnDrag:B,children:[e,V&&P.jsx(Mp,{onSelectionContextMenu:b,noPanClassName:A,disableKeyboardA11y:$})]})})}wa.displayName="FlowRenderer";const Ap=H.memo(wa),Tp=e=>t=>e?Ds(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Rp(e){return ee(H.useCallback(Tp(e),[e]),ne)}const Pp=e=>e.updateNodeInternals;function $p(){const e=ee(Pp),[t]=H.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(i=>{const s=i.target.getAttribute("data-id");r.set(s,{id:s,nodeElement:i.target,force:!0})}),e(r)}));return H.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function Op({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const i=te(),s=H.useRef(null),o=H.useRef(null),a=H.useRef(e.sourcePosition),u=H.useRef(e.targetPosition),d=H.useRef(t),c=n&&!!e.internals.handleBounds;return H.useEffect(()=>{s.current&&!e.hidden&&(!c||o.current!==s.current)&&(o.current&&(r==null||r.unobserve(o.current)),r==null||r.observe(s.current),o.current=s.current)},[c,e.hidden]),H.useEffect(()=>()=>{o.current&&(r==null||r.unobserve(o.current),o.current=null)},[]),H.useEffect(()=>{if(s.current){const l=d.current!==t,f=a.current!==e.sourcePosition,h=u.current!==e.targetPosition;(l||f||h)&&(d.current=t,a.current=e.sourcePosition,u.current=e.targetPosition,i.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:s.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),s}function Lp({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:i,onContextMenu:s,onDoubleClick:o,nodesDraggable:a,elementsSelectable:u,nodesConnectable:d,nodesFocusable:c,resizeObserver:l,noDragClassName:f,noPanClassName:h,disableKeyboardA11y:p,rfId:m,nodeTypes:w,nodeClickDistance:x,onError:v}){const{node:g,internals:y,isParent:N}=ee(F=>{const G=F.nodeLookup.get(e),X=F.parentLookup.has(e);return{node:G,internals:G.internals,isParent:X}},ne);let S=g.type||"default",C=(w==null?void 0:w[S])||Ki[S];C===void 0&&(v==null||v("003",xe.error003(S)),S="default",C=Ki.default);const _=!!(g.draggable||a&&typeof g.draggable>"u"),E=!!(g.selectable||u&&typeof g.selectable>"u"),k=!!(g.connectable||d&&typeof g.connectable>"u"),M=!!(g.focusable||c&&typeof g.focusable>"u"),I=te(),D=Fs(g),b=Op({node:g,nodeType:S,hasDimensions:D,resizeObserver:l}),R=ma({nodeRef:b,disabled:g.hidden||!_,noDragClassName:f,handleSelector:g.dragHandle,nodeId:e,isSelectable:E,nodeClickDistance:x}),A=ya();if(g.hidden)return null;const $=Ne(g),z=Sp(g),O=E||_||t||n||r||i,V=n?F=>n(F,{...y.userNode}):void 0,q=r?F=>r(F,{...y.userNode}):void 0,Y=i?F=>i(F,{...y.userNode}):void 0,T=s?F=>s(F,{...y.userNode}):void 0,L=o?F=>o(F,{...y.userNode}):void 0,j=F=>{const{selectNodesOnDrag:G,nodeDragThreshold:X}=I.getState();E&&(!G||!_||X>0)&&Rr({id:e,store:I,nodeRef:b}),t&&t(F,{...y.userNode})},B=F=>{if(!(Gs(F.nativeEvent)||p))if($s.includes(F.key)&&E){const G=F.key==="Escape";Rr({id:e,store:I,unselect:G,nodeRef:b})}else _&&g.selected&&Object.prototype.hasOwnProperty.call(Ut,F.key)&&(F.preventDefault(),I.setState({ariaLiveMessage:`Moved selected node ${F.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~y.positionAbsolute.x}, y: ${~~y.positionAbsolute.y}`}),A({direction:Ut[F.key],factor:F.shiftKey?4:1}))};return P.jsx("div",{className:se(["react-flow__node",`react-flow__node-${S}`,{[h]:_},g.className,{selected:g.selected,selectable:E,parent:N,draggable:_,dragging:R}]),ref:b,style:{zIndex:y.z,transform:`translate(${y.positionAbsolute.x}px,${y.positionAbsolute.y}px)`,pointerEvents:O?"all":"none",visibility:D?"visible":"hidden",...g.style,...z},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:V,onMouseMove:q,onMouseLeave:Y,onContextMenu:T,onClick:j,onDoubleClick:L,onKeyDown:M?B:void 0,tabIndex:M?0:void 0,role:M?"button":void 0,"aria-describedby":p?void 0:`${la}-${m}`,"aria-label":g.ariaLabel,children:P.jsx(xp,{value:e,children:P.jsx(C,{id:e,data:g.data,type:S,positionAbsoluteX:y.positionAbsolute.x,positionAbsoluteY:y.positionAbsolute.y,selected:g.selected??!1,selectable:E,draggable:_,deletable:g.deletable??!0,isConnectable:k,sourcePosition:g.sourcePosition,targetPosition:g.targetPosition,dragging:R,dragHandle:g.dragHandle,zIndex:y.z,parentId:g.parentId,...$})})})}const jp=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function va(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:i,onError:s}=ee(jp,ne),o=Rp(e.onlyRenderVisibleElements),a=$p();return P.jsx("div",{className:"react-flow__nodes",style:un,children:o.map(u=>P.jsx(Lp,{id:u,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:i,nodeClickDistance:e.nodeClickDistance,onError:s},u))})}va.displayName="NodeRenderer";const Dp=H.memo(va);function zp(e){return ee(H.useCallback(n=>{if(!e)return n.edges.map(i=>i.id);const r=[];if(n.width&&n.height)for(const i of n.edges){const s=n.nodeLookup.get(i.source),o=n.nodeLookup.get(i.target);s&&o&&Ff({sourceNode:s,targetNode:o,width:n.width,height:n.height,transform:n.transform})&&r.push(i.id)}return r},[e]),ne)}const Hp=({color:e="none",strokeWidth:t=1})=>P.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),Vp=({color:e="none",strokeWidth:t=1})=>P.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Zi={[Yt.Arrow]:Hp,[Yt.ArrowClosed]:Vp};function Bp(e){const t=te();return H.useMemo(()=>{var i,s;return Object.prototype.hasOwnProperty.call(Zi,e)?Zi[e]:((s=(i=t.getState()).onError)==null||s.call(i,"009",xe.error009(e)),null)},[e])}const Fp=({id:e,type:t,color:n,width:r=12.5,height:i=12.5,markerUnits:s="strokeWidth",strokeWidth:o,orient:a="auto-start-reverse"})=>{const u=Bp(t);return u?P.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:a,refX:"0",refY:"0",children:P.jsx(u,{color:n,strokeWidth:o})}):null},ba=({defaultColor:e,rfId:t})=>{const n=ee(s=>s.edges),r=ee(s=>s.defaultEdgeOptions),i=H.useMemo(()=>Qf(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return i.length?P.jsx("svg",{className:"react-flow__marker",children:P.jsx("defs",{children:i.map(s=>P.jsx(Fp,{id:s.id,type:s.type,color:s.color,width:s.width,height:s.height,markerUnits:s.markerUnits,strokeWidth:s.strokeWidth,orient:s.orient},s.id))})}):null};ba.displayName="MarkerDefinitions";var qp=H.memo(ba);function _a({x:e,y:t,label:n,labelStyle:r,labelShowBg:i=!0,labelBgStyle:s,labelBgPadding:o=[2,4],labelBgBorderRadius:a=2,children:u,className:d,...c}){const[l,f]=H.useState({x:1,y:0,width:0,height:0}),h=se(["react-flow__edge-textwrapper",d]),p=H.useRef(null);return H.useEffect(()=>{if(p.current){const m=p.current.getBBox();f({x:m.x,y:m.y,width:m.width,height:m.height})}},[n]),n?P.jsxs("g",{transform:`translate(${e-l.width/2} ${t-l.height/2})`,className:h,visibility:l.width?"visible":"hidden",...c,children:[i&&P.jsx("rect",{width:l.width+2*o[0],x:-o[0],y:-o[1],height:l.height+2*o[1],className:"react-flow__edge-textbg",style:s,rx:a,ry:a}),P.jsx("text",{className:"react-flow__edge-text",y:l.height/2,dy:"0.3em",ref:p,style:r,children:n}),u]}):null}_a.displayName="EdgeText";const Yp=H.memo(_a);function ln({path:e,labelX:t,labelY:n,label:r,labelStyle:i,labelShowBg:s,labelBgStyle:o,labelBgPadding:a,labelBgBorderRadius:u,interactionWidth:d=20,...c}){return P.jsxs(P.Fragment,{children:[P.jsx("path",{...c,d:e,fill:"none",className:se(["react-flow__edge-path",c.className])}),d&&P.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:d,className:"react-flow__edge-interaction"}),r&&he(t)&&he(n)?P.jsx(Yp,{x:t,y:n,label:r,labelStyle:i,labelShowBg:s,labelBgStyle:o,labelBgPadding:a,labelBgBorderRadius:u}):null]})}function Ji({pos:e,x1:t,y1:n,x2:r,y2:i}){return e===U.Left||e===U.Right?[.5*(t+r),n]:[t,.5*(n+i)]}function Ea({sourceX:e,sourceY:t,sourcePosition:n=U.Bottom,targetX:r,targetY:i,targetPosition:s=U.Top}){const[o,a]=Ji({pos:n,x1:e,y1:t,x2:r,y2:i}),[u,d]=Ji({pos:s,x1:r,y1:i,x2:e,y2:t}),[c,l,f,h]=Ws({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:o,sourceControlY:a,targetControlX:u,targetControlY:d});return[`M${e},${t} C${o},${a} ${u},${d} ${r},${i}`,c,l,f,h]}function Na(e){return H.memo(({id:t,sourceX:n,sourceY:r,targetX:i,targetY:s,sourcePosition:o=U.Bottom,targetPosition:a=U.Top,label:u,labelStyle:d,labelShowBg:c,labelBgStyle:l,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:w,interactionWidth:x})=>{const[v,g,y]=Ea({sourceX:n,sourceY:r,sourcePosition:o,targetX:i,targetY:s,targetPosition:a}),N=e.isInternal?void 0:t;return P.jsx(ln,{id:N,path:v,labelX:g,labelY:y,label:u,labelStyle:d,labelShowBg:c,labelBgStyle:l,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:w,interactionWidth:x})})}const Gp=Na({isInternal:!1}),ka=Na({isInternal:!0});Gp.displayName="SimpleBezierEdge";ka.displayName="SimpleBezierEdgeInternal";function Sa(e){return H.memo(({id:t,sourceX:n,sourceY:r,targetX:i,targetY:s,label:o,labelStyle:a,labelShowBg:u,labelBgStyle:d,labelBgPadding:c,labelBgBorderRadius:l,style:f,sourcePosition:h=U.Bottom,targetPosition:p=U.Top,markerEnd:m,markerStart:w,pathOptions:x,interactionWidth:v})=>{const[g,y,N]=Mr({sourceX:n,sourceY:r,sourcePosition:h,targetX:i,targetY:s,targetPosition:p,borderRadius:x==null?void 0:x.borderRadius,offset:x==null?void 0:x.offset}),S=e.isInternal?void 0:t;return P.jsx(ln,{id:S,path:g,labelX:y,labelY:N,label:o,labelStyle:a,labelShowBg:u,labelBgStyle:d,labelBgPadding:c,labelBgBorderRadius:l,style:f,markerEnd:m,markerStart:w,interactionWidth:v})})}const Ca=Sa({isInternal:!1}),Ma=Sa({isInternal:!0});Ca.displayName="SmoothStepEdge";Ma.displayName="SmoothStepEdgeInternal";function Ia(e){return H.memo(({id:t,...n})=>{var i;const r=e.isInternal?void 0:t;return P.jsx(Ca,{...n,id:r,pathOptions:H.useMemo(()=>{var s;return{borderRadius:0,offset:(s=n.pathOptions)==null?void 0:s.offset}},[(i=n.pathOptions)==null?void 0:i.offset])})})}const Xp=Ia({isInternal:!1}),Aa=Ia({isInternal:!0});Xp.displayName="StepEdge";Aa.displayName="StepEdgeInternal";function Ta(e){return H.memo(({id:t,sourceX:n,sourceY:r,targetX:i,targetY:s,label:o,labelStyle:a,labelShowBg:u,labelBgStyle:d,labelBgPadding:c,labelBgBorderRadius:l,style:f,markerEnd:h,markerStart:p,interactionWidth:m})=>{const[w,x,v]=Qs({sourceX:n,sourceY:r,targetX:i,targetY:s}),g=e.isInternal?void 0:t;return P.jsx(ln,{id:g,path:w,labelX:x,labelY:v,label:o,labelStyle:a,labelShowBg:u,labelBgStyle:d,labelBgPadding:c,labelBgBorderRadius:l,style:f,markerEnd:h,markerStart:p,interactionWidth:m})})}const Wp=Ta({isInternal:!1}),Ra=Ta({isInternal:!0});Wp.displayName="StraightEdge";Ra.displayName="StraightEdgeInternal";function Pa(e){return H.memo(({id:t,sourceX:n,sourceY:r,targetX:i,targetY:s,sourcePosition:o=U.Bottom,targetPosition:a=U.Top,label:u,labelStyle:d,labelShowBg:c,labelBgStyle:l,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:w,pathOptions:x,interactionWidth:v})=>{const[g,y,N]=Us({sourceX:n,sourceY:r,sourcePosition:o,targetX:i,targetY:s,targetPosition:a,curvature:x==null?void 0:x.curvature}),S=e.isInternal?void 0:t;return P.jsx(ln,{id:S,path:g,labelX:y,labelY:N,label:u,labelStyle:d,labelShowBg:c,labelBgStyle:l,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:w,interactionWidth:v})})}const Up=Pa({isInternal:!1}),$a=Pa({isInternal:!0});Up.displayName="BezierEdge";$a.displayName="BezierEdgeInternal";const eo={default:$a,straight:Ra,step:Aa,smoothstep:Ma,simplebezier:ka},to={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},Kp=(e,t,n)=>n===U.Left?e-t:n===U.Right?e+t:e,Qp=(e,t,n)=>n===U.Top?e-t:n===U.Bottom?e+t:e,no="react-flow__edgeupdater";function ro({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:i,onMouseEnter:s,onMouseOut:o,type:a}){return P.jsx("circle",{onMouseDown:i,onMouseEnter:s,onMouseOut:o,className:se([no,`${no}-${a}`]),cx:Kp(t,r,e),cy:Qp(n,r,e),r,stroke:"transparent",fill:"transparent"})}function Zp({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:i,targetX:s,targetY:o,sourcePosition:a,targetPosition:u,onReconnect:d,onReconnectStart:c,onReconnectEnd:l,setReconnecting:f,setUpdateHover:h}){const p=te(),m=(y,N)=>{if(y.button!==0)return;const{autoPanOnConnect:S,domNode:C,isValidConnection:_,connectionMode:E,connectionRadius:k,lib:M,onConnectStart:I,onConnectEnd:D,cancelConnection:b,nodeLookup:R,rfId:A,panBy:$,updateConnection:z}=p.getState(),O=N.type==="target";f(!0),c==null||c(y,n,N.type);const V=(Y,T)=>{f(!1),l==null||l(Y,n,N.type,T)},q=Y=>d==null?void 0:d(n,Y);Tr.onPointerDown(y.nativeEvent,{autoPanOnConnect:S,connectionMode:E,connectionRadius:k,domNode:C,handleId:N.id,nodeId:N.nodeId,nodeLookup:R,isTarget:O,edgeUpdaterType:N.type,lib:M,flowId:A,cancelConnection:b,panBy:$,isValidConnection:_,onConnect:q,onConnectStart:I,onConnectEnd:D,onReconnectEnd:V,updateConnection:z,getTransform:()=>p.getState().transform,getFromHandle:()=>p.getState().connection.fromHandle})},w=y=>m(y,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),x=y=>m(y,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),v=()=>h(!0),g=()=>h(!1);return P.jsxs(P.Fragment,{children:[(e===!0||e==="source")&&P.jsx(ro,{position:a,centerX:r,centerY:i,radius:t,onMouseDown:w,onMouseEnter:v,onMouseOut:g,type:"source"}),(e===!0||e==="target")&&P.jsx(ro,{position:u,centerX:s,centerY:o,radius:t,onMouseDown:x,onMouseEnter:v,onMouseOut:g,type:"target"})]})}function Jp({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:i,onDoubleClick:s,onContextMenu:o,onMouseEnter:a,onMouseMove:u,onMouseLeave:d,reconnectRadius:c,onReconnect:l,onReconnectStart:f,onReconnectEnd:h,rfId:p,edgeTypes:m,noPanClassName:w,onError:x,disableKeyboardA11y:v}){let g=ee(W=>W.edgeLookup.get(e));const y=ee(W=>W.defaultEdgeOptions);g=y?{...y,...g}:g;let N=g.type||"default",S=(m==null?void 0:m[N])||eo[N];S===void 0&&(x==null||x("011",xe.error011(N)),N="default",S=eo.default);const C=!!(g.focusable||t&&typeof g.focusable>"u"),_=typeof l<"u"&&(g.reconnectable||n&&typeof g.reconnectable>"u"),E=!!(g.selectable||r&&typeof g.selectable>"u"),k=H.useRef(null),[M,I]=H.useState(!1),[D,b]=H.useState(!1),R=te(),{zIndex:A,sourceX:$,sourceY:z,targetX:O,targetY:V,sourcePosition:q,targetPosition:Y}=ee(H.useCallback(W=>{const Q=W.nodeLookup.get(g.source),J=W.nodeLookup.get(g.target);if(!Q||!J)return{zIndex:g.zIndex,...to};const re=Kf({id:e,sourceNode:Q,targetNode:J,sourceHandle:g.sourceHandle||null,targetHandle:g.targetHandle||null,connectionMode:W.connectionMode,onError:x});return{zIndex:Bf({selected:g.selected,zIndex:g.zIndex,sourceNode:Q,targetNode:J,elevateOnSelect:W.elevateEdgesOnSelect}),...re||to}},[g.source,g.target,g.sourceHandle,g.targetHandle,g.selected,g.zIndex]),ne),T=H.useMemo(()=>g.markerStart?`url('#${Ir(g.markerStart,p)}')`:void 0,[g.markerStart,p]),L=H.useMemo(()=>g.markerEnd?`url('#${Ir(g.markerEnd,p)}')`:void 0,[g.markerEnd,p]);if(g.hidden||$===null||z===null||O===null||V===null)return null;const j=W=>{var ae;const{addSelectedEdges:Q,unselectNodesAndEdges:J,multiSelectionActive:re}=R.getState();E&&(R.setState({nodesSelectionActive:!1}),g.selected&&re?(J({nodes:[],edges:[g]}),(ae=k.current)==null||ae.blur()):Q([e])),i&&i(W,g)},B=s?W=>{s(W,{...g})}:void 0,F=o?W=>{o(W,{...g})}:void 0,G=a?W=>{a(W,{...g})}:void 0,X=u?W=>{u(W,{...g})}:void 0,Z=d?W=>{d(W,{...g})}:void 0,K=W=>{var Q;if(!v&&$s.includes(W.key)&&E){const{unselectNodesAndEdges:J,addSelectedEdges:re}=R.getState();W.key==="Escape"?((Q=k.current)==null||Q.blur(),J({edges:[g]})):re([e])}};return P.jsx("svg",{style:{zIndex:A},children:P.jsxs("g",{className:se(["react-flow__edge",`react-flow__edge-${N}`,g.className,w,{selected:g.selected,animated:g.animated,inactive:!E&&!i,updating:M,selectable:E}]),onClick:j,onDoubleClick:B,onContextMenu:F,onMouseEnter:G,onMouseMove:X,onMouseLeave:Z,onKeyDown:C?K:void 0,tabIndex:C?0:void 0,role:C?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":g.ariaLabel===null?void 0:g.ariaLabel||`Edge from ${g.source} to ${g.target}`,"aria-describedby":C?`${da}-${p}`:void 0,ref:k,children:[!D&&P.jsx(S,{id:e,source:g.source,target:g.target,type:g.type,selected:g.selected,animated:g.animated,selectable:E,deletable:g.deletable??!0,label:g.label,labelStyle:g.labelStyle,labelShowBg:g.labelShowBg,labelBgStyle:g.labelBgStyle,labelBgPadding:g.labelBgPadding,labelBgBorderRadius:g.labelBgBorderRadius,sourceX:$,sourceY:z,targetX:O,targetY:V,sourcePosition:q,targetPosition:Y,data:g.data,style:g.style,sourceHandleId:g.sourceHandle,targetHandleId:g.targetHandle,markerStart:T,markerEnd:L,pathOptions:"pathOptions"in g?g.pathOptions:void 0,interactionWidth:g.interactionWidth}),_&&P.jsx(Zp,{edge:g,isReconnectable:_,reconnectRadius:c,onReconnect:l,onReconnectStart:f,onReconnectEnd:h,sourceX:$,sourceY:z,targetX:O,targetY:V,sourcePosition:q,targetPosition:Y,setUpdateHover:I,setReconnecting:b})]})})}const eg=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function Oa({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:i,onReconnect:s,onEdgeContextMenu:o,onEdgeMouseEnter:a,onEdgeMouseMove:u,onEdgeMouseLeave:d,onEdgeClick:c,reconnectRadius:l,onEdgeDoubleClick:f,onReconnectStart:h,onReconnectEnd:p,disableKeyboardA11y:m}){const{edgesFocusable:w,edgesReconnectable:x,elementsSelectable:v,onError:g}=ee(eg,ne),y=zp(t);return P.jsxs("div",{className:"react-flow__edges",children:[P.jsx(qp,{defaultColor:e,rfId:n}),y.map(N=>P.jsx(Jp,{id:N,edgesFocusable:w,edgesReconnectable:x,elementsSelectable:v,noPanClassName:i,onReconnect:s,onContextMenu:o,onMouseEnter:a,onMouseMove:u,onMouseLeave:d,onClick:c,reconnectRadius:l,onDoubleClick:f,onReconnectStart:h,onReconnectEnd:p,rfId:n,onError:g,edgeTypes:r,disableKeyboardA11y:m},N))]})}Oa.displayName="EdgeRenderer";const tg=H.memo(Oa),ng=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function rg({children:e}){const t=ee(ng);return P.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function ig(e){const t=Xr(),n=H.useRef(!1);H.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const og=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function sg(e){const t=ee(og),n=te();return H.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function ag(e){return e.connection.inProgress?{...e.connection,to:Et(e.connection.to,e.transform)}:{...e.connection}}function cg(e){return ag}function ug(e){const t=cg();return ee(t,ne)}const lg=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function dg({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:i,width:s,height:o,isValid:a,inProgress:u}=ee(lg,ne);return!(s&&i&&u)?null:P.jsx("svg",{style:e,width:s,height:o,className:"react-flow__connectionline react-flow__container",children:P.jsx("g",{className:se(["react-flow__connection",Ls(a)]),children:P.jsx(La,{style:t,type:n,CustomComponent:r,isValid:a})})})}const La=({style:e,type:t=Me.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:i,from:s,fromNode:o,fromHandle:a,fromPosition:u,to:d,toNode:c,toHandle:l,toPosition:f}=ug();if(!i)return;if(n)return P.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:o,fromHandle:a,fromX:s.x,fromY:s.y,toX:d.x,toY:d.y,fromPosition:u,toPosition:f,connectionStatus:Ls(r),toNode:c,toHandle:l});let h="";const p={sourceX:s.x,sourceY:s.y,sourcePosition:u,targetX:d.x,targetY:d.y,targetPosition:f};switch(t){case Me.Bezier:[h]=Us(p);break;case Me.SimpleBezier:[h]=Ea(p);break;case Me.Step:[h]=Mr({...p,borderRadius:0});break;case Me.SmoothStep:[h]=Mr(p);break;default:[h]=Qs(p)}return P.jsx("path",{d:h,fill:"none",className:"react-flow__connection-path",style:e})};La.displayName="ConnectionLine";const fg={};function io(e=fg){H.useRef(e),te(),H.useEffect(()=>{},[e])}function hg(){te(),H.useRef(!1),H.useEffect(()=>{},[])}function ja({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:i,onNodeDoubleClick:s,onEdgeDoubleClick:o,onNodeMouseEnter:a,onNodeMouseMove:u,onNodeMouseLeave:d,onNodeContextMenu:c,onSelectionContextMenu:l,onSelectionStart:f,onSelectionEnd:h,connectionLineType:p,connectionLineStyle:m,connectionLineComponent:w,connectionLineContainerStyle:x,selectionKeyCode:v,selectionOnDrag:g,selectionMode:y,multiSelectionKeyCode:N,panActivationKeyCode:S,zoomActivationKeyCode:C,deleteKeyCode:_,onlyRenderVisibleElements:E,elementsSelectable:k,defaultViewport:M,translateExtent:I,minZoom:D,maxZoom:b,preventScrolling:R,defaultMarkerColor:A,zoomOnScroll:$,zoomOnPinch:z,panOnScroll:O,panOnScrollSpeed:V,panOnScrollMode:q,zoomOnDoubleClick:Y,panOnDrag:T,onPaneClick:L,onPaneMouseEnter:j,onPaneMouseMove:B,onPaneMouseLeave:F,onPaneScroll:G,onPaneContextMenu:X,paneClickDistance:Z,nodeClickDistance:K,onEdgeContextMenu:W,onEdgeMouseEnter:Q,onEdgeMouseMove:J,onEdgeMouseLeave:re,reconnectRadius:ae,onReconnect:De,onReconnectStart:dn,onReconnectEnd:fn,noDragClassName:Ze,noWheelClassName:hn,noPanClassName:Je,disableKeyboardA11y:et,nodeExtent:pn,rfId:tt,viewport:nt,onViewportChange:Nt}){return io(e),io(t),hg(),ig(n),sg(nt),P.jsx(Ap,{onPaneClick:L,onPaneMouseEnter:j,onPaneMouseMove:B,onPaneMouseLeave:F,onPaneContextMenu:X,onPaneScroll:G,paneClickDistance:Z,deleteKeyCode:_,selectionKeyCode:v,selectionOnDrag:g,selectionMode:y,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:N,panActivationKeyCode:S,zoomActivationKeyCode:C,elementsSelectable:k,zoomOnScroll:$,zoomOnPinch:z,zoomOnDoubleClick:Y,panOnScroll:O,panOnScrollSpeed:V,panOnScrollMode:q,panOnDrag:T,defaultViewport:M,translateExtent:I,minZoom:D,maxZoom:b,onSelectionContextMenu:l,preventScrolling:R,noDragClassName:Ze,noWheelClassName:hn,noPanClassName:Je,disableKeyboardA11y:et,onViewportChange:Nt,isControlledViewport:!!nt,children:P.jsxs(rg,{children:[P.jsx(tg,{edgeTypes:t,onEdgeClick:i,onEdgeDoubleClick:o,onReconnect:De,onReconnectStart:dn,onReconnectEnd:fn,onlyRenderVisibleElements:E,onEdgeContextMenu:W,onEdgeMouseEnter:Q,onEdgeMouseMove:J,onEdgeMouseLeave:re,reconnectRadius:ae,defaultMarkerColor:A,noPanClassName:Je,disableKeyboardA11y:et,rfId:tt}),P.jsx(dg,{style:m,type:p,component:w,containerStyle:x}),P.jsx("div",{className:"react-flow__edgelabel-renderer"}),P.jsx(Dp,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:u,onNodeMouseLeave:d,onNodeContextMenu:c,nodeClickDistance:K,onlyRenderVisibleElements:E,noPanClassName:Je,noDragClassName:Ze,disableKeyboardA11y:et,nodeExtent:pn,rfId:tt}),P.jsx("div",{className:"react-flow__viewport-portal"})]})})}ja.displayName="GraphView";const pg=H.memo(ja),oo=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:i,height:s,fitView:o,nodeOrigin:a,nodeExtent:u}={})=>{const d=new Map,c=new Map,l=new Map,f=new Map,h=r??t??[],p=n??e??[],m=a??[0,0],w=u??pt;Js(l,f,h),Ar(p,d,c,{nodeOrigin:m,nodeExtent:w,elevateNodesOnSelect:!1});let x=[0,0,1];if(o&&i&&s){const v=_t(d,{filter:S=>!!((S.width||S.initialWidth)&&(S.height||S.initialHeight))}),{x:g,y,zoom:N}=Vr(v,i,s,.5,2,.1);x=[g,y,N]}return{rfId:"1",width:0,height:0,transform:x,nodes:p,nodeLookup:d,parentLookup:c,edges:h,edgeLookup:f,connectionLookup:l,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:.5,maxZoom:2,translateExtent:pt,nodeExtent:w,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Xe.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:m,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:o??!1,fitViewOptions:void 0,fitViewResolver:null,connection:{...Os},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanSpeed:15,connectionRadius:20,onError:Df,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}},gg=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:i,height:s,fitView:o,nodeOrigin:a,nodeExtent:u})=>Rh((d,c)=>{async function l(){const{nodeLookup:f,panZoom:h,fitViewOptions:p,fitViewResolver:m,width:w,height:x,minZoom:v,maxZoom:g}=c();h&&(await Lf({nodes:f,width:w,height:x,panZoom:h,minZoom:v,maxZoom:g},p),m==null||m.resolve(!0),d({fitViewResolver:null}))}return{...oo({nodes:e,edges:t,width:i,height:s,fitView:o,nodeOrigin:a,nodeExtent:u,defaultNodes:n,defaultEdges:r}),setNodes:f=>{const{nodeLookup:h,parentLookup:p,nodeOrigin:m,elevateNodesOnSelect:w,fitViewQueued:x}=c(),v=Ar(f,h,p,{nodeOrigin:m,nodeExtent:u,elevateNodesOnSelect:w,checkEquality:!0});x&&v?(l(),d({nodes:f,fitViewQueued:!1,fitViewOptions:void 0})):d({nodes:f})},setEdges:f=>{const{connectionLookup:h,edgeLookup:p}=c();Js(h,p,f),d({edges:f})},setDefaultNodesAndEdges:(f,h)=>{if(f){const{setNodes:p}=c();p(f),d({hasDefaultNodes:!0})}if(h){const{setEdges:p}=c();p(h),d({hasDefaultEdges:!0})}},updateNodeInternals:f=>{const{triggerNodeChanges:h,nodeLookup:p,parentLookup:m,domNode:w,nodeOrigin:x,nodeExtent:v,debug:g,fitViewQueued:y}=c(),{changes:N,updatedInternals:S}=nh(f,p,m,w,x,v);S&&(Jf(p,m,{nodeOrigin:x,nodeExtent:v}),y?(l(),d({fitViewQueued:!1,fitViewOptions:void 0})):d({}),(N==null?void 0:N.length)>0&&(g&&console.log("React Flow: trigger node changes",N),h==null||h(N)))},updateNodePositions:(f,h=!1)=>{const p=[],m=[],{nodeLookup:w,triggerNodeChanges:x}=c();for(const[v,g]of f){const y=w.get(v),N=!!(y!=null&&y.expandParent&&(y!=null&&y.parentId)&&(g!=null&&g.position)),S={id:v,type:"position",position:N?{x:Math.max(0,g.position.x),y:Math.max(0,g.position.y)}:g.position,dragging:h};N&&y.parentId&&p.push({id:v,parentId:y.parentId,rect:{...g.internals.positionAbsolute,width:g.measured.width??0,height:g.measured.height??0}}),m.push(S)}if(p.length>0){const{parentLookup:v,nodeOrigin:g}=c(),y=Gr(p,w,v,g);m.push(...y)}x(m)},triggerNodeChanges:f=>{const{onNodesChange:h,setNodes:p,nodes:m,hasDefaultNodes:w,debug:x}=c();if(f!=null&&f.length){if(w){const v=Jh(f,m);p(v)}x&&console.log("React Flow: trigger node changes",f),h==null||h(f)}},triggerEdgeChanges:f=>{const{onEdgesChange:h,setEdges:p,edges:m,hasDefaultEdges:w,debug:x}=c();if(f!=null&&f.length){if(w){const v=ep(f,m);p(v)}x&&console.log("React Flow: trigger edge changes",f),h==null||h(f)}},addSelectedNodes:f=>{const{multiSelectionActive:h,edgeLookup:p,nodeLookup:m,triggerNodeChanges:w,triggerEdgeChanges:x}=c();if(h){const v=f.map(g=>Te(g,!0));w(v);return}w(Ve(m,new Set([...f]),!0)),x(Ve(p))},addSelectedEdges:f=>{const{multiSelectionActive:h,edgeLookup:p,nodeLookup:m,triggerNodeChanges:w,triggerEdgeChanges:x}=c();if(h){const v=f.map(g=>Te(g,!0));x(v);return}x(Ve(p,new Set([...f]))),w(Ve(m,new Set,!0))},unselectNodesAndEdges:({nodes:f,edges:h}={})=>{const{edges:p,nodes:m,nodeLookup:w,triggerNodeChanges:x,triggerEdgeChanges:v}=c(),g=f||m,y=h||p,N=g.map(C=>{const _=w.get(C.id);return _&&(_.selected=!1),Te(C.id,!1)}),S=y.map(C=>Te(C.id,!1));x(N),v(S)},setMinZoom:f=>{const{panZoom:h,maxZoom:p}=c();h==null||h.setScaleExtent([f,p]),d({minZoom:f})},setMaxZoom:f=>{const{panZoom:h,minZoom:p}=c();h==null||h.setScaleExtent([p,f]),d({maxZoom:f})},setTranslateExtent:f=>{var h;(h=c().panZoom)==null||h.setTranslateExtent(f),d({translateExtent:f})},setPaneClickDistance:f=>{var h;(h=c().panZoom)==null||h.setClickDistance(f)},resetSelectedElements:()=>{const{edges:f,nodes:h,triggerNodeChanges:p,triggerEdgeChanges:m}=c(),w=h.reduce((v,g)=>g.selected?[...v,Te(g.id,!1)]:v,[]),x=f.reduce((v,g)=>g.selected?[...v,Te(g.id,!1)]:v,[]);p(w),m(x)},setNodeExtent:f=>{const{nodes:h,nodeLookup:p,parentLookup:m,nodeOrigin:w,elevateNodesOnSelect:x,nodeExtent:v}=c();f[0][0]===v[0][0]&&f[0][1]===v[0][1]&&f[1][0]===v[1][0]&&f[1][1]===v[1][1]||(Ar(h,p,m,{nodeOrigin:w,nodeExtent:f,elevateNodesOnSelect:x,checkEquality:!1}),d({nodeExtent:f}))},panBy:f=>{const{transform:h,width:p,height:m,panZoom:w,translateExtent:x}=c();return rh({delta:f,panZoom:w,transform:h,translateExtent:x,width:p,height:m})},cancelConnection:()=>{d({connection:{...Os}})},updateConnection:f=>{d({connection:f})},reset:()=>d({...oo()})}},Object.is);function mg({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:i,initialHeight:s,fitView:o,nodeOrigin:a,nodeExtent:u,children:d}){const[c]=H.useState(()=>gg({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:i,height:s,fitView:o,nodeOrigin:a,nodeExtent:u}));return P.jsx(Ph,{value:c,children:P.jsx(ip,{children:d})})}function yg({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:i,width:s,height:o,fitView:a,nodeOrigin:u,nodeExtent:d}){return H.useContext(an)?P.jsx(P.Fragment,{children:e}):P.jsx(mg,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:i,initialWidth:s,initialHeight:o,fitView:a,nodeOrigin:u,nodeExtent:d,children:e})}const xg={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function wg({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:i,nodeTypes:s,edgeTypes:o,onNodeClick:a,onEdgeClick:u,onInit:d,onMove:c,onMoveStart:l,onMoveEnd:f,onConnect:h,onConnectStart:p,onConnectEnd:m,onClickConnectStart:w,onClickConnectEnd:x,onNodeMouseEnter:v,onNodeMouseMove:g,onNodeMouseLeave:y,onNodeContextMenu:N,onNodeDoubleClick:S,onNodeDragStart:C,onNodeDrag:_,onNodeDragStop:E,onNodesDelete:k,onEdgesDelete:M,onDelete:I,onSelectionChange:D,onSelectionDragStart:b,onSelectionDrag:R,onSelectionDragStop:A,onSelectionContextMenu:$,onSelectionStart:z,onSelectionEnd:O,onBeforeDelete:V,connectionMode:q,connectionLineType:Y=Me.Bezier,connectionLineStyle:T,connectionLineComponent:L,connectionLineContainerStyle:j,deleteKeyCode:B="Backspace",selectionKeyCode:F="Shift",selectionOnDrag:G=!1,selectionMode:X=gt.Full,panActivationKeyCode:Z="Space",multiSelectionKeyCode:K=Wt()?"Meta":"Control",zoomActivationKeyCode:W=Wt()?"Meta":"Control",snapToGrid:Q,snapGrid:J,onlyRenderVisibleElements:re=!1,selectNodesOnDrag:ae,nodesDraggable:De,nodesConnectable:dn,nodesFocusable:fn,nodeOrigin:Ze=fa,edgesFocusable:hn,edgesReconnectable:Je,elementsSelectable:et=!0,defaultViewport:pn=Gh,minZoom:tt=.5,maxZoom:nt=2,translateExtent:Nt=pt,preventScrolling:Xa=!0,nodeExtent:gn,defaultMarkerColor:Wa="#b1b1b7",zoomOnScroll:Ua=!0,zoomOnPinch:Ka=!0,panOnScroll:Qa=!1,panOnScrollSpeed:Za=.5,panOnScrollMode:Ja=$e.Free,zoomOnDoubleClick:ec=!0,panOnDrag:tc=!0,onPaneClick:nc,onPaneMouseEnter:rc,onPaneMouseMove:ic,onPaneMouseLeave:oc,onPaneScroll:sc,onPaneContextMenu:ac,paneClickDistance:Zr=0,nodeClickDistance:cc=0,children:uc,onReconnect:lc,onReconnectStart:dc,onReconnectEnd:fc,onEdgeContextMenu:hc,onEdgeDoubleClick:pc,onEdgeMouseEnter:gc,onEdgeMouseMove:mc,onEdgeMouseLeave:yc,reconnectRadius:xc=10,onNodesChange:wc,onEdgesChange:vc,noDragClassName:bc="nodrag",noWheelClassName:_c="nowheel",noPanClassName:Jr="nopan",fitView:ei,fitViewOptions:Ec,connectOnClick:Nc,attributionPosition:kc,proOptions:Sc,defaultEdgeOptions:Cc,elevateNodesOnSelect:Mc,elevateEdgesOnSelect:Ic,disableKeyboardA11y:ti=!1,autoPanOnConnect:Ac,autoPanOnNodeDrag:Tc,autoPanSpeed:Rc,connectionRadius:Pc,isValidConnection:$c,onError:Oc,style:Lc,id:ni,nodeDragThreshold:jc,viewport:Dc,onViewportChange:zc,width:Hc,height:Vc,colorMode:Bc="light",debug:Fc,onScroll:kt,...qc},Yc){const mn=ni||"1",Gc=Kh(Bc),Xc=H.useCallback(ri=>{ri.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),kt==null||kt(ri)},[kt]);return P.jsx("div",{"data-testid":"rf__wrapper",...qc,onScroll:Xc,style:{...Lc,...xg},ref:Yc,className:se(["react-flow",i,Gc]),id:ni,children:P.jsxs(yg,{nodes:e,edges:t,width:Hc,height:Vc,fitView:ei,nodeOrigin:Ze,nodeExtent:gn,children:[P.jsx(pg,{onInit:d,onNodeClick:a,onEdgeClick:u,onNodeMouseEnter:v,onNodeMouseMove:g,onNodeMouseLeave:y,onNodeContextMenu:N,onNodeDoubleClick:S,nodeTypes:s,edgeTypes:o,connectionLineType:Y,connectionLineStyle:T,connectionLineComponent:L,connectionLineContainerStyle:j,selectionKeyCode:F,selectionOnDrag:G,selectionMode:X,deleteKeyCode:B,multiSelectionKeyCode:K,panActivationKeyCode:Z,zoomActivationKeyCode:W,onlyRenderVisibleElements:re,defaultViewport:pn,translateExtent:Nt,minZoom:tt,maxZoom:nt,preventScrolling:Xa,zoomOnScroll:Ua,zoomOnPinch:Ka,zoomOnDoubleClick:ec,panOnScroll:Qa,panOnScrollSpeed:Za,panOnScrollMode:Ja,panOnDrag:tc,onPaneClick:nc,onPaneMouseEnter:rc,onPaneMouseMove:ic,onPaneMouseLeave:oc,onPaneScroll:sc,onPaneContextMenu:ac,paneClickDistance:Zr,nodeClickDistance:cc,onSelectionContextMenu:$,onSelectionStart:z,onSelectionEnd:O,onReconnect:lc,onReconnectStart:dc,onReconnectEnd:fc,onEdgeContextMenu:hc,onEdgeDoubleClick:pc,onEdgeMouseEnter:gc,onEdgeMouseMove:mc,onEdgeMouseLeave:yc,reconnectRadius:xc,defaultMarkerColor:Wa,noDragClassName:bc,noWheelClassName:_c,noPanClassName:Jr,rfId:mn,disableKeyboardA11y:ti,nodeExtent:gn,viewport:Dc,onViewportChange:zc}),P.jsx(Uh,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:h,onConnectStart:p,onConnectEnd:m,onClickConnectStart:w,onClickConnectEnd:x,nodesDraggable:De,nodesConnectable:dn,nodesFocusable:fn,edgesFocusable:hn,edgesReconnectable:Je,elementsSelectable:et,elevateNodesOnSelect:Mc,elevateEdgesOnSelect:Ic,minZoom:tt,maxZoom:nt,nodeExtent:gn,onNodesChange:wc,onEdgesChange:vc,snapToGrid:Q,snapGrid:J,connectionMode:q,translateExtent:Nt,connectOnClick:Nc,defaultEdgeOptions:Cc,fitView:ei,fitViewOptions:Ec,onNodesDelete:k,onEdgesDelete:M,onDelete:I,onNodeDragStart:C,onNodeDrag:_,onNodeDragStop:E,onSelectionDrag:R,onSelectionDragStart:b,onSelectionDragStop:A,onMove:c,onMoveStart:l,onMoveEnd:f,noPanClassName:Jr,nodeOrigin:Ze,rfId:mn,autoPanOnConnect:Ac,autoPanOnNodeDrag:Tc,autoPanSpeed:Rc,onError:Oc,connectionRadius:Pc,isValidConnection:$c,selectNodesOnDrag:ae,nodeDragThreshold:jc,onBeforeDelete:V,paneClickDistance:Zr,debug:Fc}),P.jsx(Yh,{onSelectionChange:D}),uc,P.jsx(Hh,{proOptions:Sc,position:kc}),P.jsx(Dh,{rfId:mn,disableKeyboardA11y:ti})]})})}var L0=pa(wg);function vg({dimensions:e,lineWidth:t,variant:n,className:r}){return P.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:se(["react-flow__background-pattern",n,r])})}function bg({radius:e,className:t}){return P.jsx("circle",{cx:e,cy:e,r:e,className:se(["react-flow__background-pattern","dots",t])})}var Ae;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Ae||(Ae={}));const _g={[Ae.Dots]:1,[Ae.Lines]:1,[Ae.Cross]:6},Eg=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Da({id:e,variant:t=Ae.Dots,gap:n=20,size:r,lineWidth:i=1,offset:s=0,color:o,bgColor:a,style:u,className:d,patternClassName:c}){const l=H.useRef(null),{transform:f,patternId:h}=ee(Eg,ne),p=r||_g[t],m=t===Ae.Dots,w=t===Ae.Cross,x=Array.isArray(n)?n:[n,n],v=[x[0]*f[2]||1,x[1]*f[2]||1],g=p*f[2],y=Array.isArray(s)?s:[s,s],N=w?[g,g]:v,S=[y[0]*f[2]||1+N[0]/2,y[1]*f[2]||1+N[1]/2],C=`${h}${e||""}`;return P.jsxs("svg",{className:se(["react-flow__background",d]),style:{...u,...un,"--xy-background-color-props":a,"--xy-background-pattern-color-props":o},ref:l,"data-testid":"rf__background",children:[P.jsx("pattern",{id:C,x:f[0]%v[0],y:f[1]%v[1],width:v[0],height:v[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${S[0]},-${S[1]})`,children:m?P.jsx(bg,{radius:g/2,className:c}):P.jsx(vg,{dimensions:N,lineWidth:i,variant:t,className:c})}),P.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${C})`})]})}Da.displayName="Background";const j0=H.memo(Da);function Ng(){return P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:P.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function kg(){return P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:P.jsx("path",{d:"M0 0h32v4.2H0z"})})}function Sg(){return P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:P.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function Cg(){return P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:P.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Mg(){return P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:P.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function $t({children:e,className:t,...n}){return P.jsx("button",{type:"button",className:se(["react-flow__controls-button",t]),...n,children:e})}const Ig=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function za({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:i,onZoomIn:s,onZoomOut:o,onFitView:a,onInteractiveChange:u,className:d,children:c,position:l="bottom-left",orientation:f="vertical","aria-label":h="React Flow controls"}){const p=te(),{isInteractive:m,minZoomReached:w,maxZoomReached:x}=ee(Ig,ne),{zoomIn:v,zoomOut:g,fitView:y}=Xr(),N=()=>{v(),s==null||s()},S=()=>{g(),o==null||o()},C=()=>{y(i),a==null||a()},_=()=>{p.setState({nodesDraggable:!m,nodesConnectable:!m,elementsSelectable:!m}),u==null||u(!m)},E=f==="horizontal"?"horizontal":"vertical";return P.jsxs(cn,{className:se(["react-flow__controls",E,d]),position:l,style:e,"data-testid":"rf__controls","aria-label":h,children:[t&&P.jsxs(P.Fragment,{children:[P.jsx($t,{onClick:N,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:x,children:P.jsx(Ng,{})}),P.jsx($t,{onClick:S,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:w,children:P.jsx(kg,{})})]}),n&&P.jsx($t,{className:"react-flow__controls-fitview",onClick:C,title:"fit view","aria-label":"fit view",children:P.jsx(Sg,{})}),r&&P.jsx($t,{className:"react-flow__controls-interactive",onClick:_,title:"toggle interactivity","aria-label":"toggle interactivity",children:m?P.jsx(Mg,{}):P.jsx(Cg,{})}),c]})}za.displayName="Controls";H.memo(za);function Ag({id:e,x:t,y:n,width:r,height:i,style:s,color:o,strokeColor:a,strokeWidth:u,className:d,borderRadius:c,shapeRendering:l,selected:f,onClick:h}){const{background:p,backgroundColor:m}=s||{},w=o||p||m;return P.jsx("rect",{className:se(["react-flow__minimap-node",{selected:f},d]),x:t,y:n,rx:c,ry:c,width:r,height:i,style:{fill:w,stroke:a,strokeWidth:u},shapeRendering:l,onClick:h?x=>h(x,e):void 0})}const Tg=H.memo(Ag),Rg=e=>e.nodes.map(t=>t.id),kn=e=>e instanceof Function?e:()=>e;function Pg({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:i,nodeComponent:s=Tg,onClick:o}){const a=ee(Rg,ne),u=kn(t),d=kn(e),c=kn(n),l=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return P.jsx(P.Fragment,{children:a.map(f=>P.jsx(Og,{id:f,nodeColorFunc:u,nodeStrokeColorFunc:d,nodeClassNameFunc:c,nodeBorderRadius:r,nodeStrokeWidth:i,NodeComponent:s,onClick:o,shapeRendering:l},f))})}function $g({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:i,nodeStrokeWidth:s,shapeRendering:o,NodeComponent:a,onClick:u}){const{node:d,x:c,y:l,width:f,height:h}=ee(p=>{const{internals:m}=p.nodeLookup.get(e),w=m.userNode,{x,y:v}=m.positionAbsolute,{width:g,height:y}=Ne(w);return{node:w,x,y:v,width:g,height:y}},ne);return!d||d.hidden||!Fs(d)?null:P.jsx(a,{x:c,y:l,width:f,height:h,style:d.style,selected:!!d.selected,className:r(d),color:t(d),borderRadius:i,strokeColor:n(d),strokeWidth:s,shapeRendering:o,onClick:u,id:d.id})}const Og=H.memo($g);var Lg=H.memo(Pg);const jg=200,Dg=150,zg=e=>!e.hidden,Hg=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?Bs(_t(e.nodeLookup,{filter:zg}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}},Vg="react-flow__minimap-desc";function Ha({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:i="",nodeBorderRadius:s=5,nodeStrokeWidth:o,nodeComponent:a,bgColor:u,maskColor:d,maskStrokeColor:c,maskStrokeWidth:l,position:f="bottom-right",onClick:h,onNodeClick:p,pannable:m=!1,zoomable:w=!1,ariaLabel:x="React Flow mini map",inversePan:v,zoomStep:g=10,offsetScale:y=5}){const N=te(),S=H.useRef(null),{boundingRect:C,viewBB:_,rfId:E,panZoom:k,translateExtent:M,flowWidth:I,flowHeight:D}=ee(Hg,ne),b=(e==null?void 0:e.width)??jg,R=(e==null?void 0:e.height)??Dg,A=C.width/b,$=C.height/R,z=Math.max(A,$),O=z*b,V=z*R,q=y*z,Y=C.x-(O-C.width)/2-q,T=C.y-(V-C.height)/2-q,L=O+q*2,j=V+q*2,B=`${Vg}-${E}`,F=H.useRef(0),G=H.useRef();F.current=z,H.useEffect(()=>{if(S.current&&k)return G.current=dh({domNode:S.current,panZoom:k,getTransform:()=>N.getState().transform,getViewScale:()=>F.current}),()=>{var K;(K=G.current)==null||K.destroy()}},[k]),H.useEffect(()=>{var K;(K=G.current)==null||K.update({translateExtent:M,width:I,height:D,inversePan:v,pannable:m,zoomStep:g,zoomable:w})},[m,w,v,g,M,I,D]);const X=h?K=>{var J;const[W,Q]=((J=G.current)==null?void 0:J.pointer(K))||[0,0];h(K,{x:W,y:Q})}:void 0,Z=p?H.useCallback((K,W)=>{const Q=N.getState().nodeLookup.get(W).internals.userNode;p(K,Q)},[]):void 0;return P.jsx(cn,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-background-color-props":typeof d=="string"?d:void 0,"--xy-minimap-mask-stroke-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-stroke-width-props":typeof l=="number"?l*z:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof o=="number"?o:void 0},className:se(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:P.jsxs("svg",{width:b,height:R,viewBox:`${Y} ${T} ${L} ${j}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":B,ref:S,onClick:X,children:[x&&P.jsx("title",{id:B,children:x}),P.jsx(Lg,{onClick:Z,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:i,nodeStrokeWidth:o,nodeComponent:a}),P.jsx("path",{className:"react-flow__minimap-mask",d:`M${Y-q},${T-q}h${L+q*2}v${j+q*2}h${-L-q*2}z
        M${_.x},${_.y}h${_.width}v${_.height}h${-_.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}Ha.displayName="MiniMap";H.memo(Ha);function Bg({nodeId:e,position:t,variant:n=ct.Handle,className:r,style:i={},children:s,color:o,minWidth:a=10,minHeight:u=10,maxWidth:d=Number.MAX_VALUE,maxHeight:c=Number.MAX_VALUE,keepAspectRatio:l=!1,shouldResize:f,onResizeStart:h,onResize:p,onResizeEnd:m}){const w=xa(),x=typeof e=="string"?e:w,v=te(),g=H.useRef(null),y=n===ct.Line?"right":"bottom-right",N=t??y,S=H.useRef(null);H.useEffect(()=>{if(!(!g.current||!x))return S.current||(S.current=Sh({domNode:g.current,nodeId:x,getStoreItems:()=>{const{nodeLookup:k,transform:M,snapGrid:I,snapToGrid:D,nodeOrigin:b,domNode:R}=v.getState();return{nodeLookup:k,transform:M,snapGrid:I,snapToGrid:D,nodeOrigin:b,paneDomNode:R}},onChange:(k,M)=>{const{triggerNodeChanges:I,nodeLookup:D,parentLookup:b,nodeOrigin:R}=v.getState(),A=[],$={x:k.x,y:k.y},z=D.get(x);if(z&&z.expandParent&&z.parentId){const O=z.origin??R,V=k.width??z.measured.width??0,q=k.height??z.measured.height??0,Y={id:z.id,parentId:z.parentId,rect:{width:V,height:q,...qs({x:k.x??z.position.x,y:k.y??z.position.y},{width:V,height:q},z.parentId,D,O)}},T=Gr([Y],D,b,R);A.push(...T),$.x=k.x?Math.max(O[0]*V,k.x):void 0,$.y=k.y?Math.max(O[1]*q,k.y):void 0}if($.x!==void 0&&$.y!==void 0){const O={id:x,type:"position",position:{...$}};A.push(O)}if(k.width!==void 0&&k.height!==void 0){const O={id:x,type:"dimensions",resizing:!0,setAttributes:!0,dimensions:{width:k.width,height:k.height}};A.push(O)}for(const O of M){const V={...O,type:"position"};A.push(V)}I(A)},onEnd:({width:k,height:M})=>{const I={id:x,type:"dimensions",resizing:!1,dimensions:{width:k,height:M}};v.getState().triggerNodeChanges([I])}})),S.current.update({controlPosition:N,boundaries:{minWidth:a,minHeight:u,maxWidth:d,maxHeight:c},keepAspectRatio:l,onResizeStart:h,onResize:p,onResizeEnd:m,shouldResize:f}),()=>{var k;(k=S.current)==null||k.destroy()}},[N,a,u,d,c,l,h,p,m,f]);const C=N.split("-"),_=n===ct.Line?"borderColor":"backgroundColor",E=o?{...i,[_]:o}:i;return P.jsx("div",{className:se(["react-flow__resize-control","nodrag",...C,n,r]),ref:g,style:E,children:s})}H.memo(Bg);const Pr=1.5,Qe=1,Ur=.5,Kr=1.5,so=({sx:e,...t})=>P.jsx(pe,{sx:{position:"absolute",inset:0,pointerEvents:"none",borderRadius:Kr*1.5,...e},...t}),ao=({sx:e,...t})=>P.jsx(pe,{sx:{position:"absolute",inset:0,pointerEvents:"none",bgcolor:"primary.main",...e},...t}),Fg=H.memo(({tableName:e,tableType:t,hueIndex:n})=>P.jsxs(pe,{sx:{position:"relative",borderRadius:Kr,borderBottomLeftRadius:0,borderBottomRightRadius:0,overflow:"hidden",p:Pr,py:Qe},children:[P.jsx(ao,{sx:{filter:`hue-rotate(${n*20}deg)`,opacity:.35}}),P.jsxs(pe,{sx:{display:"flex",alignItems:"flex-end",gap:Qe,position:"relative"},children:[P.jsx(Jc,{sx:{color:"text.primary",fontSize:"1.2rem"}}),P.jsx(Ie,{variant:"body1",component:"h6",sx:{lineHeight:1,...Be},children:e}),P.jsx(pe,{sx:{flexGrow:1}}),P.jsx(Ie,{variant:"caption",sx:{lineHeight:1,alignSelf:"center",p:Ur,bgcolor:"background.paper",borderRadius:1,textTransform:"uppercase"},children:t})]}),P.jsx(ao,{sx:{filter:`hue-rotate(${n*20}deg)`,opacity:.35}})]})),qg=H.memo(()=>P.jsxs(pe,{sx:{position:"relative",display:"flex",alignItems:"center",justifyContent:"space-between",gap:Qe,p:Qe,my:Ur},children:[P.jsx(Ie,{variant:"body2",sx:{...Be,opacity:.85},children:"名稱"}),P.jsxs(pe,{sx:{display:"flex",alignItems:"center"},children:[P.jsx(Ie,{variant:"body2",sx:{opacity:.85,width:"5rem",textAlign:"end",...Be},children:"型別"}),P.jsx(Ie,{variant:"body2",sx:{opacity:.85,width:"3rem",textAlign:"end",...Be},children:"空值"})]}),P.jsx(pe,{sx:{position:"absolute",inset:0,pointerEvents:"none",borderRadius:1,bgcolor:"divider",opacity:.5}})]})),co={color:"text.secondary",opacity:.85,textAlign:"end",...Be},Yg=H.memo(({fieldName:e,fieldType:t,nullable:n})=>P.jsxs(P.Fragment,{children:[P.jsx(Ie,{variant:"body2",sx:{...Be,opacity:.85},children:e}),P.jsxs(pe,{sx:{display:"flex",alignItems:"center"},children:[P.jsx(Ie,{variant:"caption",sx:{textTransform:"uppercase",width:"5rem",...co},children:t}),P.jsx(Ie,{variant:"caption",sx:{width:"3rem",...co},children:{yes:"可",no:"否",pk:"主鍵"}[n]})]})]})),D0=({selected:e,data:t})=>P.jsxs(pe,{sx:{cursor:"move",width:300,p:Ur,borderRadius:Kr*1.5,bgcolor:"background.paper"},children:[P.jsx(so,{sx:{boxShadow:2,opacity:.35}}),P.jsx(so,{sx:{outline:e?2:1,outlineColor:e?"primary.main":"divider",filter:`hue-rotate(${t.hueIndex*20}deg)`,opacity:.85}}),P.jsx(Fg,{tableName:t.tableName,tableType:t.tableType,hueIndex:t.hueIndex}),P.jsx(qg,{}),P.jsx(Qc,{sx:{gap:Pr,alignItems:"stretch",p:Pr,pt:Qe},children:t.fields.map(({fieldName:n,fieldType:r,nullable:i,isSource:s,isTarget:o},a)=>P.jsxs(pe,{sx:{position:"relative",display:"flex",alignItems:"center",justifyContent:"space-between",gap:Qe},children:[P.jsx(Yg,{fieldName:n,fieldType:r,nullable:i}),o&&P.jsx(Oe,{id:n,type:"target",position:U.Left,style:{marginLeft:`calc(var(--mui-spacing) * ${-1.5})`,opacity:0,pointerEvents:"none"}}),o&&P.jsx(Oe,{id:n+"_self",type:"target",position:U.Right,style:{marginRight:`calc(var(--mui-spacing) * ${-1.5})`,opacity:0,pointerEvents:"none"}}),s&&P.jsx(Oe,{id:n,type:"source",position:U.Right,style:{marginRight:"calc(var(--mui-spacing) * -2)",width:`calc(var(--mui-spacing) * ${1.5})`,height:"auto",aspectRatio:"1/1",background:"var(--mui-palette-background-paper)",border:"1px solid var(--mui-palette-divider)",boxShadow:"var(--mui-shadows-1)",pointerEvents:"none"}})]},a))})]});var Sn,uo;function Qr(){if(uo)return Sn;uo=1;var e="\0",t="\0",n="";class r{constructor(c){ie(this,"_isDirected",!0);ie(this,"_isMultigraph",!1);ie(this,"_isCompound",!1);ie(this,"_label");ie(this,"_defaultNodeLabelFn",()=>{});ie(this,"_defaultEdgeLabelFn",()=>{});ie(this,"_nodes",{});ie(this,"_in",{});ie(this,"_preds",{});ie(this,"_out",{});ie(this,"_sucs",{});ie(this,"_edgeObjs",{});ie(this,"_edgeLabels",{});ie(this,"_nodeCount",0);ie(this,"_edgeCount",0);ie(this,"_parent");ie(this,"_children");c&&(this._isDirected=Object.hasOwn(c,"directed")?c.directed:!0,this._isMultigraph=Object.hasOwn(c,"multigraph")?c.multigraph:!1,this._isCompound=Object.hasOwn(c,"compound")?c.compound:!1),this._isCompound&&(this._parent={},this._children={},this._children[t]={})}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(c){return this._label=c,this}graph(){return this._label}setDefaultNodeLabel(c){return this._defaultNodeLabelFn=c,typeof c!="function"&&(this._defaultNodeLabelFn=()=>c),this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var c=this;return this.nodes().filter(l=>Object.keys(c._in[l]).length===0)}sinks(){var c=this;return this.nodes().filter(l=>Object.keys(c._out[l]).length===0)}setNodes(c,l){var f=arguments,h=this;return c.forEach(function(p){f.length>1?h.setNode(p,l):h.setNode(p)}),this}setNode(c,l){return Object.hasOwn(this._nodes,c)?(arguments.length>1&&(this._nodes[c]=l),this):(this._nodes[c]=arguments.length>1?l:this._defaultNodeLabelFn(c),this._isCompound&&(this._parent[c]=t,this._children[c]={},this._children[t][c]=!0),this._in[c]={},this._preds[c]={},this._out[c]={},this._sucs[c]={},++this._nodeCount,this)}node(c){return this._nodes[c]}hasNode(c){return Object.hasOwn(this._nodes,c)}removeNode(c){var l=this;if(Object.hasOwn(this._nodes,c)){var f=h=>l.removeEdge(l._edgeObjs[h]);delete this._nodes[c],this._isCompound&&(this._removeFromParentsChildList(c),delete this._parent[c],this.children(c).forEach(function(h){l.setParent(h)}),delete this._children[c]),Object.keys(this._in[c]).forEach(f),delete this._in[c],delete this._preds[c],Object.keys(this._out[c]).forEach(f),delete this._out[c],delete this._sucs[c],--this._nodeCount}return this}setParent(c,l){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(l===void 0)l=t;else{l+="";for(var f=l;f!==void 0;f=this.parent(f))if(f===c)throw new Error("Setting "+l+" as parent of "+c+" would create a cycle");this.setNode(l)}return this.setNode(c),this._removeFromParentsChildList(c),this._parent[c]=l,this._children[l][c]=!0,this}_removeFromParentsChildList(c){delete this._children[this._parent[c]][c]}parent(c){if(this._isCompound){var l=this._parent[c];if(l!==t)return l}}children(c=t){if(this._isCompound){var l=this._children[c];if(l)return Object.keys(l)}else{if(c===t)return this.nodes();if(this.hasNode(c))return[]}}predecessors(c){var l=this._preds[c];if(l)return Object.keys(l)}successors(c){var l=this._sucs[c];if(l)return Object.keys(l)}neighbors(c){var l=this.predecessors(c);if(l){const h=new Set(l);for(var f of this.successors(c))h.add(f);return Array.from(h.values())}}isLeaf(c){var l;return this.isDirected()?l=this.successors(c):l=this.neighbors(c),l.length===0}filterNodes(c){var l=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});l.setGraph(this.graph());var f=this;Object.entries(this._nodes).forEach(function([m,w]){c(m)&&l.setNode(m,w)}),Object.values(this._edgeObjs).forEach(function(m){l.hasNode(m.v)&&l.hasNode(m.w)&&l.setEdge(m,f.edge(m))});var h={};function p(m){var w=f.parent(m);return w===void 0||l.hasNode(w)?(h[m]=w,w):w in h?h[w]:p(w)}return this._isCompound&&l.nodes().forEach(m=>l.setParent(m,p(m))),l}setDefaultEdgeLabel(c){return this._defaultEdgeLabelFn=c,typeof c!="function"&&(this._defaultEdgeLabelFn=()=>c),this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(c,l){var f=this,h=arguments;return c.reduce(function(p,m){return h.length>1?f.setEdge(p,m,l):f.setEdge(p,m),m}),this}setEdge(){var c,l,f,h,p=!1,m=arguments[0];typeof m=="object"&&m!==null&&"v"in m?(c=m.v,l=m.w,f=m.name,arguments.length===2&&(h=arguments[1],p=!0)):(c=m,l=arguments[1],f=arguments[3],arguments.length>2&&(h=arguments[2],p=!0)),c=""+c,l=""+l,f!==void 0&&(f=""+f);var w=o(this._isDirected,c,l,f);if(Object.hasOwn(this._edgeLabels,w))return p&&(this._edgeLabels[w]=h),this;if(f!==void 0&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(c),this.setNode(l),this._edgeLabels[w]=p?h:this._defaultEdgeLabelFn(c,l,f);var x=a(this._isDirected,c,l,f);return c=x.v,l=x.w,Object.freeze(x),this._edgeObjs[w]=x,i(this._preds[l],c),i(this._sucs[c],l),this._in[l][w]=x,this._out[c][w]=x,this._edgeCount++,this}edge(c,l,f){var h=arguments.length===1?u(this._isDirected,arguments[0]):o(this._isDirected,c,l,f);return this._edgeLabels[h]}edgeAsObj(){const c=this.edge(...arguments);return typeof c!="object"?{label:c}:c}hasEdge(c,l,f){var h=arguments.length===1?u(this._isDirected,arguments[0]):o(this._isDirected,c,l,f);return Object.hasOwn(this._edgeLabels,h)}removeEdge(c,l,f){var h=arguments.length===1?u(this._isDirected,arguments[0]):o(this._isDirected,c,l,f),p=this._edgeObjs[h];return p&&(c=p.v,l=p.w,delete this._edgeLabels[h],delete this._edgeObjs[h],s(this._preds[l],c),s(this._sucs[c],l),delete this._in[l][h],delete this._out[c][h],this._edgeCount--),this}inEdges(c,l){var f=this._in[c];if(f){var h=Object.values(f);return l?h.filter(p=>p.v===l):h}}outEdges(c,l){var f=this._out[c];if(f){var h=Object.values(f);return l?h.filter(p=>p.w===l):h}}nodeEdges(c,l){var f=this.inEdges(c,l);if(f)return f.concat(this.outEdges(c,l))}}function i(d,c){d[c]?d[c]++:d[c]=1}function s(d,c){--d[c]||delete d[c]}function o(d,c,l,f){var h=""+c,p=""+l;if(!d&&h>p){var m=h;h=p,p=m}return h+n+p+n+(f===void 0?e:f)}function a(d,c,l,f){var h=""+c,p=""+l;if(!d&&h>p){var m=h;h=p,p=m}var w={v:h,w:p};return f&&(w.name=f),w}function u(d,c){return o(d,c.v,c.w,c.name)}return Sn=r,Sn}var Cn,lo;function Gg(){return lo||(lo=1,Cn="2.2.4"),Cn}var Mn,fo;function Xg(){return fo||(fo=1,Mn={Graph:Qr(),version:Gg()}),Mn}var In,ho;function Wg(){if(ho)return In;ho=1;var e=Qr();In={write:t,read:i};function t(s){var o={options:{directed:s.isDirected(),multigraph:s.isMultigraph(),compound:s.isCompound()},nodes:n(s),edges:r(s)};return s.graph()!==void 0&&(o.value=structuredClone(s.graph())),o}function n(s){return s.nodes().map(function(o){var a=s.node(o),u=s.parent(o),d={v:o};return a!==void 0&&(d.value=a),u!==void 0&&(d.parent=u),d})}function r(s){return s.edges().map(function(o){var a=s.edge(o),u={v:o.v,w:o.w};return o.name!==void 0&&(u.name=o.name),a!==void 0&&(u.value=a),u})}function i(s){var o=new e(s.options).setGraph(s.value);return s.nodes.forEach(function(a){o.setNode(a.v,a.value),a.parent&&o.setParent(a.v,a.parent)}),s.edges.forEach(function(a){o.setEdge({v:a.v,w:a.w,name:a.name},a.value)}),o}return In}var An,po;function Ug(){if(po)return An;po=1,An=e;function e(t){var n={},r=[],i;function s(o){Object.hasOwn(n,o)||(n[o]=!0,i.push(o),t.successors(o).forEach(s),t.predecessors(o).forEach(s))}return t.nodes().forEach(function(o){i=[],s(o),i.length&&r.push(i)}),r}return An}var Tn,go;function Va(){if(go)return Tn;go=1;class e{constructor(){ie(this,"_arr",[]);ie(this,"_keyIndices",{})}size(){return this._arr.length}keys(){return this._arr.map(function(n){return n.key})}has(n){return Object.hasOwn(this._keyIndices,n)}priority(n){var r=this._keyIndices[n];if(r!==void 0)return this._arr[r].priority}min(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key}add(n,r){var i=this._keyIndices;if(n=String(n),!Object.hasOwn(i,n)){var s=this._arr,o=s.length;return i[n]=o,s.push({key:n,priority:r}),this._decrease(o),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var n=this._arr.pop();return delete this._keyIndices[n.key],this._heapify(0),n.key}decrease(n,r){var i=this._keyIndices[n];if(r>this._arr[i].priority)throw new Error("New priority is greater than current priority. Key: "+n+" Old: "+this._arr[i].priority+" New: "+r);this._arr[i].priority=r,this._decrease(i)}_heapify(n){var r=this._arr,i=2*n,s=i+1,o=n;i<r.length&&(o=r[i].priority<r[o].priority?i:o,s<r.length&&(o=r[s].priority<r[o].priority?s:o),o!==n&&(this._swap(n,o),this._heapify(o)))}_decrease(n){for(var r=this._arr,i=r[n].priority,s;n!==0&&(s=n>>1,!(r[s].priority<i));)this._swap(n,s),n=s}_swap(n,r){var i=this._arr,s=this._keyIndices,o=i[n],a=i[r];i[n]=a,i[r]=o,s[a.key]=n,s[o.key]=r}}return Tn=e,Tn}var Rn,mo;function Ba(){if(mo)return Rn;mo=1;var e=Va();Rn=n;var t=()=>1;function n(i,s,o,a){return r(i,String(s),o||t,a||function(u){return i.outEdges(u)})}function r(i,s,o,a){var u={},d=new e,c,l,f=function(h){var p=h.v!==c?h.v:h.w,m=u[p],w=o(h),x=l.distance+w;if(w<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+h+" Weight: "+w);x<m.distance&&(m.distance=x,m.predecessor=c,d.decrease(p,x))};for(i.nodes().forEach(function(h){var p=h===s?0:Number.POSITIVE_INFINITY;u[h]={distance:p},d.add(h,p)});d.size()>0&&(c=d.removeMin(),l=u[c],l.distance!==Number.POSITIVE_INFINITY);)a(c).forEach(f);return u}return Rn}var Pn,yo;function Kg(){if(yo)return Pn;yo=1;var e=Ba();Pn=t;function t(n,r,i){return n.nodes().reduce(function(s,o){return s[o]=e(n,o,r,i),s},{})}return Pn}var $n,xo;function Fa(){if(xo)return $n;xo=1,$n=e;function e(t){var n=0,r=[],i={},s=[];function o(a){var u=i[a]={onStack:!0,lowlink:n,index:n++};if(r.push(a),t.successors(a).forEach(function(l){Object.hasOwn(i,l)?i[l].onStack&&(u.lowlink=Math.min(u.lowlink,i[l].index)):(o(l),u.lowlink=Math.min(u.lowlink,i[l].lowlink))}),u.lowlink===u.index){var d=[],c;do c=r.pop(),i[c].onStack=!1,d.push(c);while(a!==c);s.push(d)}}return t.nodes().forEach(function(a){Object.hasOwn(i,a)||o(a)}),s}return $n}var On,wo;function Qg(){if(wo)return On;wo=1;var e=Fa();On=t;function t(n){return e(n).filter(function(r){return r.length>1||r.length===1&&n.hasEdge(r[0],r[0])})}return On}var Ln,vo;function Zg(){if(vo)return Ln;vo=1,Ln=t;var e=()=>1;function t(r,i,s){return n(r,i||e,s||function(o){return r.outEdges(o)})}function n(r,i,s){var o={},a=r.nodes();return a.forEach(function(u){o[u]={},o[u][u]={distance:0},a.forEach(function(d){u!==d&&(o[u][d]={distance:Number.POSITIVE_INFINITY})}),s(u).forEach(function(d){var c=d.v===u?d.w:d.v,l=i(d);o[u][c]={distance:l,predecessor:u}})}),a.forEach(function(u){var d=o[u];a.forEach(function(c){var l=o[c];a.forEach(function(f){var h=l[u],p=d[f],m=l[f],w=h.distance+p.distance;w<m.distance&&(m.distance=w,m.predecessor=p.predecessor)})})}),o}return Ln}var jn,bo;function qa(){if(bo)return jn;bo=1;function e(n){var r={},i={},s=[];function o(a){if(Object.hasOwn(i,a))throw new t;Object.hasOwn(r,a)||(i[a]=!0,r[a]=!0,n.predecessors(a).forEach(o),delete i[a],s.push(a))}if(n.sinks().forEach(o),Object.keys(r).length!==n.nodeCount())throw new t;return s}class t extends Error{constructor(){super(...arguments)}}return jn=e,e.CycleException=t,jn}var Dn,_o;function Jg(){if(_o)return Dn;_o=1;var e=qa();Dn=t;function t(n){try{e(n)}catch(r){if(r instanceof e.CycleException)return!1;throw r}return!0}return Dn}var zn,Eo;function Ya(){if(Eo)return zn;Eo=1,zn=e;function e(i,s,o){Array.isArray(s)||(s=[s]);var a=i.isDirected()?l=>i.successors(l):l=>i.neighbors(l),u=o==="post"?t:n,d=[],c={};return s.forEach(l=>{if(!i.hasNode(l))throw new Error("Graph does not have node: "+l);u(l,a,c,d)}),d}function t(i,s,o,a){for(var u=[[i,!1]];u.length>0;){var d=u.pop();d[1]?a.push(d[0]):Object.hasOwn(o,d[0])||(o[d[0]]=!0,u.push([d[0],!0]),r(s(d[0]),c=>u.push([c,!1])))}}function n(i,s,o,a){for(var u=[i];u.length>0;){var d=u.pop();Object.hasOwn(o,d)||(o[d]=!0,a.push(d),r(s(d),c=>u.push(c)))}}function r(i,s){for(var o=i.length;o--;)s(i[o],o,i);return i}return zn}var Hn,No;function e0(){if(No)return Hn;No=1;var e=Ya();Hn=t;function t(n,r){return e(n,r,"post")}return Hn}var Vn,ko;function t0(){if(ko)return Vn;ko=1;var e=Ya();Vn=t;function t(n,r){return e(n,r,"pre")}return Vn}var Bn,So;function n0(){if(So)return Bn;So=1;var e=Qr(),t=Va();Bn=n;function n(r,i){var s=new e,o={},a=new t,u;function d(l){var f=l.v===u?l.w:l.v,h=a.priority(f);if(h!==void 0){var p=i(l);p<h&&(o[f]=u,a.decrease(f,p))}}if(r.nodeCount()===0)return s;r.nodes().forEach(function(l){a.add(l,Number.POSITIVE_INFINITY),s.setNode(l)}),a.decrease(r.nodes()[0],0);for(var c=!1;a.size()>0;){if(u=a.removeMin(),Object.hasOwn(o,u))s.setEdge(u,o[u]);else{if(c)throw new Error("Input graph is not connected: "+r);c=!0}r.nodeEdges(u).forEach(d)}return s}return Bn}var Fn,Co;function r0(){return Co||(Co=1,Fn={components:Ug(),dijkstra:Ba(),dijkstraAll:Kg(),findCycles:Qg(),floydWarshall:Zg(),isAcyclic:Jg(),postorder:e0(),preorder:t0(),prim:n0(),tarjan:Fa(),topsort:qa()}),Fn}var qn,Mo;function ge(){if(Mo)return qn;Mo=1;var e=Xg();return qn={Graph:e.Graph,json:Wg(),alg:r0(),version:e.version},qn}var Yn,Io;function i0(){if(Io)return Yn;Io=1;class e{constructor(){let i={};i._next=i._prev=i,this._sentinel=i}dequeue(){let i=this._sentinel,s=i._prev;if(s!==i)return t(s),s}enqueue(i){let s=this._sentinel;i._prev&&i._next&&t(i),i._next=s._next,s._next._prev=i,s._next=i,i._prev=s}toString(){let i=[],s=this._sentinel,o=s._prev;for(;o!==s;)i.push(JSON.stringify(o,n)),o=o._prev;return"["+i.join(", ")+"]"}}function t(r){r._prev._next=r._next,r._next._prev=r._prev,delete r._next,delete r._prev}function n(r,i){if(r!=="_next"&&r!=="_prev")return i}return Yn=e,Yn}var Gn,Ao;function o0(){if(Ao)return Gn;Ao=1;let e=ge().Graph,t=i0();Gn=r;let n=()=>1;function r(d,c){if(d.nodeCount()<=1)return[];let l=o(d,c||n);return i(l.graph,l.buckets,l.zeroIdx).flatMap(h=>d.outEdges(h.v,h.w))}function i(d,c,l){let f=[],h=c[c.length-1],p=c[0],m;for(;d.nodeCount();){for(;m=p.dequeue();)s(d,c,l,m);for(;m=h.dequeue();)s(d,c,l,m);if(d.nodeCount()){for(let w=c.length-2;w>0;--w)if(m=c[w].dequeue(),m){f=f.concat(s(d,c,l,m,!0));break}}}return f}function s(d,c,l,f,h){let p=h?[]:void 0;return d.inEdges(f.v).forEach(m=>{let w=d.edge(m),x=d.node(m.v);h&&p.push({v:m.v,w:m.w}),x.out-=w,a(c,l,x)}),d.outEdges(f.v).forEach(m=>{let w=d.edge(m),x=m.w,v=d.node(x);v.in-=w,a(c,l,v)}),d.removeNode(f.v),p}function o(d,c){let l=new e,f=0,h=0;d.nodes().forEach(w=>{l.setNode(w,{v:w,in:0,out:0})}),d.edges().forEach(w=>{let x=l.edge(w.v,w.w)||0,v=c(w),g=x+v;l.setEdge(w.v,w.w,g),h=Math.max(h,l.node(w.v).out+=v),f=Math.max(f,l.node(w.w).in+=v)});let p=u(h+f+3).map(()=>new t),m=f+1;return l.nodes().forEach(w=>{a(p,m,l.node(w))}),{graph:l,buckets:p,zeroIdx:m}}function a(d,c,l){l.out?l.in?d[l.out-l.in+c].enqueue(l):d[d.length-1].enqueue(l):d[0].enqueue(l)}function u(d){const c=[];for(let l=0;l<d;l++)c.push(l);return c}return Gn}var Xn,To;function oe(){if(To)return Xn;To=1;let e=ge().Graph;Xn={addBorderNode:c,addDummyNode:t,applyWithChunking:h,asNonCompoundGraph:r,buildLayerMatrix:a,intersectRect:o,mapValues:S,maxRank:p,normalizeRanks:u,notime:x,partition:m,pick:N,predecessorWeights:s,range:y,removeEmptyRanks:d,simplify:n,successorWeights:i,time:w,uniqueId:g,zipObject:C};function t(_,E,k,M){let I;do I=g(M);while(_.hasNode(I));return k.dummy=E,_.setNode(I,k),I}function n(_){let E=new e().setGraph(_.graph());return _.nodes().forEach(k=>E.setNode(k,_.node(k))),_.edges().forEach(k=>{let M=E.edge(k.v,k.w)||{weight:0,minlen:1},I=_.edge(k);E.setEdge(k.v,k.w,{weight:M.weight+I.weight,minlen:Math.max(M.minlen,I.minlen)})}),E}function r(_){let E=new e({multigraph:_.isMultigraph()}).setGraph(_.graph());return _.nodes().forEach(k=>{_.children(k).length||E.setNode(k,_.node(k))}),_.edges().forEach(k=>{E.setEdge(k,_.edge(k))}),E}function i(_){let E=_.nodes().map(k=>{let M={};return _.outEdges(k).forEach(I=>{M[I.w]=(M[I.w]||0)+_.edge(I).weight}),M});return C(_.nodes(),E)}function s(_){let E=_.nodes().map(k=>{let M={};return _.inEdges(k).forEach(I=>{M[I.v]=(M[I.v]||0)+_.edge(I).weight}),M});return C(_.nodes(),E)}function o(_,E){let k=_.x,M=_.y,I=E.x-k,D=E.y-M,b=_.width/2,R=_.height/2;if(!I&&!D)throw new Error("Not possible to find intersection inside of the rectangle");let A,$;return Math.abs(D)*b>Math.abs(I)*R?(D<0&&(R=-R),A=R*I/D,$=R):(I<0&&(b=-b),A=b,$=b*D/I),{x:k+A,y:M+$}}function a(_){let E=y(p(_)+1).map(()=>[]);return _.nodes().forEach(k=>{let M=_.node(k),I=M.rank;I!==void 0&&(E[I][M.order]=k)}),E}function u(_){let E=_.nodes().map(M=>{let I=_.node(M).rank;return I===void 0?Number.MAX_VALUE:I}),k=h(Math.min,E);_.nodes().forEach(M=>{let I=_.node(M);Object.hasOwn(I,"rank")&&(I.rank-=k)})}function d(_){let E=_.nodes().map(b=>_.node(b).rank),k=h(Math.min,E),M=[];_.nodes().forEach(b=>{let R=_.node(b).rank-k;M[R]||(M[R]=[]),M[R].push(b)});let I=0,D=_.graph().nodeRankFactor;Array.from(M).forEach((b,R)=>{b===void 0&&R%D!==0?--I:b!==void 0&&I&&b.forEach(A=>_.node(A).rank+=I)})}function c(_,E,k,M){let I={width:0,height:0};return arguments.length>=4&&(I.rank=k,I.order=M),t(_,"border",I,E)}function l(_,E=f){const k=[];for(let M=0;M<_.length;M+=E){const I=_.slice(M,M+E);k.push(I)}return k}const f=65535;function h(_,E){if(E.length>f){const k=l(E);return _.apply(null,k.map(M=>_.apply(null,M)))}else return _.apply(null,E)}function p(_){const k=_.nodes().map(M=>{let I=_.node(M).rank;return I===void 0?Number.MIN_VALUE:I});return h(Math.max,k)}function m(_,E){let k={lhs:[],rhs:[]};return _.forEach(M=>{E(M)?k.lhs.push(M):k.rhs.push(M)}),k}function w(_,E){let k=Date.now();try{return E()}finally{console.log(_+" time: "+(Date.now()-k)+"ms")}}function x(_,E){return E()}let v=0;function g(_){var E=++v;return toString(_)+E}function y(_,E,k=1){E==null&&(E=_,_=0);let M=D=>D<E;k<0&&(M=D=>E<D);const I=[];for(let D=_;M(D);D+=k)I.push(D);return I}function N(_,E){const k={};for(const M of E)_[M]!==void 0&&(k[M]=_[M]);return k}function S(_,E){let k=E;return typeof E=="string"&&(k=M=>M[E]),Object.entries(_).reduce((M,[I,D])=>(M[I]=k(D,I),M),{})}function C(_,E){return _.reduce((k,M,I)=>(k[M]=E[I],k),{})}return Xn}var Wn,Ro;function s0(){if(Ro)return Wn;Ro=1;let e=o0(),t=oe().uniqueId;Wn={run:n,undo:i};function n(s){(s.graph().acyclicer==="greedy"?e(s,a(s)):r(s)).forEach(u=>{let d=s.edge(u);s.removeEdge(u),d.forwardName=u.name,d.reversed=!0,s.setEdge(u.w,u.v,d,t("rev"))});function a(u){return d=>u.edge(d).weight}}function r(s){let o=[],a={},u={};function d(c){Object.hasOwn(u,c)||(u[c]=!0,a[c]=!0,s.outEdges(c).forEach(l=>{Object.hasOwn(a,l.w)?o.push(l):d(l.w)}),delete a[c])}return s.nodes().forEach(d),o}function i(s){s.edges().forEach(o=>{let a=s.edge(o);if(a.reversed){s.removeEdge(o);let u=a.forwardName;delete a.reversed,delete a.forwardName,s.setEdge(o.w,o.v,a,u)}})}return Wn}var Un,Po;function a0(){if(Po)return Un;Po=1;let e=oe();Un={run:t,undo:r};function t(i){i.graph().dummyChains=[],i.edges().forEach(s=>n(i,s))}function n(i,s){let o=s.v,a=i.node(o).rank,u=s.w,d=i.node(u).rank,c=s.name,l=i.edge(s),f=l.labelRank;if(d===a+1)return;i.removeEdge(s);let h,p,m;for(m=0,++a;a<d;++m,++a)l.points=[],p={width:0,height:0,edgeLabel:l,edgeObj:s,rank:a},h=e.addDummyNode(i,"edge",p,"_d"),a===f&&(p.width=l.width,p.height=l.height,p.dummy="edge-label",p.labelpos=l.labelpos),i.setEdge(o,h,{weight:l.weight},c),m===0&&i.graph().dummyChains.push(h),o=h;i.setEdge(o,u,{weight:l.weight},c)}function r(i){i.graph().dummyChains.forEach(s=>{let o=i.node(s),a=o.edgeLabel,u;for(i.setEdge(o.edgeObj,a);o.dummy;)u=i.successors(s)[0],i.removeNode(s),a.points.push({x:o.x,y:o.y}),o.dummy==="edge-label"&&(a.x=o.x,a.y=o.y,a.width=o.width,a.height=o.height),s=u,o=i.node(s)})}return Un}var Kn,$o;function Kt(){if($o)return Kn;$o=1;const{applyWithChunking:e}=oe();Kn={longestPath:t,slack:n};function t(r){var i={};function s(o){var a=r.node(o);if(Object.hasOwn(i,o))return a.rank;i[o]=!0;let u=r.outEdges(o).map(c=>c==null?Number.POSITIVE_INFINITY:s(c.w)-r.edge(c).minlen);var d=e(Math.min,u);return d===Number.POSITIVE_INFINITY&&(d=0),a.rank=d}r.sources().forEach(s)}function n(r,i){return r.node(i.w).rank-r.node(i.v).rank-r.edge(i).minlen}return Kn}var Qn,Oo;function Ga(){if(Oo)return Qn;Oo=1;var e=ge().Graph,t=Kt().slack;Qn=n;function n(o){var a=new e({directed:!1}),u=o.nodes()[0],d=o.nodeCount();a.setNode(u,{});for(var c,l;r(a,o)<d;)c=i(a,o),l=a.hasNode(c.v)?t(o,c):-t(o,c),s(a,o,l);return a}function r(o,a){function u(d){a.nodeEdges(d).forEach(c=>{var l=c.v,f=d===l?c.w:l;!o.hasNode(f)&&!t(a,c)&&(o.setNode(f,{}),o.setEdge(d,f,{}),u(f))})}return o.nodes().forEach(u),o.nodeCount()}function i(o,a){return a.edges().reduce((d,c)=>{let l=Number.POSITIVE_INFINITY;return o.hasNode(c.v)!==o.hasNode(c.w)&&(l=t(a,c)),l<d[0]?[l,c]:d},[Number.POSITIVE_INFINITY,null])[1]}function s(o,a,u){o.nodes().forEach(d=>a.node(d).rank+=u)}return Qn}var Zn,Lo;function c0(){if(Lo)return Zn;Lo=1;var e=Ga(),t=Kt().slack,n=Kt().longestPath,r=ge().alg.preorder,i=ge().alg.postorder,s=oe().simplify;Zn=o,o.initLowLimValues=c,o.initCutValues=a,o.calcCutValue=d,o.leaveEdge=f,o.enterEdge=h,o.exchangeEdges=p;function o(v){v=s(v),n(v);var g=e(v);c(g),a(g,v);for(var y,N;y=f(g);)N=h(g,v,y),p(g,v,y,N)}function a(v,g){var y=i(v,v.nodes());y=y.slice(0,y.length-1),y.forEach(N=>u(v,g,N))}function u(v,g,y){var N=v.node(y),S=N.parent;v.edge(y,S).cutvalue=d(v,g,y)}function d(v,g,y){var N=v.node(y),S=N.parent,C=!0,_=g.edge(y,S),E=0;return _||(C=!1,_=g.edge(S,y)),E=_.weight,g.nodeEdges(y).forEach(k=>{var M=k.v===y,I=M?k.w:k.v;if(I!==S){var D=M===C,b=g.edge(k).weight;if(E+=D?b:-b,w(v,y,I)){var R=v.edge(y,I).cutvalue;E+=D?-R:R}}}),E}function c(v,g){arguments.length<2&&(g=v.nodes()[0]),l(v,{},1,g)}function l(v,g,y,N,S){var C=y,_=v.node(N);return g[N]=!0,v.neighbors(N).forEach(E=>{Object.hasOwn(g,E)||(y=l(v,g,y,E,N))}),_.low=C,_.lim=y++,S?_.parent=S:delete _.parent,y}function f(v){return v.edges().find(g=>v.edge(g).cutvalue<0)}function h(v,g,y){var N=y.v,S=y.w;g.hasEdge(N,S)||(N=y.w,S=y.v);var C=v.node(N),_=v.node(S),E=C,k=!1;C.lim>_.lim&&(E=_,k=!0);var M=g.edges().filter(I=>k===x(v,v.node(I.v),E)&&k!==x(v,v.node(I.w),E));return M.reduce((I,D)=>t(g,D)<t(g,I)?D:I)}function p(v,g,y,N){var S=y.v,C=y.w;v.removeEdge(S,C),v.setEdge(N.v,N.w,{}),c(v),a(v,g),m(v,g)}function m(v,g){var y=v.nodes().find(S=>!g.node(S).parent),N=r(v,y);N=N.slice(1),N.forEach(S=>{var C=v.node(S).parent,_=g.edge(S,C),E=!1;_||(_=g.edge(C,S),E=!0),g.node(S).rank=g.node(C).rank+(E?_.minlen:-_.minlen)})}function w(v,g,y){return v.hasEdge(g,y)}function x(v,g,y){return y.low<=g.lim&&g.lim<=y.lim}return Zn}var Jn,jo;function u0(){if(jo)return Jn;jo=1;var e=Kt(),t=e.longestPath,n=Ga(),r=c0();Jn=i;function i(u){switch(u.graph().ranker){case"network-simplex":a(u);break;case"tight-tree":o(u);break;case"longest-path":s(u);break;default:a(u)}}var s=t;function o(u){t(u),n(u)}function a(u){r(u)}return Jn}var er,Do;function l0(){if(Do)return er;Do=1,er=e;function e(r){let i=n(r);r.graph().dummyChains.forEach(s=>{let o=r.node(s),a=o.edgeObj,u=t(r,i,a.v,a.w),d=u.path,c=u.lca,l=0,f=d[l],h=!0;for(;s!==a.w;){if(o=r.node(s),h){for(;(f=d[l])!==c&&r.node(f).maxRank<o.rank;)l++;f===c&&(h=!1)}if(!h){for(;l<d.length-1&&r.node(f=d[l+1]).minRank<=o.rank;)l++;f=d[l]}r.setParent(s,f),s=r.successors(s)[0]}})}function t(r,i,s,o){let a=[],u=[],d=Math.min(i[s].low,i[o].low),c=Math.max(i[s].lim,i[o].lim),l,f;l=s;do l=r.parent(l),a.push(l);while(l&&(i[l].low>d||c>i[l].lim));for(f=l,l=o;(l=r.parent(l))!==f;)u.push(l);return{path:a.concat(u.reverse()),lca:f}}function n(r){let i={},s=0;function o(a){let u=s;r.children(a).forEach(o),i[a]={low:u,lim:s++}}return r.children().forEach(o),i}return er}var tr,zo;function d0(){if(zo)return tr;zo=1;let e=oe();tr={run:t,cleanup:s};function t(o){let a=e.addDummyNode(o,"root",{},"_root"),u=r(o),d=Object.values(u),c=e.applyWithChunking(Math.max,d)-1,l=2*c+1;o.graph().nestingRoot=a,o.edges().forEach(h=>o.edge(h).minlen*=l);let f=i(o)+1;o.children().forEach(h=>n(o,a,l,f,c,u,h)),o.graph().nodeRankFactor=l}function n(o,a,u,d,c,l,f){let h=o.children(f);if(!h.length){f!==a&&o.setEdge(a,f,{weight:0,minlen:u});return}let p=e.addBorderNode(o,"_bt"),m=e.addBorderNode(o,"_bb"),w=o.node(f);o.setParent(p,f),w.borderTop=p,o.setParent(m,f),w.borderBottom=m,h.forEach(x=>{n(o,a,u,d,c,l,x);let v=o.node(x),g=v.borderTop?v.borderTop:x,y=v.borderBottom?v.borderBottom:x,N=v.borderTop?d:2*d,S=g!==y?1:c-l[f]+1;o.setEdge(p,g,{weight:N,minlen:S,nestingEdge:!0}),o.setEdge(y,m,{weight:N,minlen:S,nestingEdge:!0})}),o.parent(f)||o.setEdge(a,p,{weight:0,minlen:c+l[f]})}function r(o){var a={};function u(d,c){var l=o.children(d);l&&l.length&&l.forEach(f=>u(f,c+1)),a[d]=c}return o.children().forEach(d=>u(d,1)),a}function i(o){return o.edges().reduce((a,u)=>a+o.edge(u).weight,0)}function s(o){var a=o.graph();o.removeNode(a.nestingRoot),delete a.nestingRoot,o.edges().forEach(u=>{var d=o.edge(u);d.nestingEdge&&o.removeEdge(u)})}return tr}var nr,Ho;function f0(){if(Ho)return nr;Ho=1;let e=oe();nr=t;function t(r){function i(s){let o=r.children(s),a=r.node(s);if(o.length&&o.forEach(i),Object.hasOwn(a,"minRank")){a.borderLeft=[],a.borderRight=[];for(let u=a.minRank,d=a.maxRank+1;u<d;++u)n(r,"borderLeft","_bl",s,a,u),n(r,"borderRight","_br",s,a,u)}}r.children().forEach(i)}function n(r,i,s,o,a,u){let d={width:0,height:0,rank:u,borderType:i},c=a[i][u-1],l=e.addDummyNode(r,"border",d,s);a[i][u]=l,r.setParent(l,o),c&&r.setEdge(c,l,{weight:1})}return nr}var rr,Vo;function h0(){if(Vo)return rr;Vo=1,rr={adjust:e,undo:t};function e(u){let d=u.graph().rankdir.toLowerCase();(d==="lr"||d==="rl")&&n(u)}function t(u){let d=u.graph().rankdir.toLowerCase();(d==="bt"||d==="rl")&&i(u),(d==="lr"||d==="rl")&&(o(u),n(u))}function n(u){u.nodes().forEach(d=>r(u.node(d))),u.edges().forEach(d=>r(u.edge(d)))}function r(u){let d=u.width;u.width=u.height,u.height=d}function i(u){u.nodes().forEach(d=>s(u.node(d))),u.edges().forEach(d=>{let c=u.edge(d);c.points.forEach(s),Object.hasOwn(c,"y")&&s(c)})}function s(u){u.y=-u.y}function o(u){u.nodes().forEach(d=>a(u.node(d))),u.edges().forEach(d=>{let c=u.edge(d);c.points.forEach(a),Object.hasOwn(c,"x")&&a(c)})}function a(u){let d=u.x;u.x=u.y,u.y=d}return rr}var ir,Bo;function p0(){if(Bo)return ir;Bo=1;let e=oe();ir=t;function t(n){let r={},i=n.nodes().filter(c=>!n.children(c).length),s=i.map(c=>n.node(c).rank),o=e.applyWithChunking(Math.max,s),a=e.range(o+1).map(()=>[]);function u(c){if(r[c])return;r[c]=!0;let l=n.node(c);a[l.rank].push(c),n.successors(c).forEach(u)}return i.sort((c,l)=>n.node(c).rank-n.node(l).rank).forEach(u),a}return ir}var or,Fo;function g0(){if(Fo)return or;Fo=1;let e=oe().zipObject;or=t;function t(r,i){let s=0;for(let o=1;o<i.length;++o)s+=n(r,i[o-1],i[o]);return s}function n(r,i,s){let o=e(s,s.map((f,h)=>h)),a=i.flatMap(f=>r.outEdges(f).map(h=>({pos:o[h.w],weight:r.edge(h).weight})).sort((h,p)=>h.pos-p.pos)),u=1;for(;u<s.length;)u<<=1;let d=2*u-1;u-=1;let c=new Array(d).fill(0),l=0;return a.forEach(f=>{let h=f.pos+u;c[h]+=f.weight;let p=0;for(;h>0;)h%2&&(p+=c[h+1]),h=h-1>>1,c[h]+=f.weight;l+=f.weight*p}),l}return or}var sr,qo;function m0(){if(qo)return sr;qo=1,sr=e;function e(t,n=[]){return n.map(r=>{let i=t.inEdges(r);if(i.length){let s=i.reduce((o,a)=>{let u=t.edge(a),d=t.node(a.v);return{sum:o.sum+u.weight*d.order,weight:o.weight+u.weight}},{sum:0,weight:0});return{v:r,barycenter:s.sum/s.weight,weight:s.weight}}else return{v:r}})}return sr}var ar,Yo;function y0(){if(Yo)return ar;Yo=1;let e=oe();ar=t;function t(i,s){let o={};i.forEach((u,d)=>{let c=o[u.v]={indegree:0,in:[],out:[],vs:[u.v],i:d};u.barycenter!==void 0&&(c.barycenter=u.barycenter,c.weight=u.weight)}),s.edges().forEach(u=>{let d=o[u.v],c=o[u.w];d!==void 0&&c!==void 0&&(c.indegree++,d.out.push(o[u.w]))});let a=Object.values(o).filter(u=>!u.indegree);return n(a)}function n(i){let s=[];function o(u){return d=>{d.merged||(d.barycenter===void 0||u.barycenter===void 0||d.barycenter>=u.barycenter)&&r(u,d)}}function a(u){return d=>{d.in.push(u),--d.indegree===0&&i.push(d)}}for(;i.length;){let u=i.pop();s.push(u),u.in.reverse().forEach(o(u)),u.out.forEach(a(u))}return s.filter(u=>!u.merged).map(u=>e.pick(u,["vs","i","barycenter","weight"]))}function r(i,s){let o=0,a=0;i.weight&&(o+=i.barycenter*i.weight,a+=i.weight),s.weight&&(o+=s.barycenter*s.weight,a+=s.weight),i.vs=s.vs.concat(i.vs),i.barycenter=o/a,i.weight=a,i.i=Math.min(s.i,i.i),s.merged=!0}return ar}var cr,Go;function x0(){if(Go)return cr;Go=1;let e=oe();cr=t;function t(i,s){let o=e.partition(i,p=>Object.hasOwn(p,"barycenter")),a=o.lhs,u=o.rhs.sort((p,m)=>m.i-p.i),d=[],c=0,l=0,f=0;a.sort(r(!!s)),f=n(d,u,f),a.forEach(p=>{f+=p.vs.length,d.push(p.vs),c+=p.barycenter*p.weight,l+=p.weight,f=n(d,u,f)});let h={vs:d.flat(!0)};return l&&(h.barycenter=c/l,h.weight=l),h}function n(i,s,o){let a;for(;s.length&&(a=s[s.length-1]).i<=o;)s.pop(),i.push(a.vs),o++;return o}function r(i){return(s,o)=>s.barycenter<o.barycenter?-1:s.barycenter>o.barycenter?1:i?o.i-s.i:s.i-o.i}return cr}var ur,Xo;function w0(){if(Xo)return ur;Xo=1;let e=m0(),t=y0(),n=x0();ur=r;function r(o,a,u,d){let c=o.children(a),l=o.node(a),f=l?l.borderLeft:void 0,h=l?l.borderRight:void 0,p={};f&&(c=c.filter(v=>v!==f&&v!==h));let m=e(o,c);m.forEach(v=>{if(o.children(v.v).length){let g=r(o,v.v,u,d);p[v.v]=g,Object.hasOwn(g,"barycenter")&&s(v,g)}});let w=t(m,u);i(w,p);let x=n(w,d);if(f&&(x.vs=[f,x.vs,h].flat(!0),o.predecessors(f).length)){let v=o.node(o.predecessors(f)[0]),g=o.node(o.predecessors(h)[0]);Object.hasOwn(x,"barycenter")||(x.barycenter=0,x.weight=0),x.barycenter=(x.barycenter*x.weight+v.order+g.order)/(x.weight+2),x.weight+=2}return x}function i(o,a){o.forEach(u=>{u.vs=u.vs.flatMap(d=>a[d]?a[d].vs:d)})}function s(o,a){o.barycenter!==void 0?(o.barycenter=(o.barycenter*o.weight+a.barycenter*a.weight)/(o.weight+a.weight),o.weight+=a.weight):(o.barycenter=a.barycenter,o.weight=a.weight)}return ur}var lr,Wo;function v0(){if(Wo)return lr;Wo=1;let e=ge().Graph,t=oe();lr=n;function n(i,s,o){let a=r(i),u=new e({compound:!0}).setGraph({root:a}).setDefaultNodeLabel(d=>i.node(d));return i.nodes().forEach(d=>{let c=i.node(d),l=i.parent(d);(c.rank===s||c.minRank<=s&&s<=c.maxRank)&&(u.setNode(d),u.setParent(d,l||a),i[o](d).forEach(f=>{let h=f.v===d?f.w:f.v,p=u.edge(h,d),m=p!==void 0?p.weight:0;u.setEdge(h,d,{weight:i.edge(f).weight+m})}),Object.hasOwn(c,"minRank")&&u.setNode(d,{borderLeft:c.borderLeft[s],borderRight:c.borderRight[s]}))}),u}function r(i){for(var s;i.hasNode(s=t.uniqueId("_root")););return s}return lr}var dr,Uo;function b0(){if(Uo)return dr;Uo=1,dr=e;function e(t,n,r){let i={},s;r.forEach(o=>{let a=t.parent(o),u,d;for(;a;){if(u=t.parent(a),u?(d=i[u],i[u]=a):(d=s,s=a),d&&d!==a){n.setEdge(d,a);return}a=u}})}return dr}var fr,Ko;function _0(){if(Ko)return fr;Ko=1;let e=p0(),t=g0(),n=w0(),r=v0(),i=b0(),s=ge().Graph,o=oe();fr=a;function a(l,f){if(f&&typeof f.customOrder=="function"){f.customOrder(l,a);return}let h=o.maxRank(l),p=u(l,o.range(1,h+1),"inEdges"),m=u(l,o.range(h-1,-1,-1),"outEdges"),w=e(l);if(c(l,w),f&&f.disableOptimalOrderHeuristic)return;let x=Number.POSITIVE_INFINITY,v;for(let g=0,y=0;y<4;++g,++y){d(g%2?p:m,g%4>=2),w=o.buildLayerMatrix(l);let N=t(l,w);N<x&&(y=0,v=Object.assign({},w),x=N)}c(l,v)}function u(l,f,h){return f.map(function(p){return r(l,p,h)})}function d(l,f){let h=new s;l.forEach(function(p){let m=p.graph().root,w=n(p,m,h,f);w.vs.forEach((x,v)=>p.node(x).order=v),i(p,h,w.vs)})}function c(l,f){Object.values(f).forEach(h=>h.forEach((p,m)=>l.node(p).order=m))}return fr}var hr,Qo;function E0(){if(Qo)return hr;Qo=1;let e=ge().Graph,t=oe();hr={positionX:h,findType1Conflicts:n,findType2Conflicts:r,addConflict:s,hasConflict:o,verticalAlignment:a,horizontalCompaction:u,alignCoordinates:l,findSmallestWidthAlignment:c,balance:f};function n(w,x){let v={};function g(y,N){let S=0,C=0,_=y.length,E=N[N.length-1];return N.forEach((k,M)=>{let I=i(w,k),D=I?w.node(I).order:_;(I||k===E)&&(N.slice(C,M+1).forEach(b=>{w.predecessors(b).forEach(R=>{let A=w.node(R),$=A.order;($<S||D<$)&&!(A.dummy&&w.node(b).dummy)&&s(v,R,b)})}),C=M+1,S=D)}),N}return x.length&&x.reduce(g),v}function r(w,x){let v={};function g(N,S,C,_,E){let k;t.range(S,C).forEach(M=>{k=N[M],w.node(k).dummy&&w.predecessors(k).forEach(I=>{let D=w.node(I);D.dummy&&(D.order<_||D.order>E)&&s(v,I,k)})})}function y(N,S){let C=-1,_,E=0;return S.forEach((k,M)=>{if(w.node(k).dummy==="border"){let I=w.predecessors(k);I.length&&(_=w.node(I[0]).order,g(S,E,M,C,_),E=M,C=_)}g(S,E,S.length,_,N.length)}),S}return x.length&&x.reduce(y),v}function i(w,x){if(w.node(x).dummy)return w.predecessors(x).find(v=>w.node(v).dummy)}function s(w,x,v){if(x>v){let y=x;x=v,v=y}let g=w[x];g||(w[x]=g={}),g[v]=!0}function o(w,x,v){if(x>v){let g=x;x=v,v=g}return!!w[x]&&Object.hasOwn(w[x],v)}function a(w,x,v,g){let y={},N={},S={};return x.forEach(C=>{C.forEach((_,E)=>{y[_]=_,N[_]=_,S[_]=E})}),x.forEach(C=>{let _=-1;C.forEach(E=>{let k=g(E);if(k.length){k=k.sort((I,D)=>S[I]-S[D]);let M=(k.length-1)/2;for(let I=Math.floor(M),D=Math.ceil(M);I<=D;++I){let b=k[I];N[E]===E&&_<S[b]&&!o(v,E,b)&&(N[b]=E,N[E]=y[E]=y[b],_=S[b])}}})}),{root:y,align:N}}function u(w,x,v,g,y){let N={},S=d(w,x,v,y),C=y?"borderLeft":"borderRight";function _(M,I){let D=S.nodes(),b=D.pop(),R={};for(;b;)R[b]?M(b):(R[b]=!0,D.push(b),D=D.concat(I(b))),b=D.pop()}function E(M){N[M]=S.inEdges(M).reduce((I,D)=>Math.max(I,N[D.v]+S.edge(D)),0)}function k(M){let I=S.outEdges(M).reduce((b,R)=>Math.min(b,N[R.w]-S.edge(R)),Number.POSITIVE_INFINITY),D=w.node(M);I!==Number.POSITIVE_INFINITY&&D.borderType!==C&&(N[M]=Math.max(N[M],I))}return _(E,S.predecessors.bind(S)),_(k,S.successors.bind(S)),Object.keys(g).forEach(M=>N[M]=N[v[M]]),N}function d(w,x,v,g){let y=new e,N=w.graph(),S=p(N.nodesep,N.edgesep,g);return x.forEach(C=>{let _;C.forEach(E=>{let k=v[E];if(y.setNode(k),_){var M=v[_],I=y.edge(M,k);y.setEdge(M,k,Math.max(S(w,E,_),I||0))}_=E})}),y}function c(w,x){return Object.values(x).reduce((v,g)=>{let y=Number.NEGATIVE_INFINITY,N=Number.POSITIVE_INFINITY;Object.entries(g).forEach(([C,_])=>{let E=m(w,C)/2;y=Math.max(_+E,y),N=Math.min(_-E,N)});const S=y-N;return S<v[0]&&(v=[S,g]),v},[Number.POSITIVE_INFINITY,null])[1]}function l(w,x){let v=Object.values(x),g=t.applyWithChunking(Math.min,v),y=t.applyWithChunking(Math.max,v);["u","d"].forEach(N=>{["l","r"].forEach(S=>{let C=N+S,_=w[C];if(_===x)return;let E=Object.values(_),k=g-t.applyWithChunking(Math.min,E);S!=="l"&&(k=y-t.applyWithChunking(Math.max,E)),k&&(w[C]=t.mapValues(_,M=>M+k))})})}function f(w,x){return t.mapValues(w.ul,(v,g)=>{if(x)return w[x.toLowerCase()][g];{let y=Object.values(w).map(N=>N[g]).sort((N,S)=>N-S);return(y[1]+y[2])/2}})}function h(w){let x=t.buildLayerMatrix(w),v=Object.assign(n(w,x),r(w,x)),g={},y;["u","d"].forEach(S=>{y=S==="u"?x:Object.values(x).reverse(),["l","r"].forEach(C=>{C==="r"&&(y=y.map(M=>Object.values(M).reverse()));let _=(S==="u"?w.predecessors:w.successors).bind(w),E=a(w,y,v,_),k=u(w,y,E.root,E.align,C==="r");C==="r"&&(k=t.mapValues(k,M=>-M)),g[S+C]=k})});let N=c(w,g);return l(g,N),f(g,w.graph().align)}function p(w,x,v){return(g,y,N)=>{let S=g.node(y),C=g.node(N),_=0,E;if(_+=S.width/2,Object.hasOwn(S,"labelpos"))switch(S.labelpos.toLowerCase()){case"l":E=-S.width/2;break;case"r":E=S.width/2;break}if(E&&(_+=v?E:-E),E=0,_+=(S.dummy?x:w)/2,_+=(C.dummy?x:w)/2,_+=C.width/2,Object.hasOwn(C,"labelpos"))switch(C.labelpos.toLowerCase()){case"l":E=C.width/2;break;case"r":E=-C.width/2;break}return E&&(_+=v?E:-E),E=0,_}}function m(w,x){return w.node(x).width}return hr}var pr,Zo;function N0(){if(Zo)return pr;Zo=1;let e=oe(),t=E0().positionX;pr=n;function n(i){i=e.asNonCompoundGraph(i),r(i),Object.entries(t(i)).forEach(([s,o])=>i.node(s).x=o)}function r(i){let s=e.buildLayerMatrix(i),o=i.graph().ranksep,a=0;s.forEach(u=>{const d=u.reduce((c,l)=>{const f=i.node(l).height;return c>f?c:f},0);u.forEach(c=>i.node(c).y=a+d/2),a+=d+o})}return pr}var gr,Jo;function k0(){if(Jo)return gr;Jo=1;let e=s0(),t=a0(),n=u0(),r=oe().normalizeRanks,i=l0(),s=oe().removeEmptyRanks,o=d0(),a=f0(),u=h0(),d=_0(),c=N0(),l=oe(),f=ge().Graph;gr=h;function h(T,L){let j=L&&L.debugTiming?l.time:l.notime;j("layout",()=>{let B=j("  buildLayoutGraph",()=>_(T));j("  runLayout",()=>p(B,j,L)),j("  updateInputGraph",()=>m(T,B))})}function p(T,L,j){L("    makeSpaceForEdgeLabels",()=>E(T)),L("    removeSelfEdges",()=>z(T)),L("    acyclic",()=>e.run(T)),L("    nestingGraph.run",()=>o.run(T)),L("    rank",()=>n(l.asNonCompoundGraph(T))),L("    injectEdgeLabelProxies",()=>k(T)),L("    removeEmptyRanks",()=>s(T)),L("    nestingGraph.cleanup",()=>o.cleanup(T)),L("    normalizeRanks",()=>r(T)),L("    assignRankMinMax",()=>M(T)),L("    removeEdgeLabelProxies",()=>I(T)),L("    normalize.run",()=>t.run(T)),L("    parentDummyChains",()=>i(T)),L("    addBorderSegments",()=>a(T)),L("    order",()=>d(T,j)),L("    insertSelfEdges",()=>O(T)),L("    adjustCoordinateSystem",()=>u.adjust(T)),L("    position",()=>c(T)),L("    positionSelfEdges",()=>V(T)),L("    removeBorderNodes",()=>$(T)),L("    normalize.undo",()=>t.undo(T)),L("    fixupEdgeLabelCoords",()=>R(T)),L("    undoCoordinateSystem",()=>u.undo(T)),L("    translateGraph",()=>D(T)),L("    assignNodeIntersects",()=>b(T)),L("    reversePoints",()=>A(T)),L("    acyclic.undo",()=>e.undo(T))}function m(T,L){T.nodes().forEach(j=>{let B=T.node(j),F=L.node(j);B&&(B.x=F.x,B.y=F.y,B.rank=F.rank,L.children(j).length&&(B.width=F.width,B.height=F.height))}),T.edges().forEach(j=>{let B=T.edge(j),F=L.edge(j);B.points=F.points,Object.hasOwn(F,"x")&&(B.x=F.x,B.y=F.y)}),T.graph().width=L.graph().width,T.graph().height=L.graph().height}let w=["nodesep","edgesep","ranksep","marginx","marginy"],x={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},v=["acyclicer","ranker","rankdir","align"],g=["width","height"],y={width:0,height:0},N=["minlen","weight","width","height","labeloffset"],S={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},C=["labelpos"];function _(T){let L=new f({multigraph:!0,compound:!0}),j=Y(T.graph());return L.setGraph(Object.assign({},x,q(j,w),l.pick(j,v))),T.nodes().forEach(B=>{let F=Y(T.node(B));const G=q(F,g);Object.keys(y).forEach(X=>{G[X]===void 0&&(G[X]=y[X])}),L.setNode(B,G),L.setParent(B,T.parent(B))}),T.edges().forEach(B=>{let F=Y(T.edge(B));L.setEdge(B,Object.assign({},S,q(F,N),l.pick(F,C)))}),L}function E(T){let L=T.graph();L.ranksep/=2,T.edges().forEach(j=>{let B=T.edge(j);B.minlen*=2,B.labelpos.toLowerCase()!=="c"&&(L.rankdir==="TB"||L.rankdir==="BT"?B.width+=B.labeloffset:B.height+=B.labeloffset)})}function k(T){T.edges().forEach(L=>{let j=T.edge(L);if(j.width&&j.height){let B=T.node(L.v),G={rank:(T.node(L.w).rank-B.rank)/2+B.rank,e:L};l.addDummyNode(T,"edge-proxy",G,"_ep")}})}function M(T){let L=0;T.nodes().forEach(j=>{let B=T.node(j);B.borderTop&&(B.minRank=T.node(B.borderTop).rank,B.maxRank=T.node(B.borderBottom).rank,L=Math.max(L,B.maxRank))}),T.graph().maxRank=L}function I(T){T.nodes().forEach(L=>{let j=T.node(L);j.dummy==="edge-proxy"&&(T.edge(j.e).labelRank=j.rank,T.removeNode(L))})}function D(T){let L=Number.POSITIVE_INFINITY,j=0,B=Number.POSITIVE_INFINITY,F=0,G=T.graph(),X=G.marginx||0,Z=G.marginy||0;function K(W){let Q=W.x,J=W.y,re=W.width,ae=W.height;L=Math.min(L,Q-re/2),j=Math.max(j,Q+re/2),B=Math.min(B,J-ae/2),F=Math.max(F,J+ae/2)}T.nodes().forEach(W=>K(T.node(W))),T.edges().forEach(W=>{let Q=T.edge(W);Object.hasOwn(Q,"x")&&K(Q)}),L-=X,B-=Z,T.nodes().forEach(W=>{let Q=T.node(W);Q.x-=L,Q.y-=B}),T.edges().forEach(W=>{let Q=T.edge(W);Q.points.forEach(J=>{J.x-=L,J.y-=B}),Object.hasOwn(Q,"x")&&(Q.x-=L),Object.hasOwn(Q,"y")&&(Q.y-=B)}),G.width=j-L+X,G.height=F-B+Z}function b(T){T.edges().forEach(L=>{let j=T.edge(L),B=T.node(L.v),F=T.node(L.w),G,X;j.points?(G=j.points[0],X=j.points[j.points.length-1]):(j.points=[],G=F,X=B),j.points.unshift(l.intersectRect(B,G)),j.points.push(l.intersectRect(F,X))})}function R(T){T.edges().forEach(L=>{let j=T.edge(L);if(Object.hasOwn(j,"x"))switch((j.labelpos==="l"||j.labelpos==="r")&&(j.width-=j.labeloffset),j.labelpos){case"l":j.x-=j.width/2+j.labeloffset;break;case"r":j.x+=j.width/2+j.labeloffset;break}})}function A(T){T.edges().forEach(L=>{let j=T.edge(L);j.reversed&&j.points.reverse()})}function $(T){T.nodes().forEach(L=>{if(T.children(L).length){let j=T.node(L),B=T.node(j.borderTop),F=T.node(j.borderBottom),G=T.node(j.borderLeft[j.borderLeft.length-1]),X=T.node(j.borderRight[j.borderRight.length-1]);j.width=Math.abs(X.x-G.x),j.height=Math.abs(F.y-B.y),j.x=G.x+j.width/2,j.y=B.y+j.height/2}}),T.nodes().forEach(L=>{T.node(L).dummy==="border"&&T.removeNode(L)})}function z(T){T.edges().forEach(L=>{if(L.v===L.w){var j=T.node(L.v);j.selfEdges||(j.selfEdges=[]),j.selfEdges.push({e:L,label:T.edge(L)}),T.removeEdge(L)}})}function O(T){var L=l.buildLayerMatrix(T);L.forEach(j=>{var B=0;j.forEach((F,G)=>{var X=T.node(F);X.order=G+B,(X.selfEdges||[]).forEach(Z=>{l.addDummyNode(T,"selfedge",{width:Z.label.width,height:Z.label.height,rank:X.rank,order:G+ ++B,e:Z.e,label:Z.label},"_se")}),delete X.selfEdges})})}function V(T){T.nodes().forEach(L=>{var j=T.node(L);if(j.dummy==="selfedge"){var B=T.node(j.e.v),F=B.x+B.width/2,G=B.y,X=j.x-F,Z=B.height/2;T.setEdge(j.e,j.label),T.removeNode(L),j.label.points=[{x:F+2*X/3,y:G-Z},{x:F+5*X/6,y:G-Z},{x:F+X,y:G},{x:F+5*X/6,y:G+Z},{x:F+2*X/3,y:G+Z}],j.label.x=j.x,j.label.y=j.y}})}function q(T,L){return l.mapValues(l.pick(T,L),Number)}function Y(T){var L={};return T&&Object.entries(T).forEach(([j,B])=>{typeof j=="string"&&(j=j.toLowerCase()),L[j]=B}),L}return gr}var mr,es;function S0(){if(es)return mr;es=1;let e=oe(),t=ge().Graph;mr={debugOrdering:n};function n(r){let i=e.buildLayerMatrix(r),s=new t({compound:!0,multigraph:!0}).setGraph({});return r.nodes().forEach(o=>{s.setNode(o,{label:o}),s.setParent(o,"layer"+r.node(o).rank)}),r.edges().forEach(o=>s.setEdge(o.v,o.w,{},o.name)),i.forEach((o,a)=>{let u="layer"+a;s.setNode(u,{rank:"same"}),o.reduce((d,c)=>(s.setEdge(d,c,{style:"invis"}),c))}),s}return mr}var yr,ts;function C0(){return ts||(ts=1,yr="1.1.4"),yr}var xr,ns;function M0(){return ns||(ns=1,xr={graphlib:ge(),layout:k0(),debug:S0(),util:{time:oe().time,notime:oe().notime},version:C0()}),xr}var I0=M0();const rs=Zc(I0),A0=(e,t)=>{const n=new Set;return t.forEach(r=>{n.add(r.source),n.add(r.target)}),e.filter(r=>!n.has(r.id))},T0=(e,t=0,n=0,r=50,i=50)=>{if(e.length===0)return[];const s=Math.max(...e.map(c=>{var l;return((l=c.measured)==null?void 0:l.width)??0})),o=Math.max(...e.map(c=>{var l;return((l=c.measured)==null?void 0:l.height)??0})),a=s+r,u=o+i,d=Math.ceil(Math.sqrt(e.length));return e.map((c,l)=>{var w,x;const f=l%d,h=Math.floor(l/d),p=((w=c.measured)==null?void 0:w.width)??0,m=((x=c.measured)==null?void 0:x.height)??0;return{...c,position:{x:t+f*a+(s-p)/2,y:n+h*u+(o-m)/2}}})},z0=(e,t,n)=>{const r=new rs.graphlib.Graph().setDefaultEdgeLabel(()=>({}));r.setGraph({rankdir:n==="horizontal"?"LR":"TB",nodesep:150,ranksep:100,marginx:20,marginy:20,align:"UL"}),t.forEach(l=>r.setEdge(l.source,l.target)),e.forEach(l=>{var f,h;r.setNode(l.id,{...l,width:((f=l.measured)==null?void 0:f.width)??0,height:((h=l.measured)==null?void 0:h.height)??0})}),rs.layout(r);const i=A0(e,t),s=e.filter(l=>!i.includes(l)).map(l=>{const f=r.node(l.id);if(!l.measured||!f)return l;const h=f.x-(l.measured.width??0)/2,p=f.y-(l.measured.height??0)/2;return{...l,position:{x:h,y:p}}}),o=Math.max(...s.map(l=>{var f,h;return(((f=l.position)==null?void 0:f.x)??0)+(((h=l.measured)==null?void 0:h.width)??0)})),a=Math.max(...s.map(l=>{var f,h;return(((f=l.position)==null?void 0:f.y)??0)+(((h=l.measured)==null?void 0:h.height)??0)})),u=n==="horizontal"?o+200:0,d=n==="horizontal"?0:a+200,c=T0(i,u,d);return{nodes:[...s,...c],edges:t}};export{j0 as B,Yt as M,cn as P,mg as R,D0 as T,Jh as a,ep as b,Gf as c,z0 as g,L0 as i,Xr as u};
