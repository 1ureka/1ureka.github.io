import{o as m,j as e,q as c,T as o,y as x,r as f,B as i,ac as g}from"./routes-n0rROGIf.js";import{l as b,E as y,U as I}from"./url-C4V0Sknt.js";import{T as j}from"./useMutation-3TE3W5MO.js";import{C as p}from"./Chip-Dr4JwOJ2.js";import{l as k}from"./post-BnkCC9MM.js";import{S as h}from"./Skeleton-DVK1y20g.js";const P=m(e.jsx("path",{d:"M12 4C7 4 2.73 7.11 1 11.5 2.73 15.89 7 19 12 19s9.27-3.11 11-7.5C21.27 7.11 17 4 12 4m0 12.5c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"})),C=m(e.jsx("path",{d:"M13.12 2.06 7.58 7.6c-.37.37-.58.88-.58 1.41V19c0 1.1.9 2 2 2h9c.8 0 1.52-.48 1.84-1.21l3.26-7.61C23.94 10.2 22.49 8 20.34 8h-5.65l.95-4.58c.1-.5-.05-1.01-.41-1.37-.59-.58-1.53-.58-2.11.01M3 21c1.1 0 2-.9 2-2v-8c0-1.1-.9-2-2-2s-2 .9-2 2v8c0 1.1.9 2 2 2"})),E=({postId:t,likeCount:s})=>{const{liked:n,likeCount:a,handleLike:r,disabled:l}=b(t);return e.jsx(j,{title:n?"取消喜歡":"喜歡",arrow:!0,placement:"left",children:e.jsx("span",{children:e.jsx(c,{startIcon:e.jsx(C,{}),size:"small",color:n?"primary":"inherit",onClick:r,disabled:l,children:e.jsxs(o,{variant:"caption",component:"span",children:[a??s," 個讚"]})})})})},M=({post:t,displayCount:s=3})=>{const{tags:n,id:a}=t;return e.jsxs(e.Fragment,{children:[n.map((r,l)=>l<s&&e.jsx(p,{label:r,clickable:!0,size:"small",component:"a",href:`${x.forum_posts}?topic=${r}`},r)),n.length>s&&e.jsx(p,{label:`+${n.length-s}`,clickable:!0,size:"small",variant:"outlined",component:"a",href:`${x.forum_post}?postId=${a}`})]})},T=m(e.jsx("path",{d:"M16 16h2c.55 0 1 .45 1 1s-.45 1-1 1h-2c-.55 0-1-.45-1-1s.45-1 1-1m0-8h5c.55 0 1 .45 1 1s-.45 1-1 1h-5c-.55 0-1-.45-1-1s.45-1 1-1m0 4h4c.55 0 1 .45 1 1s-.45 1-1 1h-4c-.55 0-1-.45-1-1s.45-1 1-1M3 18c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2V8H3zM13 5h-2l-.71-.71c-.18-.18-.44-.29-.7-.29H6.41c-.26 0-.52.11-.7.29L5 5H3c-.55 0-1 .45-1 1s.45 1 1 1h10c.55 0 1-.45 1-1s-.45-1-1-1"})),B=({post:t})=>{const[s,n]=f.useState(null),a=d=>n(d.currentTarget),r=()=>n(null),{mutateAsync:l,isPending:u}=k(),v=async()=>{const d=await l(t.id);if(d===null){window.location.reload();return}console.error("刪除貼文失敗"+d.error),r()};return e.jsxs(i,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e.jsx(c,{size:"small",startIcon:e.jsx(y,{}),href:`${x.forum_edit}?postId=${t.id}`,children:"編輯貼文"}),e.jsx(c,{size:"small",color:"error",startIcon:e.jsx(T,{}),onClick:a,children:"刪除貼文"}),e.jsx(g,{open:!!s,anchorEl:s,onClose:r,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},elevation:6,children:e.jsxs(i,{sx:{p:2,maxWidth:300},children:[e.jsx(o,{variant:"subtitle1",sx:{mb:1},children:"確認刪除貼文"}),e.jsx(o,{variant:"body2",sx:{mb:2,color:"text.secondary"},children:"確認刪除貼文後，將無法復原，請謹慎操作。"}),e.jsxs(i,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[e.jsx(c,{variant:"outlined",size:"small",onClick:r,color:"inherit",loading:u,children:"取消"}),e.jsx(c,{variant:"contained",color:"error",size:"small",onClick:v,loading:u,disableElevation:!0,children:"確認刪除"})]})]})})]})},D=({post:t,sx:s,...n})=>{const a=Math.abs(t.updatedAt.getTime()-t.createdAt.getTime())>1e3;return e.jsxs(i,{sx:{display:"flex",gap:1.5,mb:2,alignItems:"center",...s},...n,children:[e.jsx(I,{name:t.userName}),e.jsxs(o,{variant:"subtitle1",component:"a",href:`${x.forum_users}?user=${t.userName}`,sx:{color:"text.secondary",textDecoration:"none","&:hover":{textDecoration:"underline",color:"text.primary"}},children:["by ",t.userName]}),e.jsx(i,{sx:{flex:1}}),a?e.jsx(j,{title:`上次編輯於 ${t.updatedAt.toLocaleString()}`,arrow:!0,children:e.jsxs(o,{variant:"body2",sx:{color:"text.secondary",opacity:.9,"&:hover":{textDecoration:"underline"}},children:["*",t.createdAt.toLocaleString()]})}):e.jsx(o,{variant:"body2",sx:{color:"text.secondary",opacity:.9},children:t.createdAt.toLocaleString()})]})},H=({sx:t,...s})=>e.jsxs(i,{sx:{display:"flex",gap:1.5,mb:2,alignItems:"center",...t},...s,children:[e.jsx(h,{variant:"circular",sx:{width:"2rem",height:"2rem"},animation:"wave"}),e.jsx(h,{variant:"rounded",animation:"wave",children:e.jsx(o,{variant:"subtitle1",children:"by loading..."})}),e.jsx(i,{sx:{flex:1}}),e.jsx(h,{variant:"rounded",animation:"wave",children:e.jsx(o,{variant:"body2",children:"0000-00-00 00:00"})})]});export{H as L,D as P,B as S,C as T,P as V,M as a,E as b};
