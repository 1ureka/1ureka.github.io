import{r as p,u as k,ao as K,a4 as je,Z as Te,j as o,s as R,c as S,d as $,x as de,al as Se,m as P,D as w,g as B,a as H,b as T,aH as Re,aI as we,h as Ie,K as X,o as pe,T as I,B as f,v as ke,I as ue,y as $e,a6 as Me,ap as Be,S as He,n as U}from"./Toast-DFhmycbX.js";import{A as xe}from"./ArrowDropDownRounded-BvlBdhXR.js";import{t as Pe,A as ze}from"./array-BjoDsaFG.js";import{f as Le,b as G,a as me}from"./main-BzqcCOzZ.js";import{t as Oe}from"./SQLiteClient--yXHwvxX.js";import{z as Y}from"./index-mSkvzYyn.js";import{M as Z}from"./MenuItem--uyMP8yL.js";import{D as W,I as Ae}from"./ExpandMoreRounded-DwbyZy5l.js";import{F as be}from"./FilterAltRounded-D3DcNfya.js";import{T as J}from"./Tooltip-DBfet0F0.js";import{g as Fe,l as z,L as D,a as q}from"./ListItemText-EaIO4tsW.js";import{C as F}from"./Checkbox-Q6A5hp6-.js";import{S as Ne}from"./SortRounded-KLeCpo2K.js";import{S as Q}from"./Skeleton-6aagTK1R.js";import"./react-error-boundary.esm-tCjZQMqL.js";import"./routes-J5yqRWDh.js";import"./DataExplorationRounded-DlzxDdXP.js";import"./NotificationsRounded-BEHUrY43.js";import"./DarkModeRounded-DnQ6G5u7.js";import"./useMutation-Io05p8bM.js";import"./DownloadRounded-_zuz953O.js";import"./dayjs.min-jR_0-cUr.js";import"./SwitchBase-BXAX6q2_.js";const Ue=(e,t)=>{const{ownerState:s}=e;return[t.root,s.dense&&t.dense,s.alignItems==="flex-start"&&t.alignItemsFlexStart,s.divider&&t.divider,!s.disableGutters&&t.gutters]},De=e=>{const{alignItems:t,classes:s,dense:r,disabled:i,disableGutters:n,divider:a,selected:l}=e,u=$({root:["root",r&&"dense",!n&&"gutters",a&&"divider",i&&"disabled",t==="flex-start"&&"alignItemsFlexStart",l&&"selected"]},Fe,s);return{...s,...u}},Ee=R(de,{shouldForwardProp:e=>Se(e)||e==="classes",name:"MuiListItemButton",slot:"Root",overridesResolver:Ue})(P(({theme:e})=>({display:"flex",flexGrow:1,justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minWidth:0,boxSizing:"border-box",textAlign:"left",paddingTop:8,paddingBottom:8,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${z.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:w(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${z.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:w(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${z.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:w(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:w(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${z.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${z.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},variants:[{props:({ownerState:t})=>t.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:t})=>!t.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:t})=>t.dense,style:{paddingTop:4,paddingBottom:4}}]}))),ee=p.forwardRef(function(t,s){const r=k({props:t,name:"MuiListItemButton"}),{alignItems:i="center",autoFocus:n=!1,component:a="div",children:l,dense:c=!1,disableGutters:u=!1,divider:d=!1,focusVisibleClassName:x,selected:j=!1,className:b,...y}=r,v=p.useContext(K),m=p.useMemo(()=>({dense:c||v.dense||!1,alignItems:i,disableGutters:u}),[i,v.dense,c,u]),g=p.useRef(null);je(()=>{n&&g.current&&g.current.focus()},[n]);const h={...r,alignItems:i,dense:m.dense,disableGutters:u,divider:d,selected:j},C=De(h),M=Te(g,s);return o.jsx(K.Provider,{value:m,children:o.jsx(Ee,{ref:M,href:y.href||y.to,component:(y.href||y.to)&&a==="div"?"button":a,focusVisibleClassName:S(C.focusVisible,x),ownerState:h,className:S(C.root,b),...y,classes:C,children:l})})}),ge=p.createContext();function Ve(e){return B("MuiTable",e)}H("MuiTable",["root","stickyHeader"]);const Ge=e=>{const{classes:t,stickyHeader:s}=e;return $({root:["root",s&&"stickyHeader"]},Ve,t)},We=R("table",{name:"MuiTable",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,s.stickyHeader&&t.stickyHeader]}})(P(({theme:e})=>({display:"table",width:"100%",borderCollapse:"collapse",borderSpacing:0,"& caption":{...e.typography.body2,padding:e.spacing(2),color:(e.vars||e).palette.text.secondary,textAlign:"left",captionSide:"bottom"},variants:[{props:({ownerState:t})=>t.stickyHeader,style:{borderCollapse:"separate"}}]}))),te="table",Je=p.forwardRef(function(t,s){const r=k({props:t,name:"MuiTable"}),{className:i,component:n=te,padding:a="normal",size:l="medium",stickyHeader:c=!1,...u}=r,d={...r,component:n,padding:a,size:l,stickyHeader:c},x=Ge(d),j=p.useMemo(()=>({padding:a,size:l,stickyHeader:c}),[a,l,c]);return o.jsx(ge.Provider,{value:j,children:o.jsx(We,{as:n,role:n===te?null:"table",ref:s,className:S(x.root,i),ownerState:d,...u})})}),N=p.createContext();function _e(e){return B("MuiTableBody",e)}H("MuiTableBody",["root"]);const Ke=e=>{const{classes:t}=e;return $({root:["root"]},_e,t)},Xe=R("tbody",{name:"MuiTableBody",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"table-row-group"}),Ye={variant:"body"},oe="tbody",Ze=p.forwardRef(function(t,s){const r=k({props:t,name:"MuiTableBody"}),{className:i,component:n=oe,...a}=r,l={...r,component:n},c=Ke(l);return o.jsx(N.Provider,{value:Ye,children:o.jsx(Xe,{className:S(c.root,i),as:n,ref:s,role:n===oe?null:"rowgroup",ownerState:l,...a})})});function qe(e){return B("MuiTableCell",e)}const Qe=H("MuiTableCell",["root","head","body","footer","sizeSmall","sizeMedium","paddingCheckbox","paddingNone","alignLeft","alignCenter","alignRight","alignJustify","stickyHeader"]),et=e=>{const{classes:t,variant:s,align:r,padding:i,size:n,stickyHeader:a}=e,l={root:["root",s,a&&"stickyHeader",r!=="inherit"&&`align${T(r)}`,i!=="normal"&&`padding${T(i)}`,`size${T(n)}`]};return $(l,qe,t)},tt=R("td",{name:"MuiTableCell",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,t[s.variant],t[`size${T(s.size)}`],s.padding!=="normal"&&t[`padding${T(s.padding)}`],s.align!=="inherit"&&t[`align${T(s.align)}`],s.stickyHeader&&t.stickyHeader]}})(P(({theme:e})=>({...e.typography.body2,display:"table-cell",verticalAlign:"inherit",borderBottom:e.vars?`1px solid ${e.vars.palette.TableCell.border}`:`1px solid
    ${e.palette.mode==="light"?Re(w(e.palette.divider,1),.88):we(w(e.palette.divider,1),.68)}`,textAlign:"left",padding:16,variants:[{props:{variant:"head"},style:{color:(e.vars||e).palette.text.primary,lineHeight:e.typography.pxToRem(24),fontWeight:e.typography.fontWeightMedium}},{props:{variant:"body"},style:{color:(e.vars||e).palette.text.primary}},{props:{variant:"footer"},style:{color:(e.vars||e).palette.text.secondary,lineHeight:e.typography.pxToRem(21),fontSize:e.typography.pxToRem(12)}},{props:{size:"small"},style:{padding:"6px 16px",[`&.${Qe.paddingCheckbox}`]:{width:24,padding:"0 12px 0 16px","& > *":{padding:0}}}},{props:{padding:"checkbox"},style:{width:48,padding:"0 0 0 4px"}},{props:{padding:"none"},style:{padding:0}},{props:{align:"left"},style:{textAlign:"left"}},{props:{align:"center"},style:{textAlign:"center"}},{props:{align:"right"},style:{textAlign:"right",flexDirection:"row-reverse"}},{props:{align:"justify"},style:{textAlign:"justify"}},{props:({ownerState:t})=>t.stickyHeader,style:{position:"sticky",top:0,zIndex:2,backgroundColor:(e.vars||e).palette.background.default}}]}))),L=p.forwardRef(function(t,s){const r=k({props:t,name:"MuiTableCell"}),{align:i="inherit",className:n,component:a,padding:l,scope:c,size:u,sortDirection:d,variant:x,...j}=r,b=p.useContext(ge),y=p.useContext(N),v=y&&y.variant==="head";let m;a?m=a:m=v?"th":"td";let g=c;m==="td"?g=void 0:!g&&v&&(g="col");const h=x||y&&y.variant,C={...r,align:i,component:m,padding:l||(b&&b.padding?b.padding:"normal"),size:u||(b&&b.size?b.size:"medium"),sortDirection:d,stickyHeader:h==="head"&&b&&b.stickyHeader,variant:h},M=et(C);let A=null;return d&&(A=d==="asc"?"ascending":"descending"),o.jsx(tt,{as:m,ref:s,className:S(M.root,n),"aria-sort":A,scope:g,ownerState:C,...j})});function ot(e){return B("MuiTableContainer",e)}H("MuiTableContainer",["root"]);const st=e=>{const{classes:t}=e;return $({root:["root"]},ot,t)},rt=R("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(e,t)=>t.root})({width:"100%",overflowX:"auto"}),at=p.forwardRef(function(t,s){const r=k({props:t,name:"MuiTableContainer"}),{className:i,component:n="div",...a}=r,l={...r,component:n},c=st(l);return o.jsx(rt,{ref:s,as:n,className:S(c.root,i),ownerState:l,...a})});function nt(e){return B("MuiTableHead",e)}H("MuiTableHead",["root"]);const it=e=>{const{classes:t}=e;return $({root:["root"]},nt,t)},lt=R("thead",{name:"MuiTableHead",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"table-header-group"}),ct={variant:"head"},se="thead",dt=p.forwardRef(function(t,s){const r=k({props:t,name:"MuiTableHead"}),{className:i,component:n=se,...a}=r,l={...r,component:n},c=it(l);return o.jsx(N.Provider,{value:ct,children:o.jsx(lt,{as:n,className:S(c.root,i),ref:s,role:n===se?null:"rowgroup",ownerState:l,...a})})});function pt(e){return B("MuiTableRow",e)}const re=H("MuiTableRow",["root","selected","hover","head","footer"]),ut=e=>{const{classes:t,selected:s,hover:r,head:i,footer:n}=e;return $({root:["root",s&&"selected",r&&"hover",i&&"head",n&&"footer"]},pt,t)},xt=R("tr",{name:"MuiTableRow",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,s.head&&t.head,s.footer&&t.footer]}})(P(({theme:e})=>({color:"inherit",display:"table-row",verticalAlign:"middle",outline:0,[`&.${re.hover}:hover`]:{backgroundColor:(e.vars||e).palette.action.hover},[`&.${re.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:w(e.palette.primary.main,e.palette.action.selectedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:w(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity)}}}))),ae="tr",ye=p.forwardRef(function(t,s){const r=k({props:t,name:"MuiTableRow"}),{className:i,component:n=ae,hover:a=!1,selected:l=!1,...c}=r,u=p.useContext(N),d={...r,component:n,hover:a,selected:l,head:u&&u.variant==="head",footer:u&&u.variant==="footer"},x=ut(d);return o.jsx(xt,{as:n,ref:s,className:S(x.root,i),role:n===ae?null:"row",ownerState:d,...c})}),mt=Ie(o.jsx("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}));function bt(e){return B("MuiTableSortLabel",e)}const E=H("MuiTableSortLabel",["root","active","icon","iconDirectionDesc","iconDirectionAsc","directionDesc","directionAsc"]),gt=e=>{const{classes:t,direction:s,active:r}=e,i={root:["root",r&&"active",`direction${T(s)}`],icon:["icon",`iconDirection${T(s)}`]};return $(i,bt,t)},yt=R(de,{name:"MuiTableSortLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,s.active&&t.active]}})(P(({theme:e})=>({cursor:"pointer",display:"inline-flex",justifyContent:"flex-start",flexDirection:"inherit",alignItems:"center","&:focus":{color:(e.vars||e).palette.text.secondary},"&:hover":{color:(e.vars||e).palette.text.secondary,[`& .${E.icon}`]:{opacity:.5}},[`&.${E.active}`]:{color:(e.vars||e).palette.text.primary,[`& .${E.icon}`]:{opacity:1,color:(e.vars||e).palette.text.secondary}}}))),ft=R("span",{name:"MuiTableSortLabel",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.icon,t[`iconDirection${T(s.direction)}`]]}})(P(({theme:e})=>({fontSize:18,marginRight:4,marginLeft:4,opacity:0,transition:e.transitions.create(["opacity","transform"],{duration:e.transitions.duration.shorter}),userSelect:"none",variants:[{props:{direction:"desc"},style:{transform:"rotate(0deg)"}},{props:{direction:"asc"},style:{transform:"rotate(180deg)"}}]}))),vt=p.forwardRef(function(t,s){const r=k({props:t,name:"MuiTableSortLabel"}),{active:i=!1,children:n,className:a,direction:l="asc",hideSortIcon:c=!1,IconComponent:u=mt,slots:d={},slotProps:x={},...j}=r,b={...r,active:i,direction:l,hideSortIcon:c,IconComponent:u},y=gt(b),v={slots:d,slotProps:x},[m,g]=X("root",{elementType:yt,externalForwardedProps:v,ownerState:b,className:S(y.root,a),ref:s}),[h,C]=X("icon",{elementType:ft,externalForwardedProps:v,ownerState:b,className:y.icon});return o.jsxs(m,{disableRipple:!0,component:"span",...g,...j,children:[n,c&&!i?null:o.jsx(h,{as:u,...C})]})}),O={xs:.5,sm:1},V={xs:1,md:1.5},ht={xs:1.5,md:2},Ct=Y.array(Y.number().int()),_=()=>{const{data:e,isFetching:t}=Le({types:["table","view"]}),{searchParams:s,updateSearchParams:r}=G(),i=s.get("table")??null,n=p.useCallback(u=>{if(!e)return 0;const d=e.findIndex(({name:x})=>x===u);return d!==-1?d:0},[e]),[a,l]=p.useState(0),c=u=>{e&&r({table:e[n(u.target.value)].name,hiddenColumns:null,orderBy:null,order:null})};return p.useEffect(()=>{e&&l(n(i??e[0].name))},[i,e,n]),{data:e,selected:e&&e.length>0?e[a]:null,handleChange:c,isFetching:t}},fe=()=>{const{searchParams:e,updateSearchParams:t}=G(),s=e.get("hiddenColumns")??null,r=p.useMemo(()=>{if(!s)return[];const{data:a,error:l}=Oe(()=>JSON.parse(s));if(l)return[];const c=Ct.safeParse(a);return c.success?Array.from(new Set(c.data)):[]},[s]),i=p.useCallback(a=>()=>{const l=r.length?[]:Array.from({length:a},(c,u)=>u);t({hiddenColumns:JSON.stringify(l)},!0)},[r,t]),n=p.useCallback(a=>()=>{const l=Pe(r,a);t({hiddenColumns:JSON.stringify(l)},!0)},[r,t]);return{hiddenColumns:r,createToggleAllColumns:i,createToggleHandler:n}},jt=e=>{const{searchParams:t,updateSearchParams:s}=G(),r=p.useMemo(()=>{if(!e)return 0;const a=t.get("orderBy")??null;if(!a)return 0;const l=parseInt(a,10);return!Number.isInteger(l)||l<0||l>=e?0:l},[t,e]),i=p.useMemo(()=>{const a=t.get("order")??null;return a&&["asc","desc"].includes(a)?a:"asc"},[t]),n=p.useCallback(a=>()=>{const l=a,c=r===a&&i==="asc"?"desc":"asc";s({orderBy:l.toString(),order:c},!0)},[r,i,s]);return{orderBy:r,order:i,createToggleHandler:n}},ve={borderRadius:1,overflow:"hidden","&::before":{borderBottom:0},"&:hover:not(.Mui-disabled, .Mui-error):before":{borderBottom:0},"& input":{p:O},"& div[role='combobox']":{p:O}},he={sx:{width:"18rem"},size:"small",variant:"filled"},Tt=()=>o.jsxs(f,{sx:{position:"relative"},children:[o.jsx(pe,{...he,disabled:!0,slotProps:{input:{sx:ve}}}),o.jsx(f,{sx:{position:"absolute",inset:0,display:"grid",placeItems:"center",color:"text.secondary"},children:o.jsx(ke,{color:"inherit",size:16})})]}),St=()=>{const{data:e,selected:t,handleChange:s,isFetching:r}=_();return!e||!t||r?o.jsx(Tt,{}):o.jsxs(pe,{select:!0,value:t.name,onChange:s,...he,slotProps:{select:{IconComponent:xe,MenuProps:{slotProps:{paper:{sx:{maxHeight:350}}},elevation:3}},input:{sx:{...ve,"& #tables-ias":{color:"text.secondary",m:0}},startAdornment:o.jsx(Ae,{position:"start",id:"tables-ias",children:o.jsx(I,{variant:"caption",color:"inherit",sx:{p:.5,borderRadius:1,bgcolor:"divider",textTransform:"uppercase"},children:t.type})})}},children:[o.jsxs(Z,{dense:!0,onClickCapture:i=>i.stopPropagation(),children:[o.jsx(ze,{fontSize:"small",sx:{mr:.5}})," 新增資料表"]}),o.jsx(W,{}),e.map(({name:i},n)=>o.jsx(Z,{value:i,dense:!0,children:i},n))]})},ne={edge:"start",tabIndex:-1,disableRipple:!0,size:"small",sx:{py:0}},Ce={bgcolor:"FilledInput.disabledBg","&:hover":{bgcolor:"FilledInput.hoverBg"},borderRadius:1,height:1,width:"auto",aspectRatio:1},Rt=()=>o.jsx(J,{title:"篩選欄位",arrow:!0,children:o.jsxs("span",{style:{position:"relative"},children:[o.jsx(ue,{loading:!0,centerRipple:!1,size:"small",sx:Ce,children:o.jsx(be,{fontSize:"small"})}),o.jsx(f,{sx:{position:"absolute",top:0,bgcolor:"FilledInput.disabledBg",borderRadius:1,height:1,width:"auto",aspectRatio:1}})]})}),wt=({columns:e})=>{const[t,s]=p.useState(null),r=d=>s(x=>x?null:d.currentTarget),i=()=>s(null),{hiddenColumns:n,createToggleAllColumns:a,createToggleHandler:l}=fe(),c=n.every(d=>d>e.length-1),u=e.every((d,x)=>n.includes(x));return o.jsxs(o.Fragment,{children:[o.jsx(J,{title:"篩選欄位",arrow:!0,children:o.jsx("span",{children:o.jsx(ue,{onClick:r,centerRipple:!1,size:"small",sx:Ce,children:o.jsx(be,{fontSize:"small"})})})}),o.jsx($e,{open:!!t,anchorEl:t,onClose:i,elevation:3,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},slotProps:{paper:{sx:{maxHeight:350}}},children:o.jsxs(Me,{dense:!0,children:[o.jsx(D,{children:o.jsx(I,{variant:"body2",sx:{color:"text.secondary"},children:"篩選欄位"})}),o.jsx(D,{disablePadding:!0,children:o.jsxs(ee,{role:void 0,onClick:a(e.length),dense:!0,children:[o.jsx(F,{...ne,checked:c,indeterminate:!c&&!u}),o.jsx(q,{primary:"顯示所有"})]})}),o.jsx(W,{sx:{my:.5}}),e.toSorted((d,x)=>d.cid-x.cid).map((d,x)=>o.jsx(D,{disablePadding:!0,children:o.jsxs(ee,{role:void 0,onClick:l(x),dense:!0,children:[o.jsx(F,{...ne,checked:!n.includes(x)}),o.jsx(q,{sx:{display:"flex",width:1,gap:O,justifyContent:"space-between",my:.5},primary:d.name,secondary:d.type.toUpperCase()})]})},x))]})})]})},It=()=>{var a;const{selected:e,isFetching:t}=_(),{data:s,isFetching:r}=me({types:["table","view"]});if(r||!s||t||!e)return o.jsx(Rt,{});const n=(a=s.find(({table:l})=>l===e.name))==null?void 0:a.columns;return o.jsx(wt,{columns:n??[]})},kt=()=>o.jsxs(ye,{children:[o.jsx(L,{padding:"checkbox",sx:{border:"none"},children:o.jsx(F,{disabled:!0,size:"small"})}),o.jsx(L,{sx:{border:"none"},children:o.jsx(Q,{variant:"rounded",animation:"wave",children:o.jsx(I,{variant:"body2",children:"載入中. . ."})})}),[...Array(4)].map((e,t)=>o.jsx(L,{sx:{border:"none"},children:o.jsx(f,{sx:{display:"flex",justifyContent:"flex-end"},children:o.jsx(Q,{variant:"rounded",animation:"wave",children:o.jsx(I,{variant:"body2",children:"載入中. . ."})})})},t))]}),ie={p:.5,borderRadius:1,bgcolor:"divider"},le={textTransform:"uppercase",lineHeight:1,color:"text.secondary"},$t=({isPk:e,type:t})=>o.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:O,color:"text.secondary"},children:[e&&o.jsx(I,{variant:"caption",sx:{...ie,...le},children:"PK"}),o.jsx(f,{sx:ie,children:o.jsx(I,{variant:"caption",sx:{...le,...Be},children:t})})]}),Mt=()=>o.jsx(f,{component:"tr","aria-hidden":"true",sx:{position:"absolute",inset:0,borderRadius:3,borderBottomRightRadius:"calc(1 * var(--mui-shape-borderRadius))",borderBottomLeftRadius:"calc(1 * var(--mui-shape-borderRadius))",bgcolor:"divider",opacity:.8,pointerEvents:"none"}}),Bt=()=>{const{selected:e,isFetching:t}=_(),{data:s,isFetching:r}=me({types:["table","view"]}),i=r||!s||t||!e,{hiddenColumns:n}=fe(),a=p.useMemo(()=>{if(!s||!e)return null;const b=s.find(({table:m})=>m===e.name);if(!b)return null;const{columns:y}=b;return y.filter(({cid:m})=>!n.includes(m)).toSorted((m,g)=>m.pk!==g.pk?g.pk-m.pk:m.type==="text"&&g.type!=="text"?-1:m.type!=="text"&&g.type==="text"?1:m.cid-g.cid)},[s,e,n]),{order:l,orderBy:c,createToggleHandler:u}=jt((a==null?void 0:a.length)??0),d=Math.random()>.5,x=Math.random()>.5,j=!d&&!x;return o.jsxs(dt,{sx:{position:"relative"},children:[o.jsx(Mt,{}),i||!a?o.jsx(kt,{}):o.jsxs(ye,{children:[o.jsx(L,{padding:"checkbox",sx:{border:"none"},children:o.jsx(F,{color:"default",indeterminate:x,checked:d,size:"small",sx:{color:j?void 0:"color-mix(in srgb, var(--mui-palette-text-primary) 30%, var(--mui-palette-primary-main) 70%)"}})}),a.map((b,y)=>{const{cid:v,name:m,type:g}=b,h=b.pk===1,C=g!=="text"&&!h?"flex-end":void 0,M=c===y,A=M&&l==="desc"?1:-1;return o.jsx(L,{sx:{border:"none",minWidth:"10rem"},children:o.jsxs(f,{sx:{display:"flex",alignItems:"center",justifyContent:C},children:[o.jsx(vt,{active:M,direction:M?l:"asc",IconComponent:Ne,slotProps:{icon:{sx:{transform:`scaleY(${A})`}}},onClick:u(y),children:o.jsx(I,{variant:"body2",children:m})}),o.jsx($t,{isPk:h,type:g})]})},v)})]})]})},ce=e=>({"--temporary-color":e,bgcolor:"color-mix(in srgb, var(--temporary-color) 30%, transparent 70%)","&:hover":{bgcolor:"color-mix(in srgb, var(--temporary-color) 40%, transparent 60%)"},color:"color-mix(in srgb, var(--temporary-color) 40%, var(--mui-palette-text-primary) 60%)",px:1.5}),Ht=e=>({"--temporary-color":e,bgcolor:"color-mix(in srgb, var(--temporary-color) 90%, var(--mui-palette-text-primary) 10%)","&:hover":{bgcolor:"color-mix(in srgb, var(--temporary-color) 80%, var(--mui-palette-text-primary) 20%)"},color:"color-mix(in srgb, var(--temporary-color) 5%, var(--mui-palette-background-paper) 95%)",px:1.5}),oo=()=>o.jsxs(He,{children:[o.jsxs(f,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:V},children:[o.jsxs(f,{sx:{display:"flex",alignItems:"stretch",gap:V},children:[o.jsx(St,{}),o.jsx(It,{})]}),o.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:V},children:[o.jsx(I,{sx:{color:"text.secondary"},children:"已選取 0 個:"}),o.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:O},children:[o.jsx(J,{title:"以指定值覆蓋選取資料的某個欄位",arrow:!0,children:o.jsx(U,{sx:ce("var(--mui-palette-primary-main)"),children:"覆蓋欄位"})}),o.jsx(U,{sx:ce("var(--mui-palette-error-main)"),children:"刪除紀錄"})]}),o.jsx(W,{flexItem:!0,orientation:"vertical"}),o.jsx(U,{sx:Ht("var(--mui-palette-primary-main)"),endIcon:o.jsx(xe,{}),children:"標準化"})]})]}),o.jsx(at,{sx:{mt:ht},children:o.jsxs(Je,{children:[o.jsx(Bt,{}),o.jsx(Ze,{})]})})]});export{oo as default};
