import{f as E,l as b,r as u,j as e,p as n,n as i,T as P,C as z,h as W,i as D,I as g,z as H,o as j,S as p,aD as c,v as k,B as y,P as F,y as T}from"./Toast-DyYNk4-H.js";import{E as L,Q as G,b as Q,c as q}from"./ErrorOutlineRounded-zTQCHSuR.js";import{A as w}from"./AutoAwesomeRounded-CfvoIMJ5.js";import{L as N}from"./LightModeRounded-CyWUC3xi.js";import{D as V,T as R}from"./DarkModeRounded-Nq1sIAOR.js";import{B as K}from"./Motion-Be3Z0ox5.js";import{b as C,u as X}from"./tryCatch-Dx5fmaYy.js";import{c as Y}from"./react-CwFxSp_H.js";import{z as A}from"./index-mSkvzYyn.js";import{S as $}from"./SettingsRounded-CWmS3Du5.js";import{u as J}from"./utils-3cWt-LU5.js";import{S as Z}from"./Switch-M0R2zWnq.js";import"./proxy-CLnU6fuJ.js";import"./SwitchBase-Do9Pz7cl.js";const f=E({cssVariables:{colorSchemeSelector:".mode-%s"},typography:{fontFamily:'Comfortaa, "jf openhuninn"'},colorSchemes:{light:{palette:{border:{main:"var(--mui-palette-divider)"},primary:{main:"#8179d2"},background:{paper:"#f9f9f9",default:"#f3f3f3"},bgOpacity:{main:"0.45"}}},dark:{palette:{border:{main:"transparent"},primary:{main:"#8179d2"},background:{paper:"#1a1a1a",default:"#050505"},bgOpacity:{main:"0.3"}}}},components:{MuiInputBase:{defaultProps:{sx:{"&.Mui-disabled::before":{borderBottomStyle:"solid"}}}},MuiButton:{styleOverrides:{contained:{"&:hover":{backgroundColor:"var(--mui-palette-primary-light)"}}}}},spacing:"0.5rem",shape:{borderRadius:4*2.5}}),M=()=>{const t=b(f.breakpoints.up("lg")),s=b(f.breakpoints.up("md")),o=b(f.breakpoints.up("sm"));return u.useEffect(()=>{document.documentElement.style.fontSize="16px"},[t,s,o]),{isLg:t,isMd:s,isSm:o}},_=({error:t})=>(M(),e.jsx(n,{sx:{display:"grid",placeItems:"center",height:"100dvh"},children:e.jsxs(i,{variant:"h4",color:"error",sx:{display:"flex",alignItems:"center"},children:[e.jsx(L,{sx:{mr:1}}),(t==null?void 0:t.message)||"發生了一些錯誤"]})})),ee=new G;function te({children:t}){return e.jsxs(P,{theme:f,children:[e.jsx(z,{}),e.jsx(W,{position:"bottom-right"}),e.jsx(Q,{client:ee,children:e.jsx(q,{fallbackRender:s=>e.jsx(_,{...s}),children:t})})]})}const se=()=>e.jsxs(n,{"aria-hidden":"true",sx:{position:"absolute",inset:0,scale:1.03333,opacity:"var(--mui-palette-bgOpacity-main)",transition:"opacity 0.2s ease-in-out",overflow:"hidden",pointerEvents:"none"},children:[e.jsx(n,{sx:{position:"absolute",inset:0,filter:"contrast(2) saturate(0.7)"},children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 1200 800",preserveAspectRatio:"xMidYMid slice",children:[e.jsx("rect",{fill:"#8179D2",width:"1200",height:"800"}),e.jsxs("defs",{children:[e.jsxs("radialGradient",{id:"a",cx:"0",cy:"800",r:"800",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{offset:"0",stopColor:"#758ad2"}),e.jsx("stop",{offset:"1",stopColor:"#758ad2",stopOpacity:"0"})]}),e.jsxs("radialGradient",{id:"b",cx:"1200",cy:"800",r:"800",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{offset:"0",stopColor:"#9b78d2"}),e.jsx("stop",{offset:"1",stopColor:"#9b78d2",stopOpacity:"0"})]}),e.jsxs("radialGradient",{id:"c",cx:"600",cy:"0",r:"600",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{offset:"0",stopColor:"#7b74d2"}),e.jsx("stop",{offset:"1",stopColor:"#7b74d2",stopOpacity:"0"})]}),e.jsxs("radialGradient",{id:"d",cx:"600",cy:"800",r:"600",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{offset:"0",stopColor:"#8179D2"}),e.jsx("stop",{offset:"1",stopColor:"#8179D2",stopOpacity:"0"})]}),e.jsxs("radialGradient",{id:"e",cx:"0",cy:"0",r:"800",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{offset:"0",stopColor:"#71A6D2"}),e.jsx("stop",{offset:"1",stopColor:"#71A6D2",stopOpacity:"0"})]}),e.jsxs("radialGradient",{id:"f",cx:"1200",cy:"0",r:"800",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{offset:"0",stopColor:"#B676D2"}),e.jsx("stop",{offset:"1",stopColor:"#B676D2",stopOpacity:"0"})]})]}),e.jsx("rect",{fill:"url(#a)",width:"1200",height:"800"}),e.jsx("rect",{fill:"url(#b)",width:"1200",height:"800"}),e.jsx("rect",{fill:"url(#c)",width:"1200",height:"800"}),e.jsx("rect",{fill:"url(#d)",width:"1200",height:"800"}),e.jsx("rect",{fill:"url(#e)",width:"1200",height:"800"}),e.jsx("rect",{fill:"url(#f)",width:"1200",height:"800"})]})}),e.jsx(n,{sx:{position:"absolute",inset:0,backdropFilter:"blur(20px)"}})]}),oe=()=>{const{mode:t,setMode:s,systemMode:o}=D(),r=t==="light"||o==="light",a=t==="dark"||o==="dark";return e.jsxs(n,{sx:{position:"relative",p:.5,gap:.5,bgcolor:"action.hover",borderRadius:1.5,display:"flex",alignItems:"center"},children:[e.jsx(K,{layout:!0,sx:{position:"absolute",left:r?0:void 0,ml:r?.5:void 0,right:a?0:void 0,mr:a?.5:void 0,p:1,width:"1.25rem",height:"1.25rem",boxSizing:"content-box",bgcolor:"primary.main",borderRadius:1}}),e.jsx(g,{onClick:()=>s("light"),centerRipple:!1,sx:{position:"relative",borderRadius:1,overflow:"hidden",color:r?"background.paper":void 0,transition:"0.25s all ease"},children:e.jsx(N,{fontSize:"small"})}),e.jsx(g,{onClick:()=>s("dark"),centerRipple:!1,sx:{position:"relative",borderRadius:1,overflow:"hidden",color:a?"background.paper":void 0,transition:"0.25s all ease"},children:e.jsx(V,{fontSize:"small"})})]})},re=async t=>{const{data:s,error:o}=await C(fetch(`${t}`));if(o||!s||s.status!==200)return null;const{data:r,error:a}=await C(s.json());return a||!r?null:r},m="http://localhost:7860",B=Y(t=>({apiUrl:m,setApiUrl:s=>t({apiUrl:s})})),h={fetch:6e3,offline:6e3,start:3e3,ready:1e4},ne=()=>{const t=B(o=>o.apiUrl),{data:s}=X({queryKey:["apiState",t],queryFn:()=>re(t),refetchInterval:({state:o})=>{const{data:r}=o;return r===void 0?h.fetch:r===null?h.offline:["loading","idle"].includes((r==null?void 0:r.status)??"")?h.start:h.ready}});return s},I=()=>{const t=ne();if(t===void 0)return"loading";if(t===null)return"offline";const{status:s}=t;return s==="ok"?"connected":s==="error"?"error":["loading","idle"].includes(s)?"loading":"error"},ie={display:"flex",alignItems:"center",gap:1,borderRadius:1,bgcolor:"FilledInput.bg",p:1.5},ae=()=>e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(w,{className:"mode-light",sx:{fontSize:"2.8rem",bgcolor:"text.secondary",borderRadius:1,color:"background.default",p:1}}),e.jsx(i,{variant:"h4",component:"h2",sx:{fontSize:"1.85rem",lineHeight:1,translate:"0 2px",display:{xs:"none",sm:"block"}},children:"Blender RAG"})]}),S={loading:{color:"text.secondary",text:"啟動中"},offline:{color:"text.secondary",text:"已離線"},connected:{color:"success.light",text:"已連線"},error:{color:"error.light",text:"出現錯誤"}},le=()=>{const t=I();return e.jsxs(n,{sx:{display:"flex",alignItems:"stretch",gap:2},children:[e.jsx(oe,{}),e.jsxs(n,{sx:ie,children:[e.jsx(n,{sx:{position:"relative",p:1},children:t!=="loading"?e.jsx(n,{sx:{position:"absolute",inset:0,bgcolor:S[t].color,borderRadius:99,scale:.7}}):e.jsx(n,{sx:{position:"absolute",inset:0,display:"grid",placeItems:"center"},children:e.jsx(H,{size:16,sx:{color:"text.secondary"}})})}),e.jsx(i,{variant:"body2",sx:{textWrap:"nowrap",lineHeight:1},children:S[t].text})]})]})},ce=()=>e.jsxs(n,{component:"header",sx:{position:"sticky",display:"flex",justifyContent:"space-between",alignItems:"center",top:0,p:3.5,zIndex:1},children:[e.jsx(ae,{}),e.jsx(le,{})]}),de=j(e.jsx("path",{d:"M14.59 2.59c-.38-.38-.89-.59-1.42-.59H6c-1.1 0-2 .9-2 2v16c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8.83c0-.53-.21-1.04-.59-1.41zM15 18H9c-.55 0-1-.45-1-1s.45-1 1-1h6c.55 0 1 .45 1 1s-.45 1-1 1m0-4H9c-.55 0-1-.45-1-1s.45-1 1-1h6c.55 0 1 .45 1 1s-.45 1-1 1m-2-6V3.5L18.5 9H14c-.55 0-1-.45-1-1"})),pe=j([e.jsx("path",{d:"M13 8.57c-.79 0-1.43.64-1.43 1.43s.64 1.43 1.43 1.43 1.43-.64 1.43-1.43-.64-1.43-1.43-1.43"},"0"),e.jsx("path",{d:"M13.21 3c-3.84-.11-7 2.87-7.19 6.64L4.1 12.2c-.25.33-.01.8.4.8H6v3c0 1.1.9 2 2 2h1v2c0 .55.45 1 1 1h5c.55 0 1-.45 1-1v-3.68c2.44-1.16 4.1-3.68 4-6.58-.14-3.62-3.18-6.63-6.79-6.74M16 10c0 .13-.01.26-.02.39l.83.66c.08.06.1.16.05.25l-.8 1.39c-.05.09-.16.12-.24.09l-.99-.4c-.21.16-.43.29-.67.39L14 13.83c-.01.1-.1.17-.2.17h-1.6c-.1 0-.18-.07-.2-.17l-.15-1.06c-.25-.1-.47-.23-.68-.39l-.99.4c-.09.03-.2 0-.25-.09l-.8-1.39c-.05-.08-.03-.19.05-.25l.84-.66c-.01-.13-.02-.26-.02-.39s.02-.27.04-.39l-.85-.66c-.08-.06-.1-.16-.05-.26l.8-1.38c.05-.09.15-.12.24-.09l1 .4c.2-.15.43-.29.67-.39L12 6.17c.02-.1.1-.17.2-.17h1.6c.1 0 .18.07.2.17l.15 1.06c.24.1.46.23.67.39l1-.4c.09-.03.2 0 .24.09l.8 1.38c.05.09.03.2-.05.26l-.85.66c.03.12.04.25.04.39"},"1")]),xe=j(e.jsx("path",{d:"M7.92 7.54c-.8-.34-1.14-1.33-.66-2.05C8.23 4.05 9.85 3 11.99 3c2.35 0 3.96 1.07 4.78 2.41.7 1.15 1.11 3.3.03 4.9-1.2 1.77-2.35 2.31-2.97 3.45-.15.27-.24.49-.3.94-.09.73-.69 1.3-1.43 1.3-.87 0-1.58-.75-1.48-1.62.06-.51.18-1.04.46-1.54.77-1.39 2.25-2.21 3.11-3.44.91-1.29.4-3.7-2.18-3.7-1.17 0-1.93.61-2.4 1.34-.35.57-1.08.75-1.69.5M14 20c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2"})),ue=j(e.jsx("path",{d:"m12.93 4.26 6.15 14.99c.34.83-.51 1.66-1.33 1.29l-5.34-2.36c-.26-.11-.55-.11-.81 0l-5.34 2.36c-.82.36-1.67-.46-1.33-1.29l6.15-14.99c.33-.83 1.51-.83 1.85 0"})),he=[{Icon:de,title:"在 Blender 中，材質節點是什麼？",description:"功能概要介紹"},{Icon:pe,title:"怎麼讓角色骨架自動綁定權重？",description:"操作流程說明"},{Icon:xe,title:"為什麼我無法匯入 FBX 檔？",description:"具體問題解決"}],v={outline:1,outlineColor:"border.main","&:hover":{outlineColor:"divider",outlineWidth:10},"&:has(:focus)":{outlineColor:"primary.main",outlineWidth:5},"&:has(:focus-visible)":{outlineColor:"primary.main",outlineWidth:5},"&:active":{outlineColor:"primary.main",outlineWidth:5},transition:"outline 0.15s ease"},fe=({Icon:t,title:s,description:o})=>{const a=I()==="connected",l=()=>{if(!a)return console.warn("API 已斷開連線或正在啟動中");console.log("API 已連線，執行相關操作")};return e.jsxs(p,{sx:{position:"relative",p:3,bgcolor:"background.paper",overflow:"hidden",...v,...c([2,1.8])},children:[e.jsx(n,{sx:{pb:1.5},children:e.jsx(t,{sx:{fontSize:"3rem",bgcolor:"text.secondary",color:"background.default",p:1,...c([1.8,1.6])}})}),e.jsx(i,{variant:"h6",component:"h6",children:s}),e.jsx(i,{variant:"body1",component:"p",sx:{color:"text.secondary"},children:o}),e.jsx(g,{centerRipple:!1,sx:{position:"absolute",inset:0,...c([2,1.8])},onClick:l})]})},me=A.string().max(500,"問題過長，請簡化後再試一次").trim().min(1,"請輸入問題"),ge=()=>{const s=I()==="connected",[o,r]=u.useState(""),a=d=>{r(d.target.value)},l=()=>{const d=me.safeParse(o);if(!d.success)return console.warn(d.error.issues[0].message);if(!s)return console.warn("API 已斷開連線或正在啟動中");console.log("API 已連線，執行相關操作"),r("")};return e.jsxs(n,{sx:{display:"flex",alignItems:"flex-end",gap:2},children:[e.jsx(k,{variant:"outlined",fullWidth:!0,multiline:!0,maxRows:5,placeholder:"問我任何關於 Blender 手冊的問題...",value:o,onChange:a,sx:{"& fieldset":{border:"none"},"& > div":{px:3},bgcolor:"background.paper",...v,...c([2,1.8])}}),e.jsx(n,{sx:{...v,...c([2,1.8]),height:56,outlineOffset:-1},children:e.jsx(y,{variant:"contained",endIcon:e.jsx(ue,{sx:{rotate:"90deg"}}),sx:{textWrap:"nowrap",height:1,...c([2,1.8])},disableElevation:!0,onClick:l,children:e.jsx(i,{children:"送出"})})})]})},je=()=>e.jsxs(p,{component:"main",sx:{position:"relative",justifyContent:"space-between",alignItems:"center",flex:1,p:3.5,gap:10},children:[e.jsxs(p,{sx:{alignItems:"center"},children:[e.jsx(w,{className:"mode-light",sx:{fontSize:"6rem",bgcolor:"text.secondary",color:"background.default",p:1,mb:4,...c([3.2,2.9])}}),e.jsx(i,{variant:"h3",component:"h1",sx:{opacity:.6,mb:.5},children:"嗨，Blender 使用者"}),e.jsx(i,{variant:"h3",component:"h1",sx:{mb:2},children:"有什麼想知道的嗎？"}),e.jsx(i,{variant:"h6",component:"p",sx:{textAlign:"center",maxWidth:600,color:"text.secondary"},children:"不管是想快速了解功能、查詢操作流程，還是遇到具體問題，我都能即時協助，並用繁體中文回覆你！"})]}),e.jsxs(p,{sx:{alignItems:"stretch",maxWidth:750,gap:5},children:[e.jsx(n,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:2},children:he.map(({Icon:t,title:s,description:o},r)=>e.jsx(fe,{Icon:t,title:s,description:o},r))}),e.jsx(ge,{})]})]}),be=({onClose:t})=>{const{apiUrl:s,setApiUrl:o}=B(),[r,a]=u.useState(s!==m),[l,d]=u.useState(s!==m?s:""),O=async()=>{if(!r)return o(m),t();const x=A.string().url(),{success:U}=x.safeParse(l);if(!U)return console.error("無效的 API 服務位址");o(l),t()};return e.jsxs(e.Fragment,{children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:1.5,mb:3},children:[e.jsxs(n,{children:[e.jsx(i,{variant:"subtitle1",children:"啟用自訂 API 服務位址"}),e.jsx(i,{variant:"body2",color:"text.secondary",children:"預設連接本地服務 localhost:7860，開啟後可自訂。"})]}),e.jsx(Z,{checked:r,onChange:x=>a(x.target.checked)})]}),e.jsxs(p,{sx:{gap:2},children:[e.jsxs(n,{children:[e.jsx(i,{variant:"subtitle1",children:"自訂 API 服務位址"}),e.jsx(i,{variant:"body2",color:"text.secondary",children:"自訂連線目標，可指定遠端或本地部署的 API 服務位址。"})]}),e.jsx(R,{title:!r&&e.jsx(i,{variant:"body2",children:"請先啟用自訂 API 服務位址"}),followCursor:!0,children:e.jsx(k,{disabled:!r,value:l,onChange:x=>d(x.target.value),variant:"outlined",size:"small",placeholder:"http://localhost:7860",fullWidth:!0})})]}),e.jsxs(n,{sx:{display:"flex",mt:4,gap:1.5,color:"text.secondary"},children:[e.jsx(y,{variant:"contained",fullWidth:!0,disableElevation:!0,color:"inherit",onClick:t,sx:{"&:hover":{bgcolor:"action.selected"}},children:"取消"}),e.jsx(y,{variant:"contained",fullWidth:!0,disableElevation:!0,onClick:O,children:"確認"})]})]})},ye=()=>{const{anchorEl:t,handleOpen:s,handleClose:o}=J();return e.jsxs(e.Fragment,{children:[e.jsx(n,{sx:{position:"absolute",inset:"auto auto 0 0",m:3.5,bgcolor:"FilledInput.bg",borderRadius:99},children:e.jsx(R,{title:e.jsx(i,{variant:"body2",children:"設定"}),placement:"right",arrow:!0,children:e.jsx(g,{centerRipple:!1,sx:{p:1.5},onClick:s,children:e.jsx($,{})})})}),e.jsx(F,{keepMounted:!1,open:!!t,anchorEl:t,onClose:o,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"left"},slotProps:{paper:{elevation:0,sx:{boxShadow:"none",outline:3,outlineColor:"divider",p:3,ml:2,maxWidth:450}}},children:e.jsx(be,{onClose:o})})]})};function ve(){return M(),e.jsxs(te,{children:[e.jsx(se,{}),e.jsxs(p,{sx:{minHeight:"100dvh"},children:[e.jsx(ce,{}),e.jsx(je,{})]}),e.jsx(ye,{})]})}T.createRoot(document.getElementById("root")).render(e.jsx(u.StrictMode,{children:e.jsx(ve,{})}));
