import{o as j,j as e,g as K,a as U,r as u,u as z,N as G,s as w,c as R,d as W,m as E,D as Pe,a5 as Je,P as et,S as Ne,$ as qt,b as B,ak as Ht,al as _t,am as Vt,e as tt,an as fe,H as we,T as p,ao as ze,ap as ae,aq as Gt,Q as Kt,ar as We,as as Oe,B as d,A as Me,t as J,y as F,q as C,v as Ie,ac as ot,at as Qt,Z as Yt}from"./routes-n0rROGIf.js";import{F as st}from"./ForumRounded-Cdgm9z_Q.js";import{z as ee,o as Zt,d as nt,g as de,e as ue,p as Xt,i as xe,q as Jt,j as Q,S as Ae,r as eo,a as to,F as rt,C as $e,T as oo,s as so}from"./post-BnkCC9MM.js";import{I as no,S as at,E as Ue}from"./ExpandMoreRounded-BHtti7oY.js";import{T as oe,u as it}from"./useMutation-3TE3W5MO.js";import{g as ro,a as ao,l as ve,S as P,I as O,M as Re,D as io}from"./DarkModeRounded-BstcUZiJ.js";import{f as lt,d as N}from"./ScrollArea-C9q_aw9q.js";import{S as ie}from"./Skeleton-DVK1y20g.js";import{O as lo}from"./OpenInNewRounded-B6wH2E-Q.js";import{D as $}from"./Divider-DiSxJ-uN.js";import{B as ct,N as dt}from"./NotificationsRounded-D9n4jbA0.js";import{u as se,a as he}from"./forum-CVzoj8Ed.js";import{C as Se}from"./Chip-Dr4JwOJ2.js";import{C as qe}from"./Collapse-BIXy2GHj.js";const co=j(e.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}));function uo(t){return K("MuiAvatar",t)}U("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const po=t=>{const{classes:o,variant:s,colorDefault:n}=t;return W({root:["root",s,n&&"colorDefault"],img:["img"],fallback:["fallback"]},uo,o)},xo=w("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:s}=t;return[o.root,o[s.variant],s.colorDefault&&o.colorDefault]}})(E(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:{color:(t.vars||t).palette.background.default,...t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:{backgroundColor:t.palette.grey[400],...t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})}}}]}))),ho=w("img",{name:"MuiAvatar",slot:"Img",overridesResolver:(t,o)=>o.img})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),mo=w(co,{name:"MuiAvatar",slot:"Fallback",overridesResolver:(t,o)=>o.fallback})({width:"75%",height:"75%"});function go({crossOrigin:t,referrerPolicy:o,src:s,srcSet:n}){const[a,r]=u.useState(!1);return u.useEffect(()=>{if(!s&&!n)return;r(!1);let i=!0;const l=new Image;return l.onload=()=>{i&&r("loaded")},l.onerror=()=>{i&&r("error")},l.crossOrigin=t,l.referrerPolicy=o,l.src=s,n&&(l.srcset=n),()=>{i=!1}},[t,o,s,n]),a}const ut=u.forwardRef(function(o,s){const n=z({props:o,name:"MuiAvatar"}),{alt:a,children:r,className:i,component:l="div",slots:c={},slotProps:x={},imgProps:g,sizes:f,src:m,srcSet:h,variant:v="circular",...S}=n;let y=null;const b={...n,component:l,variant:v},L=go({...g,...typeof x.img=="function"?x.img(b):x.img,src:m,srcSet:h}),k=m||h,A=k&&L!=="error";b.colorDefault=!A,delete b.ownerState;const I=po(b),[q,X]=G("img",{className:I.img,elementType:ho,externalForwardedProps:{slots:c,slotProps:{img:{...g,...x.img}}},additionalProps:{alt:a,src:m,srcSet:h,sizes:f},ownerState:b});return A?y=e.jsx(q,{...X}):r||r===0?y=r:k&&a?y=a[0]:y=e.jsx(mo,{ownerState:b,className:I.fallback}),e.jsx(xo,{as:l,className:R(I.root,i),ref:s,...S,ownerState:b,children:y})});function fo(t){return K("MuiBottomNavigation",t)}U("MuiBottomNavigation",["root"]);const vo=t=>{const{classes:o}=t;return W({root:["root"]},fo,o)},yo=w("div",{name:"MuiBottomNavigation",slot:"Root",overridesResolver:(t,o)=>o.root})(E(({theme:t})=>({display:"flex",justifyContent:"center",height:56,backgroundColor:(t.vars||t).palette.background.paper}))),bo=u.forwardRef(function(o,s){const n=z({props:o,name:"MuiBottomNavigation"}),{children:a,className:r,component:i="div",onChange:l,showLabels:c=!1,value:x,...g}=n,f={...n,component:i,showLabels:c},m=vo(f);return e.jsx(yo,{as:i,className:R(m.root,r),ref:s,ownerState:f,...g,children:u.Children.map(a,(h,v)=>{if(!u.isValidElement(h))return null;const S=h.props.value===void 0?v:h.props.value;return u.cloneElement(h,{selected:S===x,showLabel:h.props.showLabel!==void 0?h.props.showLabel:c,value:S,onChange:l})})})});function jo(t){return K("MuiBottomNavigationAction",t)}const pt=U("MuiBottomNavigationAction",["root","iconOnly","selected","label"]),wo=t=>{const{classes:o,showLabel:s,selected:n}=t;return W({root:["root",!s&&!n&&"iconOnly",n&&"selected"],label:["label",!s&&!n&&"iconOnly",n&&"selected"]},jo,o)},So=w(Pe,{name:"MuiBottomNavigationAction",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:s}=t;return[o.root,!s.showLabel&&!s.selected&&o.iconOnly]}})(E(({theme:t})=>({transition:t.transitions.create(["color","padding-top"],{duration:t.transitions.duration.short}),padding:"0px 12px",minWidth:80,maxWidth:168,color:(t.vars||t).palette.text.secondary,flexDirection:"column",flex:"1",[`&.${pt.selected}`]:{color:(t.vars||t).palette.primary.main},variants:[{props:({showLabel:o,selected:s})=>!o&&!s,style:{paddingTop:14}},{props:({showLabel:o,selected:s,label:n})=>!o&&!s&&!n,style:{paddingTop:0}}]}))),Co=w("span",{name:"MuiBottomNavigationAction",slot:"Label",overridesResolver:(t,o)=>o.label})(E(({theme:t})=>({fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(12),opacity:1,transition:"font-size 0.2s, opacity 0.2s",transitionDelay:"0.1s",[`&.${pt.selected}`]:{fontSize:t.typography.pxToRem(14)},variants:[{props:({showLabel:o,selected:s})=>!o&&!s,style:{opacity:0,transitionDelay:"0s"}}]}))),te=u.forwardRef(function(o,s){const n=z({props:o,name:"MuiBottomNavigationAction"}),{className:a,icon:r,label:i,onChange:l,onClick:c,selected:x,showLabel:g,value:f,...m}=n,h=n,v=wo(h),S=y=>{l&&l(y,f),c&&c(y)};return e.jsxs(So,{ref:s,className:R(v.root,a),focusRipple:!0,onClick:S,ownerState:h,...m,children:[r,e.jsx(Co,{className:v.label,ownerState:h,children:i})]})});function Io(t){return K("MuiDialog",t)}const Fe=U("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),ko=u.createContext({}),Ro=w(_t,{name:"MuiDialog",slot:"Backdrop",overrides:(t,o)=>o.backdrop})({zIndex:-1}),Fo=t=>{const{classes:o,scroll:s,maxWidth:n,fullWidth:a,fullScreen:r}=t,i={root:["root"],container:["container",`scroll${B(s)}`],paper:["paper",`paperScroll${B(s)}`,`paperWidth${B(String(n))}`,a&&"paperFullWidth",r&&"paperFullScreen"]};return W(i,Io,o)},Lo=w(Ht,{name:"MuiDialog",slot:"Root",overridesResolver:(t,o)=>o.root})({"@media print":{position:"absolute !important"}}),Po=w("div",{name:"MuiDialog",slot:"Container",overridesResolver:(t,o)=>{const{ownerState:s}=t;return[o.container,o[`scroll${B(s.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),Mo=w(et,{name:"MuiDialog",slot:"Paper",overridesResolver:(t,o)=>{const{ownerState:s}=t;return[o.paper,o[`scrollPaper${B(s.scroll)}`],o[`paperWidth${B(String(s.maxWidth))}`],s.fullWidth&&o.paperFullWidth,s.fullScreen&&o.paperFullScreen]}})(E(({theme:t})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:o})=>!o.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:t.breakpoints.unit==="px"?Math.max(t.breakpoints.values.xs,444):`max(${t.breakpoints.values.xs}${t.breakpoints.unit}, 444px)`,[`&.${Fe.paperScrollBody}`]:{[t.breakpoints.down(Math.max(t.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(t.breakpoints.values).filter(o=>o!=="xs").map(o=>({props:{maxWidth:o},style:{maxWidth:`${t.breakpoints.values[o]}${t.breakpoints.unit}`,[`&.${Fe.paperScrollBody}`]:{[t.breakpoints.down(t.breakpoints.values[o]+32*2)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:o})=>o.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:o})=>o.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${Fe.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),Ee=u.forwardRef(function(o,s){const n=z({props:o,name:"MuiDialog"}),a=Je(),r={enter:a.transitions.duration.enteringScreen,exit:a.transitions.duration.leavingScreen},{"aria-describedby":i,"aria-labelledby":l,"aria-modal":c=!0,BackdropComponent:x,BackdropProps:g,children:f,className:m,disableEscapeKeyDown:h=!1,fullScreen:v=!1,fullWidth:S=!1,maxWidth:y="sm",onClick:b,onClose:L,open:k,PaperComponent:A=et,PaperProps:I={},scroll:q="paper",slots:X={},slotProps:M={},TransitionComponent:ne=Ne,transitionDuration:H=r,TransitionProps:me,...ge}=n,D={...n,disableEscapeKeyDown:h,fullScreen:v,fullWidth:S,maxWidth:y,scroll:q},_=Fo(D),V=u.useRef(),Y=ce=>{V.current=ce.target===ce.currentTarget},Lt=ce=>{b&&b(ce),V.current&&(V.current=null,L&&L(ce,"backdropClick"))},ke=qt(l),Pt=u.useMemo(()=>({titleId:ke}),[ke]),Mt={transition:ne,...X},At={transition:me,paper:I,backdrop:g,...M},le={slots:Mt,slotProps:At},[$t,Et]=G("root",{elementType:Lo,shouldForwardComponentProp:!0,externalForwardedProps:le,ownerState:D,className:R(_.root,m),ref:s}),[Dt,Tt]=G("backdrop",{elementType:Ro,shouldForwardComponentProp:!0,externalForwardedProps:le,ownerState:D}),[Bt,Nt]=G("paper",{elementType:Mo,shouldForwardComponentProp:!0,externalForwardedProps:le,ownerState:D,className:R(_.paper,I.className)}),[zt,Wt]=G("container",{elementType:Po,externalForwardedProps:le,ownerState:D,className:R(_.container)}),[Ot,Ut]=G("transition",{elementType:Ne,externalForwardedProps:le,ownerState:D,additionalProps:{appear:!0,in:k,timeout:H,role:"presentation"}});return e.jsx($t,{closeAfterTransition:!0,slots:{backdrop:Dt},slotProps:{backdrop:{transitionDuration:H,as:x,...Tt}},disableEscapeKeyDown:h,onClose:L,open:k,onClick:Lt,...Et,...ge,children:e.jsx(Ot,{...Ut,children:e.jsx(zt,{onMouseDown:Y,...Wt,children:e.jsx(Bt,{as:A,elevation:24,role:"dialog","aria-describedby":i,"aria-labelledby":ke,"aria-modal":c,...Nt,children:e.jsx(ko.Provider,{value:Pt,children:f})})})})})});function Ao(t){return K("MuiFab",t)}const He=U("MuiFab",["root","primary","secondary","extended","circular","focusVisible","disabled","colorInherit","sizeSmall","sizeMedium","sizeLarge","info","error","warning","success"]),$o=t=>{const{color:o,variant:s,classes:n,size:a}=t,r={root:["root",s,`size${B(a)}`,o==="inherit"?"colorInherit":o]},i=W(r,Ao,n);return{...n,...i}},Eo=w(Pe,{name:"MuiFab",slot:"Root",shouldForwardProp:t=>Vt(t)||t==="classes",overridesResolver:(t,o)=>{const{ownerState:s}=t;return[o.root,o[s.variant],o[`size${B(s.size)}`],s.color==="inherit"&&o.colorInherit,o[B(s.size)],o[s.color]]}})(E(({theme:t})=>{var o,s;return{...t.typography.button,minHeight:36,transition:t.transitions.create(["background-color","box-shadow","border-color"],{duration:t.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,zIndex:(t.vars||t).zIndex.fab,boxShadow:(t.vars||t).shadows[6],"&:active":{boxShadow:(t.vars||t).shadows[12]},color:t.vars?t.vars.palette.grey[900]:(s=(o=t.palette).getContrastText)==null?void 0:s.call(o,t.palette.grey[300]),backgroundColor:(t.vars||t).palette.grey[300],"&:hover":{backgroundColor:(t.vars||t).palette.grey.A100,"@media (hover: none)":{backgroundColor:(t.vars||t).palette.grey[300]},textDecoration:"none"},[`&.${He.focusVisible}`]:{boxShadow:(t.vars||t).shadows[6]},variants:[{props:{size:"small"},style:{width:40,height:40}},{props:{size:"medium"},style:{width:48,height:48}},{props:{variant:"extended"},style:{borderRadius:48/2,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48}},{props:{variant:"extended",size:"small"},style:{width:"auto",padding:"0 8px",borderRadius:34/2,minWidth:34,height:34}},{props:{variant:"extended",size:"medium"},style:{width:"auto",padding:"0 16px",borderRadius:40/2,minWidth:40,height:40}},{props:{color:"inherit"},style:{color:"inherit"}}]}}),E(({theme:t})=>({variants:[...Object.entries(t.palette).filter(tt(["dark","contrastText"])).map(([o])=>({props:{color:o},style:{color:(t.vars||t).palette[o].contrastText,backgroundColor:(t.vars||t).palette[o].main,"&:hover":{backgroundColor:(t.vars||t).palette[o].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[o].main}}}}))]})),E(({theme:t})=>({[`&.${He.disabled}`]:{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground}}))),Do=u.forwardRef(function(o,s){const n=z({props:o,name:"MuiFab"}),{children:a,className:r,color:i="default",component:l="button",disabled:c=!1,disableFocusRipple:x=!1,focusVisibleClassName:g,size:f="large",variant:m="circular",...h}=n,v={...n,color:i,component:l,disabled:c,disableFocusRipple:x,size:f,variant:m},S=$o(v);return e.jsx(Eo,{className:R(S.root,r),component:l,disabled:c,focusRipple:!x,focusVisibleClassName:R(S.focusVisible,g),ownerState:v,ref:s,...h,classes:S,children:a})});function To(t){return K("MuiLink",t)}const Bo=U("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),No=({theme:t,ownerState:o})=>{const s=o.color,n=fe(t,`palette.${s}.main`,!1)||fe(t,`palette.${s}`,!1)||o.color,a=fe(t,`palette.${s}.mainChannel`)||fe(t,`palette.${s}Channel`);return"vars"in t&&a?`rgba(${a} / 0.4)`:we(n,.4)},_e={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},zo=t=>{const{classes:o,component:s,focusVisible:n,underline:a}=t,r={root:["root",`underline${B(a)}`,s==="button"&&"button",n&&"focusVisible"]};return W(r,To,o)},Wo=w(p,{name:"MuiLink",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:s}=t;return[o.root,o[`underline${B(s.underline)}`],s.component==="button"&&o.button]}})(E(({theme:t})=>({variants:[{props:{underline:"none"},style:{textDecoration:"none"}},{props:{underline:"hover"},style:{textDecoration:"none","&:hover":{textDecoration:"underline"}}},{props:{underline:"always"},style:{textDecoration:"underline","&:hover":{textDecorationColor:"inherit"}}},{props:({underline:o,ownerState:s})=>o==="always"&&s.color!=="inherit",style:{textDecorationColor:"var(--Link-underlineColor)"}},...Object.entries(t.palette).filter(tt()).map(([o])=>({props:{underline:"always",color:o},style:{"--Link-underlineColor":t.vars?`rgba(${t.vars.palette[o].mainChannel} / 0.4)`:we(t.palette[o].main,.4)}})),{props:{underline:"always",color:"textPrimary"},style:{"--Link-underlineColor":t.vars?`rgba(${t.vars.palette.text.primaryChannel} / 0.4)`:we(t.palette.text.primary,.4)}},{props:{underline:"always",color:"textSecondary"},style:{"--Link-underlineColor":t.vars?`rgba(${t.vars.palette.text.secondaryChannel} / 0.4)`:we(t.palette.text.secondary,.4)}},{props:{underline:"always",color:"textDisabled"},style:{"--Link-underlineColor":(t.vars||t).palette.text.disabled}},{props:{component:"button"},style:{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${Bo.focusVisible}`]:{outline:"auto"}}}]}))),ye=u.forwardRef(function(o,s){const n=z({props:o,name:"MuiLink"}),a=Je(),{className:r,color:i="primary",component:l="a",onBlur:c,onFocus:x,TypographyClasses:g,underline:f="always",variant:m="inherit",sx:h,...v}=n,[S,y]=u.useState(!1),b=I=>{ze(I.target)||y(!1),c&&c(I)},L=I=>{ze(I.target)&&y(!0),x&&x(I)},k={...n,color:i,component:l,focusVisible:S,underline:f,variant:m},A=zo(k);return e.jsx(Wo,{color:i,className:R(A.root,r),classes:g,component:l,onBlur:b,onFocus:L,ref:s,ownerState:k,variant:m,...v,sx:[..._e[i]===void 0?[{color:i}]:[],...Array.isArray(h)?h:[h]],style:{...v.style,...f==="always"&&i!=="inherit"&&!_e[i]&&{"--Link-underlineColor":No({theme:a,ownerState:k})}}})});function Oo(t){return K("MuiListItem",t)}U("MuiListItem",["root","container","dense","alignItemsFlexStart","divider","gutters","padding","secondaryAction"]);const Uo=U("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]);function qo(t){return K("MuiListItemSecondaryAction",t)}U("MuiListItemSecondaryAction",["root","disableGutters"]);const Ho=t=>{const{disableGutters:o,classes:s}=t;return W({root:["root",o&&"disableGutters"]},qo,s)},_o=w("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:s}=t;return[o.root,s.disableGutters&&o.disableGutters]}})({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)",variants:[{props:({ownerState:t})=>t.disableGutters,style:{right:0}}]}),xt=u.forwardRef(function(o,s){const n=z({props:o,name:"MuiListItemSecondaryAction"}),{className:a,...r}=n,i=u.useContext(ae),l={...n,disableGutters:i.disableGutters},c=Ho(l);return e.jsx(_o,{className:R(c.root,a),ownerState:l,ref:s,...r})});xt.muiName="ListItemSecondaryAction";const Vo=(t,o)=>{const{ownerState:s}=t;return[o.root,s.dense&&o.dense,s.alignItems==="flex-start"&&o.alignItemsFlexStart,s.divider&&o.divider,!s.disableGutters&&o.gutters,!s.disablePadding&&o.padding,s.hasSecondaryAction&&o.secondaryAction]},Go=t=>{const{alignItems:o,classes:s,dense:n,disableGutters:a,disablePadding:r,divider:i,hasSecondaryAction:l}=t;return W({root:["root",n&&"dense",!a&&"gutters",!r&&"padding",i&&"divider",o==="flex-start"&&"alignItemsFlexStart",l&&"secondaryAction"],container:["container"]},Oo,s)},Ko=w("div",{name:"MuiListItem",slot:"Root",overridesResolver:Vo})(E(({theme:t})=>({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left",variants:[{props:({ownerState:o})=>!o.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:o})=>!o.disablePadding&&o.dense,style:{paddingTop:4,paddingBottom:4}},{props:({ownerState:o})=>!o.disablePadding&&!o.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:o})=>!o.disablePadding&&!!o.secondaryAction,style:{paddingRight:48}},{props:({ownerState:o})=>!!o.secondaryAction,style:{[`& > .${Uo.root}`]:{paddingRight:48}}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:o})=>o.divider,style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:o})=>o.button,style:{transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}}},{props:({ownerState:o})=>o.hasSecondaryAction,style:{paddingRight:48}}]}))),Qo=w("li",{name:"MuiListItem",slot:"Container",overridesResolver:(t,o)=>o.container})({position:"relative"}),Yo=u.forwardRef(function(o,s){const n=z({props:o,name:"MuiListItem"}),{alignItems:a="center",children:r,className:i,component:l,components:c={},componentsProps:x={},ContainerComponent:g="li",ContainerProps:{className:f,...m}={},dense:h=!1,disableGutters:v=!1,disablePadding:S=!1,divider:y=!1,secondaryAction:b,slotProps:L={},slots:k={},...A}=n,I=u.useContext(ae),q=u.useMemo(()=>({dense:h||I.dense||!1,alignItems:a,disableGutters:v}),[a,I.dense,h,v]),X=u.useRef(null),M=u.Children.toArray(r),ne=M.length&&Gt(M[M.length-1],["ListItemSecondaryAction"]),H={...n,alignItems:a,dense:q.dense,disableGutters:v,disablePadding:S,divider:y,hasSecondaryAction:ne},me=Go(H),ge=Kt(X,s),D=k.root||c.Root||Ko,_=L.root||x.root||{},V={className:R(me.root,_.className,i),...A};let Y=l||"li";return ne?(Y=!V.component&&!l?"div":Y,g==="li"&&(Y==="li"?Y="div":V.component==="li"&&(V.component="div")),e.jsx(ae.Provider,{value:q,children:e.jsxs(Qo,{as:g,className:R(me.container,f),ref:ge,ownerState:H,...m,children:[e.jsx(D,{..._,...!We(D)&&{as:Y,ownerState:{...H,..._.ownerState}},...V,children:M}),M.pop()]})})):e.jsx(ae.Provider,{value:q,children:e.jsxs(D,{..._,as:Y,ref:ge,...!We(D)&&{ownerState:{...H,..._.ownerState}},...V,children:[M,b&&e.jsx(xt,{children:b})]})})}),Zo=t=>{const{alignItems:o,classes:s}=t;return W({root:["root",o==="flex-start"&&"alignItemsFlexStart"]},ro,s)},Xo=w("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:s}=t;return[o.root,s.alignItems==="flex-start"&&o.alignItemsFlexStart]}})(E(({theme:t})=>({minWidth:56,color:(t.vars||t).palette.action.active,flexShrink:0,display:"inline-flex",variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}))),Ce=u.forwardRef(function(o,s){const n=z({props:o,name:"MuiListItemIcon"}),{className:a,...r}=n,i=u.useContext(ae),l={...n,alignItems:i.alignItems},c=Zo(l);return e.jsx(Xo,{className:R(c.root,a),ownerState:l,ref:s,...r})}),Jo=t=>{const{classes:o,inset:s,primary:n,secondary:a,dense:r}=t;return W({root:["root",s&&"inset",r&&"dense",n&&a&&"multiline"],primary:["primary"],secondary:["secondary"]},ao,o)},es=w("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:s}=t;return[{[`& .${ve.primary}`]:o.primary},{[`& .${ve.secondary}`]:o.secondary},o.root,s.inset&&o.inset,s.primary&&s.secondary&&o.multiline,s.dense&&o.dense]}})({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4,[`.${Oe.root}:where(& .${ve.primary})`]:{display:"block"},[`.${Oe.root}:where(& .${ve.secondary})`]:{display:"block"},variants:[{props:({ownerState:t})=>t.primary&&t.secondary,style:{marginTop:6,marginBottom:6}},{props:({ownerState:t})=>t.inset,style:{paddingLeft:56}}]}),ts=u.forwardRef(function(o,s){const n=z({props:o,name:"MuiListItemText"}),{children:a,className:r,disableTypography:i=!1,inset:l=!1,primary:c,primaryTypographyProps:x,secondary:g,secondaryTypographyProps:f,slots:m={},slotProps:h={},...v}=n,{dense:S}=u.useContext(ae);let y=c??a,b=g;const L={...n,disableTypography:i,inset:l,primary:!!y,secondary:!!b,dense:S},k=Jo(L),A={slots:m,slotProps:{primary:x,secondary:f,...h}},[I,q]=G("root",{className:R(k.root,r),elementType:es,externalForwardedProps:{...A,...v},ownerState:L,ref:s}),[X,M]=G("primary",{className:k.primary,elementType:p,externalForwardedProps:A,ownerState:L}),[ne,H]=G("secondary",{className:k.secondary,elementType:p,externalForwardedProps:A,ownerState:L});return y!=null&&y.type!==p&&!i&&(y=e.jsx(X,{variant:S?"body2":"body1",component:M!=null&&M.variant?void 0:"span",...M,children:y})),b!=null&&b.type!==p&&!i&&(b=e.jsx(ne,{variant:"body2",color:"textSecondary",...H,children:b})),e.jsxs(I,{...q,children:[y,b]})});function os(t){return K("MuiToolbar",t)}U("MuiToolbar",["root","gutters","regular","dense"]);const ss=t=>{const{classes:o,disableGutters:s,variant:n}=t;return W({root:["root",!s&&"gutters",n]},os,o)},ns=w("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:s}=t;return[o.root,!s.disableGutters&&o.gutters,o[s.variant]]}})(E(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",variants:[{props:({ownerState:o})=>!o.disableGutters,style:{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}}},{props:{variant:"dense"},style:{minHeight:48}},{props:{variant:"regular"},style:t.mixins.toolbar}]}))),ht=u.forwardRef(function(o,s){const n=z({props:o,name:"MuiToolbar"}),{className:a,component:r="div",disableGutters:i=!1,variant:l="regular",...c}=n,x={...n,component:r,disableGutters:i,variant:l},g=ss(x);return e.jsx(ns,{as:r,className:R(g.root,a),ref:s,ownerState:x,...c})}),Rn=()=>e.jsxs(d,{sx:{position:"absolute",inset:0,pointerEvents:"none"},children:[e.jsx(d,{sx:{bgcolor:"secondary.main",height:"35vh"}}),e.jsx(d,{sx:{height:"100px",backgroundColor:"secondary.main",maskImage:`url("data:image/svg+xml,%3Csvg viewBox='0 0 200 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='white' fill-rule='evenodd' d='M0,0H200V100H0Z M0,0C0,0 100,100 200,0L200,100L0,100Z'/%3E%3C/svg%3E")`,maskRepeat:"repeat-x",maskPosition:"center bottom",maskSize:"auto 100px"}})]}),mt=j(e.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v1c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-1c0-2.66-5.33-4-8-4"})),rs=j([e.jsx("path",{d:"M10.67 13.02c-.22-.01-.44-.02-.67-.02-2.42 0-4.68.67-6.61 1.82-.88.52-1.39 1.5-1.39 2.53V19c0 .55.45 1 1 1h8.26c-.79-1.13-1.26-2.51-1.26-4 0-1.07.25-2.07.67-2.98"},"0"),e.jsx("circle",{cx:"10",cy:"8",r:"4"},"1"),e.jsx("path",{d:"M20.75 16c0-.22-.03-.42-.06-.63l.84-.73c.18-.16.22-.42.1-.63l-.59-1.02c-.12-.21-.37-.3-.59-.22l-1.06.36q-.48-.405-1.08-.63l-.22-1.09c-.05-.23-.25-.4-.49-.4h-1.18c-.24 0-.44.17-.49.4l-.22 1.09q-.6.225-1.08.63l-1.06-.36c-.23-.08-.47.02-.59.22l-.59 1.02c-.12.21-.08.47.1.63l.84.73c-.03.21-.06.41-.06.63s.03.42.06.63l-.84.73c-.18.16-.22.42-.1.63l.59 1.02c.12.21.37.3.59.22l1.06-.36q.48.405 1.08.63l.22 1.09c.05.23.25.4.49.4h1.18c.24 0 .44-.17.49-.4l.22-1.09q.6-.225 1.08-.63l1.06.36c.23.08.47-.02.59-.22l.59-1.02c.12-.21.08-.47-.1-.63l-.84-.73c.03-.21.06-.41.06-.63M17 18c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2"},"2")]),as=j([e.jsx("path",{d:"M5 5h6c.55 0 1-.45 1-1s-.45-1-1-1H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h6c.55 0 1-.45 1-1s-.45-1-1-1H5z"},"0"),e.jsx("path",{d:"m20.65 11.65-2.79-2.79c-.32-.32-.86-.1-.86.35V11h-7c-.55 0-1 .45-1 1s.45 1 1 1h7v1.79c0 .45.54.67.85.35l2.79-2.79c.2-.19.2-.51.01-.7"},"1")]),Ve=j(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 4c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6m0 14c-2.03 0-4.43-.82-6.14-2.88C7.55 15.8 9.68 15 12 15s4.45.8 6.14 2.12C16.43 19.18 14.03 20 12 20"})),gt=j(e.jsx("path",{d:"M10.3 7.7c-.39.39-.39 1.01 0 1.4l1.9 1.9H3c-.55 0-1 .45-1 1s.45 1 1 1h9.2l-1.9 1.9c-.39.39-.39 1.01 0 1.4s1.01.39 1.4 0l3.59-3.59c.39-.39.39-1.02 0-1.41L11.7 7.7a.984.984 0 0 0-1.4 0M20 19h-7c-.55 0-1 .45-1 1s.45 1 1 1h7c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-7c-.55 0-1 .45-1 1s.45 1 1 1h7z"})),is=t=>e.jsx(ie,{variant:"circular",width:"2rem",height:"2rem",animation:"wave",...t}),ft=({name:t,sx:o,...s})=>e.jsx(ut,{sx:{bgcolor:"primary.main",width:"2rem",height:"2rem",...o},...s,children:e.jsx(p,{sx:{translate:"0px 5%"},children:t.slice(0,1).toUpperCase()})}),ls=({showProgress:t})=>e.jsxs(e.Fragment,{children:[e.jsx(ie,{variant:"circular",sx:{position:"absolute",bottom:0,width:1,height:"auto",aspectRatio:1},animation:"wave"}),t&&e.jsx(d,{sx:{position:"absolute",bottom:0,width:1,height:"auto",aspectRatio:1,display:"grid",placeItems:"center"},children:e.jsx(Me,{})})]}),Fn=({size:t=6,borderSize:o=.8})=>{const s=new URLSearchParams(window.location.search),{data:n,isFetching:a}=lt(s.get("user"));return e.jsxs(d,{sx:{display:"flex",justifyContent:"center",position:"relative",width:`${t}rem`,alignSelf:"flex-end",m:2},children:[e.jsx(d,{sx:{position:"absolute",bottom:0,width:1,height:"auto",aspectRatio:1},children:e.jsx(d,{sx:{borderRadius:"50%",position:"absolute",inset:`${-o}rem`,bgcolor:"background.paper",backgroundImage:"var(--Paper-overlay)"}})}),!a&&n?e.jsx(ut,{sx:{position:"absolute",bottom:0,width:1,height:"auto",aspectRatio:1,bgcolor:"primary.main",boxShadow:3},children:e.jsx(p,{variant:"h3",component:"span",sx:{translate:"0px 5%",color:"white"},children:n.name.charAt(0).toUpperCase()})}):e.jsx(ls,{showProgress:a})]})},cs=j(e.jsx("path",{d:"M14.9 3H9.1c-.53 0-1.04.21-1.42.59l-4.1 4.1C3.21 8.06 3 8.57 3 9.1v5.8c0 .53.21 1.04.59 1.41l4.1 4.1c.37.38.88.59 1.41.59h5.8c.53 0 1.04-.21 1.41-.59l4.1-4.1c.38-.37.59-.88.59-1.41V9.1c0-.53-.21-1.04-.59-1.41l-4.1-4.1c-.37-.38-.88-.59-1.41-.59m.64 12.54c-.39.39-1.02.39-1.41 0L12 13.41l-2.12 2.12c-.39.39-1.02.39-1.41 0a.996.996 0 0 1 0-1.41L10.59 12 8.46 9.88a.996.996 0 0 1 0-1.41c.39-.39 1.02-.39 1.41 0L12 10.59l2.12-2.12c.39-.39 1.02-.39 1.41 0s.39 1.02 0 1.41L13.41 12l2.12 2.12c.4.39.4 1.03.01 1.42"})),Le={xs:4,sm:6},vt=4,T=2,Z=1,ds=j(e.jsx("path",{d:"M18 2H9c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h9c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m0 14H9V4h9zM3 15v-2h2v2zm0-5.5h2v2H3zM10 20h2v2h-2zm-7-1.5v-2h2v2zM5 22c-1.1 0-2-.9-2-2h2zm3.5 0h-2v-2h2zm5 0v-2h2c0 1.1-.9 2-2 2M5 6v2H3c0-1.1.9-2 2-2"})),us=j(e.jsx("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m1 14H8c-.55 0-1-.45-1-1s.45-1 1-1h5c.55 0 1 .45 1 1s-.45 1-1 1m3-4H8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1m0-4H8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1"})),ps=ee.object({email:ee.string().trim().email("請輸入有效的電子郵件地址").max(100,"電子郵件地址過長"),username:ee.string().trim().min(4,"使用者名稱至少 4 個字元").max(20,"使用者名稱最多 20 個字元").regex(/^[a-zA-Z0-9 ]+$/,"使用者名稱只能包含英文字母與數字"),description:ee.string().trim().max(40,"個人簡介不可超過 40 個字元")}),Ge=({user:t})=>{const{mutateAsync:o,isPending:s}=Zt(),n=nt({defaultValues:{email:t.email,username:t.name,description:t.description},validators:{onBlur:ps},onSubmit:async({value:r})=>{if(s)return;const{email:i,username:l,description:c}=r,x=await o({userId:t.id,email:i,username:l.trim(),description:c.trim()});if(x.error)return console.error(x.error);if(x.authenticated)return console.log("已成功更新個人資料！")},onSubmitInvalid:()=>{console.error("請檢查表單是否填寫正確")}}),a=async r=>{if(r.preventDefault(),!n.state.canSubmit)return console.error("請檢查表單是否填寫正確");n.handleSubmit()};return e.jsxs(P,{sx:{gap:T},component:"form",onSubmit:a,children:[e.jsxs(d,{sx:{display:"flex",gap:Z,alignItems:"center",color:"text.secondary",mb:Z},children:[e.jsx(us,{}),e.jsx(p,{variant:"h6",sx:{color:"text.primary"},children:"基本資料"})]}),e.jsx(n.Field,{name:"email",children:r=>e.jsx(J,{name:r.name,type:"email",fullWidth:!0,size:"small",variant:"outlined",label:"電子郵件",error:ue(r.state.meta.errors),helperText:de(r.state.meta.errors),value:r.state.value,onChange:i=>r.handleChange(i.target.value),onBlur:r.handleBlur})}),e.jsx(n.Field,{name:"username",children:r=>e.jsx(J,{name:r.name,type:"text",fullWidth:!0,size:"small",variant:"outlined",label:"使用者名稱",error:ue(r.state.meta.errors),helperText:de(r.state.meta.errors),value:r.state.value,onChange:i=>r.handleChange(i.target.value),onBlur:r.handleBlur})}),e.jsxs(d,{sx:{display:"flex",gap:Z,alignItems:"center"},children:[e.jsx(J,{label:"個人檔案網址",value:`${window.location.origin}${F.forum_users}?user=${name}`,variant:"outlined",sx:{flex:1},disabled:!0,size:"small"}),e.jsx(oe,{arrow:!0,placement:"top",title:"複製個人檔案網址到剪貼簿",children:e.jsx(O,{onClick:()=>{const i=`${window.location.origin}${F.forum_users}?user=${t.name}`;navigator.clipboard.writeText(i).then(()=>{console.log("已複製個人檔案網址到剪貼簿！")})},children:e.jsx(ds,{fontSize:"small"})})}),e.jsx(oe,{arrow:!0,placement:"top",title:"在新視窗中開啟個人檔案網址",children:e.jsx(O,{href:`${F.forum_users}?user=${t.name}`,target:"_blank",rel:"noopener noreferrer",children:e.jsx(lo,{fontSize:"small"})})})]}),e.jsx(n.Field,{name:"description",children:r=>e.jsx(J,{name:r.name,type:"text",fullWidth:!0,size:"small",variant:"outlined",label:"個人簡介",placeholder:"(職稱、學校、公司等)",multiline:!0,maxRows:3,error:ue(r.state.meta.errors),helperText:de(r.state.meta.errors),value:r.state.value,onChange:i=>r.handleChange(i.target.value),onBlur:r.handleBlur})}),e.jsxs(d,{sx:{display:"flex",gap:Z,alignItems:"center"},children:[e.jsx(C,{variant:"outlined",sx:{flex:1},onClick:()=>n.reset(),loading:s,children:"重設表單"}),e.jsx(C,{variant:"contained",sx:{flex:1},disableElevation:!0,type:"submit",loading:s,children:"儲存變更"})]})]})},xs=j(e.jsx("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2M9 8V6c0-1.66 1.34-3 3-3s3 1.34 3 3v2z"})),hs=ee.object({currentPassword:ee.string().trim().min(1,"密碼不能為空"),newPassword:ee.string().trim().min(1,"密碼不能為空")}),Ke=({userId:t})=>{const{mutateAsync:o,isPending:s}=Xt(),n=nt({defaultValues:{currentPassword:"",newPassword:""},validators:{onSubmit:hs},onSubmit:async({value:r})=>{if(s)return;const{currentPassword:i,newPassword:l}=r,c=await o({userId:t,currentPassword:i,newPassword:l});if(c.error)return console.error(c.error);if(c.authenticated)return console.log("已成功更密碼！")},onSubmitInvalid:()=>{console.error("請檢查表單是否填寫正確")}}),a=async r=>{if(r.preventDefault(),!n.state.canSubmit)return console.error("請檢查表單是否填寫正確");n.handleSubmit()};return e.jsxs(P,{sx:{gap:T},component:"form",onSubmit:a,children:[e.jsxs(d,{sx:{display:"flex",gap:Z,alignItems:"center",color:"text.secondary",mb:Z},children:[e.jsx(xs,{}),e.jsx(p,{variant:"h6",sx:{color:"text.primary"},children:"修改密碼"})]}),e.jsxs(d,{sx:{display:"flex",gap:Z,alignItems:"center"},children:[e.jsx(n.Field,{name:"currentPassword",children:r=>e.jsx(J,{name:r.name,label:"舊密碼",type:"password",variant:"outlined",fullWidth:!0,size:"small",error:ue(r.state.meta.errors),helperText:de(r.state.meta.errors),value:r.state.value,onChange:i=>r.handleChange(i.target.value),onBlur:r.handleBlur})}),e.jsx(n.Field,{name:"newPassword",children:r=>e.jsx(J,{name:r.name,label:"新密碼",type:"password",variant:"outlined",fullWidth:!0,size:"small",error:ue(r.state.meta.errors),helperText:de(r.state.meta.errors),value:r.state.value,onChange:i=>r.handleChange(i.target.value),onBlur:r.handleBlur})})]}),e.jsx(n.Subscribe,{selector:r=>r.isDirty,children:r=>e.jsx(C,{variant:"contained",type:"submit",disabled:!r,loading:s,disableElevation:!0,sx:{flex:1},children:s?"修改中...":"送出變更"})})]})},Qe=()=>e.jsxs(d,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:vt,width:1},children:[e.jsx(mt,{className:"mode-light",sx:{fontSize:"3rem",bgcolor:"primary.main",borderRadius:1,color:"background.default",p:1}}),e.jsxs(P,{sx:{gap:Z},children:[e.jsx(p,{variant:"h5",children:"帳戶設定"}),e.jsx(p,{variant:"body2",sx:{opacity:.8},children:"在這裡你可以更新個人資料、修改密碼或刪除帳號。"})]})]}),Ye=({userId:t})=>{const[o,s]=u.useState(!1),{mutate:n,isPending:a}=Jt(),r=()=>{n({userId:t})};return e.jsxs(d,{children:[e.jsx(C,{variant:"contained",color:"error",fullWidth:!0,disableElevation:!0,startIcon:e.jsx(cs,{}),onClick:()=>s(!0),children:"刪除帳號"}),e.jsx(p,{variant:"body2",sx:{color:"text.secondary",mt:1},children:"刪除帳號將會永久刪除所有相關資料，無法復原。"}),e.jsx(Ee,{open:o,onClose:()=>!a&&s(!1),maxWidth:"sm",fullWidth:!0,children:e.jsxs(P,{sx:{p:Le,gap:T},children:[e.jsx(p,{variant:"h6",color:"error",children:"確認刪除帳號"}),e.jsx(p,{variant:"body1",children:"你確定要刪除此帳號嗎？此操作將會永久移除你的所有資料，且無法復原。"}),e.jsxs(d,{sx:{display:"flex",gap:vt,justifyContent:"flex-end",mt:2},children:[e.jsx(C,{variant:"outlined",onClick:()=>!a&&s(!1),loading:a,children:"取消"}),e.jsx(C,{variant:"contained",color:"error",onClick:r,loading:a,children:a?"刪除中...":"確認刪除"})]})]})})]})},ms=({onClose:t,user:o,...s})=>{const n=Ie(a=>a.breakpoints.up("md"));return e.jsx(Ee,{onClose:t,maxWidth:"lg",fullWidth:!0,...s,children:e.jsxs(P,{sx:{p:Le,gap:T},children:[e.jsx(d,{sx:{position:"absolute",inset:"0 0 auto auto",zIndex:1},children:e.jsx(O,{onClick:a=>t&&t(a,"backdropClick"),sx:{m:T},children:e.jsx(xe,{})})}),n?e.jsxs(e.Fragment,{children:[e.jsx(Qe,{}),e.jsx($,{flexItem:!0,sx:{mt:T}}),e.jsxs(d,{sx:{display:"flex",gap:Le,width:1,alignItems:"stretch"},children:[e.jsx(P,{sx:{gap:T,flex:1},children:e.jsx(Ge,{user:o})}),e.jsxs(P,{sx:{gap:T,flex:1,justifyContent:"space-between"},children:[e.jsxs(d,{children:[e.jsx(Ke,{userId:o.id}),e.jsx($,{flexItem:!0,sx:{mt:T}})]}),e.jsx(Ye,{userId:o.id})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Qe,{}),e.jsx($,{flexItem:!0,sx:{mt:T}}),e.jsx(Ge,{user:o}),e.jsx($,{flexItem:!0}),e.jsx(Ke,{userId:o.id}),e.jsx($,{flexItem:!0,sx:{mb:T}}),e.jsx(Ye,{userId:o.id})]})]})})},yt=({onItemClick:t,user:o})=>{const{mutate:s,isPending:n}=eo(),a=()=>{s(),t()},[r,i]=u.useState(!1),l=()=>i(!0),c=()=>{i(!1),t()};return e.jsxs(Qt,{dense:!0,children:[e.jsxs(Re,{href:`${F.forum_users}?user=${o.name}`,component:"a",children:[e.jsx(Ce,{children:e.jsx(mt,{})}),"個人檔案"]}),e.jsxs(Re,{onClick:l,className:"account-settings-button",children:[e.jsx(Ce,{children:e.jsx(rs,{})}),"設定"]}),e.jsx(ms,{open:r,user:{email:"",...o},onClose:c}),e.jsx($,{}),e.jsxs(Re,{onClick:a,disabled:n,children:[e.jsx(Ce,{children:e.jsx(as,{})}),n?"登出中...":"登出"]})]})},gs=()=>{const{user:t,loading:o,authenticated:s}=Q(),[n,a]=u.useState(null),r=l=>a(n?null:l.currentTarget),i=()=>a(null);return o?e.jsx(C,{variant:"outlined",color:"inherit",startIcon:e.jsx(Ve,{}),disabled:!0,loading:o,children:"Loading"}):e.jsxs(e.Fragment,{children:[s?e.jsx(C,{variant:"outlined",color:"inherit",startIcon:e.jsx(Ve,{}),onClick:r,children:t.name}):e.jsx(C,{variant:"outlined",color:"inherit",startIcon:e.jsx(gt,{}),href:F.forum_login,children:"登入"}),s&&e.jsx(ot,{anchorEl:n,anchorOrigin:{horizontal:"center",vertical:"bottom"},transformOrigin:{horizontal:"center",vertical:"top"},open:!!n,onClose:i,keepMounted:!0,children:e.jsx(yt,{onItemClick:i,user:t})})]})},fs=w("div")(({theme:t})=>({height:30,width:6,backgroundColor:t.palette.divider,borderRadius:3,position:"absolute",left:8,top:"calc(50% - 15px)",...t.applyStyles("dark",{backgroundColor:t.palette.divider})})),vs=()=>{const{user:t,loading:o,authenticated:s}=Q(),[n,a]=u.useState(!1),r=()=>a(!0),i=()=>a(!1);return o?e.jsx(te,{showLabel:!0,label:"帳戶",icon:e.jsx(Me,{size:"2rem"})}):e.jsxs(e.Fragment,{children:[s?e.jsx(te,{showLabel:!0,label:t.name,onClick:r,icon:e.jsx(ft,{name:t.name,sx:{color:"primary.contrastText"}})}):e.jsx(te,{showLabel:!0,label:"登入",icon:e.jsx(gt,{}),href:F.forum_login}),s&&e.jsxs(Ae,{anchor:"right",open:n,onClose:i,onOpen:r,slotProps:{paper:{sx:{width:240}}},keepMounted:!0,children:[e.jsx(fs,{}),e.jsxs(d,{sx:{p:3,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(p,{variant:"h6",children:"帳戶"}),e.jsx(O,{onClick:i,children:e.jsx(xe,{})})]}),e.jsx(yt,{onItemClick:i,user:t})]})]})},ys=F.forum_search,bs="?all=",js=()=>{const[t,o]=u.useState(""),s=r=>o(r.target.value),n=ys+bs+t,a=({key:r})=>{if(r==="Enter"){if(!t.trim())return console.error("請輸入搜尋內容");window.location.href=n}};return e.jsx(J,{variant:"filled",label:"搜尋",placeholder:"使用者 / 貼文",size:"small",sx:{minWidth:150,width:1,maxWidth:800},value:t,onChange:s,onKeyDown:a,slotProps:{input:{endAdornment:e.jsx(oe,{title:t.trim()?"搜尋":"請輸入搜尋內容",arrow:!0,children:e.jsx(no,{position:"end",children:e.jsx(O,{edge:"end",href:n,disabled:!t.trim(),children:e.jsx(at,{})})})})}}})},ws=j(e.jsx("path",{d:"M18 12c0 .55.45 1 1 1h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1m-1.41 4.82c-.33.44-.24 1.05.2 1.37.53.39 1.09.81 1.62 1.21.44.33 1.06.24 1.38-.2 0-.01.01-.01.01-.02.33-.44.24-1.06-.2-1.38-.53-.4-1.09-.82-1.61-1.21-.44-.33-1.06-.23-1.39.21 0 .01-.01.02-.01.02m3.22-12.01c0-.01-.01-.01-.01-.02-.33-.44-.95-.53-1.38-.2-.53.4-1.1.82-1.62 1.22-.44.33-.52.95-.19 1.38 0 .01.01.01.01.02.33.44.94.53 1.38.2.53-.39 1.09-.82 1.62-1.22.43-.32.51-.94.19-1.38M8 9H4c-1.1 0-2 .9-2 2v2c0 1.1.9 2 2 2h1v3c0 .55.45 1 1 1s1-.45 1-1v-3h1l5 3V6zm7.5 3c0-1.33-.58-2.53-1.5-3.35v6.69c.92-.81 1.5-2.01 1.5-3.34"})),Ss=[{id:1,title:"歡迎加入 論壇樣板！",content:"感謝您加入論壇樣板，希望您在這裡能找到有趣的討論。"},{id:2,title:"預計維護公告",content:"論壇樣板將於下週四的 10:00 AM 進行系統維護，預計需 2 小時。"},{id:3,title:"新留言通知",content:"您的貼文 'React 18 的並發模式值得升級嗎？' 有新留言。"}],Cs=async()=>(await new Promise(t=>setTimeout(()=>t(),Math.random()*1e3)),Ss),Is=1e3*60*5,De=()=>se({queryKey:["notifications"],queryFn:Cs,staleTime:Is}),bt=t=>{const{data:o}=De(),s=o??[];return e.jsx(Yt,{dense:!0,...t,children:s.map((n,a)=>e.jsxs(u.Fragment,{children:[e.jsxs(Yo,{alignItems:"flex-start",children:[e.jsx(Ce,{children:e.jsx(ws,{})}),e.jsx(ts,{primary:n.title,secondary:n.content})]},n.id),a<s.length-1&&e.jsx($,{component:"li"})]},n.id))})},ks=()=>{const{data:t,isFetching:o}=De(),[s,n]=u.useState(null),a=()=>n(null),r=i=>n(s?null:i.currentTarget);return e.jsxs(e.Fragment,{children:[e.jsx(oe,{title:"通知",arrow:!0,children:e.jsx("span",{children:e.jsx(O,{onClick:r,loading:o||!t,children:e.jsx(ct,{badgeContent:t==null?void 0:t.length,color:"primary",children:e.jsx(dt,{fontSize:"small"})})})})}),e.jsx(ot,{anchorEl:s,open:!!s,onClose:a,anchorOrigin:{horizontal:"center",vertical:"bottom"},transformOrigin:{horizontal:"center",vertical:"top"},children:e.jsx(bt,{sx:{maxWidth:320}})})]})},Rs=w("div")(({theme:t})=>({height:30,width:6,backgroundColor:t.palette.divider,borderRadius:3,position:"absolute",right:8,top:"calc(50% - 15px)",...t.applyStyles("dark",{backgroundColor:t.palette.divider})})),Fs=()=>{const{data:t,isFetching:o}=De(),[s,n]=u.useState(!1),a=()=>n(!1),r=()=>n(!0);return e.jsxs(e.Fragment,{children:[e.jsx(te,{showLabel:!0,label:"通知",onClick:r,disabled:o||!t,icon:e.jsx(ct,{badgeContent:(t==null?void 0:t.length)||0,color:"primary",children:e.jsx(dt,{})})}),e.jsxs(Ae,{anchor:"left",open:s,onClose:a,onOpen:r,children:[e.jsx(Rs,{}),e.jsxs(d,{sx:{p:3,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(p,{variant:"h6",children:"通知"}),e.jsx(O,{onClick:a,children:e.jsx(xe,{})})]}),e.jsx(bt,{})]})]})},Ls=j(e.jsx("path",{d:"M17 20H5c-.55 0-1-.45-1-1V7c0-.55-.45-1-1-1s-1 .45-1 1v13c0 1.1.9 2 2 2h13c.55 0 1-.45 1-1s-.45-1-1-1m3-18H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m0 10-2.5-1.5L15 12V4h5z"})),Ps=async({postId:t,userId:o})=>{const s=`
      SELECT 1 as liked
      FROM post_interactions
      WHERE postId = $postId
        AND userId = $userId
        AND type = 'like'
      LIMIT 1
    `,n=`
      SELECT COALESCE(likeCount, 0) as likeCount
      FROM post_interaction_counts
      WHERE postId = $postId
    `,a=await N.exec(s,{$postId:t,$userId:o}),r=await N.exec(n,{$postId:t}),i=a.length>0;return!r[0]||!Number.isInteger(r[0].likeCount)?null:{liked:i,likeCount:r[0].likeCount}},Ms=async({postId:t,userId:o})=>({fav:(await N.exec(`
      SELECT 1 as fav
      FROM post_interactions
      WHERE postId = $postId
        AND userId = $userId
        AND type = 'favorite'
      LIMIT 1
    `,{$postId:t,$userId:o})).length>0}),As=async({postId:t,userId:o,type:s,value:n})=>{n?await N.exec(`
        INSERT OR IGNORE INTO post_interactions (userId, postId, type)
        VALUES ($userId, $postId, $type)
      `,{$userId:o,$postId:t,$type:s}):await N.exec(`
        DELETE FROM post_interactions
        WHERE userId = $userId
          AND postId = $postId
          AND type = $type
      `,{$userId:o,$postId:t,$type:s})},$s=async({userId:t})=>(await N.exec(`
    SELECT postId
    FROM post_interactions
    WHERE userId = $userId
      AND type = 'favorite'
    ORDER BY createdAt DESC
  `,{$userId:t})).map(n=>n.postId),Te=0,jt=(t,o,s)=>{const n=he(),a=u.useRef(0);return it({mutationFn:r=>{if(o===void 0)throw new Error("未登錄");return As({postId:t,userId:o,type:s,value:r})},onMutate:()=>(a.current++,a.current),onSettled:(r,i,l,c)=>{if(c===a.current){const x=s==="like"?["likeStatus",t,o]:["favoriteStatus",t,o];n.invalidateQueries({queryKey:x})}},onError:()=>{console.error(`${s==="like"?"按讚":"收藏"}操作失敗`)}})},Ln=t=>{const o=he(),{user:s,authenticated:n,loading:a}=Q(),{data:r}=se({staleTime:Te,queryKey:["likeStatus",t,s==null?void 0:s.id],enabled:!a&&n&&(s==null?void 0:s.id)!==void 0,queryFn:async()=>Ps({postId:t,userId:s.id})}),i=!n||a||r===void 0||r===null,l=(r==null?void 0:r.liked)??!1,c=(r==null?void 0:r.likeCount)??null,{mutate:x}=jt(t,s==null?void 0:s.id,"like");return{liked:l,likeCount:c,handleLike:async()=>{i||(await o.cancelQueries({queryKey:["likeStatus",t,s.id]}),o.setQueryData(["likeStatus",t,s.id],f=>{const m=!f.liked;return x(m),{liked:m,likeCount:f.likeCount+(m?1:-1)}}))},disabled:i}},wt=t=>{const o=he(),{user:s,authenticated:n,loading:a}=Q(),{data:r,isLoading:i}=se({staleTime:Te,queryKey:["favoriteStatus",t,s==null?void 0:s.id],enabled:!a&&n&&(s==null?void 0:s.id)!==void 0,queryFn:async()=>Ms({postId:t,userId:s.id})}),l=a||i,c=!n||a||r===void 0||r===null,x=(r==null?void 0:r.fav)??!1,{mutate:g}=jt(t,s==null?void 0:s.id,"favorite");return{isFavorited:x,handleFavorite:async()=>{c||(await o.cancelQueries({queryKey:["favoriteStatus",t,s.id]}),o.setQueryData(["favoriteStatus",t,s.id],m=>{const h=!m.fav;return g(h),{fav:h}}))},disabled:c,loading:l}},Es=()=>{const{user:t,authenticated:o,loading:s}=Q(),{data:n,isFetching:a}=se({staleTime:Te,queryKey:["favoritePosts",t==null?void 0:t.id],queryFn:()=>$s({userId:t.id}),enabled:!s&&o&&(t==null?void 0:t.id)!==void 0});return{data:n,loading:s||a||n===void 0}},Ds=async({userId:t})=>{const s=await N.exec(`
      SELECT u.id, u.name, u.description
      FROM user_interactions ui
      JOIN users u ON ui.followeeId = u.id
      WHERE ui.followerId = $userId
        AND ui.type = 'follow'
      ORDER BY ui.createdAt DESC
    `,{$userId:t});return!s||s.length===0?null:s.map(n=>({id:n.id,name:n.name,description:n.description}))},Ts=async({userId:t})=>{const s=await N.exec(`
      SELECT u.id, u.name, u.description
      FROM user_interactions ui
      JOIN users u ON ui.followerId = u.id
      WHERE ui.followeeId = $userId
        AND ui.type = 'follow'
      ORDER BY ui.createdAt DESC
    `,{$userId:t});return!s||s.length===0?null:s.map(n=>({id:n.id,name:n.name,description:n.description}))},Bs=async({followerId:t,followeeId:o,value:s})=>{if(t===o)throw new Error("使用者不能追蹤自己");s?await N.exec(`
          INSERT OR IGNORE INTO user_interactions (followerId, followeeId, type)
          VALUES ($followerId, $followeeId, 'follow')
        `,{$followerId:t,$followeeId:o}):await N.exec(`
          DELETE FROM user_interactions
          WHERE followerId = $followerId
            AND followeeId = $followeeId
            AND type = 'follow'
        `,{$followerId:t,$followeeId:o})},Ns=async({targetId:t,userId:o})=>({follow:(await N.exec(`
      SELECT 1 as follow
      FROM user_interactions
      WHERE followerId = $userId
        AND followeeId = $targetId
        AND type = 'follow'
      LIMIT 1
    `,{$userId:o,$targetId:t})).length>0}),Be=0,zs=(t,o)=>{const s=he(),n=u.useRef(0);return it({mutationFn:a=>{if(o===void 0)throw new Error("未登錄");return Bs({followerId:o,followeeId:t,value:a})},onMutate:()=>(n.current++,n.current),onSettled:(a,r,i,l)=>{if(l===n.current){const c=["userFollow",t,o];s.invalidateQueries({queryKey:c})}},onError:()=>{console.error("追蹤操作失敗")}})},St=t=>{const o=he(),{user:s,authenticated:n,loading:a}=Q(),{data:r,isFetching:i}=se({staleTime:Be,queryKey:["userFollow",t,s==null?void 0:s.id],enabled:!a&&n&&(s==null?void 0:s.id)!==void 0,queryFn:async()=>Ns({targetId:t,userId:s.id})}),l=a||i,c=!n||r===void 0||t===(s==null?void 0:s.id),x=(r==null?void 0:r.follow)??!1,g=t===(s==null?void 0:s.id),{mutate:f}=zs(t,s==null?void 0:s.id);return{isFollowed:x,handleFollow:async()=>{c||(await o.cancelQueries({queryKey:["userFollow",t,s.id]}),o.setQueryData(["userFollow",t,s.id],h=>{const v=!h.follow;return f(v),{follow:v}}))},disabled:c,loading:l,isSelf:g}},Pn=({userId:t})=>se({queryKey:["userFollowers",t],queryFn:()=>Ts({userId:t}),staleTime:Be}),Ws=({userId:t})=>se({queryKey:["userFollowing",t],queryFn:()=>Ds({userId:t}),staleTime:Be}),Ct=()=>e.jsxs(d,{sx:{p:1.5,outline:"1px solid",outlineColor:"divider",borderRadius:1},children:[e.jsx(d,{sx:{display:"flex",gap:1.5,mb:2,alignItems:"center"},children:e.jsx(ie,{variant:"rounded",animation:"wave",children:e.jsx(p,{variant:"body2",children:"by loading..."})})}),e.jsx(ie,{variant:"rounded",animation:"wave",children:e.jsx(p,{variant:"subtitle1",component:"h6",sx:{textAlign:"start"},children:"正在載入標題..."})})]}),Os=({postId:t,action:o})=>{const{data:s,isFetching:n}=to({postId:t});if(n||!s)return e.jsx(Ct,{});const a=()=>{window.location.href=`${F.forum_post}?postId=${s.id}`};return e.jsxs(d,{sx:{p:1.5,outline:"1px solid",outlineColor:"divider",borderRadius:1,cursor:"pointer","&:hover":{bgcolor:"action.hover"}},onClick:a,children:[e.jsxs(d,{sx:{display:"flex",gap:1.5,mb:2,alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(p,{variant:"body2",component:"a",href:`${F.forum_users}?user=${s.userName}`,sx:{color:"text.secondary",textDecoration:"none","&:hover":{textDecoration:"underline",color:"text.primary"}},children:["by ",s.userName]}),e.jsx(d,{sx:{color:"text.secondary"},children:o})]}),e.jsx(p,{variant:"subtitle1",component:"h6",sx:{textAlign:"start",display:"-webkit-box",WebkitLineClamp:1,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",width:.7},children:s.title})]})},Us=j(e.jsx("path",{d:"M10 20h4c0 1.1-.9 2-2 2s-2-.9-2-2m4-11c0 2.61 1.67 4.83 4 5.66V17h1c.55 0 1 .45 1 1s-.45 1-1 1H5c-.55 0-1-.45-1-1s.45-1 1-1h1v-7c0-2.79 1.91-5.14 4.5-5.8v-.7c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5v.7c.71.18 1.36.49 1.95.9C14.54 6.14 14 7.51 14 9m9-1h-2V6c0-.55-.45-1-1-1s-1 .45-1 1v2h-2c-.55 0-1 .45-1 1s.45 1 1 1h2v2c0 .55.45 1 1 1s1-.45 1-1v-2h2c.55 0 1-.45 1-1s-.45-1-1-1"})),qs=j(e.jsx("path",{d:"M14 11c0 .55-.45 1-1 1H4c-.55 0-1-.45-1-1s.45-1 1-1h9c.55 0 1 .45 1 1M3 7c0 .55.45 1 1 1h9c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1m7 8c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1h5c.55 0 1-.45 1-1m8.01-2.13.71-.71c.39-.39 1.02-.39 1.41 0l.71.71c.39.39.39 1.02 0 1.41l-.71.71zm-.71.71-5.16 5.16c-.09.09-.14.21-.14.35v1.41c0 .28.22.5.5.5h1.41c.13 0 .26-.05.35-.15l5.16-5.16z"})),pe={variant:"contained",color:"primary",size:"large",startIcon:e.jsx(Us,{})},re={borderRadius:99,transition:"all 0.2s ease",boxShadow:3,scale:"1.001"},Hs=({targetId:t})=>{const{isFollowed:o,handleFollow:s,disabled:n,loading:a,isSelf:r}=St(t);return r?e.jsx(C,{variant:"contained",color:"primary",size:"large",startIcon:e.jsx(qs,{}),sx:{...re,"&:hover":{bgcolor:"primary.main",scale:"1.05",boxShadow:3},"&:active":{scale:"0.95"}},onClick:()=>{const i=document.querySelector(".account-settings-button");i&&i.click()},children:"編輯個人資料"}):n?e.jsx(C,{...pe,disabled:!0,sx:re,children:"追蹤"}):a?e.jsx(C,{...pe,loading:!0,sx:re,children:"追蹤"}):e.jsx(C,{...pe,onClick:s,sx:{...re,"&:hover":{bgcolor:"primary.main",scale:"1.05",boxShadow:3},"&:active":{scale:"0.95"}},children:o?"已追蹤":"追蹤"})},Mn=()=>{const t=new URLSearchParams(window.location.search),{data:o,isFetching:s}=lt(t.get("user"));return!s&&o===null?e.jsx(C,{...pe,disabled:!0,sx:re,children:"追蹤"}):s||!o?e.jsx(C,{...pe,loading:!0,sx:re,children:"追蹤"}):e.jsx(Hs,{targetId:o.id})},_s=({targetId:t})=>{const{isFollowed:o,handleFollow:s,disabled:n,loading:a}=St(t);return a?e.jsx(Se,{variant:"outlined",clickable:!0,disabled:!0,label:e.jsx(Me,{size:"1rem"})}):n?e.jsx(Se,{variant:"outlined",label:"追蹤",clickable:!0,disabled:!0}):e.jsx(Se,{variant:"outlined",label:o?"已追蹤":"追蹤",clickable:!0,onClick:s,color:o?"primary":"default"})},Vs=()=>e.jsxs(e.Fragment,{children:[e.jsx(is,{}),e.jsxs(d,{children:[e.jsx(ie,{variant:"rounded",animation:"wave",children:e.jsx(p,{variant:"subtitle1",sx:{textWrap:"nowrap",color:"text.primary",cursor:"pointer",textDecoration:"none","&:hover":{textDecoration:"underline"}},children:"作者名稱"})}),e.jsx(ie,{variant:"text",animation:"wave",children:e.jsx(p,{variant:"body2",component:"p",sx:{color:"text.secondary"},children:"作者描述載入中..."})})]}),e.jsx(Se,{variant:"outlined",label:"追蹤",clickable:!0,disabled:!0})]}),Gs={display:"-webkit-box",WebkitLineClamp:1,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},Ks=({id:t,name:o,description:s,ellipsis:n})=>e.jsxs(e.Fragment,{children:[e.jsx(ft,{name:o}),e.jsxs(d,{children:[e.jsx(p,{variant:"subtitle1",sx:{textWrap:"nowrap",color:"text.primary",cursor:"pointer",textDecoration:"none","&:hover":{textDecoration:"underline"}},component:"a",href:`${F.forum_users}?user=${o}`,children:o}),e.jsx(p,{variant:"body2",component:"p",sx:{color:"text.secondary",...n&&Gs},children:s||"這個使用者很懶，什麼都沒寫"})]}),e.jsx(_s,{targetId:t})]}),It=j(e.jsx("path",{d:"M21 6c0 .55-.45 1-1 1h-1v1c0 .55-.45 1-1 1s-1-.45-1-1V7h-1c-.55 0-1-.45-1-1s.45-1 1-1h1V4c0-.55.45-1 1-1s1 .45 1 1v1h1c.55 0 1 .45 1 1m-2 13.48c0 .72-.73 1.2-1.39.92L12 18l-5.61 2.4c-.66.29-1.39-.2-1.39-.92V5c0-1.1.9-2 2-2h7c-.63.84-1 1.87-1 3 0 2.76 2.24 5 5 5 .34 0 .68-.03 1-.1z"})),kt=j(e.jsx("path",{d:"M21 6c0 .55-.45 1-1 1h-4c-.55 0-1-.45-1-1s.45-1 1-1h4c.55 0 1 .45 1 1m-2 4.9c-.32.07-.66.1-1 .1-2.76 0-5-2.24-5-5 0-1.13.37-2.16 1-3H7c-1.1 0-2 .9-2 2v14.48c0 .72.73 1.2 1.39.92L12 18l5.61 2.4c.66.28 1.39-.2 1.39-.92z"})),An=({postId:t})=>{const o=Ie(r=>r.breakpoints.down("sm")),{isFavorited:s,handleFavorite:n,disabled:a}=wt(t);return e.jsx(C,{color:s?"primary":"inherit",startIcon:s?e.jsx(kt,{}):e.jsx(It,{}),size:"small",onClick:n,disabled:a,children:e.jsx(p,{variant:"caption",component:"span",children:o?s?"取消":"收藏":s?"取消收藏":"收藏該貼文"})})},Qs=({postId:t})=>{const{isFavorited:o,handleFavorite:s,disabled:n,loading:a}=wt(t),r=i=>{i.preventDefault(),i.stopPropagation(),s()};return e.jsx(C,{size:"small",color:"inherit",startIcon:o?e.jsx(kt,{}):e.jsx(It,{}),onClick:r,disabled:n,loading:a,variant:o?"text":"outlined",children:o?"取消收藏":"收藏該貼文"})},Ze={position:"relative",display:"grid",gridTemplateColumns:{xs:"auto 1fr auto",sm:"auto 1fr auto auto 1fr auto"},alignItems:"center",gap:2,"& > *:nth-of-type(6n - 3)":{"&::after":{content:'""',position:"absolute",display:{xs:"none",sm:"block"},inset:0,pointerEvents:"none",borderRight:"1px solid",borderColor:"divider",mr:-1,my:-2.1}}},Ys=({userId:t})=>{const{data:o,isFetching:s}=Ws({userId:t});return s?e.jsx(d,{sx:Ze,children:[...Array(4)].map((n,a)=>e.jsx(Vs,{},a))}):!o||o.length===0?e.jsx(d,{children:e.jsx(p,{variant:"subtitle2",color:"text.secondary",align:"center",children:"你還沒追蹤任何使用者"})}):e.jsx(d,{sx:Ze,children:o.map(n=>e.jsx(Ks,{...n,ellipsis:!0},n.id))})},Xe={display:"grid",gridTemplateColumns:{xs:"1fr",md:"repeat(2, 1fr)"},gap:1,"& > *:nth-of-type(4n+2), & > *:nth-of-type(4n+3)":{bgcolor:{xs:"",md:"action.hover"}}},Zs=()=>{const{data:t,loading:o}=Es();return o?e.jsx(d,{sx:Xe,children:[...Array(4)].map((s,n)=>e.jsx(Ct,{},n))}):!t||t.length===0?e.jsx(d,{sx:{m:3},children:e.jsx(p,{variant:"subtitle2",color:"text.secondary",align:"center",children:"你尚未收藏任何貼文"})}):e.jsx(d,{sx:Xe,children:t.map(s=>e.jsx(d,{sx:{position:"relative"},children:e.jsx(Os,{postId:s,action:e.jsx(Qs,{postId:s})})},s))})},Rt=()=>{const{user:t}=Q(),[o,s]=u.useState(!0),[n,a]=u.useState(!0),r=()=>s(!o),i=()=>a(!n);return e.jsxs(P,{children:[e.jsxs(d,{sx:{bgcolor:"action.hover",cursor:"pointer"},onClick:r,children:[e.jsx($,{}),e.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",px:3,py:1},children:[e.jsx(p,{variant:"subtitle1",children:"追蹤的使用者"}),e.jsx(Ue,{sx:{transform:o?"rotate(180deg)":"",transition:"all 0.2s ease"}})]}),e.jsx($,{})]}),e.jsx(qe,{in:o,children:e.jsx(d,{sx:{px:3,py:2},children:t?e.jsx(Ys,{userId:t.id}):e.jsx(d,{children:e.jsx(p,{variant:"subtitle2",color:"error",align:"center",children:"出了點問題，請稍後再試"})})})}),e.jsxs(d,{sx:{bgcolor:"action.hover",cursor:"pointer"},onClick:i,children:[e.jsx($,{}),e.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",px:3,py:1},children:[e.jsx(p,{variant:"subtitle1",children:"收藏的貼文"}),e.jsx(Ue,{sx:{transform:n?"rotate(180deg)":"",transition:"all 0.2s ease"}})]}),e.jsx($,{})]}),e.jsx(qe,{in:n,children:e.jsx(d,{sx:{px:3,py:2},children:e.jsx(Zs,{})})})]})},Xs=()=>{const{authenticated:t,loading:o}=Q(),[s,n]=u.useState(!1),a=()=>n(!0),r=()=>n(!1);return e.jsxs(e.Fragment,{children:[e.jsx(oe,{title:"收藏與追蹤",arrow:!0,children:e.jsx("span",{children:e.jsx(O,{onClick:a,disabled:!t,loading:o,children:e.jsx(rt,{fontSize:"small"})})})}),e.jsxs(Ee,{open:s,onClose:r,maxWidth:"md",fullWidth:!0,children:[e.jsxs(d,{sx:{position:"relative",display:"flex",gap:1,alignItems:"center",p:2,bgcolor:"background.paper",borderBottom:"1px solid",borderColor:"divider"},children:[e.jsx(d,{sx:{position:"absolute",inset:0,bgcolor:"action.hover"}}),e.jsx(Ls,{className:"mode-light",sx:{fontSize:48,mr:1,bgcolor:"primary.main",borderRadius:1,color:"background.default",p:1}}),e.jsx(p,{variant:"h6",component:"h2",sx:{color:"text.primary"},children:"收藏與追蹤"}),e.jsx(d,{sx:{flex:1}}),e.jsx(oe,{title:"關閉",arrow:!0,children:e.jsx(O,{onClick:r,children:e.jsx(xe,{})})})]}),e.jsx(Rt,{})]})]})},Js=w("div")(({theme:t})=>({height:6,width:30,backgroundColor:t.palette.divider,borderRadius:3,position:"absolute",top:8,left:"calc(50% - 15px)",...t.applyStyles("dark",{backgroundColor:t.palette.divider})})),en=()=>{const{authenticated:t,loading:o}=Q(),[s,n]=u.useState(!1),a=()=>n(!0),r=()=>n(!1);return e.jsxs(e.Fragment,{children:[e.jsx(te,{showLabel:!0,label:o?"載入中...":"收藏",icon:e.jsx(rt,{}),disabled:!t||o,onClick:a}),e.jsxs(Ae,{anchor:"bottom",open:s,onClose:r,onOpen:a,children:[e.jsx(Js,{}),e.jsxs(d,{sx:{p:2},children:[e.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[e.jsx(p,{variant:"h6",component:"h2",children:"收藏與追蹤"}),e.jsx(O,{onClick:r,children:e.jsx(xe,{})})]}),e.jsx(Rt,{})]})]})]})},tn=()=>e.jsx(oe,{title:"返回首頁",arrow:!0,children:e.jsxs(Pe,{href:F.forum_home,sx:{display:"flex",gap:1.5,alignItems:"center",justifyContent:"center",borderRadius:1,p:1,"&:hover":{bgcolor:"divider"},"&:active":{scale:"0.95"},transition:"all 0.2s ease-in-out"},children:[e.jsx(st,{fontSize:"large",color:"primary"}),e.jsx(p,{variant:"h4",component:"h1",sx:{fontFamily:'"timemachine-wa"'},children:"論壇樣板"})]})}),on={position:"sticky",top:0,zIndex:"appBar",bgcolor:"secondary.main",borderBottom:"solid 1px #fff2",boxShadow:3,".top &":{boxShadow:"none"},transition:"all 0.2s ease-in-out"},$n=({sx:t,...o})=>e.jsx(ht,{className:"mode-dark",disableGutters:!0,sx:{...on,...t},...o,children:e.jsxs($e,{sx:{display:"flex",alignItems:"center",gap:1,color:"text.primary"},maxWidth:!1,children:[e.jsx(d,{sx:{display:"flex",justifyContent:"flex-start",flex:{xs:void 0,md:1}},children:e.jsx(tn,{})}),e.jsx(d,{sx:{display:"flex",alignItems:"center",justifyContent:"center",flex:1},children:e.jsx(js,{})}),e.jsxs(d,{sx:{display:"flex",gap:1,alignItems:"center",justifyContent:"flex-end",flex:1},children:[e.jsx(oo,{}),e.jsx(Xs,{}),e.jsx(ks,{}),e.jsx(gs,{})]})]})}),sn=j(e.jsx("path",{d:"M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1"})),nn={position:"sticky",top:0,zIndex:"appBar",bgcolor:"secondary.main",borderBottom:"solid 1px #fff2",boxShadow:3,".top &":{boxShadow:"none"},transition:"all 0.2s ease-in-out"},rn={position:"fixed",inset:"auto 0 0 0",zIndex:"appBar",bgcolor:"secondary.main",borderTop:"solid 1px #fff2",boxShadow:3},En=({sx:t,...o})=>{const[s,n]=u.useState(!1),a=()=>n(!0),r=()=>n(!1),i=u.useRef(null);return u.useEffect(()=>{if(!i.current)return;const l=document.getElementById("scroll-area");if(!l)return;const c=i.current.clientHeight;return l.style.paddingBottom=`${c}px`,()=>{l.style.paddingBottom="0px"}},[i]),e.jsxs(e.Fragment,{children:[e.jsx(ht,{className:"mode-dark",disableGutters:!0,sx:{...nn,...t},...o,children:e.jsxs($e,{sx:{display:"flex",alignItems:"center",gap:1,color:"text.primary"},maxWidth:"xl",children:[e.jsxs(d,{sx:{display:"flex",gap:1,alignItems:"center",flex:1},children:[e.jsx(st,{fontSize:"large",color:"primary"}),e.jsx(p,{variant:"h4",component:"h1",sx:{mr:1,fontFamily:'"timemachine-wa"'},children:"論壇樣板"})]}),e.jsx(C,{href:F.forum_search,startIcon:e.jsx(at,{}),variant:"outlined",color:"inherit",size:"large",children:"搜尋"})]})}),e.jsxs(bo,{className:"mode-dark",value:2,showLabels:!0,sx:rn,ref:i,children:[e.jsx(Fs,{}),e.jsx(te,{label:"主題",icon:e.jsx(io,{}),onClick:a}),e.jsx(te,{sx:{cursor:"default",minWidth:"auto"},disableRipple:!0,label:e.jsx(Do,{color:"primary",size:"large",href:F.forum_home,component:"a",sx:{position:"absolute",transform:"translate(-50%, -80%) scale(1.2)",cursor:"pointer",display:"grid",placeItems:"center","&:hover":{bgcolor:"primary.light"}},children:e.jsxs(d,{children:[e.jsx(sn,{}),e.jsx(p,{variant:"caption",component:"h5",children:"首頁"})]})})}),e.jsx(en,{}),e.jsx(vs,{})]}),e.jsx(so,{open:s,onClose:r,onOpen:a})]})},an=j(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 11c-.55 0-1-.45-1-1V8c0-.55.45-1 1-1s1 .45 1 1v4c0 .55-.45 1-1 1m1 4h-2v-2h2z"})),ln=j([e.jsx("path",{d:"M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-4.99-5.58-5.34C6.54 2.58 3.3 5.38 3.03 9h2.02c.24-2.12 1.92-3.8 4.06-3.98C11.65 4.8 14 6.95 14 9.5c0 2.49-2.01 4.5-4.5 4.5-.17 0-.33-.03-.5-.05v2.02l.01.01c1.8.13 3.47-.47 4.72-1.55l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0s.41-1.08 0-1.49z"},"0"),e.jsx("path",{d:"M6.12 11.17 4 13.29l-2.12-2.12c-.2-.2-.51-.2-.71 0s-.2.51 0 .71L3.29 14l-2.12 2.12c-.2.2-.2.51 0 .71s.51.2.71 0L4 14.71l2.12 2.12c.2.2.51.2.71 0s.2-.51 0-.71L4.71 14l2.12-2.12c.2-.2.2-.51 0-.71-.2-.19-.51-.19-.71 0"},"1")]),cn=j(e.jsx("path",{d:"M8.65 5.82C9.36 4.72 10.6 4 12 4c2.21 0 4 1.79 4 4 0 1.4-.72 2.64-1.82 3.35zM20 17.17c-.02-1.1-.63-2.11-1.61-2.62-.54-.28-1.13-.54-1.77-.76zm.49 3.32L3.51 3.51a.996.996 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l8.18 8.18c-1.82.23-3.41.8-4.7 1.46C4.6 15.08 4 16.11 4 17.22V20h13.17l1.9 1.9c.39.39 1.02.39 1.41 0 .4-.39.4-1.02.01-1.41"})),dn=j(e.jsx("path",{d:"M3 5v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2m13.3 11.29c-.39.39-1.02.39-1.41 0L12 13.41 9.11 16.3c-.39.39-1.02.39-1.41 0a.996.996 0 0 1 0-1.41L10.59 12 7.7 9.11a.996.996 0 0 1 0-1.41c.39-.39 1.02-.39 1.41 0L12 10.59l2.89-2.88c.39-.39 1.02-.39 1.41 0s.39 1.02 0 1.41L13.41 12l2.89 2.88c.38.39.38 1.03 0 1.41"})),be={display:"flex",alignItems:"center",gap:1},je=t=>({gap:1,flex:1,borderRight:t?0:1,borderColor:"divider",px:3}),Dn=()=>{const t=Ie(a=>a.breakpoints.between("xs","md")),o=Ie(a=>a.breakpoints.down("sm")),[s,n]=u.useState(!1);if(s)throw new Error("測試目的的錯誤，請忽略");return e.jsx(d,{component:"footer",sx:{position:"relative",mt:"auto",py:3,bgcolor:"background.paper",borderTop:1,borderColor:"divider","&::before":{bgcolor:"action.hover",content:'""',position:"absolute",inset:0,pointerEvents:"none"}},children:e.jsxs($e,{maxWidth:"lg",sx:{position:"relative"},children:[e.jsxs(P,{sx:{display:"flex",gap:3,alignItems:"center"},children:[e.jsxs(P,{sx:{alignItems:"center"},children:[e.jsx(p,{variant:"h6",gutterBottom:!0,children:"相關連結"}),e.jsx(p,{variant:"body2",sx:{color:"text.secondary"},children:"故意引發錯誤或使用錯誤參數，用於展示網站對於真實錯誤的處理能力。"})]}),e.jsx($,{orientation:"horizontal",flexItem:!0,variant:"middle"}),e.jsxs(d,{sx:{display:"grid",width:1,rowGap:2,gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr",md:"1fr 1fr 1fr 1fr"}},children:[e.jsxs(P,{sx:je(o),children:[e.jsxs(ye,{href:"#",variant:"body2",color:"primary",sx:be,underline:"hover",onClick:()=>n(!0),children:[e.jsx(an,{fontSize:"small"}),"觸發錯誤"]}),e.jsx(p,{variant:"caption",sx:{color:"text.secondary"},children:"測試任意頁面發生錯誤時的情境"})]}),e.jsxs(P,{sx:je(t),children:[e.jsxs(ye,{href:"/this/is/a/not/exist/route",variant:"body2",color:"primary",sx:be,underline:"hover",children:[e.jsx(ln,{fontSize:"small"}),"404 錯誤"]}),e.jsx(p,{variant:"caption",sx:{color:"text.secondary"},children:"測試要求資源不存在的情境"})]}),e.jsxs(P,{sx:je(o),children:[e.jsxs(ye,{href:`${F.forum_users}?user=I_think_this_wont_be_an_username`,variant:"body2",color:"primary",sx:be,underline:"hover",children:[e.jsx(cn,{fontSize:"small"}),"使用者不存在"]}),e.jsx(p,{variant:"caption",sx:{color:"text.secondary"},children:"測試使用者頁面，但所要求的使用者不存在的情況"})]}),e.jsxs(P,{sx:je(!0),children:[e.jsxs(ye,{href:`${F.forum_post}?postId=-99`,variant:"body2",color:"primary",sx:be,underline:"hover",children:[e.jsx(dn,{fontSize:"small"}),"貼文不存在"]}),e.jsx(p,{variant:"caption",sx:{color:"text.secondary"},children:"測試單個貼文頁面，但所要求的貼文不存在的情況"})]})]})]}),e.jsxs(p,{variant:"caption",sx:{mt:2,textAlign:"center",display:"block",color:"text.secondary"},children:["© ",new Date().getFullYear()," 論壇樣板 by 1ureka"]})]})})},Tn=j(e.jsx("path",{d:"M16.5 6.75v10.58c0 2.09-1.53 3.95-3.61 4.15-2.39.23-4.39-1.64-4.39-3.98V5.14c0-1.31.94-2.5 2.24-2.63 1.5-.15 2.76 1.02 2.76 2.49v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6.75c0-.41-.34-.75-.75-.75s-.75.34-.75.75v8.61c0 1.31.94 2.5 2.24 2.63 1.5.15 2.76-1.02 2.76-2.49V5.17c0-2.09-1.53-3.95-3.61-4.15C9.01.79 7 2.66 7 5v12.27c0 2.87 2.1 5.44 4.96 5.71 3.29.3 6.04-2.26 6.04-5.48V6.75c0-.41-.34-.75-.75-.75s-.75.34-.75.75"})),Ft=new Event("locationchange"),un=window.history.pushState,pn=window.history.replaceState;window.history.pushState=function(...t){un.apply(this,t),window.dispatchEvent(Ft)};window.history.replaceState=function(...t){pn.apply(this,t),window.dispatchEvent(Ft)};function Bn(){const[t,o]=u.useState(new URLSearchParams(window.location.search)),s=u.useRef(new Set),n=u.useMemo(()=>({get:r=>(s.current.add(r),t.get(r)),getAll:r=>(s.current.add(r),t.getAll(r)),has:r=>(s.current.add(r),t.has(r))}),[t]),a=u.useCallback(r=>{const i=new URL(window.location.href),l=i.searchParams;Object.entries(r).forEach(([c,x])=>{x===null?l.delete(c):l.set(c,x)}),window.history.pushState({},"",i)},[]);return u.useEffect(()=>{const r=()=>{const i=new URLSearchParams(window.location.search);let l=!1;s.current.forEach(c=>{t.get(c)!==i.get(c)&&(l=!0)}),l&&o(i)};return window.addEventListener("popstate",r),window.addEventListener("locationchange",r),()=>{window.removeEventListener("popstate",r),window.removeEventListener("locationchange",r)}},[t,s]),{searchParams:n,updateSearchParams:a}}export{Vs as A,It as B,Ee as D,qs as E,An as F,Yo as L,Fn as P,ft as U,Ks as a,Rn as b,$n as c,En as d,Dn as e,Tn as f,ut as g,Fe as h,Pn as i,Ws as j,Mn as k,Ln as l,Bn as u};
