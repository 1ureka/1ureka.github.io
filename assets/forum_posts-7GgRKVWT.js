import{j as e,S as p,B as a,T as i,r as b,n as v,P,t as A}from"./Toast-DD81e0ZS.js";import{T as C,P as I}from"./TopicAutocomplete-3_AOhCTv.js";import{S as w,A as T}from"./SentimentDissatisfiedRounded-BpkvqQfC.js";import{a as B,A as k,S as D}from"./ScrollArea-Cw1iuxp9.js";import{u as h,b as E,c as R,d as F,e as z}from"./url-C_-tYCK8.js";import{r as _}from"./routes-J5yqRWDh.js";import{S as L}from"./SortRounded-BDIgWJ4v.js";import{A as M}from"./ArrowUpwardRounded-oXX1HEOs.js";import{F as N,S as O}from"./Switch-Ythf-BEN.js";import{T as W,a as H}from"./Tabs-9P5co5LI.js";import{T as S}from"./Tooltip-D4y8LWrL.js";import{h as U,j as $,C as q}from"./post-DSmH3M5n.js";import{E as f,a as G}from"./ExpandedPost-BRJaU_GC.js";import{S as J}from"./Skeleton-D4-wFtM2.js";import{D as y}from"./Divider-ClZXSiHJ.js";import"./Autocomplete-sgWClysp.js";import"./NotificationsRounded-DQX7XNSM.js";import"./Chip-vtOh1vX2.js";import"./react-error-boundary.esm-DV-Hw4di.js";import"./ForumRounded-xcY5LMa8.js";import"./SQLiteClient-DE74qkCZ.js";import"./ExpandMoreRounded-kr-67vvG.js";import"./DarkModeRounded-BpbMOGed.js";import"./OpenInNewRounded-BZ_qpgF0.js";import"./index-mSkvzYyn.js";import"./MenuItem-MyiTB2I2.js";import"./ListItemText-DLFdd-Xn.js";import"./useMutation-tmXyHxVB.js";import"./Collapse-DlXE4Kbp.js";import"./SwitchBase-ChVDiImR.js";import"./with-selector-Deie_L8r.js";import"./CommentRounded-DLBN9mjU.js";import"./PostHeader-f40iRlxx.js";import"./formatters-C9bWSe0O.js";const j=["title","createdAt","updatedAt","commentCount","viewCount","likeCount"],K=["標題","建立時間","更新時間","回覆數","瀏覽數","讚數"],Q=()=>{const{searchParams:t,updateSearchParams:o}=h(),s=t.get("orderBy")||j[0],c=t.get("orderDesc")==="true",x=t.get("followPrior")==="true",l=(n,r)=>{o({followPrior:r.toString()})};let d=j.findIndex(n=>n===s);d===-1&&(d=1);const u=(n,r)=>{o({orderBy:j[r],orderDesc:c.toString()})},g=n=>()=>{d===n&&o({orderBy:j[n],orderDesc:(!c).toString()})};return e.jsxs(p,{children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:1},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(L,{sx:{color:"inherit"}}),e.jsx(i,{variant:"subtitle1",component:"h2",sx:{lineHeight:1},children:"排序依據"})]}),e.jsx(N,{control:e.jsx(O,{size:"small",checked:x,onChange:l}),label:"追蹤者優先?"})]}),e.jsx(W,{value:d,onChange:u,variant:"scrollable",allowScrollButtonsMobile:!0,sx:{"& button:hover":{bgcolor:"action.hover"}},children:K.map((n,r)=>e.jsx(H,{onClick:g(r),label:e.jsx(S,{title:"再次點擊可以切換升冪或降冪排序",arrow:!0,placement:"top",children:e.jsxs(p,{direction:"row",sx:{alignItems:"center"},children:[e.jsx(i,{variant:"subtitle1",component:"span",children:n}),d===r&&e.jsx(M,{fontSize:"small",sx:{transform:c?"rotate(180deg)":"none",transition:"all 0.2s ease"}})]})})},r))})]})},V=()=>{const{searchParams:t}=h(),[o,s]=b.useState(null),c=l=>s(l.currentTarget),x=()=>s(null);return e.jsxs(e.Fragment,{children:[e.jsx(S,{title:"換一個主題",arrow:!0,children:e.jsxs(i,{variant:"h6",component:"h2",sx:{color:"text.secondary","&:hover":{cursor:"pointer",textDecoration:"underline",color:"text.primary"}},onClick:c,children:["#",t.get("topic")??"全部"]})}),e.jsx(C,{type:"query",open:!!o,anchorEl:o,onClose:x,onSelect:x})]})},X=["title","createdAt","updatedAt","commentCount","viewCount","likeCount"],Y=t=>X.includes(t),Z=()=>{const{searchParams:t}=h(),o=t.get("topic")??void 0,s=t.get("orderBy")??"title",c=t.get("orderDesc")==="true",x=t.get("followPrior")==="true",{data:l,isLoading:d,isFetchingNextPage:u,hasNextPage:g,fetchNextPage:n}=$({topic:o,orderBy:Y(s)?s:"createdAt",order:c?"desc":"asc",prioritizeFollowers:x});return d||!l?e.jsx(p,{sx:{alignItems:"stretch",mb:1.5},children:[...Array(3)].map((r,m)=>e.jsx(f,{},m))}):l.pages[0].posts.length===0?e.jsxs(a,{sx:{py:6,display:"flex",flexDirection:"column",alignItems:"center",gap:2},children:[e.jsx(w,{sx:{fontSize:"6rem",color:"action.disabled"}}),e.jsx(i,{variant:"body1",component:"p",sx:{color:"text.secondary",textAlign:"center"},children:"沒有符合條件的貼文"})]}):e.jsxs(p,{sx:{alignItems:"stretch",mb:1.5},children:[l.pages.map(r=>r.posts.map(m=>e.jsx(G,{postId:m},m))),u&&e.jsx(p,{sx:{alignItems:"stretch",mt:1.5},children:[...Array(3)].map((r,m)=>e.jsx(f,{},m))}),g?u?e.jsx(i,{sx:{color:"text.secondary",textAlign:"center",mt:3},children:"載入中..."}):e.jsxs(a,{sx:{display:"flex",justifyContent:"center",alignItems:"center",mt:3,gap:1},children:[e.jsx(i,{sx:{color:"text.secondary"},children:"滾動以載入更多，或點擊"}),e.jsx(v,{onClick:()=>n(),children:"載入更多"})]}):e.jsx(i,{sx:{color:"text.secondary",textAlign:"center",mt:3},children:"已經到底了"})]})},ee=()=>{const{searchParams:t}=h(),o=t.get("topic")??void 0,{data:s}=U({topic:o});return s?e.jsxs(i,{variant:"body2",component:"span",sx:{color:"text.secondary"},children:["共 ",s," 篇"]}):e.jsx(J,{variant:"rounded",animation:"wave",children:e.jsx(i,{variant:"body2",component:"span",sx:{color:"text.secondary"},children:"共 0 篇"})})},te=()=>{const{searchParams:t}=h(),o=t.get("topic")??"全部";return e.jsx("title",{children:`論壇樣板 | 貼文 #${o}`})};function oe(){const{isMd:t,isSm:o}=B();return e.jsxs(k,{children:[e.jsx(te,{}),e.jsx(E,{}),e.jsxs(D,{children:[t?e.jsx(R,{}):e.jsx(F,{}),e.jsx(q,{maxWidth:"lg",sx:{position:"relative",my:10,px:0},children:e.jsxs(P,{sx:{py:3,borderRadius:3,border:"1px solid",borderColor:"divider"},elevation:1,children:[e.jsxs(a,{sx:{display:"flex",gap:1,alignItems:"center",pr:{xs:3,md:5},pl:2},children:[o&&e.jsx(p,{sx:{alignItems:"flex-start",flex:1},children:e.jsx(v,{href:_.forum_home,startIcon:e.jsx(T,{}),variant:"outlined",sx:{textWrap:"nowrap"},children:t?"返回首頁":"首頁"})}),e.jsxs(a,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e.jsx(I,{className:"mode-light",sx:{fontSize:48,mr:1,bgcolor:"primary.main",borderRadius:1,color:"background.default",p:1,opacity:.8}}),e.jsx(i,{variant:"h5",component:"h2",children:"貼文列表"}),e.jsx(V,{})]}),e.jsx(p,{sx:{alignItems:"flex-end",flex:1},children:e.jsx(ee,{})})]}),e.jsx(y,{sx:{mt:2}}),e.jsxs(a,{sx:{position:"relative",px:1},children:[e.jsx(a,{sx:{position:"absolute",inset:0,bgcolor:"divider",opacity:.35,pointerEvents:"none"}}),e.jsx(Q,{})]}),e.jsx(y,{}),e.jsx(Z,{})]})}),e.jsx(z,{})]})]})}A.createRoot(document.getElementById("root")).render(e.jsx(b.StrictMode,{children:e.jsx(oe,{})}));
