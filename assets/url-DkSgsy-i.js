import{r as a}from"./routes-cr_ZCX-8.js";const p=new Event("locationchange"),y=window.history.pushState,L=window.history.replaceState;window.history.pushState=function(...t){y.apply(this,t),window.dispatchEvent(p)};window.history.replaceState=function(...t){L.apply(this,t),window.dispatchEvent(p)};const _=t=>t.startsWith("/")?t:"/"+t;function R(t,d=!1){document.startViewTransition&&!d?document.startViewTransition(t):t()}const f="__preserved__path__key__";function C(){const[t,d]=a.useState(new URLSearchParams(window.location.search)),[o,m]=a.useState(window.location.pathname),r=a.useRef(new Set),P=a.useMemo(()=>({get:e=>(r.current.add(e),t.get(e)),getAll:e=>(r.current.add(e),t.getAll(e)),has:e=>(r.current.add(e),t.has(e))}),[t]),g=a.useMemo(()=>({get:()=>(r.current.add(f),o.replace(/\/$/,"")),getParts:()=>(r.current.add(f),o.replace(/^\/|\/$/g,"").split("/").filter(e=>e!==""))}),[o]),i=a.useCallback((e,n,h)=>{const{skipTransition:c=!1,clearSearchParams:l=!1}=h||{},v=n===null||typeof n=="function"||l,s=new URL(window.location.href);if(typeof e=="string"&&(s.pathname=_(e)),typeof n=="function"){const u=Object.fromEntries(s.searchParams.entries());n=n(u)}v&&(s.search=""),n===null&&(n={}),Object.entries(n).forEach(([u,w])=>{w==null?s.searchParams.delete(u):s.searchParams.set(u,w)}),R(()=>window.history.pushState({},"",s),c)},[]),S=a.useCallback((e,n)=>{i(null,e,n)},[i]),E=a.useCallback((e,n)=>{i(e,{},n)},[i]);return a.useEffect(()=>{const e=()=>{const n=new URLSearchParams(window.location.search),h=window.location.pathname;let c=!1;r.current.forEach(l=>{(l===f&&o!==h||t.get(l)!==n.get(l))&&(c=!0)}),c&&(d(n),m(h))};return window.addEventListener("popstate",e),window.addEventListener("locationchange",e),()=>{window.removeEventListener("popstate",e),window.removeEventListener("locationchange",e)}},[t,r,o]),{pathname:g,searchParams:P,update:i,updatePath:E,updateSearchParams:S}}export{C as u};
