const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LargeTiles-ZGI74Yjo.js","assets/Toast-BWSE98qv.js","assets/Toast-Uzu4JJaw.css","assets/ArrowDropDownRounded-C0GBgAGE.js","assets/TileText-Dg6Ig9o4.js","assets/Tooltip-BuhKakYu.js","assets/Skeleton-HW9ddU7s.js","assets/MenuItem-4bQTnOK7.js","assets/DarkModeRounded-DHIdlD1_.js","assets/Chip-DQqmcggo.js","assets/style--bmyalrm.js","assets/DatasetRounded-CF2_jJQT.js","assets/with-selector-7ROEcTcX.js","assets/style-77Si7Yrt.css","assets/routes-C5afn4F_.js","assets/formatters-C9bWSe0O.js","assets/SwitchBase-BNwYG65c.js","assets/react-error-boundary.esm-q05-koDG.js","assets/forum-BUan7wf9.js","assets/DataExplorationRounded-DQANirdB.js","assets/NotificationsRounded-B9ZWkpWv.js","assets/SearchRounded-B5Wc1VKE.js","assets/ExpandMoreRounded-HPFCImli.js","assets/useMutation-c4i0f4Hd.js","assets/DownloadRounded-BKXCOb3v.js","assets/dayjs.min-DR8uAqsK.js","assets/SmallTiles-C6FKm7Zv.js","assets/OpenInNewRounded-Be0mRmxB.js","assets/Divider-BW3_Hc5D.js","assets/Sidebar-De8XBQ8L.js","assets/proxy-C4z_3Jes.js","assets/Collapse-CvP5dJYI.js","assets/useThemeProps-D2z4cs22.js","assets/FlowChart-BLYA5syr.js","assets/Motion-ChKbuJDE.js"])))=>i.map(i=>d[i]);
var Fe=Object.defineProperty;var Be=(t,s,n)=>s in t?Fe(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n;var q=(t,s,n)=>Be(t,typeof s!="symbol"?s+"":s,n);import{h as y,j as e,s as B,w as X,m as Ae,ay as ae,a as Oe,g as ze,r as p,u as qe,Q as He,c as $e,d as Ke,T as x,f as be,i as _,R as ie,B as u,S as K,o as Ve,C as Ue,p as Ne,n as ee,I as V,l as Qe,x as ye,M as We,ab as Ze,P as J,t as Ge,q as Je}from"./Toast-BWSE98qv.js";import{u as je,Q as Ye,b as Xe,E as et}from"./react-error-boundary.esm-q05-koDG.js";import{t as S,d as tt,g as ce,i as st,s as le,f as nt,R as rt,b as ot,u as E}from"./forum-BUan7wf9.js";import{c as at,B as F,r as g,t as it}from"./routes-C5afn4F_.js";import{D as te}from"./DataExplorationRounded-DQANirdB.js";import{B as ct,N as lt}from"./NotificationsRounded-B9ZWkpWv.js";import{M as v}from"./MenuItem-4bQTnOK7.js";import{I as dt,S as ut}from"./SearchRounded-B5Wc1VKE.js";import{T as A}from"./Tooltip-BuhKakYu.js";import{D as ht}from"./DarkModeRounded-DHIdlD1_.js";import{A as pt}from"./ArrowDropDownRounded-C0GBgAGE.js";import{E as xt}from"./ExpandMoreRounded-HPFCImli.js";import{D as mt,u as we}from"./useMutation-c4i0f4Hd.js";import{D as ft}from"./DownloadRounded-BKXCOb3v.js";import{d as gt}from"./dayjs.min-DR8uAqsK.js";const bt=y(e.jsx("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})),yt=B(X)(Ae(({theme:t})=>({display:"flex",marginLeft:`calc(${t.spacing(1)} * 0.5)`,marginRight:`calc(${t.spacing(1)} * 0.5)`,...t.palette.mode==="light"?{backgroundColor:t.palette.grey[100],color:t.palette.grey[700]}:{backgroundColor:t.palette.grey[700],color:t.palette.grey[100]},borderRadius:2,"&:hover, &:focus":{...t.palette.mode==="light"?{backgroundColor:t.palette.grey[200]}:{backgroundColor:t.palette.grey[600]}},"&:active":{boxShadow:t.shadows[0],...t.palette.mode==="light"?{backgroundColor:ae(t.palette.grey[200],.12)}:{backgroundColor:ae(t.palette.grey[600],.12)}}}))),jt=B(bt)({width:24,height:16});function wt(t){const{slots:s={},slotProps:n={},...r}=t,a=t;return e.jsx("li",{children:e.jsx(yt,{focusRipple:!0,...r,ownerState:a,children:e.jsx(jt,{as:s.CollapsedIcon,ownerState:a,...n.collapsedIcon})})})}function vt(t){return ze("MuiBreadcrumbs",t)}const Ct=Oe("MuiBreadcrumbs",["root","ol","li","separator"]),St=t=>{const{classes:s}=t;return Ke({root:["root"],li:["li"],ol:["ol"],separator:["separator"]},vt,s)},It=B(x,{name:"MuiBreadcrumbs",slot:"Root",overridesResolver:(t,s)=>[{[`& .${Ct.li}`]:s.li},s.root]})({}),Et=B("ol",{name:"MuiBreadcrumbs",slot:"Ol",overridesResolver:(t,s)=>s.ol})({display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"}),Rt=B("li",{name:"MuiBreadcrumbs",slot:"Separator",overridesResolver:(t,s)=>s.separator})({display:"flex",userSelect:"none",marginLeft:8,marginRight:8});function kt(t,s,n,r){return t.reduce((a,c,o)=>(o<t.length-1?a=a.concat(c,e.jsx(Rt,{"aria-hidden":!0,className:s,ownerState:r,children:n},`separator-${o}`)):a.push(c),a),[])}const Pt=p.forwardRef(function(s,n){const r=qe({props:s,name:"MuiBreadcrumbs"}),{children:a,className:c,component:o="nav",slots:i={},slotProps:d={},expandText:l="Show path",itemsAfterCollapse:m=1,itemsBeforeCollapse:h=1,maxItems:f=8,separator:b="/",...j}=r,[k,N]=p.useState(!1),P={...r,component:o,expanded:k,expandText:l,itemsAfterCollapse:m,itemsBeforeCollapse:h,maxItems:f,separator:b},z=St(P),De=He({elementType:i.CollapsedIcon,externalSlotProps:d.collapsedIcon,ownerState:P}),re=p.useRef(null),_e=w=>{const W=()=>{N(!0);const oe=re.current.querySelector("a[href],button,[tabindex]");oe&&oe.focus()};return h+m>=w.length?w:[...w.slice(0,h),e.jsx(wt,{"aria-label":l,slots:{CollapsedIcon:i.CollapsedIcon},slotProps:{collapsedIcon:De},onClick:W},"ellipsis"),...w.slice(w.length-m,w.length)]},Q=p.Children.toArray(a).filter(w=>p.isValidElement(w)).map((w,W)=>e.jsx("li",{className:z.li,children:w},`child-${W}`));return e.jsx(It,{ref:n,component:o,color:"textSecondary",className:$e(z.root,c),ownerState:P,...j,children:e.jsx(Et,{className:z.ol,ref:re,ownerState:P,children:kt(k||f&&Q.length<=f?Q:_e(Q),z.separator,b,P)})})}),Mt=be(),$=be({cssVariables:{colorSchemeSelector:".mode-%s"},typography:{fontFamily:'Comfortaa, "jf openhuninn"'},colorSchemes:{light:{palette:{primary:{main:"#66cccc",dark:"#45a1a1"},secondary:{main:"#66cccc90",dark:"color-mix(in srgb, #66cccc 50%, var(--mui-palette-text-primary) 50%)"}}},dark:{palette:{primary:{main:"#66cccc",dark:"#2d8686"},secondary:{main:"#66cccc90",dark:"color-mix(in srgb, #66cccc 50%, var(--mui-palette-text-primary) 50%)"},background:{default:"#222",paper:"#222"}}}},breakpoints:{values:{...Mt.breakpoints.values,sm:700,ml:1440}},components:{MuiInputBase:{defaultProps:{sx:{"&.Mui-disabled::before":{borderBottomStyle:"solid"}}}}},spacing:"0.5rem"}),ve=()=>{const t=_($.breakpoints.up("lg")),s=_($.breakpoints.up("md")),n=_($.breakpoints.up("sm"));return p.useEffect(()=>{t?document.documentElement.style.fontSize="16px":s&&(document.documentElement.style.fontSize="14px")},[t,s,n]),{isLg:t,isMd:s,isSm:n}},de=t=>{let s;const n=new Set,r=(l,m)=>{const h=typeof l=="function"?l(s):l;if(!Object.is(h,s)){const f=s;s=m??(typeof h!="object"||h===null)?h:Object.assign({},s,h),n.forEach(b=>b(s,f))}},a=()=>s,i={setState:r,getState:a,getInitialState:()=>d,subscribe:l=>(n.add(l),()=>n.delete(l))},d=s=t(r,a,i);return i},Lt=t=>t?de(t):de,Tt=t=>t;function Dt(t,s=Tt){const n=ie.useSyncExternalStore(t.subscribe,()=>s(t.getState()),()=>s(t.getInitialState()));return ie.useDebugValue(n),n}const ue=t=>{const s=Lt(t),n=r=>Dt(s,r);return Object.assign(n,s),n},_t=t=>t?ue(t):ue,se=_t(t=>({client:null,setClient:s=>t({client:s}),resetClient:()=>t({client:null})})),I=500;class Ft{constructor(s){q(this,"dbPromise",null);q(this,"dbPath");q(this,"storageKey");this.dbPath=s.dbPath,this.storageKey=s.storageKey}async ready(){this.dbPromise=this.dbPromise===null?this.loadDatabase():this.dbPromise,await this.dbPromise}async downloadDatabase(s="database.db"){const n=Date.now();try{this.dbPromise=this.dbPromise===null?this.loadDatabase():this.dbPromise;const a=(await this.dbPromise).export(),c=new Blob([a],{type:"application/x-sqlite3"}),o=URL.createObjectURL(c),i=document.createElement("a");i.href=o,i.download=s,i.style.display="none",document.body.appendChild(i);const d=Date.now()-n;return d<I&&await new Promise(l=>setTimeout(l,I-d)),i.click(),setTimeout(()=>{document.body.removeChild(i),URL.revokeObjectURL(o)},100),!0}catch(r){return console.error("下載資料庫失敗",r),!1}}async exec(s,n){const r=Date.now();this.dbPromise=this.dbPromise===null?this.loadDatabase():this.dbPromise;const a=await this.dbPromise;a.run("PRAGMA foreign_keys = ON;");const[{values:c}]=a.exec("PRAGMA foreign_keys;");if(c[0][0]!==1)return console.error("Failed to enable foreign keys"),this.parse([]);const o=await S((async()=>{const d=a.exec(s,n);return await this.saveDatabase(a),d})());if(o.error!==null)return console.error("Failed to execute SQL query",o.error),this.parse([]);const i=Date.now()-r;return i<I&&await new Promise(d=>setTimeout(d,I-i)),this.parse(o.data)}async reset(){const s=Date.now(),{error:n}=await S(tt(this.storageKey)),r=Date.now()-s;r<I&&await new Promise(a=>setTimeout(a,I-r)),n?console.error("刪除本地資料庫失敗"):console.log("刪除本地資料庫成功"),this.dbPromise=this.loadDatabase()}async getDatabaseSize(){await this.ready();const{data:s,error:n}=await S(ce(this.storageKey));return n?(console.error("Failed to get database size",n),0):s?s.byteLength:0}parse(s){if(s.length===0||!s[0])return[];const{columns:n,values:r}=s[0];return r.map(a=>Object.fromEntries(n.map((c,o)=>[c,a[o]])))}async loadDatabase(){const s=await st({locateFile:d=>`https://sql.js.org/dist/${d}`}),{data:n,error:r}=await S(ce(this.storageKey));if(r&&console.error("Failed to get cached database",r),n)return new s.Database(n);const{data:a,error:c}=await S((async()=>{const l=await(await fetch(this.dbPath)).arrayBuffer();return new s.Database(new Uint8Array(l))})());if(c)return console.error("Failed to fetch database file",c),new s.Database;const o=a.export(),{error:i}=await S(le(this.storageKey,o));return i&&console.error("Failed to save database to IndexedDB",i),a}async saveDatabase(s){const n=s.export(),{error:r}=await S(le(this.storageKey,n));r&&console.error("Failed to save database to IndexedDB",r)}}const Ce=new Event("locationchange"),Bt=window.history.pushState,At=window.history.replaceState;window.history.pushState=function(...t){Bt.apply(this,t),window.dispatchEvent(Ce)};window.history.replaceState=function(...t){At.apply(this,t),window.dispatchEvent(Ce)};const Ot=t=>t.startsWith("/")?t:"/"+t;function he(t){document.startViewTransition?document.startViewTransition(t):t()}const Z="__preserved__path__key__";function O(){const[t,s]=p.useState(new URLSearchParams(window.location.search)),[n,r]=p.useState(window.location.pathname),a=p.useRef(new Set),c=p.useMemo(()=>({get:l=>(a.current.add(l),t.get(l)),getAll:l=>(a.current.add(l),t.getAll(l)),has:l=>(a.current.add(l),t.has(l))}),[t]),o=p.useMemo(()=>({get:()=>(a.current.add(Z),n.replace(/\/$/,"")),getParts:()=>(a.current.add(Z),n.replace(/^\/|\/$/g,"").split("/").filter(l=>l!==""))}),[n]),i=p.useCallback(l=>{const m=new URL(window.location.href);Object.entries(l).forEach(([h,f])=>{f===null?m.searchParams.delete(h):m.searchParams.set(h,f)}),he(()=>window.history.pushState({},"",m))},[]),d=p.useCallback(l=>{const m=new URL(window.location.href);m.pathname=Ot(l),he(()=>window.history.pushState({},"",m))},[]);return p.useEffect(()=>{const l=()=>{const m=new URLSearchParams(window.location.search),h=window.location.pathname;let f=!1;a.current.forEach(b=>{(b===Z&&n!==h||t.get(b)!==m.get(b))&&(f=!0)}),f&&(s(m),r(h))};return window.addEventListener("popstate",l),window.addEventListener("locationchange",l),()=>{window.removeEventListener("popstate",l),window.removeEventListener("locationchange",l)}},[t,a,n]),{searchParams:c,updateSearchParams:i,pathname:o,updatePath:d}}const Se={forum:nt},zt=t=>at(Se).includes(t);function qt(){const{searchParams:t}=O(),s=se(r=>r.setClient),n=je();p.useEffect(()=>{let r=t.get("db");if((r===null||r.trim()==="")&&(r="forum"),!zt(r))throw new Error(`要求資料庫 "${r}" 不存在`);const a=new Ft({dbPath:Se[r],storageKey:`sqlite-db-${r}`});s(a),n.resetQueries({queryKey:[]})},[s,t,n])}const Ie=72,Ht=y(e.jsx("path",{d:"M19 11H7.83l4.88-4.88c.39-.39.39-1.03 0-1.42a.996.996 0 0 0-1.41 0l-6.59 6.59c-.39.39-.39 1.02 0 1.41l6.59 6.59c.39.39 1.02.39 1.41 0s.39-1.02 0-1.41L7.83 13H19c.55 0 1-.45 1-1s-.45-1-1-1"}));function Ee({error:t,resetErrorBoundary:s,isFatal:n}){return ve(),e.jsxs(u,{sx:{position:"fixed",inset:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",p:{xs:2,sm:4},bgcolor:"background.default"},children:[e.jsx(u,{sx:{position:"absolute",inset:0,bgcolor:"primary.main",opacity:.1,pointerEvents:"none"}}),e.jsx(u,{sx:{position:"absolute",inset:0,pointerEvents:"none",overflow:"hidden",display:"flex",justifyContent:"center"},children:e.jsxs(u,{sx:{position:"absolute",maskImage:"radial-gradient(circle at 50% 25%, #0008 0%, #0008 100%)",pointerEvents:"none",bgcolor:"primary.main",fill:"var(--mui-palette-background-paper)",fillOpacity:.2,width:1,minWidth:1200,height:1},children:[e.jsxs("svg",{style:{scale:"1 -1"},width:"100%",height:"200",viewBox:"0 0 1920 300",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",children:[e.jsx("path",{d:"M0,160 C160,180 320,140 480,160 C640,180 800,120 960,150 C1120,180 1280,130 1440,160 C1600,190 1760,150 1920,170 L1920,300 L0,300 Z"}),e.jsx("path",{d:"M0,190 C120,210 240,160 360,190 C480,220 600,140 720,180 C840,220 960,130 1080,180 C1200,230 1320,160 1440,200 C1560,240 1740,180 1920,210 L1920,300 L0,300 Z"}),e.jsx("path",{d:"M0,230 C160,250 320,190 480,230 C640,270 800,180 960,220 C1120,260 1280,170 1440,210 C1600,250 1760,200 1920,230 L1920,300 L0,300 Z"})]}),e.jsxs("svg",{style:{position:"absolute",inset:"auto 0 0 0"},width:"100%",height:"200",viewBox:"0 0 1920 300",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",children:[e.jsx("path",{d:"M0,160 C160,180 320,140 480,160 C640,180 800,120 960,150 C1120,180 1280,130 1440,160 C1600,190 1760,150 1920,170 L1920,300 L0,300 Z"}),e.jsx("path",{d:"M0,190 C120,210 240,160 360,190 C480,220 600,140 720,180 C840,220 960,130 1080,180 C1200,230 1320,160 1440,200 C1560,240 1740,180 1920,210 L1920,300 L0,300 Z"}),e.jsx("path",{d:"M0,230 C160,250 320,190 480,230 C640,270 800,180 960,220 C1120,260 1280,170 1440,210 C1600,250 1760,200 1920,230 L1920,300 L0,300 Z"})]})]})}),e.jsx(u,{sx:{position:"relative",zIndex:1,display:"grid",placeItems:"center"},children:e.jsxs(K,{sx:{gap:5,alignItems:"center"},children:[e.jsxs(u,{sx:{display:"flex",gap:1,alignItems:"center",translate:"-2.5%"},children:[e.jsx(te,{sx:{fontSize:"4rem",color:"secondary.dark"}}),e.jsx(x,{variant:"h3",component:"h1",sx:{fontFamily:'"timemachine-wa"',color:"secondary.dark"},children:"資料樣板"})]}),e.jsxs(K,{sx:{gap:1,alignItems:"center"},children:[e.jsx(x,{variant:"h5",component:"h3",children:"發生錯誤"}),e.jsx(x,{variant:"body1",sx:{color:"text.secondary"},children:(t==null?void 0:t.message)||"未知錯誤"})]}),e.jsxs(u,{sx:{display:"flex",gap:2,mt:2,color:"text.secondary"},children:[!n&&e.jsx(F,{variant:"outlined",color:"inherit",disableElevation:!0,href:g.datahub_home,startIcon:e.jsx(Ht,{}),children:"返回首頁"}),s&&e.jsx(F,{variant:"text",color:"inherit",onClick:()=>s(),startIcon:e.jsx(rt,{}),children:"重新載入"})]})]})})]})}const $t=()=>e.jsx(Ee,{error:{message:"請使用寬度超過 700px 的裝置或將視窗放大，以使用此應用程式。"},isFatal:!0}),Kt=new Ye;function pe({children:t}){return e.jsxs(Ve,{theme:$,children:[e.jsx(Ue,{}),e.jsx(Ne,{}),e.jsx(Xe,{client:Kt,children:e.jsx(et,{fallbackRender:s=>e.jsx(Ee,{...s}),children:t})})]})}const Vt=()=>e.jsxs(ee,{select:!0,defaultValue:"db",size:"small",variant:"outlined",sx:{bgcolor:"background.paper",backgroundImage:"linear-gradient(#fff1, #fff1)",borderRadius:1},slotProps:{input:{sx:{"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"secondary.main"},"& .MuiOutlinedInput-notchedOutline":{borderColor:"divider"}}}},children:[e.jsx(v,{value:"db",dense:!0,children:"資料庫"}),e.jsx(v,{value:"table",dense:!0,children:"資料表"}),e.jsx(v,{value:"column",dense:!0,children:"欄位"}),e.jsx(v,{value:"record",dense:!0,children:"紀錄"})]}),Ut=()=>{const[t,s]=p.useState(""),n=c=>s(c.target.value),r="#"+t,a=({key:c})=>{if(c==="Enter"){if(!t.trim())return console.error("請輸入搜尋內容");console.log("還沒寫完，請稍後再試"),window.location.href="#"}};return e.jsx(ee,{variant:"outlined",label:"搜尋",size:"small",sx:{width:"20vw",maxWidth:"22rem",bgcolor:"background.paper",backgroundImage:"linear-gradient(#fff1, #fff1)",borderRadius:1},value:t,onChange:n,onKeyDown:a,slotProps:{input:{sx:{"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"secondary.main"},"& .MuiOutlinedInput-notchedOutline":{borderColor:"divider"}},endAdornment:e.jsx(A,{title:t.trim()?"搜尋":"請輸入搜尋內容",arrow:!0,children:e.jsx(dt,{position:"end",children:e.jsx(V,{edge:"end",href:r,disabled:!t.trim(),children:e.jsx(ut,{})})})})}}})},Nt=()=>{const[t,s]=p.useState(null),n=a=>s(a.currentTarget),r=()=>s(null);return e.jsxs(e.Fragment,{children:[e.jsx(A,{title:"切換主題",arrow:!0,children:e.jsx(V,{onClick:n,children:e.jsx(ht,{})})}),e.jsx(Qt,{open:!!t,anchorEl:t,onClose:r,anchorOrigin:{horizontal:"center",vertical:"bottom"},transformOrigin:{horizontal:"center",vertical:"top"}})]})},Qt=({onClose:t,...s})=>{const{mode:n,setMode:r}=Qe(),a=c=>()=>{r(c),t()};return e.jsx(ye,{anchorOrigin:{horizontal:"right",vertical:"top"},onClose:t,...s,children:e.jsxs(We,{dense:!0,children:[e.jsx(v,{onClick:a("light"),selected:n==="light",children:"淺色"}),e.jsx(v,{onClick:a("dark"),selected:n==="dark",children:"暗色"}),e.jsx(v,{onClick:a("system"),selected:n==="system",children:"跟隨系統"})]})})},Wt=()=>{const t=_(s=>s.breakpoints.up("md"));return e.jsxs(X,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:1,textAlign:"left",borderRadius:1,p:.5,px:1.5,"&:hover":{bgcolor:"action.hover"}},children:[e.jsx(u,{sx:{width:"2.8rem",aspectRatio:1,borderRadius:1,bgcolor:"primary.main",display:"grid",placeItems:"center"},children:e.jsx(x,{variant:"h6",component:"span",sx:{color:"primary.contrastText"},children:"1"})}),e.jsxs(u,{sx:{pr:{xs:0,md:1}},children:[e.jsx(x,{variant:"subtitle1",component:"h6",children:"1ureka"}),t&&e.jsx(x,{variant:"body2",component:"p",color:"text.secondary",children:"資料庫管理員"})]}),e.jsx(u,{sx:{color:"text.secondary"},children:e.jsx(pt,{color:"inherit"})})]})},M={display:"flex",flexDirection:"row",alignItems:"center"},Zt=()=>{const t=_(s=>s.breakpoints.up("md"));return e.jsxs(u,{component:"header",sx:{position:"relative",gap:3,justifyContent:"space-between",px:3.5,bgcolor:"background.paper",height:Ie,...M},children:[e.jsx(u,{sx:{position:"absolute",inset:0,bgcolor:"primary.main",opacity:.1,pointerEvents:"none"}}),e.jsxs(u,{sx:{gap:6,...M},children:[e.jsxs(u,{sx:{gap:1,...M},children:[e.jsx(te,{sx:{fontSize:"3em",color:"primary.main"}}),t&&e.jsx(x,{variant:"h4",component:"h1",sx:{fontFamily:'"timemachine-wa"',color:"secondary.dark"},children:"資料樣板"})]}),e.jsxs(u,{sx:{gap:.5,...M},children:[e.jsx(Vt,{}),e.jsx(Ut,{})]})]}),e.jsxs(u,{sx:{gap:2,...M},children:[e.jsx(Nt,{}),e.jsx(A,{title:"通知",arrow:!0,children:e.jsx(V,{children:e.jsx(ct,{variant:"dot",badgeContent:1,color:"error",children:e.jsx(lt,{})})})}),e.jsx(Wt,{})]})]})},Re=y(e.jsx("path",{d:"M4 13h6c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v8c0 .55.45 1 1 1m0 8h6c.55 0 1-.45 1-1v-4c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1m10 0h6c.55 0 1-.45 1-1v-8c0-.55-.45-1-1-1h-6c-.55 0-1 .45-1 1v8c0 .55.45 1 1 1M13 4v4c0 .55.45 1 1 1h6c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1h-6c-.55 0-1 .45-1 1"})),ke=y(e.jsx("path",{d:"M14 10.5v.5h-3v-.5c0-.83-.67-1.5-1.5-1.5h-1V7h1c.83 0 1.5-.67 1.5-1.5v-3c0-.83-.67-1.5-1.5-1.5h-4C4.67 1 4 1.67 4 2.5v3C4 6.33 4.67 7 5.5 7h1v2h-1C4.67 9 4 9.67 4 10.5v3c0 .83.67 1.5 1.5 1.5h1v2h-1c-.83 0-1.5.67-1.5 1.5v3c0 .83.67 1.5 1.5 1.5h4c.83 0 1.5-.67 1.5-1.5v-3c0-.83-.67-1.5-1.5-1.5h-1v-2h1c.83 0 1.5-.67 1.5-1.5V13h3v.5c0 .83.67 1.5 1.5 1.5h4c.83 0 1.5-.67 1.5-1.5v-3c0-.83-.67-1.5-1.5-1.5h-4c-.83 0-1.5.67-1.5 1.5"})),Pe=y(e.jsx("path",{d:"M4 14h2c.55 0 1-.45 1-1v-2c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1m0 5h2c.55 0 1-.45 1-1v-2c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1M4 9h2c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1m5 5h11c.55 0 1-.45 1-1v-2c0-.55-.45-1-1-1H9c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1m0 5h11c.55 0 1-.45 1-1v-2c0-.55-.45-1-1-1H9c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1M8 6v2c0 .55.45 1 1 1h11c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1H9c-.55 0-1 .45-1 1"})),Me=y(e.jsx("path",{d:"M20 4H4c-1.11 0-2 .9-2 2v12c0 1.1.89 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.89-2-2-2m0 14H4V8h16zm-8-2c0-.55.45-1 1-1h4c.55 0 1 .45 1 1s-.45 1-1 1h-4c-.55 0-1-.45-1-1M6.79 9.71c.39-.39 1.02-.39 1.41 0l2.59 2.59c.39.39.39 1.02 0 1.41L8.2 16.3c-.39.39-1.02.39-1.41 0a.996.996 0 0 1 0-1.41L8.67 13l-1.88-1.88a.996.996 0 0 1 0-1.41"})),Gt=y(e.jsx("path",{d:"M5 10h10c.55 0 1 .45 1 1s-.45 1-1 1H5c-.55 0-1-.45-1-1s.45-1 1-1m0-4h10c.55 0 1 .45 1 1s-.45 1-1 1H5c-.55 0-1-.45-1-1s.45-1 1-1m0 8h6c.55 0 1 .45 1 1s-.45 1-1 1H5c-.55 0-1-.45-1-1s.45-1 1-1m9 .88v4.23c0 .39.42.63.76.43l3.53-2.12c.32-.19.32-.66 0-.86l-3.53-2.12c-.34-.19-.76.05-.76.44"})),Jt=y(e.jsx("path",{d:"M17.7 15.89 13.82 12l3.89-3.89c.39-.39.39-1.02 0-1.41a.996.996 0 0 0-1.41 0l-4.59 4.59c-.39.39-.39 1.02 0 1.41l4.59 4.59c.39.39 1.02.39 1.41 0 .38-.38.38-1.02-.01-1.4M7 6c.55 0 1 .45 1 1v10c0 .55-.45 1-1 1s-1-.45-1-1V7c0-.55.45-1 1-1"})),L=({title:t,active:s,onClick:n,children:r})=>e.jsx(A,{title:t,arrow:!0,placement:"right",children:e.jsx(V,{color:"inherit",centerRipple:!1,onClick:n,sx:{borderRadius:1,aspectRatio:1,bgcolor:s?"#fffc":void 0,boxShadow:s?1:void 0,color:s?"primary.dark":void 0,"&:hover":{bgcolor:s?"#fffe":void 0},transition:"all 0.2s ease-in-out"},children:r})}),T=({title:t,description:s,icon:n,active:r,onClick:a})=>e.jsx(X,{onClick:a,sx:{borderRadius:1,bgcolor:r?"#fffc":void 0,boxShadow:r?1:void 0,"&:hover":{bgcolor:r?"#fffe":"#fff1"},transition:"all 0.2s ease-in-out"},children:e.jsxs(u,{sx:{display:"flex",gap:2,alignItems:"center",p:2,width:1},children:[e.jsx(u,{children:n}),e.jsxs(u,{sx:{flex:1,textAlign:"left"},children:[e.jsx(x,{variant:"h6",component:"h6",sx:{color:r?"primary.dark":"#fffc"},children:t}),s&&e.jsx(x,{variant:"body2",component:"p",sx:{color:r?"primary.dark":"#fffc",opacity:.8},children:s})]})]})}),Yt=({open:t,onClose:s})=>{const{searchParams:n,updateSearchParams:r,updatePath:a,pathname:c}=O(),o=i=>()=>{r({db:i})};return e.jsxs(mt,{anchor:"left",open:t,onClose:s,sx:{"& .MuiDrawer-paper":{width:450,maxWidth:"100vw",bgcolor:"primary.dark",p:3,display:"flex",flexDirection:"column",gap:2}},children:[e.jsxs(u,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:2,mb:2},children:[e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(te,{sx:{fontSize:"3em",color:"#fffc"}}),e.jsx(x,{variant:"h4",component:"h1",sx:{fontFamily:'"timemachine-wa"',color:"#fffc"},children:"資料樣板"})]}),e.jsx(ee,{className:"mode-dark",select:!0,label:"資料庫",variant:"outlined",slotProps:{select:{IconComponent:xt}},value:n.get("db")||"forum",children:e.jsx(v,{value:"forum",dense:!0,children:e.jsx(x,{variant:"body2",sx:{color:"text.primary"},onClick:o("forum"),children:"論壇資料庫"})})})]}),e.jsx(T,{title:"概覽",description:"快速掌握資料庫狀態與視覺化圖表",icon:e.jsx(Re,{sx:{color:c.get()===g.datahub_home?"primary.dark":"#fffc",fontSize:"3.5rem"}}),active:c.get()===g.datahub_home,onClick:()=>{a(g.datahub_home),s()}}),e.jsx(T,{title:"資料庫結構",description:"圖像化呈現資料表間的關聯",icon:e.jsx(ke,{sx:{color:c.get()===g.datahub_schema?"primary.dark":"#fffc",fontSize:"3.5rem"}}),active:c.get()===g.datahub_schema,onClick:()=>{a(g.datahub_schema),s()}}),e.jsx(T,{title:"資料表",description:"檢視、編輯與標準化資料表內容",icon:e.jsx(Pe,{sx:{color:"#fffc",fontSize:"3.5rem"}}),onClick:s}),e.jsx(T,{title:"撰寫查詢",description:"手動撰寫 SQL 以進行自定義查詢",icon:e.jsx(Me,{sx:{color:"#fffc",fontSize:"3.5rem"}}),onClick:s}),e.jsx(u,{sx:{flex:1}}),e.jsx(T,{title:"收起側邊欄",icon:e.jsx(Jt,{sx:{color:"#fffc",fontSize:"2rem"}}),onClick:s})]})},Xt=()=>{const{updatePath:t,pathname:s}=O(),[n,r]=p.useState(!1),a=()=>r(!n);return e.jsxs(K,{sx:{position:"relative",bgcolor:"primary.dark",p:2,py:4,color:"#fffc",height:1,gap:2},children:[e.jsx(L,{title:"概覽",active:s.get()===g.datahub_home,onClick:()=>t(g.datahub_home),children:e.jsx(Re,{})}),e.jsx(L,{title:"資料庫結構",active:s.get()===g.datahub_schema,onClick:()=>t(g.datahub_schema),children:e.jsx(ke,{})}),e.jsx(L,{title:"資料表",children:e.jsx(Pe,{})}),e.jsx(L,{title:"撰寫查詢",children:e.jsx(Me,{})}),e.jsx(u,{sx:{flex:1}}),e.jsx(L,{title:"展開面板",onClick:a,children:e.jsx(Gt,{})}),e.jsx(Yt,{open:n,onClose:a})]})},es=y(e.jsx("path",{d:"M19 13H5c-1.1 0-2 .9-2 2v4c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-4c0-1.1-.9-2-2-2M7 19c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2M19 3H5c-1.1 0-2 .9-2 2v4c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M7 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2"})),ts=()=>e.jsx(u,{sx:{position:"absolute",inset:0,pointerEvents:"none",overflow:"hidden",display:"flex",justifyContent:"center"},children:e.jsx(u,{sx:{position:"relative",maskImage:"radial-gradient(circle at 50% 25%, #0003 0%, #000a 100%)",bgcolor:"primary.main",fill:"var(--mui-palette-background-paper)",fillOpacity:.375,width:1,minWidth:1200,height:1},children:e.jsxs("svg",{style:{scale:"1.01 -1"},width:"100%",height:"200",viewBox:"0 0 1920 300",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",children:[e.jsx("path",{d:"M0,160 C160,180 320,140 480,160 C640,180 800,120 960,150 C1120,180 1280,130 1440,160 C1600,190 1760,150 1920,170 L1920,300 L0,300 Z"}),e.jsx("path",{d:"M0,190 C120,210 240,160 360,190 C480,220 600,140 720,180 C840,220 960,130 1080,180 C1200,230 1320,160 1440,200 C1560,240 1740,180 1920,210 L1920,300 L0,300 Z"}),e.jsx("path",{d:"M0,230 C160,250 320,190 480,230 C640,270 800,180 960,220 C1120,260 1280,170 1440,210 C1600,250 1760,200 1920,230 L1920,300 L0,300 Z"})]})})}),ss=y(e.jsx("path",{d:"M12 5V3.21c0-.45-.54-.67-.85-.35l-2.8 2.79c-.2.2-.2.51 0 .71l2.79 2.79c.32.31.86.09.86-.36V7c3.31 0 6 2.69 6 6 0 2.72-1.83 5.02-4.31 5.75-.42.12-.69.52-.69.95 0 .65.62 1.16 1.25.97C17.57 19.7 20 16.64 20 13c0-4.42-3.58-8-8-8m-6 8c0-1.34.44-2.58 1.19-3.59.3-.4.26-.95-.09-1.31-.42-.42-1.14-.38-1.5.1-1 1.34-1.6 3-1.6 4.8 0 3.64 2.43 6.7 5.75 7.67.63.19 1.25-.32 1.25-.97 0-.43-.27-.83-.69-.95C7.83 18.02 6 15.72 6 13"})),ns=y(e.jsx("path",{d:"M10 16h4c.55 0 1-.45 1-1v-5h1.59c.89 0 1.34-1.08.71-1.71L12.71 3.7a.996.996 0 0 0-1.41 0L6.71 8.29c-.63.63-.19 1.71.7 1.71H9v5c0 .55.45 1 1 1m-4 2h12c.55 0 1 .45 1 1s-.45 1-1 1H6c-.55 0-1-.45-1-1s.45-1 1-1"})),rs=()=>{const{client:t}=se.getState();if(!t)throw new Error("SQLite client is not initialized.");return t},os=()=>rs().reset(),as=()=>{const t=je();return we({mutationFn:os,onSuccess:()=>{t.resetQueries({queryKey:[]})},onError:s=>{console.error("重置資料庫失敗:",s),t.resetQueries({queryKey:[]})}})};function is(t,s=.9){if(!Array.isArray(t)||t.length===0)return null;if(s<0||s>1)throw new Error("Ratio must be between 0 and 1");const n=t.reduce((o,i)=>(o[i]=(o[i]||0)+1,o),{});let r=t[0],a=0;for(const[o,i]of it(n))i>a&&(r=o,a=i);return a/t.length>=s?r:null}const C=()=>{const{client:t}=se.getState();if(!t)throw new Error("SQLite client is not initialized.");return t},cs=async(t="database.sqlite")=>C().downloadDatabase(t),ls=async()=>await C().getDatabaseSize(),Le=async t=>{const s=C(),n=[];return await Promise.all(t.map(async r=>{(await s.exec("SELECT name FROM sqlite_master WHERE type = $type AND name NOT LIKE 'sqlite_%';",{$type:r})).forEach(o=>{typeof o.name=="string"&&n.push({type:r,name:o.name})})})),n},ds=async t=>{const s=C(),n={},r=await Le(t);return await Promise.all(r.map(async({name:a})=>{const c=`SELECT COUNT(*) as count FROM ${a};`,o=await s.exec(c);o.length>0?n[a]=Number(o[0].count??0):n[a]=0})),n},us=t=>{if(t==null)return"empty";if(typeof t=="number"&&Number.isInteger(t))return"integer";if(typeof t=="number")return"real";if(typeof t!="string")return"unknown";if(t.trim()==="")return"empty";if(/^[0-9a-f]{8}-[0-9a-f]{4}/.test(t))return"uuid";if(["true","false","0","1"].includes(t.toLowerCase()))return"boolean";if(gt(t).isValid())return"date";const n=ot(()=>JSON.parse(t));if(n.error)return"text";const r=n.data;return Array.isArray(r)?"json_array":typeof r=="object"&&r!==null?"json_object":"text"},hs=async(t,s,n)=>{const r=C(),a=`SELECT "${s}" FROM "${t}" LIMIT 20;`,c=await r.exec(a);if(c.length===0)return n;const o=c.map(d=>us(d[s])).filter(d=>d!=="empty"),i=is(o,.9);return!i||i==="unknown"?n:i},ps=async t=>{const s=C(),n=`PRAGMA table_info(${t});`,r=await s.exec(n);if(r.length===0)return null;const c=(await Promise.all(r.map(o=>hs(t,o.name,o.type)))).map(o=>o.toLowerCase());return r.map((o,i)=>({...o,type:c[i]}))},xs=async t=>{const s=C(),n=`PRAGMA foreign_key_list(${t});`;return await s.exec(n)},ms=async t=>{const s=C(),n=`PRAGMA index_list(${t});`,r=await s.exec(n);return await Promise.all(r.map(async c=>{const o=`PRAGMA index_info(${c.name});`,i=await s.exec(o);return{...c,columns:i}}))},R=0,fs=()=>we({mutationFn:cs,onSuccess:t=>{t?console.log("下載資料庫成功"):console.error("下載資料庫失敗")},onError:t=>{console.error("下載資料庫失敗:",t)}}),Gs=()=>E({queryKey:["dbBytes"],queryFn:()=>ls(),staleTime:R}),ne=({types:t})=>E({queryKey:["objects",t],queryFn:()=>Le(t),staleTime:R}),Js=({types:t})=>E({queryKey:["rowCounts",t],queryFn:()=>ds(t),staleTime:R}),Te=({types:t})=>{const{data:s=[],isFetching:n}=ne({types:t}),{data:r,isFetching:a}=E({queryKey:["tableInfos",s],queryFn:async()=>(await Promise.all(s.map(async({name:o,type:i})=>({table:o,type:i,columns:await ps(o)})))).filter(o=>o.columns!==null),enabled:s.length>0,staleTime:R});return{data:r,isFetching:n||a}},gs=({types:t})=>{const{data:s=[],isFetching:n}=ne({types:t}),{data:r,isFetching:a}=E({queryKey:["foreignKeys",s],queryFn:async()=>(await Promise.all(s.map(async({name:o,type:i})=>({table:o,type:i,keys:await xs(o)})))).filter(o=>o.keys.length>0),enabled:s.length>0,staleTime:R});return{data:r,isFetching:n||a}},bs=({types:t})=>{const{data:s=[],isFetching:n}=ne({types:t}),{data:r,isFetching:a}=E({queryKey:["indexes",s],queryFn:async()=>(await Promise.all(s.map(async({name:o,type:i})=>({table:o,type:i,indexes:await ms(o)})))).filter(o=>o.indexes.length>0),enabled:s.length>0,staleTime:R});return{data:r,isFetching:n||a}},Ys=()=>{const{data:t=[],isFetching:s}=Te({types:["table","view"]}),{data:n=[],isFetching:r}=gs({types:["table","view"]}),a=p.useMemo(()=>{if(t.length===0||n.length===0)return[];const o={};return n.forEach(({keys:i})=>{i.forEach(({table:d,to:l})=>{o[d]||(o[d]=new Set),o[d].add(l)})}),t.toSorted((i,d)=>i.type.localeCompare(d.type)).map(({table:i,type:d,columns:l},m)=>{const h=n.find(({table:j})=>j===i)||null,f=l.map(j=>{var k;return{fieldName:j.name,fieldType:j.type,nullable:j.pk===1?"pk":j.notnull===0?"yes":"no",isSource:((k=o[i])==null?void 0:k.has(j.name))||!1,isTarget:(h==null?void 0:h.keys.some(N=>N.from===j.name))||!1}}),b=m%7;return{tableName:i,tableType:d,hueIndex:b,fields:f}})},[t,n]),c=p.useMemo(()=>{if(t.length===0||n.length===0)return[];const o=[];return n.forEach(({table:i,keys:d})=>{d.forEach(({from:l,to:m,table:h})=>{const f=m,b=h===i?`${l}_self`:l;o.push({id:`${h}.${b}->${i}.${f}`,source:h,target:i,sourceHandle:f,targetHandle:b})})}),o},[t,n]);return{nodes:a,edges:c,isFetching:s||r}},Xs=()=>{const{data:t=[],isFetching:s}=Te({types:["table","view"]}),{data:n=[],isFetching:r}=bs({types:["table","view"]});return{data:p.useMemo(()=>{if(t.length===0||n.length===0)return{};const c={};return t.toSorted((o,i)=>o.type.localeCompare(i.type)).forEach(({table:o,columns:i,type:d},l)=>{c[o]={columns:i,indexes:[],type:d,hueIndex:l%7}}),n.forEach(({table:o,indexes:i})=>{c[o]&&c[o].indexes.push(...i)}),c},[t,n]),isFetching:s||r}},xe={outlined:{variant:"outlined",color:"inherit"},main:{variant:"contained",color:"inherit"},danger:{variant:"contained",color:"error"}},G=({variant:t,sx:s,children:n,...r})=>e.jsx(F,{variant:xe[t].variant,color:xe[t].color,sx:{scale:"1.001","&:hover":{scale:"1.05"},"&:active":{scale:"0.95"},transition:"all 0.2s ease",...s},...r,children:n}),ys=()=>{const{status:t,mutate:s}=as(),{status:n,mutate:r}=fs(),[a,c]=p.useState(null),o=l=>{t!=="pending"&&c(l.currentTarget)},i=()=>{s(),c(null)},d=()=>{c(null)};return e.jsxs(u,{sx:{display:"flex",gap:1.5,color:"text.primary"},children:[e.jsx(G,{startIcon:e.jsx(ft,{}),variant:"outlined",children:"匯入"}),e.jsx(G,{startIcon:e.jsx(ns,{}),variant:"main",disableElevation:!0,sx:{bgcolor:"background.paper"},loading:n==="pending",onClick:()=>{n!=="pending"&&r("sqlite3.db")},children:"匯出"}),e.jsx(A,{title:e.jsx(x,{variant:"body2",children:"從伺服器複製一份副本取代目前資料"}),placement:"bottom",arrow:!0,children:e.jsx("span",{children:e.jsx(G,{startIcon:e.jsx(ss,{}),variant:"danger",disableElevation:!0,sx:{cursor:"help",pr:2.5},loading:t==="pending",onClick:o,children:"重置"})})}),e.jsx(ye,{open:!!a,anchorEl:a,onClose:d,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},elevation:3,children:e.jsxs(u,{sx:{p:2,maxWidth:300},children:[e.jsx(x,{variant:"subtitle1",sx:{mb:1},children:"確認重置資料庫"}),e.jsx(x,{variant:"body2",sx:{mb:2,color:"text.secondary"},children:"此操作將從伺服器複製一份新的資料庫，並覆蓋所有本地修改。為避免資料庫不一致，請先關閉所有本網站的分頁再繼續。確定要繼續嗎？"}),e.jsxs(u,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[e.jsx(F,{variant:"outlined",size:"small",onClick:d,color:"inherit",children:"取消"}),e.jsx(F,{variant:"contained",color:"error",size:"small",onClick:i,disabled:t==="pending",disableElevation:!0,children:"確認重置"})]})]})})]})},D={color:"text.secondary"},H={...D,borderRadius:1,bgcolor:"divider",p:.7},js=()=>e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(x,{variant:"body2",sx:H,children:"⇧ Shift"}),e.jsx(x,{variant:"body2",sx:D,children:" + "}),e.jsx(x,{variant:"body2",sx:H,children:"LMB"}),e.jsx(x,{variant:"body2",sx:D,children:"可選取方框範圍內的所有項目，"}),e.jsx(x,{variant:"body2",sx:H,children:"⌘ / Ctrl"}),e.jsx(x,{variant:"body2",sx:D,children:" + "}),e.jsx(x,{variant:"body2",sx:H,children:"LMB"}),e.jsx(x,{variant:"body2",sx:D,children:"可多選個別項目。"})]}),me={[g.datahub_home]:"概覽",[g.datahub_schema]:"結構圖"},ws={[g.datahub_home]:e.jsx(ys,{}),[g.datahub_schema]:e.jsx(js,{})},vs=()=>{const[t,s]=p.useState(null),n=m=>s(h=>h?null:m.currentTarget),r=()=>s(null),{updateSearchParams:a,searchParams:c,pathname:o}=O(),i=m=>()=>{a({db:m}),s(null)};if(!(o.get()in me))throw new Error(`頁面不存在: ${o.get()}`);const d=me[o.get()],l=ws[o.get()];return e.jsxs(u,{sx:{position:"relative",p:5,overflow:"hidden",borderRadius:4,borderTopLeftRadius:0,borderTopRightRadius:0},children:[e.jsx(ts,{}),e.jsxs(u,{sx:{position:"relative",display:"flex",justifyContent:"space-between",alignItems:"flex-end"},children:[e.jsxs(u,{children:[e.jsxs(u,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e.jsx(es,{fontSize:"small",sx:{color:"text.secondary"}}),e.jsxs(Pt,{children:[e.jsx(x,{variant:"body2",sx:{color:"text.secondary"},children:"資料庫"}),e.jsx(x,{variant:"body2",sx:{"&:hover":{textDecoration:"underline"},cursor:"pointer",color:"text.primary"},onClick:n,children:"論壇資料庫"})]}),e.jsx(Ze,{open:!!t,anchorEl:t,onClose:r,children:e.jsx(v,{onClick:r,selected:(c.get("db")||"forum")==="forum",children:e.jsx(x,{variant:"body2",sx:{color:"text.primary"},onClick:i("forum"),children:"論壇資料庫"})})})]}),e.jsx(x,{variant:"h4",component:"h2",sx:{pt:1.5},children:d})]}),l]})]})},Cs="modulepreload",Ss=function(t){return"/"+t},fe={},U=function(s,n,r){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),i=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(n.map(d=>{if(d=Ss(d),d in fe)return;fe[d]=!0;const l=d.endsWith(".css"),m=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${m}`))return;const h=document.createElement("link");if(h.rel=l?"stylesheet":Cs,l||(h.as="script"),h.crossOrigin="",h.href=d,i&&h.setAttribute("nonce",i),document.head.appendChild(h),l)return new Promise((f,b)=>{h.addEventListener("load",f),h.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${d}`)))})}))}function c(o){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o}return a.then(o=>{for(const i of o||[])i.status==="rejected"&&c(i.reason);return s().catch(c)})},en={xs:4,md:6,xl:8},Is={xs:3,md:4,xl:5},tn={xs:1,md:2,xl:3},sn={xs:0,md:0,xl:0},nn={color:"background.paper",bgcolor:"primary.main",borderRadius:1,p:1,fontSize:"3rem"},rn="all 0.4s cubic-bezier(0.4, 0, 0.2, 1)",Es=p.lazy(()=>U(()=>import("./LargeTiles-ZGI74Yjo.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25])).then(t=>({default:t.LargeTiles}))),Rs=p.lazy(()=>U(()=>import("./SmallTiles-C6FKm7Zv.js"),__vite__mapDeps([26,1,2,27,4,5,15,14,28,8,6,17,18,19,20,7,21,3,22,23,24,25])).then(t=>({default:t.SmallTiles}))),ks=p.lazy(()=>U(()=>import("./Sidebar-De8XBQ8L.js"),__vite__mapDeps([29,1,2,11,30,31,32,16,5,14,17,18,19,20,7,8,21,3,22,23,24,25]))),Ps=p.lazy(()=>U(()=>import("./FlowChart-BLYA5syr.js"),__vite__mapDeps([33,1,2,34,30,10,11,12,13,5,28,8,14,17,18,19,20,7,21,3,22,23,24,25]))),Y={borderRadius:4,boxShadow:"none",flex:1},ge={[g.datahub_home]:()=>e.jsxs(J,{sx:{...Y,p:Is},children:[e.jsx(Rs,{}),e.jsx(Es,{})]}),[g.datahub_schema]:()=>e.jsxs(J,{sx:{...Y,position:"relative",overflow:"hidden",display:"flex",alignItems:"stretch"},children:[e.jsx("title",{children:"資料樣板 | 結構圖"}),e.jsx(ks,{}),e.jsx(Ps,{})]})},Ms=()=>e.jsx(J,{sx:{...Y,position:"relative",display:"grid",placeItems:"stretch"},children:e.jsx(u,{sx:{position:"absolute",inset:0,display:"grid",placeItems:"center"},children:e.jsx(Ge,{})})}),Ls=()=>{const{pathname:t}=O();if(!(t.get()in ge))throw new Error(`頁面不存在: ${t.get()}`);const s=ge[t.get()];return e.jsx(p.Suspense,{fallback:e.jsx(Ms,{}),children:s()})},Ts=()=>(qt(),null);function Ds(){const{isSm:t}=ve();return t?e.jsxs(pe,{children:[e.jsx(Ts,{}),e.jsx(Zt,{}),e.jsxs(u,{component:"main",sx:{position:"relative",display:"flex",height:`calc(100dvh - ${Ie}px)`},children:[e.jsx(u,{sx:{position:"absolute",inset:0,bgcolor:"primary.main",opacity:.2,pointerEvents:"none"}}),e.jsx(Xt,{}),e.jsx(u,{sx:{position:"relative",flex:1,height:1,overflow:"auto"},id:"scroll-area",children:e.jsxs(K,{sx:{minHeight:1,gap:3,px:2,pb:3},children:[e.jsx(vs,{}),e.jsx(Ls,{})]})})]})]}):e.jsx(pe,{children:e.jsx($t,{})})}Je.createRoot(document.getElementById("root")).render(e.jsx(p.StrictMode,{children:e.jsx(Ds,{})}));export{ss as R,Te as a,O as b,rn as c,Ys as d,Gs as e,ne as f,Xs as g,en as l,Is as m,sn as n,tn as s,nn as t,Js as u};
