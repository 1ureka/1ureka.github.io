import{r as v,k as ct,l as xt,m as pt,j as t,s as ut,n as mt,o as g,p as ht,q as jt,t as _,v as gt,g as S,T as a,a as n,h as ft,B as bt,e as et,i as vt,f as yt}from"./Toast-DTVs7FW6.js";import{A as Bt}from"./ArrowBackIosRounded-DLISxYP9.js";import{b as Ct,c as $t,B as c,T as It,u as wt,A as Rt,S as St}from"./ScrollArea-CqSHRPTv.js";import{u as L,D as m,C as Q,A as N,a as Pt,b as kt,c as zt}from"./url-Di9IlQWA.js";import{a as V,L as Ft,S as w,T as D,V as st,P as Tt,c as At,A as J,d as Lt,u as Mt}from"./PostHeader-BS2E7Qua.js";import{B as Et,F as Nt,S as Wt,E as X,a as Vt}from"./ExpandedPost-C2a-lSRc.js";import{T as z,I as nt,C as Dt}from"./DarkModeRounded-BRETPBpn.js";import{S as Gt}from"./ThemeMenu-DE-gApYD.js";import{a as G,c as O,b as Ot}from"./session-xflZUqIh.js";import{E as Ut}from"./EmojiMenu-DTI4IP3G.js";import{T as Y,a as A}from"./Tabs-2ZUseKKc.js";import"./CommentRounded-Cvb71559.js";function qt(e){return v.Children.toArray(e).filter(s=>v.isValidElement(s))}function Ht(e){return xt("MuiButtonGroup",e)}const r=ct("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","horizontal","vertical","colorPrimary","colorSecondary","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),Kt=(e,s)=>{const{ownerState:o}=e;return[{[`& .${r.grouped}`]:s.grouped},{[`& .${r.grouped}`]:s[`grouped${g(o.orientation)}`]},{[`& .${r.grouped}`]:s[`grouped${g(o.variant)}`]},{[`& .${r.grouped}`]:s[`grouped${g(o.variant)}${g(o.orientation)}`]},{[`& .${r.grouped}`]:s[`grouped${g(o.variant)}${g(o.color)}`]},{[`& .${r.firstButton}`]:s.firstButton},{[`& .${r.lastButton}`]:s.lastButton},{[`& .${r.middleButton}`]:s.middleButton},s.root,s[o.variant],o.disableElevation===!0&&s.disableElevation,o.fullWidth&&s.fullWidth,o.orientation==="vertical"&&s.vertical]},_t=e=>{const{classes:s,color:o,disabled:l,disableElevation:i,fullWidth:x,orientation:h,variant:u}=e,j={root:["root",u,h,x&&"fullWidth",i&&"disableElevation",`color${g(o)}`],grouped:["grouped",`grouped${g(h)}`,`grouped${g(u)}`,`grouped${g(u)}${g(h)}`,`grouped${g(u)}${g(o)}`,l&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return ht(j,Ht,s)},Qt=ut("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:Kt})(jt(({theme:e})=>({display:"inline-flex",borderRadius:(e.vars||e).shape.borderRadius,variants:[{props:{variant:"contained"},style:{boxShadow:(e.vars||e).shadows[2]}},{props:{disableElevation:!0},style:{boxShadow:"none"}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"vertical"},style:{flexDirection:"column",[`& .${r.lastButton},& .${r.middleButton}`]:{borderTopRightRadius:0,borderTopLeftRadius:0},[`& .${r.firstButton},& .${r.middleButton}`]:{borderBottomRightRadius:0,borderBottomLeftRadius:0}}},{props:{orientation:"horizontal"},style:{[`& .${r.firstButton},& .${r.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${r.lastButton},& .${r.middleButton}`]:{borderTopLeftRadius:0,borderBottomLeftRadius:0}}},{props:{variant:"text",orientation:"horizontal"},style:{[`& .${r.firstButton},& .${r.middleButton}`]:{borderRight:e.vars?`1px solid rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${r.disabled}`]:{borderRight:`1px solid ${(e.vars||e).palette.action.disabled}`}}}},{props:{variant:"text",orientation:"vertical"},style:{[`& .${r.firstButton},& .${r.middleButton}`]:{borderBottom:e.vars?`1px solid rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${r.disabled}`]:{borderBottom:`1px solid ${(e.vars||e).palette.action.disabled}`}}}},...Object.entries(e.palette).filter(_()).flatMap(([s])=>[{props:{variant:"text",color:s},style:{[`& .${r.firstButton},& .${r.middleButton}`]:{borderColor:e.vars?`rgba(${e.vars.palette[s].mainChannel} / 0.5)`:gt(e.palette[s].main,.5)}}}]),{props:{variant:"outlined",orientation:"horizontal"},style:{[`& .${r.firstButton},& .${r.middleButton}`]:{borderRightColor:"transparent","&:hover":{borderRightColor:"currentColor"}},[`& .${r.lastButton},& .${r.middleButton}`]:{marginLeft:-1}}},{props:{variant:"outlined",orientation:"vertical"},style:{[`& .${r.firstButton},& .${r.middleButton}`]:{borderBottomColor:"transparent","&:hover":{borderBottomColor:"currentColor"}},[`& .${r.lastButton},& .${r.middleButton}`]:{marginTop:-1}}},{props:{variant:"contained",orientation:"horizontal"},style:{[`& .${r.firstButton},& .${r.middleButton}`]:{borderRight:`1px solid ${(e.vars||e).palette.grey[400]}`,[`&.${r.disabled}`]:{borderRight:`1px solid ${(e.vars||e).palette.action.disabled}`}}}},{props:{variant:"contained",orientation:"vertical"},style:{[`& .${r.firstButton},& .${r.middleButton}`]:{borderBottom:`1px solid ${(e.vars||e).palette.grey[400]}`,[`&.${r.disabled}`]:{borderBottom:`1px solid ${(e.vars||e).palette.action.disabled}`}}}},...Object.entries(e.palette).filter(_(["dark"])).map(([s])=>({props:{variant:"contained",color:s},style:{[`& .${r.firstButton},& .${r.middleButton}`]:{borderColor:(e.vars||e).palette[s].dark}}}))],[`& .${r.grouped}`]:{minWidth:40,boxShadow:"none",props:{variant:"contained"},style:{"&:hover":{boxShadow:"none"}}}}))),Jt=v.forwardRef(function(s,o){const l=pt({props:s,name:"MuiButtonGroup"}),{children:i,className:x,color:h="primary",component:u="div",disabled:j=!1,disableElevation:d=!1,disableFocusRipple:p=!1,disableRipple:f=!1,fullWidth:b=!1,orientation:y="horizontal",size:$="medium",variant:I="outlined",...F}=l,P={...l,color:h,component:u,disabled:j,disableElevation:d,disableFocusRipple:p,disableRipple:f,fullWidth:b,orientation:y,size:$,variant:I},B=_t(P),C=v.useMemo(()=>({className:B.grouped,color:h,disabled:j,disableElevation:d,disableFocusRipple:p,disableRipple:f,fullWidth:b,size:$,variant:I}),[h,j,d,p,f,b,$,I,B.grouped]),H=qt(i),lt=H.length,dt=T=>{const k=T===0,K=T===lt-1;return k&&K?"":k?B.firstButton:K?B.lastButton:B.middleButton};return t.jsx(Qt,{as:u,role:"group",className:mt(B.root,x),ref:o,ownerState:P,...F,children:t.jsx(Ct.Provider,{value:C,children:H.map((T,k)=>t.jsx($t.Provider,{value:dt(k),children:T},k))})})}),M=S(t.jsx("path",{d:"m11.71 15.29 2.59-2.59c.39-.39.39-1.02 0-1.41L11.71 8.7c-.63-.62-1.71-.18-1.71.71v5.17c0 .9 1.08 1.34 1.71.71"}),"ArrowRightRounded"),E=S(t.jsx("path",{d:"M12.29 8.71 9.7 11.3c-.39.39-.39 1.02 0 1.41l2.59 2.59c.63.63 1.71.18 1.71-.71V9.41c0-.89-1.08-1.33-1.71-.7"}),"ArrowLeftRounded"),R={display:"-webkit-box",WebkitLineClamp:1,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",textTransform:"none"},Xt=()=>{const{searchParams:e,updateSearchParams:s}=L(),o=e.get("postId"),l=o&&/^\d+$/.test(o)&&Number(o)>0?Number(o):-1,{data:i,isFetching:x}=V(l-1);return x&&!i?t.jsx(c,{startIcon:t.jsx(E,{}),loading:!0,children:t.jsx(a,{variant:"button",sx:R,children:"載入中..."})}):i?t.jsx(c,{startIcon:t.jsx(E,{}),onClick:()=>s({postId:(l-1).toString()}),children:t.jsxs(a,{variant:"button",sx:R,children:["上一篇：",i.title]})}):t.jsx(c,{startIcon:t.jsx(E,{}),disabled:!0,children:t.jsx(a,{variant:"button",sx:R,children:"沒有上一篇了"})})},Yt=()=>{const{searchParams:e,updateSearchParams:s}=L(),o=e.get("postId"),l=o&&/^\d+$/.test(o)&&Number(o)>0?Number(o):-1,{data:i,isFetching:x}=V(l+1);return x&&!i?t.jsx(c,{endIcon:t.jsx(M,{}),loading:!0,children:t.jsx(a,{variant:"button",sx:R,children:"載入中..."})}):i?t.jsx(c,{endIcon:t.jsx(M,{}),onClick:()=>s({postId:(l+1).toString()}),children:t.jsxs(a,{variant:"button",sx:R,children:["下一篇：",i.title]})}):t.jsx(c,{endIcon:t.jsx(M,{}),disabled:!0,children:t.jsx(a,{variant:"button",sx:R,children:"沒有下一篇了"})})},Zt=S(t.jsx("path",{d:"m21.41 11.41-8.83-8.83c-.37-.37-.88-.58-1.41-.58H4c-1.1 0-2 .9-2 2v7.17c0 .53.21 1.04.59 1.41l8.83 8.83c.78.78 2.05.78 2.83 0l7.17-7.17c.78-.78.78-2.04-.01-2.83M6.5 8C5.67 8 5 7.33 5 6.5S5.67 5 6.5 5 8 5.67 8 6.5 7.33 8 6.5 8"}),"Sell"),te=e=>Array.from({length:e},()=>Math.random()*.7+.3),ee=()=>t.jsxs(n,{sx:{pt:1.5},children:[t.jsx(m,{}),t.jsxs(n,{sx:{position:"relative",py:1.5,height:"fit-content"},children:[t.jsx(n,{sx:{position:"absolute",inset:0,bgcolor:"divider",opacity:.35,pointerEvents:"none"}}),t.jsx(n,{sx:{px:2.5},children:t.jsx(Ft,{sx:{m:0}})})]}),t.jsx(m,{sx:{mb:2.5}}),t.jsxs(n,{sx:{px:2.5,position:"relative"},children:[t.jsx(w,{variant:"rounded",animation:"wave",sx:{mb:1},children:t.jsx(a,{variant:"h4",component:"h2",sx:{textAlign:"start"},gutterBottom:!0,children:"正在載入標題... 正在載入"})}),te(4).map((e,s)=>t.jsx(w,{variant:"text",animation:"wave",width:`${e*100}%`},s)),t.jsx(ft,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}})]}),t.jsx(m,{sx:{mt:2.5}}),t.jsxs(n,{sx:{p:1.5,py:1,display:"flex",gap:1.5,alignItems:"center",position:"relative",color:"text.secondary"},children:[t.jsx(n,{sx:{position:"absolute",inset:0,bgcolor:"divider",opacity:.35}}),t.jsx(c,{color:"inherit",startIcon:t.jsx(D,{}),size:"small",loading:!0,children:t.jsx(a,{variant:"caption",component:"span",children:"100 個讚"})}),t.jsx(c,{color:"inherit",startIcon:t.jsx(Et,{}),size:"small",loading:!0,children:t.jsx(a,{variant:"caption",component:"span",children:"收藏該貼文"})}),t.jsx(n,{sx:{flex:1}}),t.jsx(c,{color:"inherit",startIcon:t.jsx(st,{}),size:"small",loading:!0,children:t.jsx(a,{variant:"caption",component:"span",children:"1000 次瀏覽"})})]}),t.jsx(m,{})]}),se=({post:e})=>t.jsxs(n,{sx:{pt:1.5},children:[t.jsx("title",{children:`論壇樣板 | ${e.title}`}),t.jsx(m,{}),t.jsxs(n,{sx:{position:"relative",py:1.5,height:"fit-content"},children:[t.jsx(n,{sx:{position:"absolute",inset:0,bgcolor:"divider",opacity:.35,pointerEvents:"none"}}),t.jsx(n,{sx:{px:2.5},children:t.jsx(Tt,{post:e,sx:{m:0}})})]}),t.jsx(m,{sx:{mb:2.5}}),t.jsxs(n,{sx:{px:2.5},children:[t.jsx(a,{variant:"h4",component:"h2",sx:{textAlign:"start"},gutterBottom:!0,children:e.title}),t.jsx(a,{variant:"body2",component:"p",sx:{whiteSpace:"pre-line"},children:e.content}),e.photos&&e.photos.length>0&&t.jsx(n,{sx:{display:"grid",gap:1,mt:2,gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))"},children:e.photos.map(({name:s,url:o},l)=>t.jsx(z,{title:"查看圖片",arrow:!0,placement:"top",children:t.jsx(bt,{sx:{position:"relative",aspectRatio:"1 / 1",bgcolor:"divider",borderRadius:1,overflow:"hidden"},children:t.jsx(n,{sx:{position:"absolute",inset:"auto 0 0 0",pb:1,display:"grid",placeItems:"center"},children:t.jsx(Q,{label:s,size:"small"})})})},`${o}${l}`))}),t.jsxs(Gt,{sx:{gap:1.5,flexDirection:"row",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap-reverse",mt:2},children:[t.jsxs(n,{sx:{display:"flex",gap:1.5,flexWrap:"wrap",alignItems:"center"},children:[t.jsxs(a,{variant:"subtitle2",sx:{color:"text.secondary",display:"flex",alignItems:"center",gap:.5},children:[t.jsx(Zt,{fontSize:"small"}),"標籤："]}),t.jsx(At,{post:e,displayCount:99})]}),e.attachments&&e.attachments.length>0&&t.jsxs(n,{sx:{display:"flex",gap:1,flexWrap:"wrap",alignItems:"center"},children:[t.jsxs(a,{variant:"subtitle2",sx:{color:"text.secondary",display:"flex",alignItems:"center",gap:.5},children:[t.jsx(J,{fontSize:"small"}),"附件："]}),e.attachments.map((s,o)=>t.jsx(z,{title:"下載附件",arrow:!0,placement:"top",children:t.jsx(Q,{label:`${s.name} (${(s.size/1024).toFixed(1)}KB)`,clickable:!0,icon:t.jsx(J,{fontSize:"small"})})},o))]})]})]}),t.jsx(m,{sx:{mt:2.5}}),t.jsxs(n,{sx:{px:2.5,py:1,display:"flex",gap:1.5,alignItems:"center",position:"relative",color:"text.secondary"},children:[t.jsx(n,{sx:{position:"absolute",inset:0,bgcolor:"divider",opacity:.35}}),t.jsx(Lt,{postId:e.id}),t.jsx(Nt,{postId:e.id}),t.jsx(n,{sx:{flex:1}}),t.jsx(c,{startIcon:t.jsx(st,{}),disabled:!0,size:"small",sx:{"button&.Mui-disabled":{color:"text.secondary",opacity:.8}},children:t.jsxs(a,{variant:"caption",component:"span",children:[e.viewCount," 次瀏覽"]})})]}),t.jsx(m,{flexItem:!0})]}),ne=async e=>(await new Promise(s=>setTimeout(s,Math.random()*1e3)),O.filter(s=>s.postId===e&&!s.parentId).map(s=>s.id)||[]),oe=async e=>(await new Promise(s=>setTimeout(s,Math.random()*1e3)),O.filter(s=>s.parentId===e).map(s=>s.id)||[]),re=async e=>(await new Promise(s=>setTimeout(s,Math.random()*1e3)),O.find(s=>s.id===e)||null),U=1e3*60*10,ie=e=>G({queryKey:["commentsByPost",e],queryFn:()=>ne(e),staleTime:U}),ot=e=>G({queryKey:["commentsByComment",e],queryFn:()=>oe(e),staleTime:U}),ae=e=>G({queryKey:["comment",e],queryFn:()=>re(e),staleTime:U}),rt=S(t.jsx("path",{d:"M10 9V7.41c0-.89-1.08-1.34-1.71-.71L3.7 11.29c-.39.39-.39 1.02 0 1.41l4.59 4.59c.63.63 1.71.19 1.71-.7V14.9c5 0 8.5 1.6 11 5.1-1-5-4-10-11-11"}),"ReplyRounded"),it=S(t.jsx("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"MoreVert"),Z=S(t.jsx("path",{d:"M8.12 9.29 12 13.17l3.88-3.88c.39-.39 1.02-.39 1.41 0s.39 1.02 0 1.41l-4.59 4.59c-.39.39-1.02.39-1.41 0L6.7 10.7a.996.996 0 0 1 0-1.41c.39-.38 1.03-.39 1.42 0"}),"KeyboardArrowDownRounded"),W=({sx:e,onCancel:s,...o})=>{const{user:l,authenticated:i,loading:x}=Ot(),h=v.useRef(null),[u,j]=v.useState(""),d=p=>{j(f=>{const b=h.current;if(b){const y=b.selectionStart||0,$=b.selectionEnd||0,I=f.substring(0,y)+p+f.substring($);return setTimeout(()=>{b.focus(),b.setSelectionRange(y+p.length,y+p.length)},0),I}return f+p})};return t.jsx(n,{sx:{position:"relative",py:1,px:2,...e},...o,children:t.jsxs(n,{sx:{display:"flex",alignItems:"flex-start",gap:1.5},children:[i&&l?t.jsx(N,{sx:{bgcolor:"primary.main",width:"2rem",height:"2rem",mt:1.5},children:l.name.slice(0,1).toUpperCase()}):t.jsx(N,{sx:{width:"2rem",height:"2rem",mt:1.5}}),t.jsxs(n,{sx:{flex:1},component:"form",children:[t.jsx(It,{inputRef:h,variant:"standard",size:"small",name:"comment",label:i?"發表你的想法":"登入後即可發表留言",fullWidth:!0,type:"text",value:u,onChange:p=>j(p.target.value),disabled:!i||x}),t.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",mt:1,alignItems:"center",gap:1},children:[t.jsx(Ut,{onEmojiClick:d,disabled:!i||x}),t.jsxs(n,{sx:{display:"flex",gap:1},children:[t.jsx(c,{size:"small",disabled:!i||x,sx:{color:"text.secondary"},onClick:()=>{j(""),s!==void 0&&s()},children:"取消"}),t.jsx(c,{size:"small",disabled:!i||x||u.trim().length===0,variant:"contained",children:"留言"})]})]})]})]})})},le=()=>Math.floor(Math.random()*100),at=({commentId:e,nestedLevel:s,sx:o,...l})=>{if(s<0)throw new Error("nestedLevel must be greater than 0");const[i,x]=v.useState(!1),[h,u]=v.useState(le),j=()=>{x(!i),u(C=>i?C-1:C+1)},{data:d,isFetching:p}=ae(e),{data:f,isFetching:b}=ot(e),[y,$]=v.useState(!1),I=()=>$(C=>!C),[F,P]=v.useState(!1),B=()=>P(C=>!C);return p||!d||b?t.jsx(q,{nestedLevel:s,sx:o,...l}):t.jsx(n,{sx:{position:"relative",py:1,pb:s>0?0:1,pl:2,borderLeft:s>0?"2px solid":"none",borderColor:"divider",...o},...l,children:t.jsxs(n,{sx:{display:"flex",alignItems:"flex-start",gap:1.5},children:[t.jsx(N,{sx:{bgcolor:"primary.main",width:"2rem",height:"2rem",mt:1},children:d.author.slice(0,1).toUpperCase()}),t.jsxs(n,{sx:{flex:1},children:[t.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(a,{variant:"subtitle2",component:"a",sx:{"&:hover":{textDecoration:"underline"},color:"text.primary"},href:`${et.forum_users}?user=${d.author}`,children:d.author}),t.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:.5},children:[t.jsx(a,{variant:"caption",color:"text.secondary",children:d.createdAt.toLocaleString()}),d.createdAt.getTime()!==d.updatedAt.getTime()&&t.jsx(z,{title:`最後編輯於 ${d.updatedAt.toLocaleString()}`,arrow:!0,children:t.jsx(a,{variant:"caption",color:"text.secondary",children:"(已編輯)"})}),t.jsx(z,{title:"更多選項",arrow:!0,children:t.jsx(nt,{size:"small",children:t.jsx(it,{fontSize:"small"})})})]})]}),t.jsx(a,{variant:"body2",sx:{mt:.5,whiteSpace:"pre-line"},children:d.content}),t.jsxs(n,{sx:{display:"flex",alignItems:"center",mt:1,gap:1},children:[t.jsx(c,{size:"small",startIcon:t.jsx(D,{}),onClick:j,color:i?"primary":"inherit",sx:{color:i?void 0:"text.secondary"},children:t.jsx(a,{variant:"caption",children:h>0?h:"讚"})}),t.jsx(c,{size:"small",startIcon:t.jsx(rt,{}),sx:{color:"text.secondary"},onClick:B,children:t.jsx(a,{variant:"caption",children:F?"取消回覆":"回覆"})})]}),F&&t.jsx(W,{onCancel:()=>P(!1)}),f&&f.length>0&&t.jsx(c,{startIcon:y?t.jsx(Z,{sx:{transform:"rotate(180deg)",transition:"transform 0.2s ease",transformOrigin:"center"}}):t.jsx(Z,{}),sx:{mt:1},size:"small",onClick:I,children:y?"隱藏回覆":`顯示 ${f.length||0} 則回覆`}),y&&f&&t.jsx(de,{commentId:e})]})]})})},q=({nestedLevel:e,sx:s,...o})=>t.jsx(n,{sx:{position:"relative",py:1,pb:e>0?0:1,pl:2,borderLeft:e>0?"2px solid":"none",borderColor:"divider",...s},...o,children:t.jsxs(n,{sx:{display:"flex",alignItems:"flex-start",gap:1.5},children:[t.jsx(w,{variant:"circular",width:"2rem",height:"2rem",sx:{mt:1},animation:"wave"}),t.jsxs(n,{sx:{flex:1},children:[t.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(w,{variant:"rounded",animation:"wave",children:t.jsx(a,{variant:"subtitle2",component:"span",children:"載入名稱中..."})}),t.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:.5},children:[t.jsx(w,{variant:"rounded",animation:"wave",children:t.jsx(a,{variant:"caption",color:"text.secondary",children:"0000-00-00 00:00:00"})}),t.jsx(z,{title:"更多選項",arrow:!0,children:t.jsx("span",{children:t.jsx(nt,{size:"small",disabled:!0,children:t.jsx(it,{fontSize:"small"})})})})]})]}),t.jsx(w,{variant:"rounded",animation:"wave",children:t.jsx(a,{variant:"body2",sx:{mt:.5,whiteSpace:"pre-line"},children:"佔位文字，佔位文字，佔位文字，佔位文字，佔位文字，佔位文字，"})}),t.jsxs(n,{sx:{display:"flex",alignItems:"center",mt:1,gap:1},children:[t.jsx(c,{size:"small",startIcon:t.jsx(D,{}),sx:{color:"text.secondary"},loading:!0,children:t.jsx(a,{variant:"caption",children:"讚"})}),t.jsx(c,{size:"small",startIcon:t.jsx(rt,{}),sx:{color:"text.secondary"},loading:!0,children:t.jsx(a,{variant:"caption",children:"回覆"})})]})]})]})}),de=({commentId:e})=>{const{data:s,isFetching:o}=ot(e);return o?t.jsx(n,{children:[...Array(1)].map((l,i)=>t.jsx(q,{nestedLevel:1},i))}):s?t.jsx(n,{children:s.map(l=>t.jsx(at,{commentId:l,nestedLevel:1},l))}):null},tt={content:'""',display:"block",position:"absolute",inset:0,bgcolor:"divider",opacity:.2,pointerEvents:"none",mr:-2},ce=()=>{const{searchParams:e,updateSearchParams:s}=L(),o=e.get("postId"),l=o&&/^\d+$/.test(o)&&Number(o)>0?Number(o):-1,{data:i,isFetching:x}=ie(l),u=(e.get("orderBy")||"latest")==="likes"?"likes":"latest",j=(d,p)=>{s({orderBy:p===0?"latest":"likes"})};return x?t.jsxs(t.Fragment,{children:[t.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[t.jsx(w,{variant:"rounded",animation:"wave",sx:{mx:2},children:t.jsx(a,{variant:"subtitle1",component:"h3",children:"0 則留言"})}),t.jsx(m,{flexItem:!0,orientation:"vertical",variant:"middle"}),t.jsxs(Y,{value:u==="latest"?0:1,onChange:j,children:[t.jsx(A,{label:"最新",disabled:!0}),t.jsx(A,{label:"最多人按讚",disabled:!0})]})]}),t.jsx(m,{}),t.jsx(n,{sx:{pr:2,"& > .comment:nth-of-type(odd):before":tt},children:[...Array(3)].map((d,p)=>t.jsx(q,{nestedLevel:0,className:"comment"},p))})]}):!i||i.length===0?t.jsxs(t.Fragment,{children:[t.jsx(n,{sx:{pr:2},children:t.jsx(W,{})}),t.jsx(n,{sx:{pb:2},children:t.jsx(a,{variant:"body2",sx:{color:"text.secondary",textAlign:"center",mt:2},children:"還沒有留言，快來發表你的看法吧！"})})]}):t.jsxs(t.Fragment,{children:[t.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[t.jsxs(a,{variant:"subtitle1",component:"h3",sx:{px:2},children:[i.length," 則留言"]}),t.jsx(m,{flexItem:!0,orientation:"vertical",variant:"middle"}),t.jsxs(Y,{value:u==="latest"?0:1,onChange:j,children:[t.jsx(A,{label:"最新"}),t.jsx(A,{label:"最多人按讚"})]})]}),t.jsx(m,{}),t.jsxs(n,{sx:{pr:2,"& > .comment:nth-of-type(odd):before":tt},children:[t.jsx(W,{className:"comment"}),i.map(d=>t.jsx(at,{commentId:d,nestedLevel:0,className:"comment"},d))]})]})},xe=()=>{const{data:e,isFetching:s}=Mt({limit:2,orderBy:"likeCount",order:"desc"});return s||!e?t.jsxs(n,{children:[t.jsx(X,{}),t.jsx(X,{})]}):t.jsx(n,{children:e.map(o=>t.jsx(Vt,{postId:o},o))})},pe=()=>{const{searchParams:e}=L(),s=e.get("postId"),o=s&&/^\d+$/.test(s)&&Number(s)>0?Number(s):-1,{data:l,isFetching:i}=V(o);return i&&!l?t.jsx(ee,{}):l?t.jsxs(t.Fragment,{children:[t.jsx(se,{post:l}),t.jsx(ce,{})]}):t.jsxs(n,{sx:{pt:1.5},children:[t.jsx(m,{}),t.jsxs(n,{sx:{py:6,display:"flex",flexDirection:"column",alignItems:"center",gap:2},children:[t.jsx(Wt,{sx:{fontSize:"6rem",color:"action.disabled"}}),t.jsx(a,{variant:"body1",component:"p",sx:{color:"text.secondary",textAlign:"center"},children:"貼文不存在或已被刪除"})]}),t.jsx(m,{}),t.jsxs(n,{sx:{position:"relative"},children:[t.jsx(n,{sx:{position:"absolute",inset:0,bgcolor:"divider",opacity:.35}}),t.jsx(a,{variant:"h6",sx:{p:2},children:"我們找不到這篇貼文...但你可能會喜歡這些！"})]}),t.jsx(m,{}),t.jsx(xe,{})]})};function ue(){const{isMd:e}=wt();return t.jsxs(Rt,{children:[t.jsx(n,{sx:{bgcolor:"secondary.main",height:"35vh",position:"absolute",inset:"0 0 auto 0"}}),t.jsxs(St,{children:[e?t.jsx(Pt,{}):t.jsx(kt,{}),t.jsx(Dt,{maxWidth:"lg",sx:{position:"relative",my:10},children:t.jsxs(vt,{sx:{pb:3,borderRadius:3,border:"1px solid",borderColor:"divider"},elevation:1,children:[t.jsxs(n,{sx:{display:"flex",justifyContent:"center",mt:2,mx:2},children:[t.jsx(c,{href:et.forum_home,startIcon:t.jsx(Bt,{}),variant:"outlined",sx:{textWrap:"nowrap"},children:e?"返回首頁":"首頁"}),t.jsx(n,{sx:{flex:1}}),t.jsxs(Jt,{variant:"text",children:[t.jsx(Xt,{}),t.jsx(Yt,{})]})]}),t.jsx(pe,{})]})}),t.jsx(zt,{})]})]})}yt.createRoot(document.getElementById("root")).render(t.jsx(v.StrictMode,{children:t.jsx(ue,{})}));
